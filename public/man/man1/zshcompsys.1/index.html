<!DOCTYPE html>
<html
    lang="en-us"
    dir="ltr"
>
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Manpages - zshcompsys.1 | Technical Notes</title>

    <link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/css/syntax.css">
        
        
    </head>
    <body>
        <header class="container header">
            <span class="header__title">Technical Notes</span>
<button id="menuOpenBtn" class="header__menu-open-btn"><i data-lucide="menu"></i></button>

  <nav id="siteNav">
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a href="/notes/">Notes</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/man/">Manpages</a>
    </li>
    <li>
      <a href="/search/">Search</a>
    </li>
    </ul>
    <button id="menuCloseBtn" class="header__menu-close-btn"><i data-lucide="x"></i></button>
  </nav>


        </header>
        <main class="container">
            
    <h1>Manpages - zshcompsys.1</h1>
    
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
NAME
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>zshcompsys - zsh completion system</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
DESCRIPTION
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>This describes the shell code for the `new&#39; completion system, referred
to as <strong>compsys</strong>. It is written in shell functions based on the features
described in /zshcompwid/(1).</p>
<p>
The features are contextual, sensitive to the point at which completion
is started. Many completions are already provided. For this reason, a
user can perform a great many tasks without knowing any details beyond
how to initialize the system, which is described below in
INITIALIZATION.</p>
<p>
The context that decides what completion is to be performed may be</p>
<p>
· an argument or option position: these describe the position on the
command line at which completion is requested. For example `first
argument to rmdir, the word being completed names a directory&#39;;</p>
<dl>
<dt>
·
</dt>
<dd>a special context, denoting an element in the shell&#39;s syntax. For
example `a word in command position&#39; or `an array subscript&#39;.</dd>
</dl>
<p>A full context specification contains other elements, as we shall
describe.</p>
<p>
Besides commands names and contexts, the system employs two more
concepts, <em>styles</em> and <em>tags</em>. These provide ways for the user to
configure the system&#39;s behaviour.</p>
<p>
Tags play a dual role. They serve as a classification system for the
matches, typically indicating a class of object that the user may need
to distinguish. For example, when completing arguments of the <strong>ls</strong>
command the user may prefer to try <strong>files</strong> before <strong>directories</strong>, so both
of these are tags. They also appear as the rightmost element in a
context specification.</p>
<p>
Styles modify various operations of the completion system, such as
output formatting, but also what kinds of completers are used (and in
what order), or which tags are examined. Styles may accept arguments and
are manipulated using the <strong>zstyle</strong> command described in /zshmodules/(1).</p>
<p>
In summary, tags describe <em>what</em> the completion objects are, and style
<strong>how</strong> they are to be completed. At various points of execution, the
completion system checks what styles and/or tags are defined for the
current context, and uses that to modify its behavior. The full
description of context handling, which determines how tags and other
elements of the context influence the behaviour of styles, is described
below in COMPLETION SYSTEM CONFIGURATION.</p>
<p>
When a completion is requested, a dispatcher function is called; see the
description of <strong>_main_complete</strong> in the list of control functions below.
This dispatcher decides which function should be called to produce the
completions, and calls it. The result is passed to one or more
<em>completers</em>, functions that implement individual completion strategies:
simple completion, error correction, completion with error correction,
menu selection, etc.</p>
<p>
More generally, the shell functions contained in the completion system
are of two types:</p>
<p>
· those beginning `*comp*&#39; are to be called directly; there are only a
few of these;</p>
<dl>
<dt>
·
</dt>
<dd>those beginning `*_*&#39; are called by the completion code. The
shell functions of this set, which implement completion behaviour and
may be bound to keystrokes, are referred to as `widgets&#39;. These
proliferate as new completions are required.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
INITIALIZATION
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>If the system was installed completely, it should be enough to call the
shell function <strong>compinit</strong> from your initialization file; see the next
section. However, the function <strong>compinstall</strong> can be run by a user to
configure various aspects of the completion system.</p>
<p>
Usually, <strong>compinstall</strong> will insert code into <strong>.zshrc</strong>, although if that
is not writable it will save it in another file and tell you that file&#39;s
location. Note that it is up to you to make sure that the lines added to
<strong>.zshrc</strong> are actually run; you may, for example, need to move them to an
earlier place in the file if <strong>.zshrc</strong> usually returns early. So long as
you keep them all together (including the comment lines at the start and
finish), you can rerun <strong>compinstall</strong> and it will correctly locate and
modify these lines. Note, however, that any code you add to this section
by hand is likely to be lost if you rerun <strong>compinstall</strong>, although lines
using the command `*zstyle*&#39; should be gracefully handled.</p>
<p>
The new code will take effect next time you start the shell, or run
<strong>.zshrc</strong> by hand; there is also an option to make them take effect
immediately. However, if <strong>compinstall</strong> has removed definitions, you will
need to restart the shell to see the changes.</p>
<p>
To run <strong>compinstall</strong> you will need to make sure it is in a directory
mentioned in your <strong>fpath</strong> parameter, which should already be the case if
zsh was properly configured as long as your startup files do not remove
the appropriate directories from <strong>fpath</strong>. Then it must be autoloaded
(`*autoload -U compinstall*&#39; is recommended). You can abort the
installation any time you are being prompted for information, and your
<strong>.zshrc</strong> will not be altered at all; changes only take place right at
the end, where you are specifically asked for confirmation.</p>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
Use of compinit
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>This section describes the use of <strong>compinit</strong> to initialize completion
for the current session when called directly; if you have run
<strong>compinstall</strong> it will be called automatically from your <strong>.zshrc</strong>.</p>
<p>
To initialize the system, the function <strong>compinit</strong> should be in a
directory mentioned in the <strong>fpath</strong> parameter, and should be autoloaded
(`*autoload -U compinit*&#39; is recommended), and then run simply as
`*compinit*&#39;. This will define a few utility functions, arrange for all
the necessary shell functions to be autoloaded, and will then re-define
all widgets that do completion to use the new system. If you use the
<strong>menu-select</strong> widget, which is part of the <strong>zsh/complist</strong> module, you
should make sure that that module is loaded before the call to
<strong>compinit</strong> so that that widget is also re-defined. If completion styles
(see below) are set up to perform expansion as well as completion by
default, and the TAB key is bound to <strong>expand-or-complete</strong>, <strong>compinit</strong>
will rebind it to <strong>complete-word</strong>; this is necessary to use the correct
form of expansion.</p>
<p>
Should you need to use the original completion commands, you can still
bind keys to the old widgets by putting a `*.*&#39; in front of the widget
name, e.g. `*.expand-or-complete*&#39;.</p>
<p>
To speed up the running of <strong>compinit</strong>, it can be made to produce a
dumped configuration that will be read in on future invocations; this is
the default, but can be turned off by calling <strong>compinit</strong> with the option
<strong>-D</strong>. The dumped file is <strong>.zcompdump</strong> in the same directory as the
startup files (i.e. <strong>$ZDOTDIR</strong> or <strong>$HOME</strong>); alternatively, an explicit
file name can be given by `*compinit -d* <em>dumpfile</em>&#39;. The next
invocation of <strong>compinit</strong> will read the dumped file instead of performing
a full initialization.</p>
<p>
If the number of completion files changes, <strong>compinit</strong> will recognise
this and produce a new dump file. However, if the name of a function or
the arguments in the first line of a <strong>#compdef</strong> function (as described
below) change, it is easiest to delete the dump file by hand so that
<strong>compinit</strong> will re-create it the next time it is run. The check
performed to see if there are new functions can be omitted by giving the
option <strong>-C</strong>. In this case the dump file will only be created if there
isn&#39;t one already.</p>
<p>
The dumping is actually done by another function, <strong>compdump</strong>, but you
will only need to run this yourself if you change the configuration
(e.g. using <strong>compdef</strong>) and then want to dump the new one. The name of
the old dumped file will be remembered for this purpose.</p>
<p>
If the parameter <strong>_compdir</strong> is set, <strong>compinit</strong> uses it as a directory
where completion functions can be found; this is only necessary if they
are not already in the function search path.</p>
<p>
For security reasons <strong>compinit</strong> also checks if the completion system
would use files not owned by root or by the current user, or files in
directories that are world- or group-writable or that are not owned by
root or by the current user. If such files or directories are found,
<strong>compinit</strong> will ask if the completion system should really be used. To
avoid these tests and make all files found be used without asking, use
the option <strong>-u</strong>, and to make <strong>compinit</strong> silently ignore all insecure
files and directories use the option <strong>-i</strong>. This security check is
skipped entirely when the <strong>-C</strong> option is given, provided the dumpfile
exists.</p>
<p>
The security check can be retried at any time by running the function
<strong>compaudit</strong>. This is the same check used by <strong>compinit</strong>, but when it is
executed directly any changes to <strong>fpath</strong> are made local to the function
so they do not persist. The directories to be checked may be passed as
arguments; if none are given, <strong>compaudit</strong> uses <strong>fpath</strong> and <strong>_compdir</strong> to
find completion system directories, adding missing ones to <strong>fpath</strong> as
necessary. To force a check of exactly the directories currently named
in <strong>fpath</strong>, set <strong>_compdir</strong> to an empty string before calling <strong>compaudit</strong>
or <strong>compinit</strong>.</p>
<p>
The function <strong>bashcompinit</strong> provides compatibility with bash&#39;s
programmable completion system. When run it will define the functions,
<strong>compgen</strong> and <strong>complete</strong> which correspond to the bash builtins with the
same names. It will then be possible to use completion specifications
and functions written for bash.</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
Autoloaded files
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>The convention for autoloaded functions used in completion is that they
start with an underscore; as already mentioned, the <strong>fpath/FPATH</strong>
parameter must contain the directory in which they are stored. If <strong>zsh</strong>
was properly installed on your system, then <strong>fpath/FPATH</strong> automatically
contains the required directories for the standard functions.</p>
<p>
For incomplete installations, if <strong>compinit</strong> does not find enough files
beginning with an underscore (fewer than twenty) in the search path, it
will try to find more by adding the directory <strong>_compdir</strong> to the search
path. If that directory has a subdirectory named <strong>Base</strong>, all
subdirectories will be added to the path. Furthermore, if the
subdirectory <strong>Base</strong> has a subdirectory named <strong>Core</strong>, <strong>compinit</strong> will add
all subdirectories of the subdirectories to the path: this allows the
functions to be in the same format as in the <strong>zsh</strong> source distribution.</p>
<p>
When <strong>compinit</strong> is run, it searches all such files accessible via
<strong>fpath/FPATH</strong> and reads the first line of each of them. This line should
contain one of the tags described below. Files whose first line does not
start with one of these tags are not considered to be part of the
completion system and will not be treated specially.</p>
<p>
The tags are:</p>
<p>
<strong>#compdef</strong> <em>name</em> … [ <strong>-*{*p*|*P</strong>} <em>pattern</em> … [ <strong>-N</strong> <em>name</em> … ] ]
The file will be made autoloadable and the function defined in it will
be called when completing /name/s, each of which is either the name of a
command whose arguments are to be completed or one of a number of
special contexts in the form <strong>-*/context/</strong>-* described below.</p>
<blockquote>
<p>Each <em>name</em> may also be of the form `/cmd/*=*/service/&#39;. When completing
the command <em>cmd</em>, the function typically behaves as if the command (or
special context) <em>service</em> was being completed instead. This provides a
way of altering the behaviour of functions that can perform many
different completions. It is implemented by setting the parameter
<strong>$service</strong> when calling the function; the function may choose to
interpret this how it wishes, and simpler functions will probably ignore
it.</p>
<p>
If the <strong>#compdef</strong> line contains one of the options <strong>-p</strong> or <strong>-P</strong>, the
words following are taken to be patterns. The function will be called
when completion is attempted for a command or context that matches one
of the patterns. The options <strong>-p</strong> and <strong>-P</strong> are used to specify patterns
to be tried before or after other completions respectively. Hence <strong>-P</strong>
may be used to specify default actions.</p>
<p>
The option <strong>-N</strong> is used after a list following <strong>-p</strong> or <strong>-P</strong>; it
specifies that remaining words no longer define patterns. It is possible
to toggle between the three options as many times as necessary.</p>
</blockquote>
<dl>
<dt>
<strong>#compdef -k</strong> <em>style key-sequence</em> …
</dt>
<dd>This option creates a widget
behaving like the builtin widget <em>style</em> and binds it to the given
<em>key-sequence/s, if any. The /style</em> must be one of the builtin
widgets that perform completion, namely <strong>complete-word</strong>,
<strong>delete-char-or-list</strong>, <strong>expand-or-complete</strong>,
<strong>expand-or-complete-prefix</strong>, <strong>list-choices</strong>, <strong>menu-complete</strong>,
<strong>menu-expand-or-complete</strong>, or <strong>reverse-menu-complete</strong>. If the
<strong>zsh/complist</strong> module is loaded (see /zshmodules/(1)) the widget
<strong>menu-select</strong> is also available.

When one of the /key-sequence/s is typed, the function in the file
will be invoked to generate the matches. Note that a key will not be
re-bound if it already was (that is, was bound to something other than
<strong>undefined-key</strong>). The widget created has the same name as the file and
can be bound to any other keys using <strong>bindkey</strong> as usual.</dd>
<dt>
?
</dt>
<dd>
<p><strong>#compdef -K</strong> <em>widget-name</em> <em>style</em> <em>key-sequence</em> [ <em>name</em> <em>style</em>
<em>seq</em> … ] :: This is similar to <strong>-k</strong> except that only one
<em>key-sequence</em> argument may be given for each <em>widget-name</em> <em>style</em>
pair. However, the entire set of three arguments may be repeated with
a different set of arguments. Note in particular that the
<em>widget-name</em> must be distinct in each set. If it does not begin with
`*_*&#39; this will be added. The <em>widget-name</em> should not clash with the
name of any existing widget: names based on the name of the function
are most useful. For example,</p>
<blockquote>
<pre class="example">
#compdef -K _foo_complete complete-word &#34;^X^C&#34; \ 
  _foo_list list-choices &#34;^X^D&#34;
</pre>
</blockquote>
<p>
(all on one line) defines a widget <strong>_foo_complete</strong> for completion,
bound to `*^X^C*&#39;, and a widget <strong>_foo_list</strong> for listing, bound to
`*^X^D*&#39;.</p>
</dd>
<dt>
<strong>#autoload</strong> [ <em>options</em> ]
</dt>
<dd>Functions with the <strong>#autoload</strong> tag are
marked for autoloading but are not otherwise treated specially.
Typically they are to be called from within one of the completion
functions. Any <em>options</em> supplied will be passed to the <strong>autoload</strong>
builtin; a typical use is <strong>+X</strong> to force the function to be loaded
immediately. Note that the <strong>-U</strong> and <strong>-z</strong> flags are always added
implicitly.</dd>
</dl>
<p>The <strong>#</strong> is part of the tag name and no white space is allowed after it.
The <strong>#compdef</strong> tags use the <strong>compdef</strong> function described below; the main
difference is that the name of the function is supplied implicitly.</p>
<p>
The special contexts for which completion functions can be defined are:</p>
<p>
<strong>-array-value-</strong> The right hand side of an array-assignment
(`/name/*=(<strong><em>…</em></strong>)*&#39;)</p>
<dl>
<dt>
<strong>-assign-parameter-</strong>
</dt>
<dd>The name of a parameter in an assignment, i.e.
on the left hand side of an `*=*&#39;</dd>
<dt>
<strong>-brace-parameter-</strong>
</dt>
<dd>The name of a parameter expansion within braces
(`*${<strong><em>…</em></strong>}*&#39;)</dd>
<dt>
<strong>-command-</strong>
</dt>
<dd>A word in command position</dd>
<dt>
<strong>-condition-</strong>
</dt>
<dd>A word inside a condition (`*<a href="*/.../*">*/.../*</a>*&#39;)</dd>
<dt>
<strong>-default-</strong>
</dt>
<dd>Any word for which no other completion is defined</dd>
<dt>
<strong>-equal-</strong>
</dt>
<dd>A word beginning with an equals sign</dd>
<dt>
<strong>-first-</strong>
</dt>
<dd>This is tried before any other completion function. The
function called may set the <strong>_compskip</strong> parameter to one of various
values: <strong>all</strong>: no further completion is attempted; a string containing
the substring <strong>patterns</strong>: no pattern completion functions will be
called; a string containing <strong>default</strong>: the function for the
`*-default-*&#39; context will not be called, but functions defined for
commands will be.</dd>
<dt>
<strong>-math-</strong>
</dt>
<dd>Inside mathematical contexts, such as `*((<strong><em>…</em></strong>))*&#39;</dd>
<dt>
<strong>-parameter-</strong>
</dt>
<dd>The name of a parameter expansion (`*$*/…/&#39;)</dd>
<dt>
<strong>-redirect-</strong>
</dt>
<dd>The word after a redirection operator.</dd>
<dt>
<strong>-subscript-</strong>
</dt>
<dd>The contents of a parameter subscript.</dd>
<dt>
<strong>-tilde-</strong>
</dt>
<dd>After an initial tilde (`*~*&#39;), but before the first
slash in the word.</dd>
<dt>
<strong>-value-</strong>
</dt>
<dd>On the right hand side of an assignment.</dd>
</dl>
<p>Default implementations are supplied for each of these contexts. In most
cases the context <strong>-*/context/</strong>-* is implemented by a corresponding
function <strong>_*/context/, for example the context `</strong>-tilde-<strong>&#39; and the
function `*_tilde</strong>&#39;).</p>
<p>
The contexts <strong>-redirect-</strong> and <strong>-value-</strong> allow extra context-specific
information. (Internally, this is handled by the functions for each
context calling the function <strong>_dispatch</strong>.) The extra information is
added separated by commas.</p>
<p>
For the <strong>-redirect-</strong> context, the extra information is in the form
`*-redirect-,*/op/*,*/command/&#39;, where <em>op</em> is the redirection operator
and <em>command</em> is the name of the command on the line. If there is no
command on the line yet, the <em>command</em> field will be empty.</p>
<p>
For the <strong>-value-</strong> context, the form is `*-value-,*/name/*,*/command/&#39;,
where <em>name</em> is the name of the parameter on the left hand side of the
assignment. In the case of elements of an associative array, for example
`*assoc=(key &lt;TAB&gt;*&#39;, <em>name</em> is expanded to `/name/*-<strong><em>key</em>&#39;. In certain
special contexts, such as completing after `*make CFLAGS=</strong>&#39;, the
<em>command</em> part gives the name of the command, here <strong>make</strong>; otherwise it
is empty.</p>
<p>
It is not necessary to define fully specific completions as the
functions provided will try to generate completions by progressively
replacing the elements with `*-default-<strong>&#39;. For example, when completing
after `*foo=&lt;TAB&gt;</strong>&#39;, <strong>_value</strong> will try the names `*-value-,foo,*&#39; (note
the empty <em>command</em> part), `*-value-,foo,-default-<strong>&#39;
and`</strong>-value-,-default-,-default-*&#39;, in that order, until it finds a
function to handle the context.</p>
<p>
As an example:</p>
<blockquote>
<pre class="example">
compdef &#39;_files -g &#34;*.log&#34;&#39; &#39;-redirect-,2&gt;,-default-&#39;
</pre>
</blockquote>
<p>
completes files matching `**.log*&#39; after `*2&gt; &lt;TAB&gt;*&#39; for any command
with no more specific handler defined.</p>
<p>
Also:</p>
<blockquote>
<pre class="example">
compdef _foo -value-,-default-,-default-
</pre>
</blockquote>
<p>
specifies that <strong>_foo</strong> provides completions for the values of parameters
for which no special function has been defined. This is usually handled
by the function <strong>_value</strong> itself.</p>
<p>
The same lookup rules are used when looking up styles (as described
below); for example</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:-redirect-,2&gt;,*:*&#39; file-patterns &#39;*.log&#39;
</pre>
</blockquote>
<p>
is another way to make completion after `*2&gt; &lt;TAB&gt;*&#39; complete files
matching `**.log*&#39;.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
Functions
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p>The following function is defined by <strong>compinit</strong> and may be called
directly.</p>
<p>
<strong>compdef</strong> [ <strong>-ane</strong> ] <em>function name</em> … [ <strong>-*{*p*|*P</strong>} <em>pattern</em> … [
<strong>-N</strong> <em>name</em> …]]</p>
<p>
<strong>compdef -d</strong> <em>name</em> …</p>
<p>
<strong>compdef -k</strong> [ <strong>-an</strong> ] <em>function style key-sequence</em> [ <em>key-sequence</em>
… ]</p>
<p>
<strong>compdef -K</strong> [ <strong>-an</strong> ] <em>function name style key-seq</em> [ <em>name style seq</em>
… ] The first form defines the <em>function</em> to call for completion in
the given contexts as described for the <strong>#compdef</strong> tag above.</p>
<blockquote>
<p>Alternatively, all the arguments may have the form `/cmd/*=*/service/&#39;.
Here <em>service</em> should already have been defined by `/cmd1/*=*/service/&#39;
lines in <strong>#compdef</strong> files, as described above. The argument for <em>cmd</em>
will be completed in the same way as <em>service</em>.</p>
<p>
The <em>function</em> argument may alternatively be a string containing almost
any shell code. If the string contains an equal sign, the above will
take precedence. The option <strong>-e</strong> may be used to specify the first
argument is to be evaluated as shell code even if it contains an equal
sign. The string will be executed using the <strong>eval</strong> builtin command to
generate completions. This provides a way of avoiding having to define a
new completion function. For example, to complete files ending in `*.h*&#39;
as arguments to the command <strong>foo</strong>:</p>
<blockquote>
<pre class="example">
compdef &#39;_files -g &#34;*.h&#34;&#39; foo
</pre>
</blockquote>
<p>
The option <strong>-n</strong> prevents any completions already defined for the command
or context from being overwritten.</p>
<p>
The option <strong>-d</strong> deletes any completion defined for the command or
contexts listed.</p>
<p>
The /name/s may also contain <strong>-p</strong>, <strong>-P</strong> and <strong>-N</strong> options as described
for the <strong>#compdef</strong> tag. The effect on the argument list is identical,
switching between definitions of patterns tried initially, patterns
tried finally, and normal commands and contexts.</p>
<p>
The parameter <strong>$_compskip</strong> may be set by any function defined for a
pattern context. If it is set to a value containing the substring
`*patterns*&#39; none of the pattern-functions will be called; if it is set
to a value containing the substring `*all*&#39;, no other function will be
called. Setting <strong>$_compskip</strong> in this manner is of particular utility
when using the <strong>-p</strong> option, as otherwise the dispatcher will move on to
additional functions (likely the default one) after calling the
pattern-context one, which can mangle the display of completion
possibilities if not handled properly.</p>
<p>
The form with <strong>-k</strong> defines a widget with the same name as the <em>function</em>
that will be called for each of the /key-sequence/s; this is like the
<strong>#compdef -k</strong> tag. The function should generate the completions needed
and will otherwise behave like the builtin widget whose name is given as
the <em>style</em> argument. The widgets usable for this are: <strong>complete-word</strong>,
<strong>delete-char-or-list</strong>, <strong>expand-or-complete</strong>,
<strong>expand-or-complete-prefix</strong>, <strong>list-choices</strong>, <strong>menu-complete</strong>,
<strong>menu-expand-or-complete</strong>, and <strong>reverse-menu-complete</strong>, as well as
<strong>menu-select</strong> if the <strong>zsh/complist</strong> module is loaded. The option <strong>-n</strong>
prevents the key being bound if it is already to bound to something
other than <strong>undefined-key</strong>.</p>
<p>
The form with <strong>-K</strong> is similar and defines multiple widgets based on the
same <em>function</em>, each of which requires the set of three arguments
<em>name</em>, <em>style</em> and /key-seq/uence, where the latter two are as for <strong>-k</strong>
and the first must be a unique widget name beginning with an underscore.</p>
<p>
Wherever applicable, the <strong>-a</strong> option makes the <em>function</em> autoloadable,
equivalent to *autoload -U */function/.</p>
</blockquote>
<p>
The function <strong>compdef</strong> can be used to associate existing completion
functions with new commands. For example,</p>
<blockquote>
<pre class="example">
compdef _pids foo
</pre>
</blockquote>
<p>
uses the function <strong>_pids</strong> to complete process IDs for the command <strong>foo</strong>.</p>
<p>
Note also the <strong>_gnu_generic</strong> function described below, which can be used
to complete options for commands that understand the `*–help*&#39; option.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-2">
<h2 id="headline-7">
COMPLETION SYSTEM CONFIGURATION
</h2>
<div id="outline-text-headline-7" class="outline-text-2">
<p>This section gives a short overview of how the completion system works,
and then more detail on how users can configure how and when matches are
generated.</p>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
Overview
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p>When completion is attempted somewhere on the command line the
completion system begins building the context. The context represents
everything that the shell knows about the meaning of the command line
and the significance of the cursor position. This takes account of a
number of things including the command word (such as `*grep*&#39; or
`*zsh*&#39;) and options to which the current word may be an argument (such
as the `*-o*&#39; option to <strong>zsh</strong> which takes a shell option as an
argument).</p>
<p>
The context starts out very generic (&#34;we are beginning a completion&#34;)
and becomes more specific as more is learned (&#34;the current word is in a
position that is usually a command name&#34; or &#34;the current word might be a
variable name&#34; and so on). Therefore the context will vary during the
same call to the completion system.</p>
<p>
This context information is condensed into a string consisting of
multiple fields separated by colons, referred to simply as `the context&#39;
in the remainder of the documentation. Note that a user of the
completion system rarely needs to compose a context string, unless for
example a new function is being written to perform completion for a new
command. What a user may need to do is compose a <em>style</em> pattern, which
is matched against a context when needed to look up context-sensitive
options that configure the completion system.</p>
<p>
The next few paragraphs explain how a context is composed within the
completion function suite. Following that is discussion of how <em>styles</em>
are defined. Styles determine such things as how the matches are
generated, similarly to shell options but with much more control. They
are defined with the <strong>zstyle</strong> builtin command (see /zshmodules/(1)).</p>
<p>
The context string always consists of a fixed set of fields, separated
by colons and with a leading colon before the first. Fields which are
not yet known are left empty, but the surrounding colons appear anyway.
The fields are always in the order
<strong>:completion:*/function/</strong>:*/completer/*:*/command/*:*/argument/*:*/tag/.
These have the following meaning:</p>
<p>
· The literal string <strong>completion</strong>, saying that this style is used by the
completion system. This distinguishes the context from those used by,
for example, zle widgets and ZFTP functions.</p>
<dl>
<dt>
·
</dt>
<dd>The <em>function</em>, if completion is called from a named widget
rather than through the normal completion system. Typically this is
blank, but it is set by special widgets such as <strong>predict-on</strong> and the
various functions in the <strong>Widget</strong> directory of the distribution to the
name of that function, often in an abbreviated form.</dd>
<dt>
·
</dt>
<dd>The <em>completer</em> currently active, the name of the function
without the leading underscore and with other underscores converted to
hyphens. A `completer&#39; is in overall control of how completion is to
be performed; `*complete*&#39; is the simplest, but other completers exist
to perform related tasks such as correction, or to modify the
behaviour of a later completer. See the section `Control Functions&#39;
below for more information.</dd>
<dt>
·
</dt>
<dd>The <em>command</em> or a special <strong>-*/context/</strong>-<strong>, just at it appears
following the *#compdef</strong> tag or the <strong>compdef</strong> function. Completion
functions for commands that have sub-commands usually modify this
field to contain the name of the command followed by a minus sign and
the sub-command. For example, the completion function for the <strong>cvs</strong>
command sets this field to <strong>cvs-add</strong> when completing arguments to the
<strong>add</strong> subcommand.</dd>
<dt>
·
</dt>
<dd>The <em>argument</em>; this indicates which command line or option
argument we are completing. For command arguments this generally takes
the form <strong>argument-*/n/, where <em>n</em> is the number of the argument, and
for arguments to options the form *option-*/opt/</strong>-*/n/ where <em>n</em> is
the number of the argument to option <em>opt</em>. However, this is only the
case if the command line is parsed with standard UNIX-style options
and arguments, so many completions do not set this.</dd>
<dt>
·
</dt>
<dd>The <em>tag</em>. As described previously, tags are used to discriminate
between the types of matches a completion function can generate in a
certain context. Any completion function may use any tag name it
likes, but a list of the more common ones is given below.</dd>
</dl>
<p>The context is gradually put together as the functions are executed,
starting with the main entry point, which adds <strong>:completion:</strong> and the
<em>function</em> element if necessary. The completer then adds the <em>completer</em>
element. The contextual completion adds the <em>command</em> and <em>argument</em>
options. Finally, the <em>tag</em> is added when the types of completion are
known. For example, the context name</p>
<blockquote>
<pre class="example">
:completion::complete:dvips:option-o-1:files
</pre>
</blockquote>
<p>
says that normal completion was attempted as the first argument to the
option <strong>-o of the command dvips:</strong></p>
<blockquote>
<pre class="example">
dvips -o ...
</pre>
</blockquote>
<p>
and the completion function will generate filenames.</p>
<p>
Usually completion will be tried for all possible tags in an order given
by the completion function. However, this can be altered by using the
<strong>tag-order style. Completion is then restricted to the list of given</strong>
tags in the given order.</p>
<p>
The <strong>_complete_help bindable command shows all the contexts and tags</strong>
available for completion at a particular point. This provides an easy
way of finding information for <strong>tag-order and other styles. It is</strong>
described in the section `Bindable Commands&#39; below.</p>
<p>
When looking up styles the completion system uses full context names,
including the tag. Looking up the value of a style therefore consists of
two things: the context, which is matched to the most specific (best
fitting) pattern, and the name of the style itself, which must be
matched exactly. The following examples demonstrate that patterns may be
loosely defined for styles that apply broadly, or as tightly defined as
desired for styles that apply in narrower circumstances.</p>
<p>
For example, many completion functions can generate matches in a simple
and a verbose form and use the <strong>verbose style to decide</strong> which form
should be used. To make all such functions use the verbose form, put</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; verbose yes
</pre>
</blockquote>
<p>
in a startup file (probably <strong>.zshrc).</strong> This gives the <strong>verbose style the
value yes in every</strong> context inside the completion system, unless that
context has a more specific definition. It is best to avoid giving the
pattern as `**&#39;* in case the style has some meaning outside the
completion system.</p>
<p>
Many such general purpose styles can be configured simply by using the
<strong>compinstall function.</strong></p>
<p>
A more specific example of the use of the <strong>verbose style is by the</strong>
completion for the <strong>kill builtin. If the style is set, the builtin</strong>
lists full job texts and process command lines; otherwise it shows the
bare job numbers and PIDs. To turn the style off for this use only:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:kill:*:*&#39; verbose no
</pre>
</blockquote>
<p>
For even more control, the style can use one of the tags `*jobs&#39; or*
`*processes&#39;. To turn off verbose display only for jobs:*</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:kill:*:jobs&#39; verbose no
</pre>
</blockquote>
<p>
The <strong>-e option to zstyle even allows completion function code to</strong> appear
as the argument to a style; this requires some understanding of the
internals of completion functions (see see /zshcompwid/*(1))). For
example,*</p>
<blockquote>
<pre class="example">
zstyle -e &#39;:completion:*&#39; hosts &#39;reply=($myhosts)&#39;
</pre>
</blockquote>
<p>
This forces the value of the <strong>hosts style to be read from the</strong> variable
<strong>myhosts each time a host name is needed; this is useful</strong> if the value
of <strong>myhosts can change dynamically.</strong> For another useful example, see the
example in the description of the <strong>file-list style below. This form can
be</strong> slow and should be avoided for commonly examined styles such as
<strong>menu and list-rows-first.</strong></p>
<p>
Note that the order in which styles are /defined/* does not matter; the*
style mechanism uses the most specific possible match for a particular
style to determine the set of values. Strings are preferred over
patterns (for example, `*:completion::complete:::foo&#39; is* more specific
than `*:completion::complete:::*&#39;), and longer patterns are* preferred
over the pattern `**&#39;. See * /zmodules/*(1)* for details.</p>
<p>
Context patterns that use something other than a wildcard (<strong>*) to match
the</strong> middle parts of the context – the /completer/*, <strong><em>command</em></strong>, and*
<em>argument/* in*
<strong>:completion:*/function/</strong>:*/completer/*:*/command/*:*/argument/*:*/tag</em>
– should include all six colons (<strong>:) explicitly. Without this,</strong> a
pattern such as <strong>:completion:</strong>:foo:* could match foo against a*
component other than the intended one (for example, against /completer/*
when* a match against /command/* was intended).*</p>
<p>
Style names like those of tags are arbitrary and depend on the
completion function. However, the following two sections list some of
the most common tags and styles.</p>
</div>
</div>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
Standard Tags
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p>Some of the following are only used when looking up particular styles
and do not refer to a type of match.</p>
<p>
<strong>accounts</strong> used to look up the <strong>users-hosts style</strong></p>
<dl>
<dt>
<strong>all-expansions</strong>
</dt>
<dd>used by the <strong>_expand completer when adding the
single string containing</strong> all possible expansions</dd>
<dt>
<strong>all-files</strong>
</dt>
<dd>for the names of all files (as distinct from a
particular subset, see the <strong>globbed-files tag).</strong></dd>
<dt>
<strong>arguments</strong>
</dt>
<dd>for arguments to a command</dd>
<dt>
<strong>arrays</strong>
</dt>
<dd>for names of array parameters</dd>
<dt>
<strong>association-keys</strong>
</dt>
<dd>for keys of associative arrays; used when
completing inside a subscript to a parameter of this type</dd>
<dt>
<strong>bookmarks</strong>
</dt>
<dd>when completing bookmarks (e.g. for URLs and the <strong>zftp
function suite)</strong></dd>
<dt>
<strong>builtins</strong>
</dt>
<dd>for names of builtin commands</dd>
<dt>
<strong>characters</strong>
</dt>
<dd>for single characters in arguments of commands such as
<strong>stty. Also used</strong> when completing character classes after an opening
bracket</dd>
<dt>
<strong>colormapids</strong>
</dt>
<dd>for X colormap ids</dd>
<dt>
<strong>colors</strong>
</dt>
<dd>for color names</dd>
<dt>
<strong>commands</strong>
</dt>
<dd>for names of external commands. Also used by complex
commands such as <strong>cvs when completing names subcommands.</strong></dd>
<dt>
<strong>contexts</strong>
</dt>
<dd>for contexts in arguments to the <strong>zstyle builtin
command</strong></dd>
<dt>
<strong>corrections</strong>
</dt>
<dd>used by the <strong>_approximate and _correct completers for
possible</strong> corrections</dd>
<dt>
<strong>cursors</strong>
</dt>
<dd>for cursor names used by X programs</dd>
<dt>
<strong>default</strong>
</dt>
<dd>used in some contexts to provide a way of supplying a
default when more specific tags are also valid. Note that this tag is
used when only the /function/* field of the context name is set*</dd>
<dt>
<strong>descriptions</strong>
</dt>
<dd>used when looking up the value of the <strong>format style
to generate</strong> descriptions for types of matches</dd>
<dt>
<strong>devices</strong>
</dt>
<dd>for names of device special files</dd>
<dt>
<strong>directories</strong>
</dt>
<dd>for names of directories – <strong>local-directories is
used instead</strong> when completing arguments of <strong>cd and related builtin
commands when</strong> the <strong>cdpath array is set</strong></dd>
<dt>
<strong>directory-stack</strong>
</dt>
<dd>for entries in the directory stack</dd>
<dt>
<strong>displays</strong>
</dt>
<dd>for X display names</dd>
<dt>
<strong>domains</strong>
</dt>
<dd>for network domains</dd>
<dt>
*email-*/plugin/
</dt>
<dd>for email addresses from the `*_email-<strong><em>plugin</em></strong>&#39;
backend of _email_addresses*</dd>
<dt>
<strong>expansions</strong>
</dt>
<dd>used by the <strong>_expand completer for individual words
(as opposed to</strong> the complete set of expansions) resulting from the
expansion of a word on the command line</dd>
<dt>
<strong>extensions</strong>
</dt>
<dd>for X server extensions</dd>
<dt>
<strong>file-descriptors</strong>
</dt>
<dd>for numbers of open file descriptors</dd>
<dt>
<strong>files</strong>
</dt>
<dd>the generic file-matching tag used by functions completing
filenames</dd>
<dt>
<strong>fonts</strong>
</dt>
<dd>for X font names</dd>
<dt>
<strong>fstypes</strong>
</dt>
<dd>for file system types (e.g. for the <strong>mount command)</strong></dd>
<dt>
<strong>functions</strong>
</dt>
<dd>names of functions – normally shell functions,
although certain commands may understand other kinds of function</dd>
<dt>
<strong>globbed-files</strong>
</dt>
<dd>for filenames when the name has been generated by
pattern matching</dd>
<dt>
<strong>groups</strong>
</dt>
<dd>for names of user groups</dd>
<dt>
<strong>history-words</strong>
</dt>
<dd>for words from the history</dd>
<dt>
<strong>hosts</strong>
</dt>
<dd>for hostnames</dd>
<dt>
<strong>indexes</strong>
</dt>
<dd>for array indexes</dd>
<dt>
<strong>interfaces</strong>
</dt>
<dd>for network interfaces</dd>
<dt>
<strong>jobs</strong>
</dt>
<dd>for jobs (as listed by the `*jobs&#39; builtin)*</dd>
<dt>
<strong>keymaps</strong>
</dt>
<dd>for names of zsh keymaps</dd>
<dt>
<strong>keysyms</strong>
</dt>
<dd>for names of X keysyms</dd>
<dt>
<strong>libraries</strong>
</dt>
<dd>for names of system libraries</dd>
<dt>
<strong>limits</strong>
</dt>
<dd>for system limits</dd>
<dt>
<strong>local-directories</strong>
</dt>
<dd>for names of directories that are
subdirectories of the current working directory when completing
arguments of <strong>cd and related builtin</strong> commands (compare
<strong>path-directories) – when the cdpath</strong> array is unset, <strong>directories is
used instead</strong></dd>
<dt>
<strong>mailboxes</strong>
</dt>
<dd>for e-mail folders</dd>
<dt>
<strong>manuals</strong>
</dt>
<dd>for names of manual pages</dd>
<dt>
<strong>maps</strong>
</dt>
<dd>for map names (e.g. NIS maps)</dd>
<dt>
<strong>messages</strong>
</dt>
<dd>used to look up the <strong>format style for messages</strong></dd>
<dt>
<strong>modifiers</strong>
</dt>
<dd>for names of X modifiers</dd>
<dt>
<strong>modules</strong>
</dt>
<dd>for modules (e.g. <strong>zsh modules)</strong></dd>
<dt>
<strong>my-accounts</strong>
</dt>
<dd>used to look up the <strong>users-hosts style</strong></dd>
<dt>
<strong>named-directories</strong>
</dt>
<dd>for named directories (you wouldn&#39;t have
guessed that, would you?)</dd>
<dt>
<strong>names</strong>
</dt>
<dd>for all kinds of names</dd>
<dt>
<strong>newsgroups</strong>
</dt>
<dd>for USENET groups</dd>
<dt>
<strong>nicknames</strong>
</dt>
<dd>for nicknames of NIS maps</dd>
<dt>
<strong>options</strong>
</dt>
<dd>for command options</dd>
<dt>
<strong>original</strong>
</dt>
<dd>used by the <strong>_approximate, _correct and _expand
completers when</strong> offering the original string as a match</dd>
<dt>
<strong>other-accounts</strong>
</dt>
<dd>used to look up the <strong>users-hosts style</strong></dd>
<dt>
<strong>packages</strong>
</dt>
<dd>for packages (e.g. <strong>rpm or installed Debian packages)</strong></dd>
<dt>
<strong>parameters</strong>
</dt>
<dd>for names of parameters</dd>
<dt>
<strong>path-directories</strong>
</dt>
<dd>for names of directories found by searching the
<strong>cdpath array when</strong> completing arguments of <strong>cd and related builtin
commands (compare</strong> <strong>local-directories)</strong></dd>
<dt>
<strong>paths</strong>
</dt>
<dd>used to look up the values of the <strong>expand, ambiguous and</strong>
<strong>special-dirs styles</strong></dd>
<dt>
<strong>pods</strong>
</dt>
<dd>for perl pods (documentation files)</dd>
<dt>
<strong>ports</strong>
</dt>
<dd>for communication ports</dd>
<dt>
<strong>prefixes</strong>
</dt>
<dd>for prefixes (like those of a URL)</dd>
<dt>
<strong>printers</strong>
</dt>
<dd>for print queue names</dd>
<dt>
<strong>processes</strong>
</dt>
<dd>for process identifiers</dd>
<dt>
<strong>processes-names</strong>
</dt>
<dd>used to look up the <strong>command style when
generating the names of</strong> processes for <strong>killall</strong></dd>
<dt>
<strong>sequences</strong>
</dt>
<dd>for sequences (e.g. <strong>mh sequences)</strong></dd>
<dt>
<strong>sessions</strong>
</dt>
<dd>for sessions in the <strong>zftp function suite</strong></dd>
<dt>
<strong>signals</strong>
</dt>
<dd>for signal names</dd>
<dt>
<strong>strings</strong>
</dt>
<dd>for strings (e.g. the replacement strings for the <strong>cd
builtin</strong> command)</dd>
<dt>
<strong>styles</strong>
</dt>
<dd>for styles used by the zstyle builtin command</dd>
<dt>
<strong>suffixes</strong>
</dt>
<dd>for filename extensions</dd>
<dt>
<strong>tags</strong>
</dt>
<dd>for tags (e.g. <strong>rpm tags)</strong></dd>
<dt>
<strong>targets</strong>
</dt>
<dd>for makefile targets</dd>
<dt>
<strong>time-zones</strong>
</dt>
<dd>for time zones (e.g. when setting the <strong>TZ parameter)</strong></dd>
<dt>
<strong>types</strong>
</dt>
<dd>for types of whatever (e.g. address types for the <strong>xhost
command)</strong></dd>
<dt>
<strong>urls</strong>
</dt>
<dd>used to look up the <strong>urls and local styles when completing
URLs</strong></dd>
<dt>
<strong>users</strong>
</dt>
<dd>for usernames</dd>
<dt>
<strong>values</strong>
</dt>
<dd>for one of a set of values in certain lists</dd>
<dt>
<strong>variant</strong>
</dt>
<dd>used by <strong>_pick_variant to look up the command to run when
determining</strong> what program is installed for a particular command name.</dd>
<dt>
<strong>visuals</strong>
</dt>
<dd>for X visuals</dd>
<dt>
<strong>warnings</strong>
</dt>
<dd>used to look up the <strong>format style for warnings</strong></dd>
<dt>
<strong>widgets</strong>
</dt>
<dd>for zsh widget names</dd>
<dt>
<strong>windows</strong>
</dt>
<dd>for IDs of X windows</dd>
<dt>
<strong>zsh-options</strong>
</dt>
<dd>for shell options</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-10" class="outline-3">
<h3 id="headline-10">
Standard Styles
</h3>
<div id="outline-text-headline-10" class="outline-text-3">
<p>Note that the values of several of these styles represent boolean
values. Any of the strings `*true&#39;, `on&#39;,* `*yes&#39;, and `1&#39; can be used
for the value `true&#39; and* any of the strings `*false&#39;, `off&#39;, `no&#39;, and
`0&#39; for* the value `false&#39;. The behavior for any other value is
undefined except where explicitly mentioned. The default value may be
either `true&#39; or `false&#39; if the style is not set.</p>
<p>
Some of these styles are tested first for every possible tag
corresponding to a type of match, and if no style was found, for the
*default tag. The most notable styles of this type are menu, *
<strong>list-colors and styles controlling completion listing such as *
*list-packed and last-prompt. When tested for the default</strong> tag, only the
/function/* field of the context will be set so that* a style using the
<strong>default tag will normally be defined along the lines of:</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:default&#39; menu ...
</pre>
</blockquote>
<p>
<strong>accept-exact</strong> This is tested for the <strong>default tag in addition to the
tags valid for</strong> the current context. If it is set to `true&#39; and any of
the trial matches is the same as the string on the command line, this
match will immediately be accepted (even if it would otherwise be
considered ambiguous).</p>
<blockquote>
<p>When completing pathnames (where the tag used is `*paths&#39;)* this style
accepts any number of patterns as the value in addition to the boolean
values. Pathnames matching one of these patterns will be accepted
immediately even if the command line contains some more partially typed
pathname components and these match no file under the directory
accepted.</p>
<p>
This style is also used by the <strong>_expand completer to decide if</strong> words
beginning with a tilde or parameter expansion should be expanded. For
example, if there are parameters *foo and foobar, the string `$foo&#39; will
only be expanded if * *accept-exact is set to `true&#39;; otherwise the
completion system will* be allowed to complete *$foo to $foobar. If the
style is set to* `*continue&#39;, _expand will add the expansion as a match
and the completion* system will also be allowed to continue.</p>
</blockquote>
<dl>
<dt>
<strong>accept-exact-dirs</strong>
</dt>
<dd>This is used by filename completion. Unlike
<strong>accept-exact it is</strong> a boolean. By default, filename completion
examines all components of a path to see if there are completions of
that component, even if the component matches an existing directory.
For example, when completion after <strong><em>usr/bin</em>, the function examines
possible</strong> completions to <strong>/usr.</strong>

When this style is `true&#39;, any prefix of a path that matches an
existing directory is accepted without any attempt to complete it
further. Hence, in the given example, the path <strong><em>usr/bin</em> is accepted</strong>
immediately and completion tried in that directory.

This style is also useful when completing after directories that
magically appear when referenced, such as ZFS <strong>.zfs directories</strong> or
NetApp <strong>.snapshot directories. When the style is set the</strong> shell does
not check for the existence of the directory within the parent
directory.

If you wish to inhibit this behaviour entirely, set the
<strong>path-completion</strong> style (see below) to `false&#39;.</dd>
<dt>
<strong>add-space</strong>
</dt>
<dd>This style is used by the <strong>_expand completer. If it is
`true&#39; (the</strong> default), a space will be inserted after all words
resulting from the expansion, or a slash in the case of directory
names. If the value is `*file&#39;, the completer will only add a space*
to names of existing files. Either a boolean `true&#39; or the value
`*file&#39; may be combined with `subst&#39;, in which case the completer*
will not add a space to words generated from the expansion of a
substitution of the form `*$(*/.../*)&#39; or `${<strong><em>…</em></strong>}&#39;.*

The <strong>_prefix completer uses this style as a simple boolean value</strong> to
decide if a space should be inserted before the suffix.</dd>
<dt>
<strong>ambiguous</strong>
</dt>
<dd>This applies when completing non-final components of
filename paths, in other words those with a trailing slash. If it is
set, the cursor is left after the first ambiguous component, even if
menu completion is in use. The style is always tested with the <strong>paths
tag.</strong></dd>
<dt>
<strong>assign-list</strong>
</dt>
<dd>When completing after an equals sign that is being
treated as an assignment, the completion system normally completes
only one filename. In some cases the value may be a list of filenames
separated by colons, as with <strong>PATH and similar parameters. This style
can be set to a</strong> list of patterns matching the names of such
parameters.

The default is to complete lists when the word on the line already
contains a colon.</dd>
<dt>
<strong>auto-description</strong>
</dt>
<dd>If set, this style&#39;s value will be used as the
description for options that are not described by the completion
functions, but that have exactly one argument. The sequence `*%d&#39; in
the value will be replaced by* the description for this argument.
Depending on personal preferences, it may be useful to set this style
to something like `*specify: %d&#39;. * Note that this may not work for
some commands.</dd>
<dt>
<strong>avoid-completer</strong>
</dt>
<dd>This is used by the *_all_matches completer to
decide if the string * consisting of all matches should be added to
the list currently being generated. Its value is a list of names of
completers. If any of these is the name of the completer that
generated the matches in this completion, the string will not be
added.

The default value for this style is `*_expand _old_list _correct*
_approximate*&#39;, i.e. it contains the completers for which a string*
with all matches will almost never be wanted.</dd>
<dt>
<strong>cache-path</strong>
</dt>
<dd>This style defines the path where any cache files
containing dumped completion data are stored. It defaults to
`*$ZDOTDIR/.zcompcache&#39;, or* `*$HOME/.zcompcache&#39; if $ZDOTDIR is not
defined. The completion* cache will not be used unless the <strong>use-cache
style is set.</strong></dd>
<dt>
<strong>cache-policy</strong>
</dt>
<dd>This style defines the function that will be used to
determine whether a cache needs rebuilding. See the section on the
<strong>_cache_invalid</strong> function below.</dd>
<dt>
<strong>call-command</strong>
</dt>
<dd>This style is used in the function for commands such
as <strong>make and</strong> <strong>ant where calling the command directly to generate
matches suffers</strong> problems such as being slow or, as in the case of
<strong>make can</strong> potentially cause actions in the makefile to be executed.
If it is set to `true&#39; the command is called to generate matches. The
default value of this style is `false&#39;.</dd>
<dt>
<strong>command</strong>
</dt>
<dd>In many places, completion functions need to call
external commands to generate the list of completions. This style can
be used to override the command that is called in some such cases. The
elements of the value are joined with spaces to form a command line to
execute. The value can also start with a hyphen, in which case the
usual command will be added to the end; this is most useful for
putting `*builtin&#39; or `command&#39; in* front to make sure the appropriate
version of a command is called, for example to avoid calling a shell
function with the same name as an external command.

As an example, the completion function for process IDs uses this style
with the <strong>processes tag to generate the IDs to complete and</strong> the list
of processes to display (if the <strong>verbose style is `true&#39;).</strong> The list
produced by the command should look like the output of the <strong>ps
command. The first line is not displayed, but is searched for</strong> the
string `*PID&#39; (or `pid&#39;) to find the position of the* process IDs in
the following lines. If the line does not contain `*PID&#39;, the first
numbers in each of the other lines are taken as the * process IDs to
complete.

Note that the completion function generally has to call the specified
command for each attempt to generate the completion list. Hence care
should be taken to specify only commands that take a short time to
run, and in particular to avoid any that may never terminate.</dd>
<dt>
<strong>command-path</strong>
</dt>
<dd>This is a list of directories to search for commands
to complete. The default for this style is the value of the special
parameter <strong>path.</strong></dd>
<dt>
<strong>commands</strong>
</dt>
<dd>This is used by the function completing sub-commands for
the system initialisation scripts (residing in <strong>/etc/init.d or
somewhere not</strong> too far away from that). Its values give the default
commands to complete for those commands for which the completion
function isn&#39;t able to find them out automatically. The default for
this style are the two strings `*start&#39; and `stop&#39;.*</dd>
<dt>
<strong>complete</strong>
</dt>
<dd>This is used by the <strong>_expand_alias function when invoked
as a</strong> bindable command. If set to `true&#39; and the word on the command
line is not the name of an alias, matching alias names will be
completed.</dd>
<dt>
<strong>complete-options</strong>
</dt>
<dd>This is used by the completer for <strong>cd, chdir and
pushd.</strong> For these commands a <strong>- is used to introduce a directory stack
entry</strong> and completion of these is far more common than completing
options. Hence unless the value of this style is `true&#39; options will
not be completed, even after an initial <strong>-. If it is `true&#39;, options
will</strong> be completed after an initial <strong>- unless there is a preceding</strong>
<strong>– on the command line.</strong></dd>
<dt>
<strong>completer</strong>
</dt>
<dd>
<p>The strings given as the value of this style provide
the names of the completer functions to use. The available completer
functions are described in the section `Control Functions&#39; below.</p>
<p>
Each string may be either the name of a completer function or a string
of the form `/function/*:*/name/*&#39;. In the first case the*
/completer/* field of the context will contain the name of the*
completer without the leading underscore and with all other
underscores replaced by hyphens. In the second case the /function/* is
the name of the completer to call, but the context* will contain the
user-defined /name/* in the <strong><em>completer</em></strong> field of* the context. If
the /name/* starts with a hyphen, the string for the* context will be
build from the name of the completer function as in the first case
with the /name/* appended to it. For example: *</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer _complete _complete:-foo
</pre>
</blockquote>
<p>
Here, completion will call the <strong>_complete completer twice, once</strong> using
`*complete&#39; and once using `complete-foo&#39; in the* /completer/* field
of the context. Normally, using the same* completer more than once
only makes sense when used with the `/functions/*:*/name/*&#39; form,
because otherwise the context* name will be the same in all calls to
the completer; possible exceptions to this rule are the <strong>_ignored and
_prefix</strong> completers.</p>
<p>
The default value for this style is `*_complete _ignored&#39;:* only
completion will be done, first using the <strong>ignored-patterns style</strong> and
the <strong>$fignore array and then without ignoring matches.</strong></p>
</dd>
<dt>
<strong>condition</strong>
</dt>
<dd>This style is used by the <strong>_list completer function to
decide if</strong> insertion of matches should be delayed unconditionally. The
default is `true&#39;.</dd>
<dt>
<strong>delimiters</strong>
</dt>
<dd>This style is used when adding a delimiter for use
with history modifiers or glob qualifiers that have delimited
arguments. It is an array of preferred delimiters to add. Non-special
characters are preferred as the completion system may otherwise become
confused. The default list is <strong>:, +, /, -, %. The list</strong> may be empty
to force a delimiter to be typed.</dd>
<dt>
<strong>disabled</strong>
</dt>
<dd>If this is set to `true&#39;, the *_expand_alias completer
and bindable * command will try to expand disabled aliases, too. The
default is `false&#39;.</dd>
<dt>
<strong>domains</strong>
</dt>
<dd>A list of names of network domains for completion. If
this is not set, domain names will be taken from the file
<strong>/etc/resolv.conf.</strong></dd>
<dt>
<strong>environ</strong>
</dt>
<dd>
<p>The environ style is used when completing for `*sudo&#39;. It
is set to an* array of `/VAR/*=*/value/*&#39; assignments to be exported
into the* local environment before the completion for the target
command is invoked.</p>
<pre class="example">
zstyle &#39;:completion:*:sudo::&#39; environ \ 
  PATH=&#34;/sbin:/usr/sbin:$PATH&#34; HOME=&#34;/root&#34;
</pre>
</dd>
<dt>
<strong>expand</strong>
</dt>
<dd>This style is used when completing strings consisting of
multiple parts, such as path names.

If one of its values is the string `*prefix&#39;, the partially typed*
word from the line will be expanded as far as possible even if
trailing parts cannot be completed.

If one of its values is the string `*suffix&#39;, matching names for*
components after the first ambiguous one will also be added. This
means that the resulting string is the longest unambiguous string
possible. However, menu completion can be used to cycle through all
matches.</dd>
<dt>
<strong>extra-verbose</strong>
</dt>
<dd>If set, the completion listing is more verbose at
the cost of a probable decrease in completion speed. Completion
performance will suffer if this style is set to `true&#39;.</dd>
<dt>
<strong>fake</strong>
</dt>
<dd>This style may be set for any completion context. It
specifies additional strings that will always be completed in that
context. The form of each string is `/value/*:*/description/*&#39;; * the
colon and description may be omitted, but any literal colons in
<em>value/* must be quoted with a backslash. Any */description</em> provided
is shown alongside the value in completion listings.

It is important to use a sufficiently restrictive context when
specifying fake strings. Note that the styles <strong>fake-files and
fake-parameters</strong> provide additional features when completing files or
parameters.</dd>
<dt>
<strong>fake-always</strong>
</dt>
<dd>
<p>This works identically to the <strong>fake style except
that</strong> the <strong>ignored-patterns style is not applied to it. This makes it</strong>
possible to override a set of matches completely by setting the
ignored patterns to `**&#39;.*</p>
<p>
The following shows a way of supplementing any tag with arbitrary
data, but having it behave for display purposes like a separate tag.
In this example we use the features of the <strong>tag-order style to divide
the</strong> <strong>named-directories tag into two when performing completion with</strong>
the standard completer <strong>complete for arguments of cd. The tag</strong>
<strong>named-directories-normal behaves as normal, but the tag</strong>
<strong>named-directories-mine contains a fixed set of directories.</strong> This has
the effect of adding the match group `*extra directories&#39; with* the
given completions.</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion::complete:cd:*&#39; tag-order \ 
  &#39;named-directories:-mine:extra\ directories
  named-directories:-normal:named\ directories *&#39;
zstyle &#39;:completion::complete:cd:*:named-directories-mine&#39; \ 
  fake-always mydir1 mydir2
zstyle &#39;:completion::complete:cd:*:named-directories-mine&#39; \ 
  ignored-patterns &#39;*&#39;
</pre>
</blockquote>
</dd>
<dt>
<strong>fake-files</strong>
</dt>
<dd>This style is used when completing files and looked up
without a tag. Its values are of the form `/dir/*:*/names…/*&#39;. This
will add the <strong><em>names</em></strong> (strings* separated by spaces) as possible
matches when completing in the directory /dir/*, even if no * such
files really exist. The dir may be a pattern; pattern characters or
colons in /dir/* should be quoted with a backslash to be treated*
literally.

This can be useful on systems that support special file systems whose
top-level pathnames can not be listed or generated with glob patterns
(but see <strong>accept-exact-dirs for a more general way of dealing</strong> with
this problem). It can also be used for directories for which one does
not have read permission.

The pattern form can be used to add a certain `magic&#39; entry to all
directories on a particular file system.</dd>
<dt>
<strong>fake-parameters</strong>
</dt>
<dd>This is used by the completion function for
parameter names. Its values are names of parameters that might not yet
be set but should be completed nonetheless. Each name may also be
followed by a colon and a string specifying the type of the parameter
(like `*scalar&#39;, `array&#39; or `integer&#39;). If the type is* given, the
name will only be completed if parameters of that type are required in
the particular context. Names for which no type is specified will
always be completed.</dd>
<dt>
<strong>file-list</strong>
</dt>
<dd>
<p>This style controls whether files completed using the
standard builtin mechanism are to be listed with a long list similar
to <strong>ls -l.</strong> Note that this feature uses the shell module <strong>zsh/stat for
file information; this loads the builtin stat</strong> which will replace any
external <strong>stat executable. To avoid</strong> this the following code can be
included in an initialization file:</p>
<blockquote>
<pre class="example">
zmodload -i zsh/stat
disable stat
</pre>
</blockquote>
<p>
The style may either be set to a `true&#39; value (or `*all&#39;), or* one of
the values `*insert&#39; or `list&#39;, indicating that files* are to be
listed in long format in all circumstances, or when attempting to
insert a file name, or when listing file names without attempting to
insert one.</p>
<p>
More generally, the value may be an array of any of the above values,
optionally followed by <strong>=*/num/</strong>. If <strong><em>num</em></strong> is present it* gives the
maximum number of matches for which long listing style will be used.
For example,</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; file-list list=20 insert=10
</pre>
</blockquote>
<p>
specifies that long format will be used when listing up to 20 files or
inserting a file with up to 10 matches (assuming a listing is to be
shown at all, for example on an ambiguous completion), else short
format will be used.</p>
<blockquote>
<pre class="example">
zstyle -e &#39;:completion:*&#39; file-list \ 
       &#39;(( ${+NUMERIC} )) &amp;&amp; reply=(true)&#39;
</pre>
</blockquote>
<p>
specifies that long format will be used any time a numeric argument is
supplied, else short format.</p>
</dd>
<dt>
<strong>file-patterns</strong>
</dt>
<dd>
<p>This is used by the standard function for
completing filenames, <strong>_files. If the style is unset up to three tags
are offered,</strong> `*globbed-files&#39;,`directories&#39; and `all-files&#39;,
depending on* the types of files expected by the caller of <strong>_files.
The first two</strong> (`*globbed-files&#39; and `directories&#39;) are normally
offered* together to make it easier to complete files in
sub-directories.</p>
<p>
The <strong>file-patterns style provides alternatives to the default tags,</strong>
which are not used. Its value consists of elements of the form
`/pattern/*:*/tag/*&#39;; each string may contain any number of* such
specifications separated by spaces.</p>
<p>
The /pattern/* is a pattern that is to be used to generate filenames.*
Any occurrence of the sequence `*%p&#39; is replaced by any* pattern(s)
passed by the function calling <strong>_files. Colons in the pattern must</strong> be
preceded by a backslash to make them distinguishable from the colon
before the /tag/*. If more than one pattern is needed, the patterns*
can be given inside braces, separated by commas.</p>
<p>
The /tag/*s of all strings in the value will be offered by _files* and
used when looking up other styles. Any /tag/*s in the same* word will
be offered at the same time and before later words. If no `*:*/tag/*&#39;
is given the `files&#39; tag will be used.*</p>
<p>
The /tag/* may also be followed by an optional second colon and a*
description, which will be used for the `*%d&#39; in the value of* the
<strong>format style (if that is set) instead of the default</strong> description
supplied by the completion function. The inclusion of a description
also gives precedence to associated options such as for completion
grouping so it can be used where files should be separated.</p>
<p>
For example, to make the <strong>rm command first complete only names of</strong>
object files and then the names of all files if there is no matching
object file:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:rm:*:*&#39; file-patterns \ 
    &#39;*.o:object-files&#39; &#39;%p:all-files&#39;
</pre>
</blockquote>
<p>
To alter the default behaviour of file completion – offer files
matching a pattern and directories on the first attempt, then all
files – to offer only matching files on the first attempt, then
directories, and finally all files:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; file-patterns \ 
    &#39;%p:globbed-files&#39; &#39;*(-/):directories&#39; &#39;*:all-files&#39;
</pre>
</blockquote>
<p>
This works even where there is no special pattern: <strong>_files matches</strong>
all files using the pattern `**&#39; at the first step and stops when it*
sees this pattern. Note also it will never try a pattern more than
once for a single completion attempt.</p>
<p>
To separate directories into a separate group from the files but still
complete them at the first attempt, a description needs to be given.
Note that directories need to be explicitly excluded from the
globbed-files because `**&#39; will match directories. For grouping, it*
is also necessary to set the <strong>group-name style.</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; file-patterns \ 
    &#39;%p(^-/):globbed-files *(-/):directories:location&#39;
</pre>
</blockquote>
<p>
During the execution of completion functions, the <strong>EXTENDED_GLOB</strong>
option is in effect, so the characters `*#&#39;, `~&#39; and `^&#39; have* special
meanings in the patterns.</p>
</dd>
<dt>
<strong>file-sort</strong>
</dt>
<dd>The standard filename completion function uses this
style without a tag to determine in which order the names should be
listed; menu completion will cycle through them in the same order. The
possible values are: `*size&#39; to sort by the size of the file;*
`*links&#39; to sort by the number of links to the file;* `*modification&#39;
(or `time&#39; or `date&#39;) to sort by the last* modification time;
`*access&#39; to sort by the last access time; and* `*inode&#39; (or `change&#39;)
to sort by the last inode change* time. If the style is set to any
other value, or is unset, files will be sorted alphabetically by name.
If the value contains the string `*reverse&#39;, sorting is done in the
opposite order. If the value* contains the string `*follow&#39;,
timestamps are associated with the* targets of symbolic links; the
default is to use the timestamps of the links themselves.</dd>
<dt>
<strong>file-split-chars</strong>
</dt>
<dd>A set of characters that will cause /all/* file
completions for* the given context to be split at the point where any
of the characters occurs. A typical use is to set the style to <strong>:;
then everything</strong> up to and including the last <strong>: in the string so far
is ignored when</strong> completing files. As this is quite heavy-handed, it
is usually preferable to update completion functions for contexts
where this behaviour is useful.</dd>
<dt>
<strong>filter</strong>
</dt>
<dd>The <strong>ldap plugin of email address completion (see
_email_addresses) uses</strong> this style to specify the attributes to match
against when filtering entries. So for example, if the style is set to
`*sn&#39;, matching is done against surnames. Standard* LDAP filtering is
used so normal completion matching is bypassed. If this style is not
set, the LDAP plugin is skipped. You may also need to set the <strong>command
style to specify how to connect to your LDAP server.</strong></dd>
<dt>
<strong>force-list</strong>
</dt>
<dd>This forces a list of completions to be shown at any
point where listing is done, even in cases where the list would
usually be suppressed. For example, normally the list is only shown if
there are at least two different matches. By setting this style to
`*always&#39;, the list will always be shown, even if there is only a*
single match that will immediately be accepted. The style may also be
set to a number. In this case the list will be shown if there are at
least that many matches, even if they would all insert the same
string.

This style is tested for the default tag as well as for each tag valid
for the current completion. Hence the listing can be forced only for
certain types of match.</dd>
<dt>
<strong>format</strong>
</dt>
<dd>
<p>If this is set for the <strong>descriptions tag, its value is
used as a</strong> string to display above matches in completion lists. The
sequence `*%d&#39; in this string will be replaced with a short
description of* what these matches are. This string may also contain
the output attribute sequences understood by <strong>compadd -X</strong> (see
/zshcompwid/*(1)).*</p>
<p>
The style is tested with each tag valid for the current completion
before it is tested for the *descriptions tag. Hence different format</p>
<ul>
<li>strings can be defined for different types of match.</li>
</ul>
<p>Note also that some completer functions define additional
`*%&#39;-sequences. These are described for the completer functions that *
make use of them.</p>
<p>
Some completion functions display messages that may be customised by
setting this style for the <strong>messages tag. Here, the `%d&#39; is</strong> replaced
with a message given by the completion function.</p>
<p>
Finally, the format string is looked up with the *warnings tag, * for
use when no matches could be generated at all. In this case the `*%d&#39;
is replaced with the descriptions for the matches that were* expected
separated by spaces. The sequence `*%D&#39; is replaced with* the same
descriptions separated by newlines.</p>
<p>
It is possible to use printf-style field width specifiers with `*%d&#39;*
and similar escape sequences. This is handled by the <strong>zformat</strong> builtin
command from the <strong>zsh/zutil module, see</strong> /zshmodules/*(1).*</p>
</dd>
<dt>
<strong>gain-privileges</strong>
</dt>
<dd>If set to <strong>true, this style enables the use of
commands like sudo</strong> or <strong>doas to gain extra privileges when retrieving
information for</strong> completion. This is only done when a command such as
<strong>sudo appears on</strong> the command-line. To force the use of, e.g. <strong>sudo or
to override any</strong> prefix that might be added due to <strong>gain-privileges,
the command</strong> style can be used with a value that begins with a hyphen.</dd>
<dt>
<strong>glob</strong>
</dt>
<dd>This is used by the <strong>_expand completer. If</strong> it is set to
`true&#39; (the default), globbing will be attempted on the words
resulting from a previous substitution (see the <strong>substitute</strong> style) or
else the original string from the line.</dd>
<dt>
<strong>global</strong>
</dt>
<dd>If this is set to `true&#39; (the default), the
<strong>_expand_alias</strong> completer and bindable command will try to expand
global aliases.</dd>
<dt>
<strong>group-name</strong>
</dt>
<dd>
<p>The completion system can group different types of
matches, which appear in separate lists. This style can be used to
give the names of groups for particular tags. For example, in command
position the completion system generates names of builtin and external
commands, names of aliases, shell functions and parameters and
reserved words as possible completions. To have the external commands
and shell functions listed separately:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:-command-:*:commands&#39; \ 
       group-name commands
zstyle &#39;:completion:*:*:-command-:*:functions&#39; \ 
       group-name functions
</pre>
</blockquote>
<p>
As a consequence, any match with the same tag will be displayed in the
same group.</p>
<p>
If the name given is the empty string the name of the tag for the
matches will be used as the name of the group. So, to have all
different types of matches displayed separately, one can just set:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; group-name &#39;&#39;
</pre>
</blockquote>
<p>
All matches for which no group name is defined will be put in a group
named <strong>-default-.</strong></p>
<p>
To display the group name in the output, see the <strong>format style (q.v.)</strong>
under the <strong>descriptions tag.</strong></p>
</dd>
<dt>
<strong>group-order</strong>
</dt>
<dd>
<p>This style is additional to the <strong>group-name style to
specify the</strong> order for display of the groups defined by that style
(compare <strong>tag-order,</strong> which determines which completions appear at
all). The groups named are shown in the given order; any other groups
are shown in the order defined by the completion function.</p>
<p>
For example, to have names of builtin commands, shell functions and
external commands appear in that order when completing in command
position:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:-command-:*:*&#39; group-order \ 
       builtins functions commands
</pre>
</blockquote>
</dd>
<dt>
<strong>groups</strong>
</dt>
<dd>A list of names of UNIX groups. If this is not set, group
names are taken from the YP database or the file `*/etc/group&#39;.*</dd>
<dt>
<strong>hidden</strong>
</dt>
<dd>If this is set to `true&#39;, matches for the given context
will not be listed, although any description for the matches set with
the <strong>format style will be</strong> shown. If it is set to `*all&#39;, not even the
description will be* displayed.

Note that the matches will still be completed; they are just not shown
in the list. To avoid having matches considered as possible
completions at all, the <strong>tag-order style can be modified as described</strong>
below.</dd>
<dt>
<strong>hosts</strong>
</dt>
<dd>A list of names of hosts that should be completed. If this
is not set, hostnames are taken from the file `*/etc/hosts&#39;.*</dd>
<dt>
<strong>hosts-ports</strong>
</dt>
<dd>This style is used by commands that need or accept
hostnames and network ports. The strings in the value should be of the
form `/host/*:*/port/*&#39;. Valid ports are determined by the presence*
of hostnames; multiple ports for the same host may appear.</dd>
<dt>
<strong>ignore-line</strong>
</dt>
<dd>This is tested for each tag valid for the current
completion. If it is set to `true&#39;, none of the words that are already
on the line will be considered as possible completions. If it is set
to `*current&#39;, the word the cursor is on will not be considered as a*
possible completion. The value `*current-shown&#39; is similar but only*
applies if the list of completions is currently shown on the screen.
Finally, if the style is set to `*other&#39;, all words on the line
except* for the current one will be excluded from the possible
completions.

The values `*current&#39; and `current-shown&#39; are a bit like the* opposite
of the <strong>accept-exact style: only strings with</strong> missing characters will
be completed.

Note that you almost certainly don&#39;t want to set this to `true&#39; or
`*other&#39; for a general* context such as `*:completion:*&#39;. This is
because it would disallow* completion of, for example, options
multiple times even if the command in question accepts the option more
than once.</dd>
<dt>
<strong>ignore-parents</strong>
</dt>
<dd>
<p>The style is tested without a tag by the function
completing pathnames in order to determine whether to ignore the names
of directories already mentioned in the current word, or the name of
the current working directory. The value must include one or both of
the following strings:</p>
<p>
<strong>parent</strong> The name of any directory whose path is already contained in
the word on the line is ignored. For example, when completing after
<strong>foo/../, the</strong> directory <strong>foo will not be considered a valid
completion.</strong></p>
<dl>
<dt>
<strong>pwd</strong>
</dt>
<dd>The name of the current working directory will not be
completed; hence, for example, completion after <strong>../ will not use
the name of the current</strong> directory.</dd>
</dl>
<p>In addition, the value may include one or both of:</p>
<p>
<strong>..</strong> Ignore the specified directories only when the word on the line
contains the substring `*../&#39;.*</p>
<dl>
<dt>
<strong>directory</strong>
</dt>
<dd>Ignore the specified directories only when names of
directories are completed, not when completing names of files.</dd>
</dl>
<p>Excluded values act in a similar fashion to values of the
<strong>ignored-patterns style, so they can be restored to consideration by</strong>
the <strong>_ignored completer.</strong></p>
</dd>
<dt>
<strong>ignored-patterns</strong>
</dt>
<dd>A list of patterns; any trial completion
matching one of the patterns will be excluded from consideration. The
<strong>_ignored completer can appear in the list of completers to</strong> restore
the ignored matches. This is a more configurable version of the shell
parameter <strong>$fignore.</strong>

Note that the <strong>EXTENDED_GLOB option is set during the execution of
completion</strong> functions, so the characters `*#&#39;, `~&#39; and `^&#39; have
special* meanings in the patterns.</dd>
<dt>
<strong>insert</strong>
</dt>
<dd>This style is used by the <strong>_all_matches completer to
decide whether to</strong> insert the list of all matches unconditionally
instead of adding the list as another match.</dd>
<dt>
<strong>insert-ids</strong>
</dt>
<dd>When completing process IDs, for example as arguments
to the <strong>kill and</strong> <strong>wait builtins the name of a</strong> command may be
converted to the appropriate process ID. A problem arises when the
process name typed is not unique. By default (or if this style is set
explicitly to `*menu&#39;) the name will be converted* immediately to a
set of possible IDs, and menu completion will be started to cycle
through them.

If the value of the style is `*single&#39;,* the shell will wait until the
user has typed enough to make the command unique before converting the
name to an ID; attempts at completion will be unsuccessful until that
point. If the value is any other string, menu completion will be
started when the string typed by the user is longer than the common
prefix to the corresponding IDs.</dd>
<dt>
<strong>insert-sections</strong>
</dt>
<dd>
<p>This style is used with tags of the form
`*manuals.*/X/*&#39; when* completing names of manual pages. If set and
the /X/* in the tag name matches* the section number of the page being
completed, the section number is inserted along with the page name.
For example, given</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:manuals.*&#39; insert-sections true
</pre>
</blockquote>
<p>
<strong>man ssh_&lt;TAB&gt; may be completed to man 5 ssh_config.</strong></p>
<p>
The value may also be set to one of `*prepend&#39;, or `suffix&#39;.*
`*prepend&#39; behaves the same as `true&#39; as in the above example, while*
`*suffix&#39; would complete man ssh_&lt;TAB&gt; as man ssh_config.5.*</p>
<p>
This is especially useful in conjunction with <strong>separate-sections, as</strong>
it ensures that the page requested of <strong>man corresponds to the one</strong>
displayed in the completion listing when there are multiple pages with
the same name (e.g., <strong>printf(1) and printf(3)).</strong></p>
<p>
The default for this style is `false&#39;.</p>
</dd>
<dt>
<strong>insert-tab</strong>
</dt>
<dd>If this is set to `true&#39;, the completion system will
insert a TAB character (assuming that was used to start completion)
instead of performing completion when there is no non-blank character
to the left of the cursor. If it is set to `false&#39;, completion will be
done even there.

The value may also contain the substrings `*pending&#39; or*
`*pending=*/val/*&#39;. In this case, the typed character will be*
inserted instead of starting completion when there is unprocessed
input pending. If a /val/* is given, completion will not be done if
there* are at least that many characters of unprocessed input. This is
often useful when pasting characters into a terminal. Note however,
that it relies on the <strong>$PENDING special parameter from the</strong> <strong>zsh/zle
module being set properly which is not guaranteed on all</strong> platforms.

The default value of this style is `true&#39; except for completion within
<strong>vared builtin command where it is `false&#39;.</strong></dd>
<dt>
<strong>insert-unambiguous</strong>
</dt>
<dd>This is used by the <strong>_match and _approximate
completers.</strong> These completers are often used with menu completion
since the word typed may bear little resemblance to the final
completion. However, if this style is `true&#39;, the completer will start
menu completion only if it could find no unambiguous initial string at
least as long as the original string typed by the user.

In the case of the <strong>_approximate completer, the completer</strong> field in
the context will already have been set to one of <strong>correct-*/num/</strong> or
approximate-<strong><em>num</em></strong>, where <strong><em>num</em></strong> is the* number of errors that were
accepted.

In the case of the <strong>_match completer, the style may also be set to</strong>
the string `*pattern&#39;. Then the pattern on the line is left* unchanged
if it does not match unambiguously.</dd>
<dt>
<strong>keep-prefix</strong>
</dt>
<dd>This style is used by the <strong>_expand completer. If it
is `true&#39;, the</strong> completer will try to keep a prefix containing a tilde
or parameter expansion. Hence, for example, the string `*~/f*&#39; would
be expanded to* `*~/foo&#39; instead of `/home/user/foo&#39;. If the style is
set to* `*changed&#39; (the default), the prefix will only be left
unchanged if* there were other changes between the expanded words and
the original word from the command line. Any other value forces the
prefix to be expanded unconditionally.

The behaviour of <strong>_expand when this style is `true&#39; is to cause
_expand</strong> to give up when a single expansion with the restored prefix
is the same as the original; hence any remaining completers may be
called.</dd>
<dt>
<strong>known-hosts-files</strong>
</dt>
<dd>This style should contain a list of files to
search for host names and (if the <strong>use-ip style is set) IP addresses
in a format compatible with</strong> ssh <strong>known_hosts files. If it is not set,
the files</strong> <strong><em>etc/ssh/ssh_known_hosts and ~</em>.ssh/known_hosts are used.</strong></dd>
<dt>
<strong>last-prompt</strong>
</dt>
<dd>This is a more flexible form of the
<strong>ALWAYS_LAST_PROMPT option.</strong> If it is `true&#39;, the completion system
will try to return the cursor to the previous command line after
displaying a completion list. It is tested for all tags valid for the
current completion, then the <strong>default tag. The cursor will be moved
back to the</strong> previous line if this style is `true&#39; for all types of
match. Note that unlike the <strong>ALWAYS_LAST_PROMPT option this is
independent of the</strong> numeric argument.</dd>
<dt>
<strong>list</strong>
</dt>
<dd>This style is used by the <strong>_history_complete_word bindable
command.</strong> If it is set to `true&#39; it has no effect. If it is set to
`false&#39; matches will not be listed. This overrides the setting of the
options controlling listing behaviour, in particular <strong>AUTO_LIST. The
context</strong> always starts with `*:completion:history-words&#39;.*</dd>
<dt>
<strong>list-colors</strong>
</dt>
<dd>
<p>If the <strong>zsh/complist module is loaded, this style can
be used to set</strong> color specifications. This mechanism replaces the use
of the <strong>ZLS_COLORS and ZLS_COLOURS parameters described in</strong> the
section `The zsh/complist Module&#39; in /zshmodules/*(1), but the syntax
is the same.*</p>
<p>
If this style is set for the *default tag, the strings in the value *
are taken as specifications that are to be used everywhere. If it is
set for other tags, the specifications are used only for matches of
the type described by the tag. For this to work best, the <strong>group-name</strong>
style must be set to an empty string.</p>
<p>
In addition to setting styles for specific tags, it is also possible
to use group names specified explicitly by the <strong>group-name tag
together</strong> with the `*(group)&#39; syntax allowed by the ZLS_COLORS and*
<strong>ZLS_COLOURS parameters and simply using the default tag.</strong></p>
<p>
It is possible to use any color specifications already set up for the
GNU version of the <strong>ls command:</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:default&#39; list-colors \ 
       ${(s.:.)LS_COLORS}
</pre>
</blockquote>
<p>
The default colors are the same as for the GNU <strong>ls command and can be</strong>
obtained by setting the style to an empty string (i.e. <strong>&#39;&#39;).</strong></p>
</dd>
<dt>
<strong>list-dirs-first</strong>
</dt>
<dd>This is used by file completion and corresponds
to a particular setting of the <strong>file-patterns style.</strong> If set, the
default directories to be completed are listed separately from and
before completion for other files.</dd>
<dt>
<strong>list-grouped</strong>
</dt>
<dd>If this style is `true&#39; (the default), the
completion system will try to make certain completion listings more
compact by grouping matches. For example, options for commands that
have the same description (shown when the <strong>verbose style is set to
`true&#39;) will appear as a single</strong> entry. However, menu selection can be
used to cycle through all the matches.</dd>
<dt>
<strong>list-packed</strong>
</dt>
<dd>This is tested for each tag valid in the current
context as well as the <strong>default tag. If it is set to `true&#39;, the
corresponding matches</strong> appear in listings as if the <strong>LIST_PACKED
option were set. If it is</strong> set to `false&#39;, they are listed normally.</dd>
<dt>
<strong>list-prompt</strong>
</dt>
<dd>If this style is set for the <strong>default tag,</strong>
completion lists that don&#39;t fit on the screen can be scrolled (see the
description of the <strong>zsh/complist module in */zshmodules/*(1)). The
value, if not the empty string, will be displayed after every</strong>
screenful and the shell will prompt for a key press; if the style is
set to the empty string, a default prompt will be used.

The value may contain the escape sequences: `*%l&#39; or `%L&#39;, which will
be replaced by the number of the last line* displayed and the total
number of lines; `*%m&#39; or `%M&#39;, * the number of the last match shown
and the total number of matches; and `*%p&#39; and `%P&#39;, `Top&#39;* when at
the beginning of the list, `*Bottom&#39; when at the end and the* position
shown as a percentage of the total length otherwise. In each case the
form with the uppercase letter will be replaced by a string of fixed
width, padded to the right with spaces, while the lowercase form will
be replaced by a variable width string. As in other prompt strings,
the escape sequences `*%S&#39;, `%s&#39;, `%B&#39;, `%b&#39;, `%U&#39;,* `*%u&#39; for
entering and leaving the display modes* standout, bold and underline,
and `*%F&#39;, `%f&#39;, `%K&#39;, `%k&#39; for* changing the foreground background
colour, are also available, as is the form `*%{…%}&#39; for enclosing
escape sequences which display with zero* (or, with a numeric
argument, some other) width.

After deleting this prompt the variable <strong>LISTPROMPT should be unset
for</strong> the removal to take effect.</dd>
<dt>
<strong>list-rows-first</strong>
</dt>
<dd>This style is tested in the same way as the
<strong>list-packed style and</strong> determines whether matches are to be listed in
a rows-first fashion as if the <strong>LIST_ROWS_FIRST option were set.</strong></dd>
<dt>
<strong>list-separator</strong>
</dt>
<dd>The value of this style is used in completion
listing to separate the string to complete from a description when
possible (e.g. when completing options). It defaults to `*–&#39; (two
hyphens).*</dd>
<dt>
<strong>list-suffixes</strong>
</dt>
<dd>This style is used by the function that completes
filenames. If it is `true&#39;, and completion is attempted on a string
containing multiple partially typed pathname components, all ambiguous
components will be shown. Otherwise, completion stops at the first
ambiguous component.</dd>
<dt>
<strong>local</strong>
</dt>
<dd>
<p>This is for use with functions that complete URLs for which
the corresponding files are available directly from the file system.
Its value should consist of three strings: a hostname, the path to the
default web pages for the server, and the directory name used by a
user placing web pages within their home area.</p>
<p>
For example:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; local toast \ 
    /var/http/public/toast public_html
</pre>
</blockquote>
<p>
Completion after `*<a href="http://toast/stuff/&#39;">http://toast/stuff/&#39;</a> will look for files in the*
directory <strong>/var/http/public/toast/stuff, while completion after</strong>
`*<a href="http://toast/~yousir/&#39;">http://toast/~yousir/&#39;</a> will look for files in the directory*
<strong>~yousir/public_html.</strong></p>
</dd>
<dt>
<strong>mail-directory</strong>
</dt>
<dd>If set, zsh will assume that mailbox files can be
found in the directory specified. It defaults to `*~/Mail&#39;.*</dd>
<dt>
<strong>match-original</strong>
</dt>
<dd>This is used by the <strong>_match completer. If it is
set to</strong> <strong>only, _match will try to generate matches without inserting
a</strong> `**&#39; at the cursor position. If set to any other non-empty value,*
it will first try to generate matches without inserting the `**&#39;* and
if that yields no matches, it will try again with the `**&#39;* inserted.
If it is unset or set to the empty string, matching will only be
performed with the `**&#39; inserted.*</dd>
<dt>
<strong>matcher</strong>
</dt>
<dd>This style is tested separately for each tag valid in the
current context. Its value is placed before any match specifications
given by the <strong>matcher-list style so can override them via the use of
an x:</strong> specification. The value should be in the form described in the
section `Completion Matching Control&#39; in /zshcompwid/*(1). For
examples of this, see the description of the tag-order style.*

For notes comparing the use of this and the <strong>matcher-list style, see</strong>
under the description of the <strong>tag-order style.</strong></dd>
<dt>
<strong>matcher-list</strong>
</dt>
<dd>
<p>This style can be set to a list of match
specifications that are to be applied everywhere. Match specifications
are described in the section `Completion Matching Control&#39; in
/zshcompwid/*(1).* The completion system will try them one after
another for each completer selected. For example, to try first simple
completion and, if that generates no matches, case-insensitive
completion:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; matcher-list &#39;&#39; &#39;m:{a-zA-Z}={A-Za-z}&#39;
</pre>
</blockquote>
<p>
By default each specification replaces the previous one; however, if a
specification is prefixed with <strong>+, it is added to the existing list.</strong>
Hence it is possible to create increasingly general specifications
without repetition:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; matcher-list \ 
       &#39;&#39; &#39;+m:{a-z}={A-Z}&#39; &#39;+m:{A-Z}={a-z}&#39;
</pre>
</blockquote>
<p>
It is possible to create match specifications valid for particular
completers by using the third field of the context. This applies only
to completers that override the global matcher-list, which as of this
writing includes only <strong>_prefix and _ignored. For example, to</strong> use the
completers <strong>_complete and _prefix but allow</strong> case-insensitive
completion only with <strong>_complete:</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer _complete _prefix
zstyle &#39;:completion:*:complete:*:*:*&#39; matcher-list \ 
       &#39;&#39; &#39;m:{a-zA-Z}={A-Za-z}&#39;
</pre>
</blockquote>
<p>
User-defined names, as explained for the <strong>completer style, are</strong>
available. This makes it possible to try the same completer more than
once with different match specifications each time. For example, to
try normal completion without a match specification, then normal
completion with case-insensitive matching, then correction, and
finally partial-word completion:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer \ 
    _complete _correct _complete:foo
zstyle &#39;:completion:*:complete:*:*:*&#39; matcher-list \ 
    &#39;&#39; &#39;m:{a-zA-Z}={A-Za-z}&#39;
zstyle &#39;:completion:*:foo:*:*:*&#39; matcher-list \ 
    &#39;m:{a-zA-Z}={A-Za-z} r:|[-_./]=* r:|=*&#39;
</pre>
</blockquote>
<p>
If the style is unset in any context no match specification is
applied. Note also that some completers such as <strong>_correct and
_approximate</strong> do not use the match specifications at all, though these
completers will only ever be called once even if the <strong>matcher-list
contains more than</strong> one element.</p>
<p>
Where multiple specifications are useful, note that the <em>entire</em>
completion is done for each element of <strong>matcher-list, which can</strong>
quickly reduce the shell&#39;s performance. As a rough rule of thumb, one
to three strings will give acceptable performance. On the other hand,
putting multiple space-separated values into the same string does not
have an appreciable impact on performance.</p>
<p>
If there is no current matcher or it is empty, and the option
<strong>NO_CASE_GLOB is in effect, the matching for files is performed</strong>
case-insensitively in any case. However, any matcher must explicitly
specify case-insensitive matching if that is required.</p>
<p>
For notes comparing the use of this and the <strong>matcher style, see</strong> under
the description of the <strong>tag-order style.</strong></p>
</dd>
<dt>
<strong>max-errors</strong>
</dt>
<dd>
<p>This is used by the <strong>_approximate and _correct
completer functions</strong> to determine the maximum number of errors to
allow. The completer will try to generate completions by first
allowing one error, then two errors, and so on, until either a match
or matches were found or the maximum number of errors given by this
style has been reached.</p>
<p>
If the value for this style contains the string `*numeric&#39;, the *
completer function will take any numeric argument as the maximum
number of errors allowed. For example, with</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:approximate:::&#39; max-errors 2 numeric
</pre>
</blockquote>
<p>
two errors are allowed if no numeric argument is given, but with a
numeric argument of six (as in `*ESC-6 TAB&#39;), up to six* errors are
accepted. Hence with a value of `*0 numeric&#39;, no correcting*
completion will be attempted unless a numeric argument is given.</p>
<p>
If the value contains the string `*not-numeric&#39;, the completer* will
/not/* try to generate corrected* completions when given a numeric
argument, so in this case the number given should be greater than
zero. For example, `*2 not-numeric&#39; specifies that* correcting
completion with two errors will usually be performed, but if a numeric
argument is given, correcting completion will not be performed.</p>
<p>
The default value for this style is `*2 numeric&#39;.*</p>
</dd>
<dt>
<strong>max-matches-width</strong>
</dt>
<dd>This style is used to determine the trade off
between the width of the display used for matches and the width used
for their descriptions when the <strong>verbose style is in effect. The value
gives the number of</strong> display columns to reserve for the matches. The
default is half the width of the screen.

This has the most impact when several matches have the same
description and so will be grouped together. Increasing the style will
allow more matches to be grouped together; decreasing it will allow
more of the description to be visible.</dd>
<dt>
<strong>menu</strong>
</dt>
<dd>If this is `true&#39; in the context of any of the tags defined
for the current completion menu completion will be used. The value for
a specific tag will take precedence over that for the `*default&#39; tag.*

If none of the values found in this way is `true&#39; but at least one is
set to `*auto&#39;, the shell behaves as if the AUTO_MENU* option is set.

If one of the values is explicitly set to `false&#39;, menu completion
will be explicitly turned off, overriding the <strong>MENU_COMPLETE option
and other settings.</strong>

In the form `*yes=*/num/*&#39;, where `yes&#39; may be any of the* `true&#39;
values (`*yes&#39;, `true&#39;, `on&#39; and `1&#39;),* menu completion will be turned
on if there are at least /num/* matches.* In the form `*yes=long&#39;,
menu completion will be turned on* if the list does not fit on the
screen. This does not activate menu completion if the widget normally
only lists completions, but menu completion can be activated in that
case with the value `*yes=long-list&#39;* (Typically, the value
`*select=long-list&#39; described later is more* useful as it provides
control over scrolling.)

Similarly, with any of the `false&#39; values (as in `*no=10&#39;), menu*
completion will /not/* be used if there are <strong><em>num</em></strong> or more matches. *

The value of this widget also controls menu selection, as implemented
by the <strong>zsh/complist module. The following values may appear either</strong>
alongside or instead of the values above.

If the value contains the string `*select&#39;, menu selection* will be
started unconditionally.

In the form `*select=*/num/*&#39;, menu selection will only be started if*
there are at least /num/* matches. If the values for more than one*
tag provide a number, the smallest number is taken.

Menu selection can be turned off explicitly by defining a value
containing the string`*no-select&#39;.*

It is also possible to start menu selection only if the list of
matches does not fit on the screen by using the value `*select=long&#39;.
To start menu selection even if the current widget* only performs
listing, use the value `*select=long-list&#39;.*

To turn on menu completion or menu selection when there are a certain
number of matches /or/* the list of matches does not fit on the*
screen, both of `*yes=&#39; and `select=&#39; may be given twice, once* with a
number and once with `*long&#39; or `long-list&#39;.*

Finally, it is possible to activate two special modes of menu
selection. The word `*interactive&#39; in the value causes interactive
mode* to be entered immediately when menu selection is started; see
the description of the <strong>zsh/complist module in */zshmodules/*(1)</strong> for
a description of interactive mode. Including the string `*search&#39; does
the same for incremental search mode. To select backward* incremental
search, include the string `*search-backward&#39;.*</dd>
<dt>
<strong>muttrc</strong>
</dt>
<dd>If set, gives the location of the mutt configuration file.
It defaults to `*~/.muttrc&#39;.*</dd>
<dt>
<strong>numbers</strong>
</dt>
<dd>This is used with the <strong>jobs tag. If it is `true&#39;, the
shell will</strong> complete job numbers instead of the shortest unambiguous
prefix of the job command text. If the value is a number, job numbers
will only be used if that many words from the job descriptions are
required to resolve ambiguities. For example, if the value is `*1&#39;,
strings will* only be used if all jobs differ in the first word on
their command lines.</dd>
<dt>
<strong>old-list</strong>
</dt>
<dd>This is used by the <strong>_oldlist completer. If it is set to
`always&#39;,</strong> then standard widgets which perform listing will retain the
current list of matches, however they were generated; this can be
turned off explicitly with the value `*never&#39;, giving the behaviour
without the _oldlist* completer. If the style is unset, or any other
value, then the existing list of completions is displayed if it is not
already; otherwise, the standard completion list is generated; this is
the default behaviour of <strong>_oldlist. However, if there is an old list
and this style contains</strong> the name of the completer function that
generated the list, then the old list will be used even if it was
generated by a widget which does not do listing.

For example, suppose you type <strong>^Xc to use the _correct_word</strong> widget,
which generates a list of corrections for the word under the cursor.
Usually, typing <strong>^D would generate a standard list of</strong> completions for
the word on the command line, and show that. With <strong>_oldlist, it will
instead show the list of corrections already</strong> generated.

As another example consider the <strong>_match completer: with the</strong>
<strong>insert-unambiguous style set to `true&#39; it inserts only a common
prefix</strong> string, if there is any. However, this may remove parts of the
original pattern, so that further completion could produce more
matches than on the first attempt. By using the <strong>_oldlist completer
and setting this style</strong> to <strong>_match, the list of matches generated on
the first attempt will be</strong> used again.</dd>
<dt>
<strong>old-matches</strong>
</dt>
<dd>This is used by the <strong>_all_matches completer to decide
if an old</strong> list of matches should be used if one exists. This is
selected by one of the `true&#39; values or by the string `*only&#39;. If* the
value is `*only&#39;, _all_matches will only use an old list* and won&#39;t
have any effect on the list of matches currently being generated.

If this style is set it is generally unwise to call the <strong>_all_matches</strong>
completer unconditionally. One possible use is for either this style
or the <strong>completer style to be defined with the -e option to</strong> <strong>zstyle
to make the style conditional.</strong></dd>
<dt>
<strong>old-menu</strong>
</dt>
<dd>This is used by the <strong>_oldlist completer. It controls how
menu</strong> completion behaves when a completion has already been inserted
and the user types a standard completion key such as <strong>TAB. The
default</strong> behaviour of <strong>_oldlist is that menu completion always
continues</strong> with the existing list of completions. If this style is set
to `false&#39;, however, a new completion is started if the old list was
generated by a different completion command; this is the behaviour
without the <strong>_oldlist completer.</strong>

For example, suppose you type <strong>^Xc to generate a list of corrections,</strong>
and menu completion is started in one of the usual ways. Usually, or
with this style set to `false&#39;, typing <strong>TAB at this point would start</strong>
trying to complete the line as it now appears. With <strong>_oldlist, it</strong>
instead continues to cycle through the list of corrections.</dd>
<dt>
<strong>original</strong>
</dt>
<dd>This is used by the <strong>_approximate and _correct</strong>
completers to decide if the original string should be added as a
possible completion. Normally, this is done only if there are at least
two possible corrections, but if this style is set to `true&#39;, it is
always added. Note that the style will be examined with the completer
field in the context name set to <strong>correct-*/num/</strong> or*
<strong>approximate-*/num/</strong>, where <strong><em>num</em></strong> is the number of errors that* were
accepted.</dd>
<dt>
<strong>packageset</strong>
</dt>
<dd>
<p>This style is used when completing arguments of the
Debian `*dpkg&#39;* program. It contains an override for the default
package set for a given context. For example,</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:complete:dpkg:option--status-1:*&#39; \ 
               packageset avail
</pre>
</blockquote>
<p>
causes available packages, rather than only installed packages, to be
completed for `*dpkg –status&#39;.*</p>
</dd>
<dt>
<strong>path</strong>
</dt>
<dd>The function that completes color names uses this style with
the <strong>colors tag. The value should be the pathname of a file</strong>
containing color names in the format of an X11 <strong>rgb.txt file. If</strong> the
style is not set but this file is found in one of various standard
locations it will be used as the default.</dd>
<dt>
<strong>path-completion</strong>
</dt>
<dd>This is used by filename completion. By default,
filename completion examines all components of a path to see if there
are completions of that component. For example, <strong>/u/b/z can be
completed to</strong> <strong>/usr/bin/zsh. Explicitly setting this style to `false&#39;
inhibits this</strong> behaviour for path components up to the <strong>/ before the
cursor; this</strong> overrides the setting of <strong>accept-exact-dirs.</strong>

Even with the style set to `false&#39;, it is still possible to complete
multiple paths by setting the option <strong>COMPLETE_IN_WORD and moving the</strong>
cursor back to the first component in the path to be completed. For
example, <strong>/u/b/z can be completed to /usr/bin/zsh if the cursor is</strong>
after the <strong>/u.</strong></dd>
<dt>
<strong>pine-directory</strong>
</dt>
<dd>If set, specifies the directory containing PINE
mailbox files. There is no default, since recursively searching this
directory is inconvenient for anyone who doesn&#39;t use PINE.</dd>
<dt>
<strong>ports</strong>
</dt>
<dd>A list of Internet service names (network ports) to
complete. If this is not set, service names are taken from the file
`*/etc/services&#39;.*</dd>
<dt>
<strong>prefix-hidden</strong>
</dt>
<dd>This is used for certain completions which share a
common prefix, for example command options beginning with dashes. If
it is `true&#39;, the prefix will not be shown in the list of matches.

The default value for this style is `false&#39;.</dd>
<dt>
<strong>prefix-needed</strong>
</dt>
<dd>This style is also relevant for matches with a
common prefix. If it is set to `true&#39; this common prefix must be typed
by the user to generate the matches.

The style is applicable to the <strong>options, signals, jobs,</strong> <strong>functions,
and parameters completion tags.</strong>

For command options, this means that the initial `*-&#39;, `+&#39;, or* `*–&#39;
must be typed explicitly before option names will be* completed.

For signals, an initial `*-&#39; is required before signal names will* be
completed.

For jobs, an initial `*%&#39; is required before job names will be*
completed.

For function and parameter names, an initial `*_&#39; or `.&#39; is* required
before function or parameter names starting with those characters will
be completed.

The default value for this style is `false&#39; for <strong>function and</strong>
<strong>parameter completions, and `true&#39; otherwise.</strong></dd>
<dt>
<strong>preserve-prefix</strong>
</dt>
<dd>This style is used when completing path names.
Its value should be a pattern matching an initial prefix of the word
to complete that should be left unchanged under all circumstances. For
example, on some Unices an initial `*//&#39; (double slash) has a special
meaning; setting* this style to the string `*//&#39; will preserve it. As
another example,* setting this style to `*?:/&#39; under Cygwin would
allow completion* after `*a:/…&#39; and so on.*</dd>
<dt>
<strong>range</strong>
</dt>
<dd>This is used by the <strong>_history completer and the</strong>
<strong>_history_complete_word bindable command to decide which words</strong> should
be completed.

If it is a single number, only the last /N/* words from the history*
will be completed.

If it is a range of the form `/max/*:*/slice/*&#39;,* the last /slice/*
words will be completed; then if that* yields no matches, the /slice/*
words before those will be tried and * so on. This process stops
either when at least one match has been found, or /max/* words have
been tried.*

The default is to complete all words from the history at once.</dd>
<dt>
<strong>recursive-files</strong>
</dt>
<dd>
<p>If this style is set, its value is an array of
patterns to be tested against `*$PWD/&#39;: note the trailing slash, which
allows* directories in the pattern to be delimited unambiguously by
including slashes on both sides. If an ordinary file completion fails
and the word on the command line does not yet have a directory part to
its name, the style is retrieved using the same tag as for the
completion just attempted, then the elements tested against *$PWD/ in
turn.* If one matches, then the shell reattempts completion by
prepending the word on the command line with each directory in the
expansion of <strong>**/*(/)</strong> in turn. Typically the elements of the style
will be set to restrict the number of directories beneath the current
one to a manageable number, for example `**/.git/*&#39;.*</p>
<p>
For example,</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; recursive-files &#39;*/zsh/*&#39;
</pre>
</blockquote>
<p>
If the current directory is <strong>/home/pws/zsh/Src, then</strong> <strong>zle_tr&lt;TAB&gt; can
be completed to Zle/zle_tricky.c.</strong></p>
</dd>
<dt>
<strong>regular</strong>
</dt>
<dd>This style is used by the *_expand_alias completer and
bindable * command. If set to `true&#39; (the default), regular aliases
will be expanded but only in command position. If it is set to
`false&#39;, regular aliases will never be expanded. If it is set to
`*always&#39;,* regular aliases will be expanded even if not in command
position.</dd>
<dt>
<strong>rehash</strong>
</dt>
<dd>If this is set when completing external commands, the
internal list (hash) of commands will be updated for each search by
issuing the <strong>rehash command. There is a speed penalty for this which</strong>
is only likely to be noticeable when directories in the path have slow
file access.</dd>
<dt>
<strong>remote-access</strong>
</dt>
<dd>If set to `false&#39;, certain commands will be
prevented from making Internet connections to retrieve remote
information. This includes the completion for the <strong>CVS command.</strong>

It is not always possible to know if connections are in fact to a
remote site, so some may be prevented unnecessarily.</dd>
<dt>
<strong>remove-all-dups</strong>
</dt>
<dd>The <strong>_history_complete_word bindable command and
the _history</strong> completer use this to decide if all duplicate matches
should be removed, rather than just consecutive duplicates.</dd>
<dt>
<strong>select-prompt</strong>
</dt>
<dd>If this is set for the <strong>default tag, its</strong> value
will be displayed during menu selection (see the <strong>menu style</strong> above)
when the completion list does not fit on the screen as a whole. The
same escapes as for the <strong>list-prompt style are</strong> understood, except
that the numbers refer to the match or line the mark is on. A default
prompt is used when the value is the empty string.</dd>
<dt>
<strong>select-scroll</strong>
</dt>
<dd>This style is tested for the <strong>default tag and
determines how a</strong> completion list is scrolled during a menu selection
(see the <strong>menu</strong> style above) when the completion list does not fit on
the screen as a whole. If the value is `*0&#39; (zero), the list is
scrolled by* half-screenfuls; if it is a positive integer, the list is
scrolled by the given number of lines; if it is a negative number, the
list is scrolled by a screenful minus the absolute value of the given
number of lines. The default is to scroll by single lines.</dd>
<dt>
<strong>separate-sections</strong>
</dt>
<dd>This style is used with the <strong>manuals tag when
completing names of</strong> manual pages. If it is `true&#39;, entries for
different sections are added separately using tag names of the form
`*manuals.*/X/*&#39;,* where /X/* is the section number. When the
group-name style is* also in effect, pages from different sections
will appear separately. This style is also used similarly with the
<strong>words style when</strong> completing words for the dict command. It allows
words from different dictionary databases to be added separately. See
also <strong>insert-sections.</strong>

The default for this style is `false&#39;.</dd>
<dt>
<strong>show-ambiguity</strong>
</dt>
<dd>If the <strong>zsh/complist module is loaded, this style
can be used to</strong> highlight the first ambiguous character in completion
lists. The value is either a color indication such as those supported
by the <strong>list-colors style or, with a value of `true&#39;, a default of</strong>
underlining is selected. The highlighting is only applied if the
completion display strings correspond to the actual matches.</dd>
<dt>
<strong>show-completer</strong>
</dt>
<dd>Tested whenever a new completer is tried. If it is
`true&#39;, the completion system outputs a progress message in the
listing area showing what completer is being tried. The message will
be overwritten by any output when completions are found and is removed
after completion is finished.</dd>
<dt>
<strong>single-ignored</strong>
</dt>
<dd>This is used by the <strong>_ignored completer when there
is only one match.</strong> If its value is `*show&#39;, the single match will be*
displayed but not inserted. If the value is `*menu&#39;, then the single*
match and the original string are both added as matches and menu
completion is started, making it easy to select either of them.</dd>
<dt>
<strong>sort</strong>
</dt>
<dd>This allows the standard ordering of matches to be
overridden.

If its value is `*true&#39; or `false&#39;, sorting is enabled or disabled.*
Additionally the values associated with the `*-o&#39; option to compadd
can* also be listed: <strong>match, nosort, numeric, reverse. If it is not</strong>
set for the context, the standard behaviour of the calling widget is
used.

The style is tested first against the full context including the tag,
and if that fails to produce a value against the context without the
tag.

In many cases where a calling widget explicitly selects a particular
ordering in lieu of the default, a value of `*true&#39; is not honoured.
An example of* where this is not the case is for command history where
the default of sorting matches chronologically may be overridden by
setting the style to `true&#39;.

In the <strong>_expand completer, if it is set to</strong> `true&#39;, the expansions
generated will always be sorted. If it is set to `*menu&#39;, then the
expansions are only sorted when they are offered * as single strings
but not in the string containing all possible expansions.</dd>
<dt>
<strong>special-dirs</strong>
</dt>
<dd>
<p>Normally, the completion code will not produce the
directory names `*.&#39; and `..&#39; as possible completions. If this style
is set to* `true&#39;, it will add both `*.&#39; and `..&#39; as possible
completions;* if it is set to `*..&#39;, only `..&#39; will be added.*</p>
<p>
The following example sets <strong>special-dirs to `..&#39; when the</strong> current
prefix is empty, is a single `*.&#39;, or consists only of a path*
beginning with `*../&#39;. Otherwise the value is `false&#39;.*</p>
<blockquote>
<pre class="example">
zstyle -e &#39;:completion:*&#39; special-dirs \ 
   &#39;[[ $PREFIX = (../)#(|.|..) ]] &amp;&amp; reply=(..)&#39;
</pre>
</blockquote>
</dd>
<dt>
<strong>squeeze-slashes</strong>
</dt>
<dd>If set to `true&#39;, sequences of slashes in
filename paths (for example in `*foo//bar&#39;) will be treated as a
single slash. This is the usual* behaviour of UNIX paths. However, by
default the file completion function behaves as if there were a `**&#39;
between the slashes.*</dd>
<dt>
<strong>stop</strong>
</dt>
<dd>If set to `true&#39;, the <strong>_history_complete_word bindable</strong>
command will stop once when reaching the beginning or end of the
history. Invoking *_history_complete_word will then wrap around to *
the opposite end of the history. If this style is set to `false&#39; (the
default), <strong>_history_complete_word will loop immediately as in a</strong> menu
completion.</dd>
<dt>
<strong>strip-comments</strong>
</dt>
<dd>If set to `true&#39;, this style causes non-essential
comment text to be removed from completion matches. Currently it is
only used when completing e-mail addresses where it removes any
display name from the addresses, cutting them down to plain
/user@host/* form.*</dd>
<dt>
<strong>subst-globs-only</strong>
</dt>
<dd>This is used by the <strong>_expand completer. If it is
set to `true&#39;,</strong> the expansion will only be used if it resulted from
globbing; hence, if expansions resulted from the use of the
<strong>substitute style</strong> described below, but these were not further changed
by globbing, the expansions will be rejected.

The default for this style is `false&#39;.</dd>
<dt>
<strong>substitute</strong>
</dt>
<dd>This boolean style controls whether the <strong>_expand
completer will</strong> first try to expand all substitutions in the string
(such as `*$(*/.../*)&#39; and `${<strong><em>…</em></strong>}&#39;).*

The default is `true&#39;.</dd>
<dt>
<strong>suffix</strong>
</dt>
<dd>This is used by the <strong>_expand completer if the word starts
with a</strong> tilde or contains a parameter expansion. If it is set to
`true&#39;, the word will only be expanded if it doesn&#39;t have a suffix,
i.e. if it is something like `*~foo&#39; or `$foo&#39; rather than `~foo/&#39; or*
`*$foo/bar&#39;, unless that suffix itself contains characters eligible*
for expansion. The default for this style is `true&#39;.</dd>
<dt>
<strong>tag-order</strong>
</dt>
<dd>
<p>This provides a mechanism for sorting how the tags
available in a particular context will be used.</p>
<p>
The values for the style are sets of space-separated lists of tags.
The tags in each value will be tried at the same time; if no match is
found, the next value is used. (See the <strong>file-patterns style for</strong> an
exception to this behavior.)</p>
<p>
For example:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:complete:-command-:*:*&#39; tag-order \ 
    &#39;commands functions&#39;
</pre>
</blockquote>
<p>
specifies that completion in command position first offers external
commands and shell functions. Remaining tags will be tried if no
completions are found.</p>
<p>
In addition to tag names, each string in the value may take one of the
following forms:</p>
<p>
<strong>-</strong> If any value consists of only a hyphen, then /only/* the tags
specified in the other values are* generated. Normally all tags not
explicitly selected are tried last if the specified tags fail to
generate any matches. This means that a single value consisting only
of a single hyphen turns off completion.</p>
<dl>
<dt>
<strong>! */tags/</strong>…*
</dt>
<dd>A string starting with an exclamation mark
specifies names of tags that are /not/* to be used. The effect is*
the same as if all other possible tags for the context had been
listed.</dd>
<dt>
/tag/*:*/label/* …*
</dt>
<dd>Here, /tag/* is one of the standard tags
and <strong><em>label</em></strong> is an* arbitrary name. Matches are generated as normal
but the name <em>label</em> is used in contexts instead of /tag/*. This is
not useful in words* starting with <strong>!.</strong>

If the /label/* starts with a hyphen, the <strong><em>tag</em></strong> is prepended to
the* /label/* to form the name used for lookup. This can be* used to
make the completion system try a certain tag more than once,
supplying different style settings for each attempt; see below for
an example.</dd>
<dt>
<em>tag/*:*/label/*:*/description</em>
</dt>
<dd>As before, but <strong>description will
replace the `%d&#39; in</strong> the value of the <strong>format style instead of the
default description</strong> supplied by the completion function. Spaces in
the description must be quoted with a backslash. A `*%d&#39; appearing*
in /description/* is replaced with the description given by the*
completion function.</dd>
</dl>
<p>In any of the forms above the tag may be a pattern or several patterns
in the form `*{<strong><em>pat1</em></strong>,*/pat2…/*}&#39;. In this* case all matching tags
will be used except for any given explicitly in the same string.</p>
<p>
One use of these features is to try one tag more than once, setting
other styles differently on each attempt, but still to use all the
other tags without having to repeat them all. For example, to make
completion of function names in command position ignore all the
completion functions starting with an underscore the first time
completion is tried:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:-command-:*:*&#39; tag-order \ 
    &#39;functions:-non-comp *&#39; functions
zstyle &#39;:completion:*:functions-non-comp&#39; \ 
    ignored-patterns &#39;_*&#39;
</pre>
</blockquote>
<p>
On the first attempt, all tags will be offered but the <strong>functions tag</strong>
will be replaced by *functions-non-comp. The ignored-patterns style *
is set for this tag to exclude functions starting with an underscore.
If there are no matches, the second value of the <strong>tag-order style is
used which completes functions using the default</strong> tag, this time
presumably including all function names.</p>
<p>
The matches for one tag can be split into different groups. For
example:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; tag-order \ 
    &#39;options:-long:long\ options
     options:-short:short\ options
     options:-single-letter:single\ letter\ options&#39;
zstyle &#39;:completion:*:options-long&#39; \ 
     ignored-patterns &#39;[-+](|-|[^-]*)&#39;
zstyle &#39;:completion:*:options-short&#39; \ 
     ignored-patterns &#39;--*&#39; &#39;[-+]?&#39;
zstyle &#39;:completion:*:options-single-letter&#39; \ 
     ignored-patterns &#39;???*&#39;
</pre>
</blockquote>
<p>
With the <strong>group-names style set, options beginning with</strong> `*–&#39;,
options beginning with a single `-&#39; or `+&#39; but* containing multiple
characters, and single-letter options will be displayed in separate
groups with different descriptions.</p>
<p>
Another use of patterns is to try multiple match specifications one
after another. The <strong>matcher-list style offers something similar, but
it is tested very</strong> early in the completion system and hence can&#39;t be
set for single commands nor for more specific contexts. Here is how to
try normal completion without any match specification and, if that
generates no matches, try again with case-insensitive matching,
restricting the effect to arguments of the command <strong>foo:</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:*:foo:*:*&#39; tag-order &#39;*&#39; &#39;*:-case&#39;
zstyle &#39;:completion:*-case&#39; matcher &#39;m:{a-z}={A-Z}&#39;
</pre>
</blockquote>
<p>
First, all the tags offered when completing after <strong>foo are tried
using</strong> the normal tag name. If that generates no matches, the second
value of <strong>tag-order is used, which tries all tags again except that
this time</strong> each has <strong>-case appended to its name for lookup of styles.
Hence this</strong> time the value for the <strong>matcher style from the second call
to zstyle</strong> in the example is used to make completion case-insensitive.</p>
<p>
It is possible to use the <strong>-e option of the zstyle builtin</strong> command to
specify conditions for the use of particular tags. For example:</p>
<blockquote>
<pre class="example">
zstyle -e &#39;*:-command-:*&#39; tag-order &#39;
    if [[ -n $PREFIX$SUFFIX ]]; then
      reply=( )
    else
      reply=( - )
    fi&#39;
</pre>
</blockquote>
<p>
Completion in command position will be attempted only if the string
typed so far is not empty. This is tested using the <strong>PREFIX</strong> special
parameter; see zshcompwid for a description of parameters which are
special inside completion widgets. Setting <strong>reply to an empty array
provides the default</strong> behaviour of trying all tags at once; setting it
to an array containing only a hyphen disables the use of all tags and
hence of all completions.</p>
<p>
If no <strong>tag-order style has been defined for a context, the strings</strong>
`*(|*-)argument-* (|*-)option-* values&#39; and `options&#39; plus all* tags
offered by the completion function will be used to provide a sensible
default behavior that causes arguments (whether normal command
arguments or arguments of options) to be completed before option names
for most commands.</p>
</dd>
<dt>
<strong>urls</strong>
</dt>
<dd>
<p>This is used together with the <strong>urls tag by</strong> functions
completing URLs.</p>
<p>
If the value consists of more than one string, or if the only string
does not name a file or directory, the strings are used as the URLs to
complete.</p>
<p>
If the value contains only one string which is the name of a normal
file the URLs are taken from that file (where the URLs may be
separated by white space or newlines).</p>
<p>
Finally, if the only string in the value names a directory, the
directory hierarchy rooted at this directory gives the completions.
The top level directory should be the file access method, such as
`*http&#39;, `ftp&#39;, `bookmark&#39; and so on. In many cases the next* level of
directories will be a filename. The directory hierarchy can descend as
deep as necessary.</p>
<p>
For example,</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; urls ~/.urls
mkdir -p ~/.urls/ftp/ftp.zsh.org/pub
</pre>
</blockquote>
<p>
allows completion of all the components of the URL
<strong><a href="ftp://ftp.zsh.org/pub">ftp://ftp.zsh.org/pub</a> after suitable commands such as</strong> `*netscape&#39; or
`lynx&#39;. Note, however, that access methods and* files are completed
separately, so if the <strong>hosts style is set hosts</strong> can be completed
without reference to the <strong>urls style.</strong></p>
<p>
See the description in the function <strong>_urls itself</strong> for more
information (e.g. `*more $^fpath/_urls(N)&#39;).*</p>
</dd>
<dt>
<strong>use-cache</strong>
</dt>
<dd>If this is set, the completion caching layer is
activated for any completions which use it (via the <strong>_store_cache,
_retrieve_cache, and</strong> <strong>_cache_invalid functions). The directory
containing the cache</strong> files can be changed with the <strong>cache-path
style.</strong></dd>
<dt>
<strong>use-compctl</strong>
</dt>
<dd>If this style is set to a string /not/* equal to
false, 0,* <strong>no, and off, the completion system may use any completion</strong>
specifications defined with the <strong>compctl builtin command. If the</strong>
style is unset, this is done only if the <strong>zsh/compctl module</strong> is
loaded. The string may also contain the substring `*first&#39; to* use
completions defined with `*compctl -T&#39;, and the substring* `*default&#39;
to use the completion defined with `compctl -D&#39;.*

Note that this is only intended to smooth the transition from <strong>compctl
to the new completion system and may disappear in the</strong> future.

Note also that the definitions from <strong>compctl will only be used if</strong>
there is no specific completion function for the command in question.
For example, if there is a function <strong>_foo to complete arguments to
the</strong> command <strong>foo, compctl will never be invoked for foo.</strong> However,
the <strong>compctl version will be tried if foo only uses</strong> default
completion.</dd>
<dt>
<strong>use-ip</strong>
</dt>
<dd>By default, the function <strong>_hosts that completes host names
strips</strong> IP addresses from entries read from host databases such as NIS
and ssh files. If this style is `true&#39;, the corresponding IP addresses
can be completed as well. This style is not use in any context where
the <strong>hosts style is set; note also it must be set before</strong> the cache of
host names is generated (typically the first completion attempt).</dd>
<dt>
<strong>users</strong>
</dt>
<dd>This may be set to a list of usernames to be completed. If
it is not set all usernames will be completed. Note that if it is set
only that list of users will be completed; this is because on some
systems querying all users can take a prohibitive amount of time.</dd>
<dt>
<strong>users-hosts</strong>
</dt>
<dd>The values of this style should be of the form
`/user/*@*/host/*&#39; or `*/user/*:*/host/*&#39;. It is used for* commands
that need pairs of user- and hostnames. These commands will complete
usernames from this style (only), and will restrict subsequent
hostname completion to hosts paired with that user in one of the
values of the style.

It is possible to group values for sets of commands which allow a
remote login, such as <strong>rlogin and ssh, by using the my-accounts tag.</strong>
Similarly, values for sets of commands which usually refer to the
accounts of other people, such as <strong>talk and finger, can be</strong> grouped by
using the <strong>other-accounts tag. More ambivalent commands</strong> may use the
<strong>accounts tag.</strong></dd>
<dt>
<strong>users-hosts-ports</strong>
</dt>
<dd>Like <strong>users-hosts but used for commands like
telnet and</strong> containing strings of the form
`/user/*@*/host/*:*/port/*&#39;.*</dd>
<dt>
<strong>verbose</strong>
</dt>
<dd>If set, as it is by default, the completion listing is
more verbose. In particular many commands show descriptions for
options if this style is `true&#39;.</dd>
<dt>
<strong>word</strong>
</dt>
<dd>This is used by the <strong>_list completer, which prevents the
insertion of</strong> completions until a second completion attempt when the
line has not changed. The normal way of finding out if the line has
changed is to compare its entire contents between the two occasions.
If this style is `true&#39;, the comparison is instead performed only on
the current word. Hence if completion is performed on another word
with the same contents, completion will not be delayed.</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-11" class="outline-2">
<h2 id="headline-11">
CONTROL FUNCTIONS
</h2>
<div id="outline-text-headline-11" class="outline-text-2">
<p>The initialization script <strong>compinit redefines all the widgets</strong> which
perform completion to call the supplied widget function <strong>_main_complete.
This function acts as a wrapper calling the</strong> so-called `completer&#39;
functions that generate matches. If <strong>_main_complete is called with
arguments, these are taken as the</strong> names of completer functions to be
called in the order given. If no arguments are given, the set of
functions to try is taken from the <strong>completer style. For example, to use
normal completion and</strong> correction if that doesn&#39;t generate any matches:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer _complete _correct
</pre>
</blockquote>
<p>
after calling <strong>compinit. The default value for this style is</strong>
`*_complete _ignored&#39;, i.e. normally only ordinary completion is tried,*
first with the effect of the <strong>ignored-patterns style and then without</strong>
it. The <strong>_main_complete function uses the return status of the
completer</strong> functions to decide if other completers should be called. If
the return status is zero, no other completers are tried and the
<strong>_main_complete</strong> function returns.</p>
<p>
If the first argument to <strong>_main_complete is a single hyphen, the</strong>
arguments will not be taken as names of completers. Instead, the second
argument gives a name to use in the /completer/* field of the * context
and the other arguments give a command name and arguments to call to
generate the matches.</p>
<p>
The following completer functions are contained in the distribution,
although users may write their own. Note that in contexts the leading
underscore is stripped, for example basic completion is performed in the
context `*:completion::complete:*/…/*&#39;.*</p>
<p>
<strong>_all_matches</strong> This completer can be used to add a string consisting of
all other matches. As it influences later completers it must appear as
the first completer in the list. The list of all matches is affected by
the <strong>avoid-completer and old-matches styles described above.</strong></p>
<blockquote>
<p>It may be useful to use the <strong>_generic function described below</strong> to bind
<strong>_all_matches to its own keystroke, for example:</strong></p>
<blockquote>
<pre class="example">
zle -C all-matches complete-word _generic
bindkey &#39;^Xa&#39; all-matches
zstyle &#39;:completion:all-matches:*&#39; old-matches only
zstyle &#39;:completion:all-matches::::&#39; completer _all_matches
</pre>
</blockquote>
<p>
Note that this does not generate completions by itself: first use any of
the standard ways of generating a list of completions, then use <strong>^Xa to
show all matches. It is possible instead to</strong> add a standard completer to
the list and request that the list of all matches should be directly
inserted:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:all-matches::::&#39; completer \ 
       _all_matches _complete
zstyle &#39;:completion:all-matches:*&#39; insert true
</pre>
</blockquote>
<p>
In this case the <strong>old-matches style should not be set.</strong></p>
</blockquote>
<dl>
<dt>
<strong>_approximate</strong>
</dt>
<dd>
<p>This is similar to the basic <strong>_complete completer
but allows the</strong> completions to undergo corrections. The maximum number
of errors can be specified by the <strong>max-errors style; see the
description of</strong> approximate matching in /zshexpn/*(1)* for how errors
are counted. Normally this completer will only be tried after the
normal <strong>_complete completer:</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer _complete _approximate
</pre>
</blockquote>
<p>
This will give correcting completion if and only if normal completion
yields no possible completions. When corrected completions are found,
the completer will normally start menu completion allowing you to
cycle through these strings.</p>
<p>
This completer uses the tags <strong>corrections and original when</strong>
generating the possible corrections and the original string. The
<strong>format style for the former may contain the additional sequences</strong>
`*%e&#39; and `%o&#39; which will be replaced by the number of errors*
accepted to generate the corrections and the original string,
respectively.</p>
<p>
The completer progressively increases the number of errors allowed up
to the limit by the <strong>max-errors style, hence if a completion is found</strong>
with one error, no completions with two errors will be shown, and so
on. It modifies the completer name in the context to indicate the
number of errors being tried: on the first try the completer field
contains `*approximate-1&#39;, on the second try `approximate-2&#39;, and so
on.*</p>
<p>
When <strong>_approximate is called from another function, the number of</strong>
errors to accept may be passed with the <strong>-a option. The argument</strong> is
in the same format as the <strong>max-errors style, all in one string.</strong></p>
<p>
Note that this completer (and the <strong>_correct completer mentioned</strong>
below) can be quite expensive to call, especially when a large number
of errors are allowed. One way to avoid this is to set up the
<strong>completer style using the -e option to zstyle so that some</strong>
completers are only used when completion is attempted a second time on
the same string, e.g.:</p>
<blockquote>
<pre class="example">
zstyle -e &#39;:completion:*&#39; completer &#39;
  if [[ $_last_try != &#34;$HISTNO$BUFFER$CURSOR&#34; ]]; then
    _last_try=&#34;$HISTNO$BUFFER$CURSOR&#34;
    reply=(_complete _match _prefix)
  else
    reply=(_ignored _correct _approximate)
  fi&#39;
</pre>
</blockquote>
<p>
This uses the <strong>HISTNO parameter and the BUFFER and CURSOR</strong> special
parameters that are available inside zle and completion widgets to
find out if the command line hasn&#39;t changed since the last time
completion was tried. Only then are the <strong>_ignored,</strong> <strong>_correct and
_approximate completers called.</strong></p>
</dd>
<dt>
?
</dt>
<dd><strong>_canonical_paths [ -A */var/</strong> ] [ -N ] [ -MJV12nfX ] <strong><em>tag</em></strong>
<strong><em>descr</em></strong> [ <strong><em>paths</em></strong> … ]* :: This completion function completes all
paths given to it, and also tries to offer completions which point to
the same file as one of the paths given (relative path when an
absolute path is given, and vice versa; when <strong>..&#39;s</strong> are present in the
word to be completed; and some paths got from symlinks).

<strong>-A, if specified, takes the paths from the array variable specified.
Paths can</strong> also be specified on the command line as shown above. <strong>-N,
if specified,</strong> prevents canonicalizing the paths given before using
them for completion, in case they are already so. The options <strong>-M, -J,
-V, -1, -2,</strong> <strong>-n, -F, -X are passed to compadd.</strong>

See <strong>_description for a description of */tag/</strong> and <strong><em>descr</em></strong>.*</dd>
<dt>
<strong>_cmdambivalent</strong>
</dt>
<dd>Completes the remaining positional arguments as an
external command. The external command and its arguments are completed
as separate arguments (in a manner appropriate for completing
<strong>/usr/bin/env)</strong> if there are two or more remaining positional
arguments on the command line, and as a quoted command string (in the
manner of <strong>system(…)) otherwise.</strong> See also <strong>_cmdstring and
_precommand.</strong>

This function takes no arguments.</dd>
<dt>
<strong>_cmdstring</strong>
</dt>
<dd>Completes an external command as a single argument, as
for <strong>system(…).</strong></dd>
<dt>
<strong>_complete</strong>
</dt>
<dd>This completer generates all possible completions in a
context-sensitive manner, i.e. using the settings defined with the
<strong>compdef function</strong> explained above and the current settings of all
special parameters. This gives the normal completion behaviour.

To complete arguments of commands, <strong>_complete uses the utility
function</strong> <strong>_normal, which is in turn responsible for finding the
particular</strong> function; it is described below. Various contexts of the
form <strong>-*/context/</strong>- are handled specifically. These are all* mentioned
above as possible arguments to the <strong>#compdef tag.</strong>

Before trying to find a function for a specific context, <strong>_complete *
checks if the parameter `*compcontext&#39; is set. Setting</strong> `*compcontext&#39;
allows the usual completion dispatching to be* overridden which is
useful in places such as a function that uses <strong>vared for input. If it
is set to an array, the elements are taken</strong> to be the possible matches
which will be completed using the tag `*values&#39; and the description
`value&#39;. If it is set to an* associative array, the keys are used as
the possible completions and the values (if non-empty) are used as
descriptions for the matches. If `*compcontext&#39; is set to a string
containing colons, it should be of* the form
`/tag/*:*/descr/*:*/action/*&#39;. In this case the* /tag/* and <strong><em>descr</em></strong>
give the tag and description to use and the* /action/* indicates what
should be completed in one of the forms* accepted by the <strong>_arguments
utility function described below.</strong>

Finally, if `*compcontext&#39; is set to a string without colons, the*
value is taken as the name of the context to use and the function
defined for that context will be called. For this purpose, there is a
special context named <strong>-command-line- that completes whole command</strong>
lines (commands and their arguments). This is not used by the
completion system itself but is nonetheless handled when explicitly
called.</dd>
<dt>
<strong>_correct</strong>
</dt>
<dd>
<p>Generate corrections, but not completions, for the
current word; this is similar to <strong>_approximate but will not allow any
number of extra</strong> characters at the cursor as that completer does. The
effect is similar to spell-checking. It is based on <strong>_approximate, but
the</strong> completer field in the context name is <strong>correct.</strong></p>
<p>
For example, with:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:::::&#39; completer \ 
       _complete _correct _approximate
zstyle &#39;:completion:*:correct:::&#39; max-errors 2 not-numeric
zstyle &#39;:completion:*:approximate:::&#39; max-errors 3 numeric
</pre>
</blockquote>
<p>
correction will accept up to two errors. If a numeric argument is
given, correction will not be performed, but correcting completion
will be, and will accept as many errors as given by the numeric
argument. Without a numeric argument, first correction and then
correcting completion will be tried, with the first one accepting two
errors and the second one accepting three errors.</p>
<p>
When <strong>_correct is called as a function, the number of errors to
accept</strong> may be given following the <strong>-a option. The argument is in the
same</strong> form a values to the <strong>accept style, all in one string.</strong></p>
<p>
This completer function is intended to be used without the
<strong>_approximate completer or, as in the example, just before</strong> it. Using
it after the <strong>_approximate completer is useless since</strong> <strong>_approximate
will at least generate the corrected strings</strong> generated by the
<strong>_correct completer – and probably more.</strong></p>
</dd>
<dt>
<strong>_expand</strong>
</dt>
<dd>This completer function does not really perform
completion, but instead checks if the word on the command line is
eligible for expansion and, if it is, gives detailed control over how
this expansion is done. For this to happen, the completion system
needs to be invoked with <strong>complete-word, not expand-or-complete (the
default binding for</strong> <strong>TAB), as otherwise the string will be expanded
by the shell&#39;s</strong> internal mechanism before the completion system is
started. Note also this completer should be called before the
*_complete * completer function.

The tags used when generating expansions are <strong>all-expansions for the</strong>
string containing all possible expansions, <strong>expansions when adding</strong>
the possible expansions as single matches and <strong>original when adding</strong>
the original string from the line. The order in which these strings
are generated, if at all, can be controlled by the <strong>group-order and</strong>
<strong>tag-order styles, as usual.</strong>

The format string for <strong>all-expansions and for expansions may</strong> contain
the sequence `*%o&#39; which will be replaced by the original* string from
the line.

The kind of expansion to be tried is controlled by the <strong>substitute,</strong>
<strong>glob and subst-globs-only styles.</strong>

It is also possible to call <strong>_expand as a function, in which case the</strong>
different modes may be selected with options: <strong>-s for</strong> <strong>substitute, -g
for glob and -o for subst-globs-only.</strong></dd>
<dt>
<strong>_expand_alias</strong>
</dt>
<dd>If the word the cursor is on is an alias, it is
expanded and no other completers are called. The types of aliases
which are to be expanded can be controlled with the styles <strong>regular,
global and disabled.</strong>

This function is also a bindable command, see the section `Bindable
Commands&#39; below.</dd>
<dt>
<strong>_extensions</strong>
</dt>
<dd>If the cursor follows the string `**.&#39;, filename
extensions are* completed. The extensions are taken from files in
current directory or a directory specified at the beginning of the
current word. For exact matches, completion continues to allow other
completers such as <strong>_expand to</strong> expand the pattern. The standard
<strong>add-space and prefix-hidden</strong> styles are observed.</dd>
<dt>
<strong>_external_pwds</strong>
</dt>
<dd>Completes current directories of other zsh
processes belonging to the current user.

This is intended to be used via <strong>_generic, bound to a custom key</strong>
combination. Note that pattern matching is enabled so matching is
performed similar to how it works with the <strong>_match completer.</strong></dd>
<dt>
<strong>_history</strong>
</dt>
<dd>Complete words from the shell&#39;s command history. This
completer can be controlled by the <strong>remove-all-dups, and sort styles
as for the</strong> <strong>_history_complete_word bindable command, see</strong> the section
`Bindable Commands&#39; below and the section `Completion System
Configuration&#39; above.</dd>
<dt>
<strong>_ignored</strong>
</dt>
<dd>The <strong>ignored-patterns style can be set to a list of
patterns which are</strong> compared against possible completions; matching
ones are removed. With this completer those matches can be reinstated,
as if no <strong>ignored-patterns style were set. The completer actually</strong>
generates its own list of matches; which completers are invoked is
determined in the same way as for the <strong>_prefix completer.</strong> The
<strong>single-ignored style is also available as described above.</strong></dd>
<dt>
<strong>_list</strong>
</dt>
<dd>This completer allows the insertion of matches to be
delayed until completion is attempted a second time without the word
on the line being changed. On the first attempt, only the list of
matches will be shown. It is affected by the styles <strong>condition and
word, see</strong> the section `Completion System Configuration&#39; above.</dd>
<dt>
<strong>_match</strong>
</dt>
<dd>This completer is intended to be used after the
<strong>_complete</strong> completer. It behaves similarly but the string on the
command line may be a pattern to match against trial completions. This
gives the effect of the <strong>GLOB_COMPLETE option.</strong>

Normally completion will be performed by taking the pattern from the
line, inserting a `**&#39; at the cursor position and comparing the
resulting* pattern with the possible completions generated. This can
be modified with the <strong>match-original style described above.</strong>

The generated matches will be offered in a menu completion unless the
<strong>insert-unambiguous style is set to `true&#39;; see the description above</strong>
for other options for this style.

Note that matcher specifications defined globally or used by the
completion functions (the styles <strong>matcher-list and matcher) will</strong> not
be used.</dd>
<dt>
<strong>_menu</strong>
</dt>
<dd>This completer was written as simple example function to
show how menu completion can be enabled in shell code. However, it has
the notable effect of disabling menu selection which can be useful
with <strong>_generic based widgets. It should be used as the first completer
in</strong> the list. Note that this is independent of the setting of the
<strong>MENU_COMPLETE option and does not work with the other menu</strong>
completion widgets such as <strong>reverse-menu-complete, or</strong>
<strong>accept-and-menu-complete.</strong></dd>
<dt>
<strong>_oldlist</strong>
</dt>
<dd>This completer controls how the standard completion
widgets behave when there is an existing list of completions which may
have been generated by a special completion (i.e. a separately-bound
completion command). It allows the ordinary completion keys to
continue to use the list of completions thus generated, instead of
producing a new list of ordinary contextual completions. It should
appear in the list of completers before any of the widgets which
generate matches. It uses two styles: <strong>old-list and</strong> <strong>old-menu, see</strong>
the section `Completion System Configuration&#39; above.</dd>
<dt>
<strong>_precommand</strong>
</dt>
<dd>Complete an external command in word-separated
arguments, as for <strong>exec and /usr/bin/env.</strong></dd>
<dt>
<strong>_prefix</strong>
</dt>
<dd>
<p>This completer can be used to try completion with the
suffix (everything after the cursor) ignored. In other words, the
suffix will not be considered to be part of the word to complete. The
effect is similar to the <strong>expand-or-complete-prefix command.</strong></p>
<p>
The <strong>completer style is used to decide which other completers are to</strong>
be called to generate matches. If this style is unset, the list of
completers set for the current context is used – except, of course,
the <strong>_prefix completer itself. Furthermore, if this completer appears</strong>
more than once in the list of completers only those completers not
already tried by the last invocation of <strong>_prefix will be called.</strong></p>
<p>
For example, consider this global <strong>completer style:</strong></p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer \ 
    _complete _prefix _correct _prefix:foo
</pre>
</blockquote>
<p>
Here, the <strong>_prefix completer tries normal completion but ignoring the</strong>
suffix. If that doesn&#39;t generate any matches, and neither does the
call to the *_correct completer after it, _prefix will * be called a
second time and, now only trying correction with the suffix ignored.
On the second invocation the completer part of the context appears as
`*foo&#39;.*</p>
<p>
To use <strong>_prefix as the last resort and try only normal completion</strong>
when it is invoked:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*&#39; completer _complete ... _prefix
zstyle &#39;:completion::prefix:*&#39; completer _complete
</pre>
</blockquote>
<p>
The <strong>add-space style is also respected. If it is set to `true&#39; then</strong>
*_prefix will insert a space between the matches generated (if any) *
and the suffix.</p>
<p>
Note that this completer is only useful if the <strong>COMPLETE_IN_WORD
option is set; otherwise, the cursor will</strong> be moved to the end of the
current word before the completion code is called and hence there will
be no suffix.</p>
</dd>
<dt>
<strong>_user_expand</strong>
</dt>
<dd>
<p>This completer behaves similarly to the <strong>_expand
completer but</strong> instead performs expansions defined by users. The
styles <strong>add-space and</strong> <strong>sort styles specific to the _expand completer
are usable with</strong> <strong>_user_expand in addition to other styles handled
more generally by</strong> the completion system. The tag <strong>all-expansions is
also available.</strong></p>
<p>
The expansion depends on the array style <strong>user-expand being defined</strong>
for the current context; remember that the context for completers is
less specific than that for contextual completion as the full context
has not yet been determined. Elements of the array may have one of the
following forms:</p>
<dl>
<dt>
*$*/hash/
</dt>
<dd>/hash/* is the name of an associative array. Note this
is not a full* parameter expression, merely a <strong>$, suitably quoted to
prevent immediate</strong> expansion, followed by the name of an associative
array. If the trial expansion word matches a key in /hash/*, the
resulting expansion is the* corresponding value.</dd>
<dt>
<em>_func</em>
</dt>
<dd>/_func/* is the name of a shell function whose name must
begin with* <strong>_ but is not otherwise special to the completion
system. The function</strong> is called with the trial word as an argument.
If the word is to be expanded, the function should set the array
<strong>reply to a list of</strong> expansions. Optionally, it can set <strong>REPLY to a
word that will</strong> be used as a description for the set of expansions.
The return status of the function is irrelevant.</dd>
</dl>
</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-12" class="outline-2">
<h2 id="headline-12">
BINDABLE COMMANDS
</h2>
<div id="outline-text-headline-12" class="outline-text-2">
<p>In addition to the context-dependent completions provided, which are
expected to work in an intuitively obvious way, there are a few widgets
implementing special behaviour which can be bound separately to keys.
The following is a list of these and their default bindings.</p>
<p>
<strong>_bash_completions</strong> This function is used by two widgets,
<strong>_bash_complete-word and</strong> <strong>_bash_list-choices. It exists to provide
compatibility with</strong> completion bindings in bash. The last character of
the binding determines what is completed: `*!&#39;, command names; `$&#39;,
environment variables;* `*@&#39;, host names; `/&#39;, file names; `~&#39; user
names. In bash, the* binding preceded by `*\e&#39; gives completion, and
preceded by `^X&#39;* lists options. As some of these bindings clash with
standard zsh bindings, only `*\e~&#39; and `^X~&#39; are bound by default. To
add the* rest, the following should be added to <strong>.zshrc after compinit
has</strong> been run:</p>
<blockquote>
<blockquote>
<pre class="example">
for key in &#39;!&#39; &#39;$&#39; &#39;@&#39; &#39;/&#39; &#39;~&#39;; do
  bindkey &#34;\e$key&#34; _bash_complete-word
  bindkey &#34;^X$key&#34; _bash_list-choices
done
</pre>
</blockquote>
<p>
This includes the bindings for `*~&#39; in case they were already bound to*
something else; the completion code does not override user bindings.</p>
</blockquote>
<dl>
<dt>
<strong>_correct_filename (^XC)</strong>
</dt>
<dd>Correct the filename path at the cursor
position. Allows up to six errors in the name. Can also be called with
an argument to correct a filename path, independently of zle; the
correction is printed on standard output.</dd>
<dt>
<strong>_correct_word (^Xc)</strong>
</dt>
<dd>Performs correction of the current argument
using the usual contextual completions as possible choices. This
stores the string `*correct-word&#39; in the <strong><em>function</em></strong> field of the
context name and* then calls the <strong>_correct completer.</strong></dd>
<dt>
<strong>_expand_alias (^Xa)</strong>
</dt>
<dd>This function can be used as a completer and
as a bindable command. It expands the word the cursor is on if it is
an alias. The types of alias expanded can be controlled with the
styles <strong>regular, global</strong> and <strong>disabled.</strong>

When used as a bindable command there is one additional feature that
can be selected by setting the <strong>complete style to `true&#39;. In this</strong>
case, if the word is not the name of an alias, <strong>_expand_alias tries</strong>
to complete the word to a full alias name without expanding it. It
leaves the cursor directly after the completed word so that invoking
<strong>_expand_alias once more will expand the now-complete alias name.</strong></dd>
<dt>
<strong>_expand_word (^Xe)</strong>
</dt>
<dd>Performs expansion on the current word:
equivalent to the standard <strong>expand-word command, but using the _expand
completer. Before</strong> calling it, the /function/* field of the context is
set to* `*expand-word&#39;.*</dd>
<dt>
<strong>_generic</strong>
</dt>
<dd>
<p>This function is not defined as a widget and not bound
by default. However, it can be used to define a widget and will then
store the name of the widget in the /function/* field of the context *
and call the completion system. This allows custom completion widgets
with their own set of style settings to be defined easily. For
example, to define a widget that performs normal completion and starts
menu selection:</p>
<blockquote>
<pre class="example">
zle -C foo complete-word _generic
bindkey &#39;...&#39; foo
zstyle &#39;:completion:foo:*&#39; menu yes select=1
</pre>
</blockquote>
<p>
Note in particular that the <strong>completer style may be set for the
context</strong> in order to change the set of functions used to generate
possible matches. If <strong>_generic is called with arguments, those are
passed through to</strong> <strong>_main_complete as the list of completers in place
of those defined by</strong> the <strong>completer style.</strong></p>
</dd>
<dt>
<strong>_history_complete_word (\e/)</strong>
</dt>
<dd>Complete words from the shell&#39;s
command history. This uses the <strong>list, remove-all-dups, sort, and stop
styles.</strong></dd>
<dt>
<strong>_most_recent_file (^Xm)</strong>
</dt>
<dd>Complete the name of the most recently
modified file matching the pattern on the command line (which may be
blank). If given a numeric argument /N/*, complete the <strong>/N/*th most
recently modified file. Note the</strong> completion, if any, is always
unique.</dd>
<dt>
<strong>_next_tags (^Xn)</strong>
</dt>
<dd>This command alters the set of matches used to
that for the next tag, or set of tags, either as given by the
<strong>tag-order style or as set by</strong> default; these matches would otherwise
not be available. Successive invocations of the command cycle through
all possible sets of tags.</dd>
<dt>
<strong>_read_comp (^X^R)</strong>
</dt>
<dd>Prompt the user for a string, and use that to
perform completion on the current word. There are two possibilities
for the string. First, it can be a set of words beginning `*_&#39;, for
example `_files -/&#39;, in which* case the function with any arguments
will be called to generate the completions. Unambiguous parts of the
function name will be completed automatically (normal completion is
not available at this point) until a space is typed.

Second, any other string will be passed as a set of arguments to
<strong>compadd and should hence be an expression specifying what should</strong> be
completed.

A very restricted set of editing commands is available when reading
the string: `*DEL&#39; and `^H&#39; delete the last character; `^U&#39; deletes*
the line, and `*^C&#39; and `^G&#39; abort the function, while `RET&#39;* accepts
the completion. Note the string is used verbatim as a command line, so
arguments must be quoted in accordance with standard shell rules.

Once a string has been read, the next call to <strong>_read_comp will use
the</strong> existing string instead of reading a new one. To force a new
string to be read, call <strong>_read_comp with a numeric argument.</strong></dd>
<dt>
<strong>_complete_debug (^X?)</strong>
</dt>
<dd>This widget performs ordinary completion,
but captures in a temporary file a trace of the shell commands
executed by the completion system. Each completion attempt gets its
own file. A command to view each of these files is pushed onto the
editor buffer stack.</dd>
<dt>
<strong>_complete_help (^Xh)</strong>
</dt>
<dd>This widget displays information about the
context names, the tags, and the completion functions used when
completing at the current cursor position. If given a numeric argument
other than <strong>1 (as in `ESC-2 ^Xh&#39;), then the styles</strong> used and the
contexts for which they are used will be shown, too.

Note that the information about styles may be incomplete; it depends
on the information available from the completion functions called,
which in turn is determined by the user&#39;s own styles and other
settings.</dd>
<dt>
<strong>_complete_help_generic</strong>
</dt>
<dd>
<p>Unlike other commands listed here, this
must be created as a normal ZLE widget rather than a completion widget
(i.e. with <strong>zle -N). It</strong> is used for generating help with a widget
bound to the <strong>_generic</strong> widget that is described above.</p>
<p>
If this widget is created using the name of the function, as it is by
default, then when executed it will read a key sequence. This is
expected to be bound to a call to a completion function that uses the
<strong>_generic</strong> widget. That widget will be executed, and information
provided in the same format that the <strong>_complete_help widget displays
for</strong> contextual completion.</p>
<p>
If the widget&#39;s name contains <strong>debug, for example if it is created</strong> as
`*zle -N _complete_debug_generic _complete_help_generic&#39;, it* will
read and execute the keystring for a generic widget as before, but
then generate debugging information as done by <strong>_complete_debug</strong> for
contextual completion.</p>
<p>
If the widget&#39;s name contains <strong>noread, it will not read a keystring</strong>
but instead arrange that the next use of a generic widget run in the
same shell will have the effect as described above.</p>
<p>
The widget works by setting the shell parameter
<strong>ZSH_TRACE_GENERIC_WIDGET which is read by _generic. Unsetting</strong> the
parameter cancels any pending effect of the <strong>noread form.</strong></p>
<p>
For example, after executing the following:</p>
<blockquote>
<pre class="example">
zle -N _complete_debug_generic _complete_help_generic
bindkey &#39;^x:&#39; _complete_debug_generic
</pre>
</blockquote>
<p>
typing `*C-x :&#39; followed by the key sequence for a generic widget*
will cause trace output for that widget to be saved to a file.</p>
</dd>
<dt>
<strong>_complete_tag (^Xt)</strong>
</dt>
<dd>This widget completes symbol tags created by
the <strong>etags or ctags</strong> programmes (note there is no connection with the
completion system&#39;s tags) stored in a file <strong>TAGS, in the format used
by etags, or tags, in the</strong> format created by <strong>ctags. It will look back
up the path hierarchy for</strong> the first occurrence of either file; if
both exist, the file <strong>TAGS is</strong> preferred. You can specify the full
path to a <strong>TAGS or tags file by</strong> setting the parameter <strong>$TAGSFILE or
$tagsfile respectively.</strong> The corresponding completion tags used are
<strong>etags and vtags, after</strong> emacs and vi respectively.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-13" class="outline-2">
<h2 id="headline-13">
UTILITY FUNCTIONS
</h2>
<div id="outline-text-headline-13" class="outline-text-2">
<p>Descriptions follow for utility functions that may be useful when
writing completion functions. If functions are installed in
subdirectories, most of these reside in the *Base subdirectory. Like the
example * functions for commands in the distribution, the utility
functions generating matches all follow the convention of returning
status zero if they generated completions and non-zero if no matching
completions could be added.</p>
<p>
<strong>_absolute_command_paths</strong> This function completes external commands as
absolute paths (unlike <strong>_command_names -e which completes their
basenames). It takes no</strong> arguments.</p>
<ul>
<li>
<p><strong>_all_labels [ -x ] [ -12VJ ] */tag/</strong> <strong><em>name</em></strong> <strong><em>descr</em></strong> [ <strong><em>command</em></strong>
<strong><em>arg</em></strong> … ]* :: This is a convenient interface to the <strong>_next_label
function below,</strong> implementing the loop shown in the <strong>_next_label
example. The</strong> /command/* and its arguments are called to generate the
matches. The* options stored in the parameter /name/* will
automatically be inserted* into the /arg/*s passed to the <strong><em>command</em></strong>.
Normally, they are put* directly after the /command/*, but if one of
the <strong>/arg/*s is a single</strong> hyphen, they are inserted directly before
that. If the hyphen is the last argument, it will be removed from the
argument list before the /command/* is called. This allows _all_labels
to be used in almost all* cases where the matches can be generated by
a single call to the <strong>compadd builtin command or by a call to one of
the utility functions.</strong></p>
<p>
For example:</p>
<blockquote>
<pre class="example">
local expl
...
if _requested foo; then
  ...
  _all_labels foo expl &#39;...&#39; compadd ... - $matches
fi
</pre>
</blockquote>
<p>
Will complete the strings from the <strong>matches parameter, using</strong> <strong>compadd
with additional options which will take precedence over</strong> those
generated by <strong>_all_labels.</strong></p>
</li>
<li>
<p><strong>_alternative [ -O */name/</strong> ] [ -C <strong><em>name</em></strong> ] <strong><em>spec</em></strong> …* :: This
function is useful in simple cases where multiple tags are available.
Essentially it implements a loop like the one described for the
<strong>_tags</strong> function below.</p>
<p>
The tags to use and the action to perform if a tag is requested are
described using the /spec/*s which are of the form:*
`/tag/*:*/descr/*:*/action/*&#39;. The <strong>/tag/*s are offered using</strong> <strong>_tags
and if the tag is requested, the */action/</strong> is executed with the*
given description /descr/*. The <strong>/action/*s are those accepted</strong> by the
<strong>_arguments function (described below), with the following</strong>
exceptions:</p>
<p>
· The `*-&gt;*/state/*&#39; and `=*/…/*&#39; forms are not supported.*</p>
<dl>
<dt>
·
</dt>
<dd>The `*((a\:bar b\:baz))&#39; form does not need* the colon to be
escaped, since the /spec/*s have no colon-separated fields* after
the /action/*.*</dd>
</dl>
<p>For example, the /action/* may be a simple function call:*</p>
<blockquote>
<pre class="example">
_alternative \ 
    &#39;users:user:_users&#39; \ 
    &#39;hosts:host:_hosts&#39;
</pre>
</blockquote>
<p>
offers usernames and hostnames as possible matches, generated by the
<strong>_users and _hosts functions respectively.</strong></p>
<p>
Like *_arguments, this function uses _all_labels to execute * the
actions, which will loop over all sets of tags. Special handling is
only required if there is an additional valid tag, for example inside
a function called from <strong>_alternative.</strong></p>
<p>
The option `*-O <strong><em>name</em></strong>&#39; is used in the same way as by the*
<strong>_arguments function. In other words, the elements of the */name/
array will be passed to *compadd when executing an action.</strong></p>
<p>
Like <strong>_tags this function supports the -C option to give a</strong> different
name for the argument context field.</p>
</li>
</ul>
<p><strong>_arguments [ -nswWCRS ] [ -A */pat/</strong> ] [ -O <strong><em>name</em></strong> ] [ -M
<strong><em>matchspec</em></strong> ]*</p>
</div>
</div>
<div id="outline-container-headline-14" class="outline-2">
<h2 id="headline-14">
[ : ] <strong><em>spec</em></strong> …*
</h2>
<div id="outline-text-headline-14" class="outline-text-2">
<p>
<strong>_arguments [ */opt/</strong> … ] – [ -l ] [ -i <strong><em>pats</em></strong> ] [ -s <strong><em>pair</em></strong> ]*</p>
</div>
</div>
<div id="outline-container-headline-15" class="outline-2">
<h2 id="headline-15">
[ <strong><em>helpspec</em></strong> …]* This function can be used to give a complete
</h2>
<div id="outline-text-headline-15" class="outline-text-2">
<p>specification for completion for a command whose arguments follow
standard UNIX option and argument conventions.</p>
<blockquote>
<p><em>Options Overview</em></p>
<p>
Options to <strong>_arguments itself must be in separate words, i.e. -s -w,</strong>
not <strong>-sw. The options are followed by */spec/*s that describe options
and</strong> arguments of the analyzed command. To avoid ambiguity, all options
to <strong>_arguments itself may be separated from the */spec/</strong> forms* by a
single colon.</p>
<p>
The `*–&#39;* form is used to intuit /spec/* forms from the help output of
the command* being analyzed, and is described in detail below. The
/opts/* for the* `*–&#39; form are otherwise the same options as the first
form. Note* that `*-s&#39; following `–&#39; has a distinct meaning from `-s&#39;*
preceding `*–&#39;, and both may appear.*</p>
<p>
The option switches <strong>-s, -S, -A, -w, and -W affect how</strong> <strong>_arguments
parses the analyzed command line&#39;s options. These switches are</strong> useful
for commands with standard argument parsing.</p>
<p>
The options of <strong>_arguments have the following meanings:</strong></p>
<p>
<strong>-n</strong> With this option, <strong>_arguments sets the parameter NORMARG</strong> to the
position of the first normal argument in the <strong>$words array,</strong> i.e. the
position after the end of the options. If that argument has not been
reached, <strong>NORMARG is set to -1. The caller</strong> should declare `*integer
NORMARG&#39; if the -n option is passed;* otherwise the parameter is not
used.</p>
<dl>
<dt>
<strong>-s</strong>
</dt>
<dd>Enable /option stacking/* for single-letter options, whereby
multiple* single-letter options may be combined into a single word.
For example, the two options `*-x&#39; and `-y&#39; may be combined into* a
single word `*-xy&#39;. By default, every word corresponds to a single*
option name (`*-xy&#39; is a single option named `xy&#39;).*

Options beginning with a single hyphen or plus sign are eligible for
stacking; words beginning with two hyphens are not.

Note that <strong>-s after – has a different meaning, which is documented</strong>
in the segment entitled `Deriving /spec/* forms from the help
output&#39;.*</dd>
<dt>
<strong>-w</strong>
</dt>
<dd>In combination with <strong>-s, allow option stacking</strong> even if one or
more of the options take arguments. For example, if <strong>-x takes an
argument, with no</strong> <strong>-s, `-xy&#39; is considered as a single (unhandled)
option; with</strong> <strong>-s, -xy is an option with the argument `y&#39;; with both
-s</strong> and <strong>-w, -xy is the option -x and the option -y with</strong> arguments to
<strong>-x (and to -y, if it takes arguments) still to come</strong> in subsequent
words.</dd>
<dt>
<strong>-W</strong>
</dt>
<dd>This option takes <strong>-w a stage further: it is possible to</strong>
complete single-letter options even after an argument that occurs in
the same word. However, it depends on the action performed whether
options will really be completed at this point. For more control, use
a utility function like <strong>_guard as part of the action.</strong></dd>
<dt>
<strong>-C</strong>
</dt>
<dd>Modify the <strong>curcontext parameter for an action of the form
`-&gt;*/state/</strong>&#39;.* This is discussed in detail below.</dd>
<dt>
<strong>-R</strong>
</dt>
<dd>Return status 300 instead of zero when a <strong>$state is to</strong> be
handled, in the `*-&gt;*/string/*&#39; syntax.*</dd>
<dt>
<strong>-S</strong>
</dt>
<dd>
<p>Do not complete options after a `*–&#39; appearing on the line,*
and ignore the `*–&#39;. For example, with -S, in the line*</p>
<blockquote>
<pre class="example">
foobar -x -- -y
</pre>
</blockquote>
<p>
the `*-x&#39; is considered an option, the `-y&#39; is considered an*
argument, and the `*–&#39; is considered to be neither.*</p>
</dd>
<dt>
*-A */pat/
</dt>
<dd>Do not complete options after the first non-option
argument on the line. /pat/* is a pattern matching* all strings which
are not to be taken as arguments. For example, to make <strong>_arguments
stop completing options after the first normal argument, but</strong> ignoring
all strings starting with a hyphen even if they are not described by
one of the /optspec/*s, the form is `-A &#34;-<strong>&#34;&#39;.</strong></dd>
<dt>
*-O */name/
</dt>
<dd>Pass the elements of the array /name/* as arguments to
functions called to* execute /action/*s.* This is discussed in detail
below.</dd>
<dt>
*-M */matchspec/
</dt>
<dd>
<p>Use the match specification /matchspec/* for
completing option names and values.* The default /matchspec/* allows
partial word completion after `_&#39; and* `*-&#39;, such as completing `-f-b&#39;
to `-foo-bar&#39;. The default* /matchspec/* is:*</p>
<pre class="example">
r:|[_-]=* r:|=*
</pre>
</dd>
<dt>
<strong>-0</strong>
</dt>
<dd>When populating values of the `*opt_args&#39; associative array,
don&#39;t* backslash-escape colons and backslashes and use NUL rather than
colon for joining multiple values. This option is described in more
detail below, under the heading <em>specs: actions.</em></dd>
</dl>
<p><em>specs: overview</em></p>
<p>
Each of the following forms is a <em>spec describing individual sets of</em>
options or arguments on the command line being analyzed.</p>
<p>
<em>n/*:*/message/*:*/action</em></p>
<p>
<em>n/*::*/message/*:*/action</em> This describes the /n&#39;th normal argument.
The message will be / printed above the matches generated and the
<em>action indicates what can</em> be completed in this position (see below).
If there are two colons before the <em>message the argument is optional. If
the</em> <em>message contains only white space, nothing will be printed above</em>
the matches unless the action adds an explanation string itself.</p>
<p>
<strong>:*/message/</strong>:*/action/</p>
<p>
<strong>::*/message/</strong>:*/action/ Similar, but describes the <em>next argument,
whatever number that</em> happens to be. If all arguments are specified in
this form in the correct order the numbers are unnecessary.</p>
<p>
<strong>*:*/message/</strong>:*/action/</p>
<p>
<strong>*::*/message/</strong>:*/action/</p>
<p>
<strong>*:::*/message/</strong>:*/action/ This describes how arguments (usually
non-option arguments, those not beginning with *-*/ or <em><strong>+</strong></em>) are to be
completed when neither/ of the first two forms was provided. Any number
of arguments can be completed in this fashion.</p>
<blockquote>
<p>With two colons before the <em>message, the /*words*</em> special array and/
the *CURRENT*/ special parameter are modified to refer only to the/
normal arguments when the <em>action is executed or evaluated. With</em> three
colons before the <em>message they are modified to refer only to</em> the
normal arguments covered by this description.</p>
</blockquote>
<p>
<em>optspec</em></p>
<p>
<em>optspec/*:*</em>…/ This describes an option. The colon indicates handling
for one or more arguments to the option; if it is not present, the
option is assumed to take no arguments.</p>
<blockquote>
<p>The following forms are available for the initial <em>optspec, whether</em> or
not the option has arguments.</p>
<p>
***/optspec/ Here <em>optspec is one of the remaining forms below. This
indicates</em> the following <em>optspec may be repeated. Otherwise if the</em>
corresponding option is already present on the command line to the left
of the cursor it will not be offered again.</p>
<p>
*-*/optname/</p>
<p>
<strong>+*/optname/ In the simplest form the <em>optspec is just the option name
beginning</em> with a minus or a plus sign, such as `</strong>-foo*/&#39;. The first
argument for/ the option (if any) must follow as a <em>separate word
directly after the</em> option.</p>
<blockquote>
<p>Either of `*-<del><strong><em>optname&#39; and `</em></strong></del>-*/optname&#39; can be used to/ specify
that *-*/optname and <em>*+*/optname are both valid.</em></p>
<p>
In all the remaining forms, the leading `*-*/&#39; may be replaced by or/
paired with `*+*/&#39; in this way./</p>
</blockquote>
<dl>
<dt>
<strong>-*/optname/</strong>-*
</dt>
<dd>The first argument of the option must come directly
after the option name <em>in the same word. For example, `/*-foo-:*</em>…&#39;
specifies that/ the completed option and argument will look like
`*-foo*/arg&#39;./</dd>
<dt>
<strong>-*/optname/*+</strong>
</dt>
<dd>The first argument may appear immediately after
<em>optname in the same</em> word, or may appear as a separate word after the
option. For example, `*-foo+:*/…&#39; specifies that the completed
option and argument/ will look like either `*-foo*/arg&#39; or `/*-foo*/
arg&#39;./</dd>
<dt>
<strong>-*/optname/*=</strong>
</dt>
<dd>The argument may appear as the next word, or in
same word as the option name provided that it is separated from it by
an equals sign, for example `*-foo=*/arg&#39; or `/*-foo*/ arg&#39;./</dd>
<dt>
<strong>-*/optname/*=-</strong>
</dt>
<dd>The argument to the option must appear after an
equals sign in the same word, and may not be given in the next
argument.</dd>
<dt>
/optspec/*[*/explanation/*]*
</dt>
<dd>An explanation string may be appended
to any of the preceding forms of <em>optspec by enclosing it in brackets,
as in `/*-q[query operation]*</em>&#39;./

The *verbose*/ style is used to decide whether the explanation
strings/ are displayed with the option in a completion listing.

If no bracketed explanation string is given but the <strong>auto-description</strong>
style is set and only one argument is described for this <em>optspec,
the</em> value of the style is displayed, with any appearance of the
sequence `*%d*/&#39; in it replaced by the message of the first optarg/
that follows the <em>optspec; see below.</em></dd>
</dl>
<p>It is possible for options with a literal `*+*/&#39; or `/*=*/&#39; to/ appear,
but that character must be quoted, for example `*-\+*/&#39;./</p>
<p>
Each <em>optarg following an optspec must take one of the</em> following forms:</p>
<p>
<strong>:*/message/</strong>:*/action/</p>
<p>
<strong>::*/message/</strong>:*/action/ An argument to the option; <em>message and action
are treated as</em> for ordinary arguments. In the first form, the argument
is mandatory, and in the second form it is optional.</p>
<blockquote>
<p>This group may be repeated for options which take multiple arguments. In
other words, <strong>:*/message1/</strong>:*/action1/*:*/message2/*:*/action2/
specifies that the option takes two arguments.</p>
</blockquote>
<p>
<strong>:**/pattern/</strong>:*/message/*:*/action/</p>
<p>
<strong>:**/pattern/</strong>::*/message/*:*/action/</p>
<p>
<strong>:**/pattern/</strong>:::*/message/*:*/action/ This describes multiple
arguments. Only the last <em>optarg for</em> an option taking multiple
arguments may be given in this form. If the <em>pattern is empty (i.e.
/*:*:*</em>), all/ the remaining words on the line are to be completed as
described by the <em>action; otherwise, all the words up to and including a
word matching</em> the <em>pattern are to be completed using the action.</em></p>
<blockquote>
<p>Multiple colons are treated as for the `**:*/…&#39; forms for/ ordinary
arguments: when the <em>message is preceded by two colons,</em> the *words*/
special array and the <em><strong>CURRENT</strong></em> special parameter are/ modified during
the execution or evaluation of the <em>action to refer</em> only to the words
after the option. When preceded by three colons, they are modified to
refer only to the words covered by this description.</p>
</blockquote>
</blockquote>
<p>
Any literal colon in an <em>optname, message, or action</em> must be preceded
by a backslash, `*\:*/&#39;./</p>
<p>
Each of the forms above may be preceded by a list in parentheses of
option names and argument numbers. If the given option is on the command
line, the options and arguments indicated in parentheses will not be
offered. For example, `*(-two -three 1)-one:*/…&#39; completes the option
`/*-one*/&#39;; if this/ appears on the command line, the options <strong>-two*/
and /</strong>-three*/ and the/ first ordinary argument will not be completed
after it. `*(-foo):*/…&#39; specifies an ordinary argument completion;/
*-foo*/ will not be completed if that argument is already present./</p>
<p>
Other items may appear in the list of excluded options to indicate
various other items that should not be applied when the current
specification is matched: a single star (<strong><strong>*/) for the rest arguments/
(i.e. a specification of the form `</strong></strong>:*/…&#39;); a colon (<em><strong>:</strong></em>)/ for all
normal (non-option-) arguments; and a hyphen (<strong>-*/) for all/ options.
For example, if `*(</strong>)*/&#39; appears before an option and the/ option
appears on the command line, the list of remaining arguments (those
shown in the above table beginning with `**:*/&#39;) will not be/ completed.</p>
<p>
To aid in reuse of specifications, it is possible to precede any of the
forms above with `*!*/&#39;; then the form will no longer be completed,/
although if the option or argument appears on the command line they will
be skipped as normal. The main use for this is when the arguments are
given by an array, and *_arguments*/ is called repeatedly for more/
specific contexts: on the first call `*_arguments $global_options*/&#39; is/
used, and on subsequent calls `*_arguments !$^global_options*/&#39;./</p>
<p>
<em>specs: actions</em></p>
<p>
In each of the forms above the <em>action determines how</em> completions
should be generated. Except for the `*-&gt;*/string&#39;/ form below, the
<em>action will be executed by calling the</em> *_all_labels*/ function to
process all tag labels. No special handling/ of tags is needed unless a
function call introduces a new one.</p>
<p>
The functions called to execute <em>actions will be called with the</em>
elements of the array named by the `*-O*/ name&#39; option as arguments./
This can be used, for example, to pass the same set of options for the
*compadd*/ builtin to all actions./</p>
<p>
The forms for <em>action are as follows.</em></p>
<div id="outline-container-headline-16" class="outline-2">
<h2 id="headline-16">
*/(single unquoted space)/ This is useful where an argument is
</h2>
<div id="outline-text-headline-16" class="outline-text-2">
<p>required but it is not possible or desirable to generate matches for it.
The <em>message will be displayed but no completions listed. Note</em> that
even in this case the colon at the end of the <em>message is</em> needed; it
may only be omitted when neither a <em>message</em> nor an <em>action is given.</em></p>
<dl>
<dt>
<strong>(*/item1 item2 …/</strong>)*
</dt>
<dd>
<p>One of a list of possible matches, for
example:</p>
<blockquote>
<pre class="example">
:foo:(foo bar baz)
</pre>
</blockquote>
</dd>
<dt>
<strong>((*/item1/</strong>\:*/desc1/* <strong><em>…</em></strong>))*
</dt>
<dd>
<p>Similar to the above, but with
descriptions for each possible match. Note the backslash before the
colon. For example,</p>
<blockquote>
<pre class="example">
:foo:((a\:bar b\:baz))
</pre>
</blockquote>
<p>
The matches will be listed together with their descriptions if the
<strong>description style is set with the values tag in the context.</strong></p>
</dd>
<dt>
*-&gt;*/string/
</dt>
<dd>
<p>In this form, <strong>_arguments processes the arguments and
options and then</strong> returns control to the calling function with
parameters set to indicate the state of processing; the calling
function then makes its own arrangements for generating completions.
For example, functions that implement a state machine can use this
type of action.</p>
<p>
Where <strong>_arguments encounters */action/</strong> in the `-&gt;*/string/*&#39;* format,
it will strip all leading and trailing whitespace from <em>string</em> and
set the array <strong>state to the set of all */string/*s for which an</strong>
action is to be performed. The elements of the array <strong>state_descr are</strong>
assigned the corresponding <em>message/* field from each */optarg</em>
containing such an /action/*.*</p>
<p>
By default and in common with all other well behaved completion
functions, _arguments returns status zero if it was able to add
matches and non-zero otherwise. However, if the <strong>-R option is given,</strong>
<strong>_arguments will instead return a status of 300 to indicate that</strong>
<strong>$state is to be handled.</strong></p>
<p>
In addition to <strong>$state and $state_descr, _arguments also</strong> sets the
global parameters `*context&#39;, `line&#39; and `opt_args&#39; as described*
below, and does not reset any changes made to the special parameters
such as <strong>PREFIX and words. This gives the calling function the</strong> choice
of resetting these parameters or propagating changes in them.</p>
<p>
A function calling <strong>_arguments with at least</strong> one action containing a
`*-&gt;*/string/*&#39; must therefore declare* appropriate local parameters:</p>
<blockquote>
<pre class="example">
local context state state_descr line
typeset -A opt_args
</pre>
</blockquote>
<p>
to prevent <strong>_arguments from altering the global environment.</strong></p>
</dd>
<dt>
<strong>{*/eval-string/</strong>}*
</dt>
<dd>A string in braces is evaluated as shell code
to generate matches. If the /eval-string/* itself does not begin with
an opening parenthesis or* brace it is split into separate words
before execution.</dd>
<dt>
*= */action/
</dt>
<dd>If the /action/* starts with `= &#39; (an equals sign
followed by a* space), *_arguments will insert the contents of the
*/argument/ field of the current context as the new first element in
the <strong>words * special array and increment the value of the *CURRENT
special</strong> parameter. This has the effect of inserting a dummy word onto
the completion command line while not changing the point at which
completion is taking place.

This is most useful with one of the specifiers that restrict the words
on the command line on which the /action/* is to operate (the two-
and* three-colon forms above). One particular use is when an /action/*
itself* causes <strong>_arguments on a restricted range; it is necessary to
use this</strong> trick to insert an appropriate command name into the range
for the second call to <strong>_arguments to be able to parse the line.</strong></dd>
</dl>
</div>
</div>
<div id="outline-container-headline-17" class="outline-2">
<h2 id="headline-17">
*/word…/
</h2>
<div id="outline-text-headline-17" class="outline-text-2">
<p>
<em>word…</em> This covers all forms other than those above. If the <em>action</em>
starts with a space, the remaining list of words will be invoked
unchanged.</p>
<blockquote>
<p>Otherwise it will be invoked with some extra strings placed after the
first word; these are to be passed down as options to the <strong>compadd</strong>
builtin. They ensure that the state specified by <strong>_arguments, in</strong>
particular the descriptions of options and arguments, is correctly
passed to the completion command. These additional arguments are taken
from the array parameter `*expl&#39;; this will be set up* before executing
the /action/* and hence may be referred to inside it,* typically in an
expansion of the form `*$expl[@]&#39; which preserves empty* elements of the
array.</p>
</blockquote>
<p>
During the performance of the action the array `*line&#39; will be set to*
the normal arguments from the command line, i.e. the words from the
command line after the command name excluding all options and their
arguments. Options are stored in the associative array `*opt_args&#39; with
option names as keys and their arguments as* the values. By default, all
colons and backslashes in the value are escaped with backslashes, and if
an option has multiple arguments (for example, when using an /optspec/*
of the form `**/optspec/*&#39;), they are joined with* (unescaped) colons.
However, if the <strong>-0 option was passed, no backslash</strong> escaping is
performed, and multiple values are joined with NUL bytes. For example,
after `*zsh -o foo:foo -o bar:bar -o &lt;TAB&gt;&#39;, the contents of*
`*opt_args&#39; would be*</p>
<blockquote>
<pre class="example">
typeset -A opt_args=( [-o]=&#39;foo\:foo:bar\:bar:&#39; )
</pre>
</blockquote>
<p>
by default, and</p>
<blockquote>
<pre class="example">
typeset -A opt_args=( [-o]=$&#39;foo:foo\x00bar:bar\x00&#39; )
</pre>
</blockquote>
<p>
if <strong>_arguments had been called with the -0 option.</strong></p>
<p>
The parameter `*context&#39; is set when returning to the calling function*
to perform an action of the form `*-&gt;*/string/*&#39;. It is set to an* array
of elements corresponding to the elements of <strong>$state. Each</strong> element is a
suitable name for the argument field of the context: either a string of
the form `*option*/-opt/*-<strong><em>n</em></strong>&#39; for the <strong><em>n</em></strong>&#39;th* argument of the
option /-opt/*, or a string of the form* `*argument-<strong><em>n</em></strong>&#39; for the
<strong><em>n</em></strong>&#39;th argument. For `rest&#39; arguments,* that is those in the list at
the end not handled by position, /n/* is the* string `*rest&#39;. For
example, when completing the argument of the -o* option, the name is
`*option-o-1&#39;, while for the second normal* (non-option-) argument it is
`*argument-2&#39;.*</p>
<p>
Furthermore, during the evaluation of the /action/* the context name in*
the <strong>curcontext parameter is altered to append the same string that is</strong>
stored in the <strong>context parameter.</strong></p>
<p>
The option <strong>-C tells _arguments to modify the curcontext</strong> parameter for
an action of the form `*-&gt;*/state/*&#39;. This is the* standard parameter
used to keep track of the current context. Here it (and not the <strong>context
array) should be made local to the calling</strong> function to avoid passing
back the modified value and should be initialised to the current value
at the start of the function:</p>
<blockquote>
<pre class="example">
local curcontext=&#34;$curcontext&#34;
</pre>
</blockquote>
<p>
This is useful where it is not possible for multiple states to be valid
together.</p>
<p>
<em>Grouping Options</em></p>
<p>
Options can be grouped to simplify exclusion lists. A group is
introduced with `*+&#39; followed by a name for the group in the* subsequent
word. Whole groups can then be referenced in an exclusion list or a
group name can be used to disambiguate between two forms of the same
option. For example:</p>
<blockquote>
<pre class="example">
_arguments \ 
    &#39;(group2--x)-a&#39; \ 
  + group1 \ 
    -m \ 
    &#39;(group2)-n&#39; \ 
  + group2 \ 
    -x -y
</pre>
</blockquote>
<p>
If the name of a group is specified in the form `*(<strong><em>name</em></strong>)&#39; then only
one value from that group* will ever be completed; more formally, all
specifications are mutually exclusive to all other specifications in
that group. This is useful for defining options that are aliases for
each other. For example:</p>
<blockquote>
<pre class="example">
_arguments \ 
    -a -b \ 
  + &#39;(operation)&#39; \ 
    {-c,--compress}&#39;[compress]&#39; \ 
    {-d,--decompress}&#39;[decompress]&#39; \ 
    {-l,--list}&#39;[list]&#39;
</pre>
</blockquote>
<p>
If an option in a group appears on the command line, it is stored in the
associative array `*opt_args&#39; with &#39;<strong><em>group</em></strong>-<strong><em>option</em></strong>&#39;* as a key. In
the example above, a key `*operation–c&#39; is used if the option* `*-c&#39; is
present on the command line.*</p>
<p>
<em>Specifying Multiple Sets of Arguments</em></p>
<p>
It is possible to specify multiple sets of options and arguments with
the sets separated by single hyphens. This differs from groups in that
sets are considered to be mutually exclusive of each other.</p>
<p>
Specifications before the first set and from any group are common to all
sets. For example:</p>
<blockquote>
<pre class="example">
_arguments \ 
    -a \ 
  - set1 \ 
    -c \ 
  - set2 \ 
    -d \ 
    &#39;:arg:(x2 y2)&#39;
</pre>
</blockquote>
<p>
This defines two sets. When the command line contains the option `*-c&#39;,
the `-d&#39; option and the argument will not be considered* possible
completions. When it contains `*-d&#39; or an argument, the* option `*-c&#39;
will not be considered. However, after `-a&#39;* both sets will still be
considered valid.</p>
<p>
As for groups, the name of a set may appear in exclusion lists, either
alone or preceding a normal option or argument specification.</p>
<p>
The completion code has to parse the command line separately for each
set. This can be slow so sets should only be used when necessary. A
useful alternative is often an option specification with rest-arguments
(as in `*-foo:*:…&#39;); here the option -foo swallows up all* remaining
arguments as described by the /optarg/* definitions.*</p>
<p>
<em>Deriving spec forms from the help output</em></p>
<p>
The option `*–<strong><em>&#39; allows /*_arguments*</em> to work out the names of long/
options that support the `</strong>–help*/&#39; option which is standard in many/
GNU commands. The command word is called with the argument `*–help*/&#39;
and the output examined for option names. Clearly, it can/ be dangerous
to pass this to commands which may not support this option as the
behaviour of the command is unspecified.</p>
<p>
In addition to options, `*_arguments –<strong><em>&#39; will try to deduce the</em> types
of arguments available for options when the form `</strong>–*/opt/*=*/val&#39; is
valid. It is also possible to provide/ hints by examining the help text
of the command and adding <em>helpspec of</em> the form
`/pattern/*:*/message/*:*/action&#39;; note that other/ *_arguments*/ spec
forms are not used. The pattern is matched/ against the help text for an
option, and if it matches the <em>message and</em> <em>action are used as for
other argument specifiers. The special case</em> of `**:*/&#39; means both
message and action are empty, which has/ the effect of causing options
having no description in the help output to be ordered in listings ahead
of options that have a description.</p>
<p>
For example:</p>
<blockquote>
<pre class="example">
_arguments -- &#39;*\*:toggle:(yes no)&#39; \ 
              &#39;*=FILE*:file:_files&#39; \ 
              &#39;*=DIR*:directory:_files -/&#39; \ 
              &#39;*=PATH*:directory:_files -/&#39;
</pre>
</blockquote>
<p>
Here, `*yes*/&#39; and `/*no*/&#39; will be completed as the argument of/
options whose description ends in a star; file names will be completed
for options that contain the substring `*=FILE*/&#39; in the description;
and/ directories will be completed for options whose description
contains `*=DIR*/&#39; or `/*=PATH*/&#39;. The last three are in fact the
default and so/ need not be given explicitly, although it is possible to
override the use of these patterns. A typical help text which uses this
feature is:</p>
<blockquote>
<pre class="example">
  -C, --directory=DIR          change to directory DIR
</pre>
</blockquote>
<p>
so that the above specifications will cause directories to be completed
after `*–directory*/&#39;, though not after `/*-C*/&#39;./</p>
<p>
Note also that *_arguments*/ tries to find out automatically if the/
argument for an option is optional. This can be specified explicitly by
doubling the colon before the <em>message.</em></p>
<p>
If the <em>pattern ends in `/*(-)*</em>&#39;, this will be removed from the/
pattern and the <em>action will be used only directly after the</em> `*=*/&#39;,
not in the next word. This is the behaviour of a normal/ specification
defined with the form `*=-*/&#39;./</p>
<p>
By default, the command (with the option `*–help*/&#39;) is run after/
resetting all the locale categories (except for *LC_CTYPE*/) to
`/*C*/&#39;./ If the localized help output is known to work, the option
`*-l*/&#39; can/ be specified after the `*_arguments –*/&#39; so that the
command is/ run in the current locale.</p>
<p>
The `*_arguments –<strong><em>&#39; can be followed by the option `</em></strong>-i* <em>patterns&#39;
to give patterns for options which are not to be</em> completed. The
patterns can be given as the name of an array parameter or as a literal
list in parentheses. For example,</p>
<blockquote>
<pre class="example">
_arguments -- -i \ 
    &#34;(--(en|dis)able-FEATURE*)&#34;
</pre>
</blockquote>
<p>
will cause completion to ignore the options `*–enable-FEATURE*/&#39; and
`/*–disable-FEATURE*/&#39; (this example is/ useful with GNU
*configure*/)./</p>
<p>
The `*_arguments –<strong><em>&#39; form can also be followed by the option `</em></strong>-s*
<em>pair&#39; to describe option aliases. The pair consists of a list</em> of
alternating patterns and corresponding replacements, enclosed in parens
and quoted so that it forms a single argument word in the <strong>_arguments</strong>
call.</p>
<p>
For example, some <strong>configure*/-script help output describes options
only/ as `</strong>–enable-foo*/&#39;, but the script also accepts the negated
form/ `*–disable-foo*/&#39;. To allow completion of the second form:/</p>
<blockquote>
<pre class="example">
_arguments -- -s &#34;((#s)--enable- --disable-)&#34;
</pre>
</blockquote>
<p>
<em>Miscellaneous notes</em></p>
<p>
Finally, note that *_arguments*/ generally expects to be the primary/
function handling any completion for which it is used. It may have side
effects which change the treatment of any matches added by other
functions called after it. To combine *_arguments*/ with other
functions, those/ functions should be called either before
<strong>_arguments*/, as an action/ within a <em>spec, or in handlers for
`</em></strong>-&gt;*/state&#39; actions./</p>
<p>
Here is a more general example of the use of *_arguments*/:/</p>
<blockquote>
<pre class="example">
_arguments &#39;-l+:left border:&#39; \ 
           &#39;-format:paper size:(letter A4)&#39; \ 
           &#39;*-copy:output file:_files::resolution:(300 600)&#39; \ 
           &#39;:postscript file:_files -g \*.\(ps\|eps\)&#39; \ 
           &#39;*:page number:&#39;
</pre>
</blockquote>
<p>
This describes three options: `*-l*/&#39;, `/*-format*/&#39;, and/ `*-copy*/&#39;.
The first takes one argument described as `left/ border/&#39; for which no
completion will be offered because of the empty/ action. Its argument
may come directly after the `*-l*/&#39; or it may be / given as the next
word on the line.</p>
<p>
The `*-format*/&#39; option takes one/ argument in the next word, described
as `/paper size&#39; for which/ only the strings `*letter*/&#39; and `/*A4*/&#39;
will be completed./</p>
<p>
The `*-copy*/&#39; option may appear more than once on the command line and/
takes two arguments. The first is mandatory and will be completed as a
filename. The second is optional (because of the second colon before the
description `/resolution&#39;) and will be completed from the strings/
`*300*/&#39; and `/*600*/&#39;./</p>
<p>
The last two descriptions say what should be completed as arguments. The
first describes the first argument as a `/postscript file&#39; and makes
files ending in `/*ps*/&#39; or `/*eps*/&#39; / be completed. The last
description gives all other arguments the description `/page number&#39; but
does not offer completions./</p>
</div>
</div>
</blockquote>
<dl>
<dt>
*_cache_invalid*/ cache_identifier/
</dt>
<dd>
<p>This function returns status
zero if the completions cache corresponding to the given cache
identifier needs rebuilding. It determines this by looking up the
*cache-policy*/ style for the current context./ This should provide a
function name which is run with the full path to the relevant cache
file as the only argument.</p>
<p>
Example:</p>
<blockquote>
<pre class="example">
_example_caching_policy () {
    # rebuild if cache is more than a week old
    local -a oldp
    oldp=( &#34;$1&#34;(Nm+7) )
    (( $#oldp ))
}
</pre>
</blockquote>
</dd>
<dt>
*_call_function*/ return name [ arg … ]/
</dt>
<dd>If a function <em>name
exists, it is called with the arguments</em> <em>args. The return argument
gives the name of a parameter in which</em> the return status from the
function <em>name should be stored; if return</em> is empty or a single
hyphen it is ignored.

The return status of *_call_function*/ itself is zero if the function/
<em>name exists and was called and non-zero otherwise.</em></dd>
<dt>
<strong>_call_program*/ [ /</strong>-l*/ ] [ <em><strong>-p</strong></em> ] tag string …/
</dt>
<dd>This
function provides a mechanism for the user to override the use of an
external command. It looks up the *command*/ style with the supplied/
<em>tag. If the style is set, its value is used as the command to</em>
execute. The <em>strings from the call to /*_call_program*</em>, or from the/
style if set, are concatenated with spaces between them and the
resulting string is evaluated. The return status is the return status
of the command called.

By default, the command is run in an environment where all the locale
categories (except for *LC_CTYPE*/) are reset to `/*C*/&#39; by calling
the/ utility function <strong>_comp_locale*/ (see below). If the option
`/</strong>-l*/&#39; is/ given, the command is run with the current locale.

If the option `*-p*/&#39; is supplied it indicates that the command/
output is influenced by the permissions it is run with. If the
*gain-privileges*/ style is set to true, <em><strong>_call_program</strong></em> will make/
use of commands such as *sudo*/, if present on the command-line, to/
match the permissions to whatever the final command is likely to run
under. When looking up the *gain-privileges*/ and <em><strong>command</strong></em> styles,/
the command component of the zstyle context will end with a slash
(`*/*/&#39;) followed by the command that would be used to gain
privileges./</dd>
<dt>
?
</dt>
<dd><strong>_combination*/ [ /</strong>-s*/ pattern ] tag style spec … field opts
…/ :: This function is used to complete combinations of values, for
example pairs of hostnames and usernames. The <em>style argument gives
the style</em> which defines the pairs; it is looked up in a context with
the <em>tag</em> specified.

The style name consists of field names separated by hyphens, for
example `*users-hosts-ports*/&#39;. For each field for a value is already
known, a/ <em>spec of the form `field/*=*/pattern&#39; is given. For
example,</em> if the command line so far specifies a user `*pws*/&#39;, the
argument/ `*users=pws*/&#39; should appear./

The next argument with no equals sign is taken as the name of the
field for which completions should be generated (presumably not one of
the <em>fields for which the value is known).</em>

The matches generated will be taken from the value of the style. These
should contain the possible values for the combinations in the
appropriate order (users, hosts, ports in the example above). The
values for the different fields are separated by colons. This can be
altered with the option <strong>-s*/ to <em><strong>_combination</strong></em> which specifies a/
pattern. Typically this is a character class, as for example `</strong>-s
&#34;[:@]&#34;*/&#39; in the case of the <em><strong>users-hosts</strong></em> style. Each/
`/field/*=*/pattern&#39; specification restricts the/ completions which
apply to elements of the style with appropriately matching fields.

If no style with the given name is defined for the given tag, or if
none of the strings in style&#39;s value match, but a function name of the
required field preceded by an underscore is defined, that function
will be called to generate the matches. For example, if there is no
`*users-hosts-ports*/&#39; or no/ matching hostname when a host is
required, the function `*_hosts*/&#39; will/ automatically be called.

If the same name is used for more than one field, in both the
`/field/*=*/pattern&#39; and the argument that gives the name of the/
field to be completed, the number of the field (starting with one) may
be given after the fieldname, separated from it by a colon.

All arguments after the required field name are passed to *compadd*/
when generating matches from the style value, or to / the functions
for the fields if they are called.</dd>
<dt>
<strong>_command_names*/ [ /</strong>-e*/ | <em><strong>-</strong></em> ]/
</dt>
<dd>This function completes words
that are valid at command position: names of aliases, builtins, hashed
commands, functions, and so on. With the <strong>-e</strong> flag, only hashed
commands are completed. The *-*/ flag is ignored./</dd>
<dt>
<strong>_comp_locale</strong>
</dt>
<dd>This function resets all the locale categories other
than *LC_CTYPE*/ to/ `*C*/&#39; so that the output from external commands
can be easily analyzed by/ the completion system. *LC_CTYPE*/ retains
the current value (taking/ *LC_ALL*/ and <em><strong>LANG</strong></em> into account),
ensuring that non-ASCII characters/ in file names are still handled
properly.

This function should normally be run only in a subshell, because the
new locale is exported to the environment. Typical usage would be
`*$(_comp_locale; <strong><em>command …</em></strong>)*/&#39;./</dd>
<dt>
<strong>_completers*/ [ /</strong>-p*/ ]/
</dt>
<dd>This function completes names of
completers.

<strong>-p</strong> Include the leading underscore (`*_*/&#39;) in the matches./</dd>
<dt>
<strong>_default</strong>
</dt>
<dd>This function corresponds to the *-default-*/ special
context which is/ applied where no completion is defined. It is useful
to call it under certain error conditions such as completion after an
unrecognised subcommand. This applies the concept of graceful
degradation to the completion system, allowing it to fallback on basic
completion of commonly useful things like filenames.</dd>
</dl>
<p><strong>_describe */[/</strong>-12JVx*/] [ <em><strong>-oO</strong></em> | <em><strong>-t</strong></em> tag ] descr name1 [ name2 ]
[ opt … ]/</p>
</div>
</div>
<div id="outline-container-headline-18" class="outline-2">
<h2 id="headline-18">
<strong>/[ /</strong>–*/ name1 [ name2 ] [ opt … ] … ]/ This function associates
</h2>
<div id="outline-text-headline-18" class="outline-text-2">
<p>completions with descriptions. Multiple groups separated by *–*/ can be
supplied, potentially with/ different completion options <em>opts.</em></p>
<blockquote>
<p>The <em>descr is taken as a string to display above the matches if the</em>
*format*/ style for the <em><strong>descriptions</strong></em> tag is set. This is followed
by/ one or two names of arrays followed by options to pass to
<strong>compadd*/. The/ array <em>name1 contains the possible completions with
their descriptions in</em> the form `/completion/</strong>:*/description&#39;. Any
literal colons in/ <em>completion must be quoted with a backslash. If a
name2 is</em> given, it should have the same number of elements as <em>name1;
in this</em> case the corresponding elements are added as possible
completions instead of the <em>completion strings from name1. The
completion list</em> will retain the descriptions from <em>name1. Finally, a
set of</em> completion options can appear.</p>
<p>
If the option `*-o*/&#39; appears before the first argument, the matches
added/ will be treated as names of command options (N.B. not shell
options), typically following a `*-<strong><em>&#39;, `</em></strong>–*/&#39; or `/*+*/&#39; on the
command/ line. In this case *_describe*/ uses the <em><strong>prefix-hidden</strong></em>,/
*prefix-needed*/ and <em><strong>verbose</strong></em> styles to find out if the strings
should/ be added as completions and if the descriptions should be shown.
Without the `*-o*/&#39; option, only the <em><strong>verbose</strong></em> style is used to decide
how/ descriptions are shown. If `*-O*/&#39; is used instead of `/*-o*/&#39;,
command/ options are completed as above but *_describe*/ will not handle
the/ *prefix-needed*/ style./</p>
<p>
With the <strong>-t*/ option a tag can be specified. The default is/
`*values*/&#39; or, if the /</strong>-o*/ option is given, `/*options*/&#39;./</p>
<p>
The options <strong>-1*/, /</strong>-2*/, <em><strong>-J</strong></em>, <em><strong>-V</strong></em>, <em><strong>-x</strong></em> are passed to/
*_next_label*/./</p>
<p>
If selected by the *list-grouped*/ style, strings with the same/
description will appear together in the list.</p>
<p>
*_describe*/ uses the <em><strong>_all_labels</strong></em> function to generate the matches,
so/ it does not need to appear inside a loop over tag labels.</p>
</blockquote>
<ul>
<li>
<p><strong>_description*/ [ /</strong>-x*/ ] [ <em><strong>-12VJ</strong></em> ] tag name descr [ spec …
]/ :: This function is not to be confused with the previous one; it is
used as a helper function for creating options to *compadd*/. It is
buried/ inside many of the higher level completion functions and so
often does not need to be called directly.</p>
<p>
The styles listed below are tested in the current context using the
given <em>tag. The resulting options for /*compadd*</em> are put into the/
array named <em>name (this is traditionally `/*expl*</em>&#39;, but this/
convention is not enforced). The description for the corresponding set
of matches is passed to the function in <em>descr.</em></p>
<p>
The styles tested are: *format*/, <em><strong>hidden</strong></em>, <em><strong>matcher</strong></em>,/
*ignore-line*/, <em><strong>ignored-patterns</strong></em>, <em><strong>group-name</strong></em> and <em><strong>sort</strong></em>./
The *format*/ style is first tested for the given tag and then for/
the *descriptions*/ tag if no value was found, while the remainder
are/ only tested for the tag given as the first argument. The function
also calls *_setup*/ which tests some more styles./</p>
<p>
The string returned by the *format*/ style (if any) will be modified
so/ that the sequence `*%d*/&#39; is replaced by the descr given as the
third/ argument without any leading or trailing white space. If, after
removing the white space, the <em>descr is the empty string, the format</em>
style will not be used and the options put into the <em>name array will</em>
not contain an explanation string to be displayed above the matches.</p>
<p>
If <strong>_description*/ is called with more than three arguments,/ the
additional <em>specs should be of the form `char</em></strong>:*/str&#39;./ These supply
escape sequence replacements for the *format*/ style:/ every
appearance of `*%*/char&#39; will be replaced by string./ If no additional
<em>specs are given but the description in descr</em> conforms to a common
form then further escape sequences are set for elements of that
description. These elements correspond to a default value (`*%o*/&#39;),
the units (`/*%m*/&#39;) range of acceptable values/ (`*%r*/&#39;) and the
remaining initial part of the description (`/*%h*/&#39;)./ The form the
description takes consists of specifying the units and range in
parentheses and the default value in square brackets, for example:</p>
<blockquote>
<pre class="example">
_description times expl &#39;timeout (seconds) (0-60) [20]&#39;
</pre>
</blockquote>
<p>
It is possible to use *zformat*/ conditional expressions when styling/
these elements. So, for example, to add `*default:*/&#39; as a tag but
only/ when there is a default value to show, the *format*/ style
might/ include `*%(o.default: %o.)*/&#39;./</p>
<p>
If the <strong>-x*/ option is given, the description will be passed to/
*compadd*/ using the /</strong>-x*/ option instead of the default <em><strong>-X</strong></em>.
This/ means that the description will be displayed even if there are
no corresponding matches.</p>
<p>
The options placed in the array <em>name take account of the</em>
*group-name*/ style, so matches are placed in a separate group where/
necessary. The group normally has its elements sorted (by passing the
option <strong>-J*/ to <em><strong>compadd</strong></em>), but if an option starting with
`/</strong>-V*/&#39;,/ `*-J*/&#39;, `/*-1*/&#39;, or `/*-2*/&#39; is passed to
<em><strong>_description</strong></em>, that/ option will be included in the array. Hence it
is possible for the completion group to be unsorted by giving the
option `*-V*/&#39;,/ `*-1V*/&#39;, or `/*-2V*/&#39;./</p>
<p>
In most cases, the function will be used like this:</p>
<blockquote>
<pre class="example">
local expl
_description files expl file
compadd &#34;$expl[@]&#34; - &#34;$files[@]&#34;
</pre>
</blockquote>
<p>
Note the use of the parameter *expl*/, the hyphen, and the list of/
matches. Almost all calls to *compadd*/ within the completion system
use/ a similar format; this ensures that user-specified styles are
correctly passed down to the builtins which implement the internals of
completion.</p>
</li>
<li>
<p><strong>_dir_list*/ [ /</strong>-s*/ sep ] [ <em><strong>-S</strong></em> ]/ :: Complete a list of
directory names separated by colons (the same format as *$PATH*/)./</p>
<p>
<strong>-s*/ sep/ Use <em>sep as separator between items.</em> <em>sep defaults to a
colon (`</em></strong>:*/&#39;)./</p>
<dl>
<dt>
<strong>-S</strong>
</dt>
<dd>Add <em>sep instead of slash (`/*/*</em>&#39;) as an autoremoveable
suffix./</dd>
</dl>
</li>
<li>*_dispatch*/ context string …/ :: This sets the current context to
<em>context and looks for completion</em> functions to handle this context by
hunting through the list of command names or special contexts (as
described above for *compdef*/)/ given as <em>strings. The first
completion function to be defined</em> for one of the contexts in the list
is used to generate matches. Typically, the last <em>string is
/*-default-*</em> to cause the function/ for default completion to be used
as a fallback.

The function sets the parameter *$service*/ to the string being tried,
and sets/ the /context/command field (the fourth) of the
/*$curcontext* parameter to the <em>context given as the first argument.</em></li>
<li>
<p><strong>_email_addresses*/ [ /</strong>-c*/ ] [ <em><strong>-n</strong></em> plugin ]/ :: Complete email
addresses. Addresses are provided by plugins.</p>
<p>
<strong>-c</strong> Complete bare *localhost@domain.tld*/ addresses, without a name
part or/ a comment. Without this option, RFC822 `/Firstname Lastname
<em><strong>&lt;*/address/*&gt;</strong></em>&#39;/ strings are completed.</p>
<dl>
<dt>
*-n*/ plugin/
</dt>
<dd>Complete aliases from /plugin. /</dd>
</dl>
<p>The following plugins are available by default: *_email-ldap*/ (see
the <em><strong>filter</strong></em> style),/ *_email-local*/ (completes user/*@*/hostname
Unix addresses),/ *_email-mail*/ (completes aliases from
<em>*~</em>.mailrc*/),/ *_email-mush*/,/ *_email-mutt*/,/ and
*_email-pine*/./</p>
<p>
Addresses from the *_email-*/foo plugin are added under the/ tag
`*email-*/foo&#39;./</p>
<p>
<em>Writing plugins</em></p>
<p>
Plugins are written as separate functions with names starting with
`*_email-*/&#39;./ They are invoked with the *-c*/ option and <em><strong>compadd</strong></em>
options./ They should either do their own completion or set the
<strong>$reply*/ array to a list of `alias/</strong>:*/address&#39; elements and return
<em><strong>300</strong></em>./ New plugins will be picked up and run automatically.</p>
</li>
<li><strong>_files</strong> :: The function *_files*/ is a wrapper around
<em><strong>_path_files</strong></em>. It supports/ all of the same functionality, with some
enhancements – notably, it respects the <strong>list-dirs-first*/ style, and
it allows users to override/ the behaviour of the *-g*/ and /</strong>-<em>*</em>
options with the <em><strong>file-patterns</strong> style. <strong>_files</strong></em> should therefore be
preferred over <em><strong>_path_files</strong></em> in/ most cases.

This function accepts the full set of options allowed by
*_path_files*/, described below./</li>
<li>
<p><strong>_gnu_generic</strong> :: This function is a simple wrapper around the
*_arguments*/ function/ described above. It can be used to determine
automatically the long options understood by commands that produce a
list when passed the option `*–help*/&#39;. It is intended to be used as
a top-level/ completion function in its own right. For example, to
enable option completion for the commands *foo*/ and <em><strong>bar</strong></em>, use/</p>
<blockquote>
<pre class="example">
compdef _gnu_generic foo bar
</pre>
</blockquote>
<p>
after the call to *compinit*/./</p>
<p>
The completion system as supplied is conservative in its use of this
function, since it is important to be sure the command understands the
option `*–help*/&#39;./</p>
</li>
<li>
<p>*_guard*/ [ options ] pattern descr/ :: This function displays <em>descr
if pattern matches the string to</em> be completed. It is intended to be
used in the <em>action for the</em> specifications passed to *_arguments*/
and similar functions./</p>
<p>
The return status is zero if the message was displayed and the word to
complete is not empty, and non-zero otherwise.</p>
<p>
The <em>pattern may be preceded by any of the options understood by</em>
<strong>compadd*/ that are passed down from <em><strong>_description</strong></em>, namely /</strong>-M*/,/
<strong>-J*/, /</strong>-V*/, <em><strong>-1</strong></em>, <em><strong>-2</strong></em>, <em><strong>-n</strong></em>, <em><strong>-F</strong></em> and <em><strong>-X</strong></em>. All of
these/ options will be ignored. This fits in conveniently with the
argument-passing conventions of actions for *_arguments*/./</p>
<p>
As an example, consider a command taking the options <strong>-n*/ and/
*-none*/, where /</strong>-n*/ must be followed by a numeric value in the/
same word. By using:</p>
<blockquote>
<pre class="example">
_arguments &#39;-n-: :_guard &#34;[0-9]#&#34; &#34;numeric value&#34;&#39; &#39;-none&#39;
</pre>
</blockquote>
<p>
<strong>_arguments*/ can be made to both display the message `/*numeric</strong>
value/&#39; and complete options after `/*-n&lt;TAB&gt;*/&#39;. If the `/*-n*/&#39; is/
already followed by one or more digits (the pattern passed to
<strong>_guard*/) only the message will be displayed; if the `/</strong>-n*/&#39; is/
followed by another character, only options are completed.</p>
</li>
</ul>
<p><strong>_message*/ [ /</strong>-r12*/ ] [ <em><strong>-VJ</strong></em> group ] descr/</p>
<p>
*_message -e*/ [ tag ] descr/ The <em>descr is used in the same way as the
third</em> argument to the *_description*/ function, except that the
resulting/ string will always be shown whether or not matches were
generated. This is useful for displaying a help message in places where
no completions can be generated.</p>
<blockquote>
<p>The *format*/ style is examined with the <em><strong>messages</strong></em> tag to find a/
message; the usual tag, *descriptions*/, is used only if the style is/
not set with the former.</p>
<p>
If the *-r*/ option is given, no style is used; the descr is/ taken
literally as the string to display. This is most useful when the <em>descr
comes from a pre-processed argument list</em> which already contains an
expanded description. Note that this option does not disable the
`*%*/&#39;-sequence parsing done by/ *compadd*/./</p>
<p>
The *-12VJ*/ options and the group are passed to <em><strong>compadd</strong></em> and/ hence
determine the group the message string is added to.</p>
<p>
The second *-e*/ form gives a description for completions with the tag/
<em>tag to be shown even if there are no matches for that tag. This form</em>
is called by *_arguments*/ in the event that there is no action for an/
option specification. The tag can be omitted and if so the tag is taken
from the parameter *$curtag*/; this is maintained by the completion/
system and so is usually correct. Note that if there are no matches at
the time this function is called, *compstate[insert]*/ is cleared, so/
additional matches generated later are not inserted on the command line.</p>
</blockquote>
<dl>
<dt>
<strong>_multi_parts*/ [ /</strong>-i*/ ] sep array/
</dt>
<dd>The argument <em>sep is a
separator character.</em> The <em>array may be either the</em> name of an array
parameter or a literal array in the form `*(foo bar)*/&#39;, a
parenthesised list of words separated/ by whitespace. The possible
completions are the strings from the array. However, each chunk
delimited by <em>sep will be</em> completed separately. For example, the
*_tar*/ function uses/ `*_multi_parts*/ <em><strong>/</strong></em> patharray&#39; to complete
partial file paths/ from the given array of complete file paths.

The *-i*/ option causes <em><strong>_multi_parts</strong></em> to insert a unique match
even/ if that requires multiple separators to be inserted. This is not
usually the expected behaviour with filenames, but certain other types
of completion, for example those with a fixed set of possibilities,
may be more suited to this form.

Like other utility functions, this function accepts the `*-V*/&#39;,/
`*-J*/&#39;, `/*-1*/&#39;, `/*-2*/&#39;, `/*-n*/&#39;, `/*-f*/&#39;, `/*-X*/&#39;, `/*-M*/&#39;,/
`*-P*/&#39;, `/*-S*/&#39;, `/*-r*/&#39;, `/*-R*/&#39;, and `/*-q*/&#39; options and
passes/ them to the *compadd*/ builtin./</dd>
<dt>
?
</dt>
<dd>
<p><strong>_next_label*/ [ /</strong>-x*/ ] [ <em><strong>-12VJ</strong></em> ] tag name descr [ option …
]/ :: This function is used to implement the loop over different tag
labels for a particular tag as described above for the <strong>tag-order</strong>
style. On each call it checks to see if there are any more tag labels;
if there is it returns status zero, otherwise non-zero. As this
function requires a current tag to be set, it must always follow a
call to *_tags*/ or <em><strong>_requested</strong></em>./</p>
<p>
The *-x12VJ*/ options and the first three arguments are passed to the/
*_description*/ function. Where appropriate the tag will be/ replaced
by a tag label in this call. Any description given in the *tag-order*/
style is preferred to the descr passed to/ *_next_label*/./</p>
<p>
The <em>options given after the descr</em> are set in the parameter given by
<em>name, and hence are to be passed</em> to *compadd*/ or whatever function
is called to add the matches./</p>
<p>
Here is a typical use of this function for the tag *foo*/. The call
to/ *_requested*/ determines if tag <em><strong>foo</strong></em> is required at all; the
loop/ over *_next_label*/ handles any labels defined for the tag in
the/ *tag-order*/ style./</p>
<blockquote>
<pre class="example">
local expl ret=1
...
if _requested foo; then
  ...
  while _next_label foo expl &#39;...&#39;; do
    compadd &#34;$expl[@]&#34; ... &amp;&amp; ret=0
  done
  ...
fi
return ret
</pre>
</blockquote>
</dd>
<dt>
<strong>_normal*/ [ /</strong>-P*/ | <em><strong>-p</strong></em> precommand ]/
</dt>
<dd>
<p>This is the standard
function called to handle completion outside any special
<strong>-*/context/</strong>-*/. It is called both to complete the command/ word and
also the arguments for a command. In the second case, *_normal*/ looks
for a special completion for that command, and if/ there is none it
uses the completion for the *-default-*/ context./</p>
<p>
A second use is to reexamine the command line specified by the
<strong>$words</strong> array and the *$CURRENT*/ parameter after those have been
modified./ For example, the function *_precommand*/, which/ completes
after precommand specifiers such as *nohup*/, removes the/ first word
from the *words*/ array, decrements the /*CURRENT*/ parameter,/ then
calls `*_normal -p $service*/&#39;. The effect is that/ `*nohup*/ cmd …&#39;
is treated in the same way as `cmd …&#39;./</p>
<p>
<strong>-P</strong> Reset the list of precommands. This option should be used if
completing a command line which allows internal commands (e.g.
builtins and functions) regardless of prior precommands (e.g. `*zsh
-c*/&#39;)./</p>
<dl>
<dt>
*-p*/ precommand/
</dt>
<dd>Append <em>precommand to the list of precommands.
This option should be</em> used in nearly all cases in which *-P*/ is
not applicable./</dd>
</dl>
<p>If the command name matches one of the patterns given by one of the
options <strong>-p*/ or /</strong>-P*/ to <em><strong>compdef</strong></em>, the corresponding completion/
function is called and then the parameter *_compskip*/ is/ checked. If
it is set completion is terminated at that point even if no matches
have been found. This is the same effect as in the *-first-*/
context./</p>
</dd>
<dt>
*_numbers*/ [ option … ] [ description ] [ suffix … ]/
</dt>
<dd>
<p>This can
be used where a number is followed by a suffix to indicate the units.
The unit suffixes are completed and can also be included in the
description used when completion is invoked for the preceding number.</p>
<p>
In addition to common *compadd*/ options, <em><strong>_numbers</strong></em> accepts the
following/ options:</p>
<p>
*-t*/ tag/ Specify a tag to use instead of the default of *numbers*/./</p>
<dl>
<dt>
*-u*/ units/
</dt>
<dd>Indicate the default units for the number, e.g.
*bytes*/./</dd>
<dt>
*-l*/ min/
</dt>
<dd>Specify the lowest possible value for the number.</dd>
<dt>
*-m*/ max/
</dt>
<dd>Specify the highest possible value for the number.</dd>
<dt>
*-d*/ default/
</dt>
<dd>Specify the default value.</dd>
<dt>
<strong>-N</strong>
</dt>
<dd>Allow negative numbers. This is implied if the range
includes a negative.</dd>
<dt>
<strong>-f</strong>
</dt>
<dd>Allow decimal numbers.</dd>
</dl>
<p>Where a particular suffix represents the default units for a number,
it should be prefixed with a colon. Additionally, suffixes can be
followed by a colon and a description. So for example, the following
allows the age of something to be specified, either in seconds or with
an optional suffix with a longer unit of time:</p>
<blockquote>
<pre class="example">
_numbers -u seconds age :s:seconds m:minutes h:hours d:days
</pre>
</blockquote>
<p>
It is typically helpful for units to be presented in order of
magnitude when completed. To facilitate this, the order in which they
are given is preserved.</p>
<p>
When the *format*/ style is looked up with the <em><strong>descriptions</strong></em> tag
or/ the tag specified with *-t*/, the list of suffixes is available as
a/ `*%x*/&#39; escape sequence. This is in addition to the usual
sequences/ documented under the *format*/ style. The form this list
takes can also/ be configured. To this end, the *format*/ style is
first looked up with/ the tag *unit-suffixes*/. The retrieved format
is applied to each/ suffix in turn and the results are then
concatenated to form the completed list. For the *unit-suffixes*/
format, `/*%x*/&#39; expands to/ the individual suffix and `*%X*/&#39; to its
description. <em><strong>%d</strong></em>&#39; indicates/ a default suffix and can be used in a
condition. The index and reverse index are set in `*%i*/&#39; and `/*%r*/&#39;
respectively and are useful for/ text included only with the first and
last suffixes in the list. So for example, the following joins the
suffixes together as a comma-separated list:</p>
<blockquote>
<pre class="example">
zstyle &#39;:completion:*:unit-suffixes&#39; format &#39;%x%(r::,)&#39;
</pre>
</blockquote>
</dd>
<dt>
<strong>_options</strong>
</dt>
<dd>This can be used to complete the names of shell options.
It provides a matcher specification that ignores a leading `*no*/&#39;,
ignores/ underscores and allows upper-case letters to match their
lower-case counterparts (for example, `*glob*/&#39;,/ `*noglob*/&#39;,
`/*NO_GLOB*/&#39; are all completed). Any arguments/ are propagated to the
*compadd*/ builtin./</dd>
<dt>
<strong>_options_set*/ and /*_options_unset</strong>
</dt>
<dd>These functions complete only
set or unset options, with the same matching specification used in the
*_options*/ function./

Note that you need to uncomment a few lines in the <strong>_main_complete</strong>
function for these functions to work properly. The lines in question
are used to store the option settings in effect before the completion
widget locally sets the options it needs. Hence these functions are
not generally used by the completion system.</dd>
<dt>
<strong>_parameters</strong>
</dt>
<dd>This is used to complete the names of shell
parameters.

The option `*-g*/ pattern&#39; limits the completion to parameters/ whose
type matches the <em>pattern. The type of a parameter is that</em> shown by
`*print ${(t)*/param/*}*/&#39;, hence judicious use of/ `***/&#39; in pattern
is probably necessary./

All other arguments are passed to the *compadd*/ builtin./</dd>
<dt>
<strong>_path_files</strong>
</dt>
<dd>
<p>This function is used throughout the completion
system to complete filenames. It allows completion of partial paths.
For example, the string `*/u/i/s/sig*/&#39; may be completed to/
`*/usr/include/sys/signal.h*/&#39;./</p>
<p>
The options accepted by both *_path_files*/ and <em><strong>_files</strong></em> are:/</p>
<p>
<strong>-f</strong> Complete all filenames. This is the default.</p>
<dl>
<dt>
<strong>-/</strong>
</dt>
<dd>Specifies that only directories should be completed.</dd>
<dt>
*-g*/ pattern/
</dt>
<dd>Specifies that only files matching the <em>pattern
should be completed.</em></dd>
<dt>
*-W*/ paths/
</dt>
<dd>Specifies path prefixes that are to be prepended to
the string from the command line to generate the filenames but that
should not be inserted as completions nor shown in completion
listings. Here, <em>paths may be</em> the name of an array parameter, a
literal list of paths enclosed in parentheses or an absolute
pathname.</dd>
<dt>
*-F*/ ignored-files/
</dt>
<dd>This behaves as for the corresponding option
to the *compadd*/ builtin./ It gives direct control over which
filenames should be ignored. If the option is not present, the
*ignored-patterns*/ style is used./</dd>
</dl>
<p>Both <strong>_path_files*/ and <em><strong>_files</strong></em> also accept the following options/
which are passed to *compadd*/: `/</strong>-J*/&#39;, `/*-V*/&#39;,/ `*-1*/&#39;,
`/*-2*/&#39;, `/*-n*/&#39;, `/*-X*/&#39;, `/*-M*/&#39;, `/*-P*/&#39;, `/*-S*/&#39;,/ `*-q*/&#39;,
`/*-r*/&#39;, and `/*-R*/&#39;./</p>
<p>
Finally, the <strong>_path_files*/ function uses the styles <em><strong>expand</strong></em>,/
*ambiguous*/, <em><strong>special-dirs</strong></em>, <em><strong>list-suffixes</strong></em> and /*file-sort</strong>
described above.</p>
</dd>
</dl>
<p><strong>_pick_variant */[ /</strong>-b*/ builtin-label ] [ <em><strong>-c</strong></em> command ] [ <em><strong>-r</strong></em>
name ]/</p>
</div>
</div>
<div id="outline-container-headline-19" class="outline-2">
<h2 id="headline-19">
*/label/*=*/pattern … label [ arg … ]/ This function is used to
</h2>
<div id="outline-text-headline-19" class="outline-text-2">
<p>resolve situations where a single command name requires more than one
type of handling, either because it has more than one variant or because
there is a name clash between two different commands.</p>
<blockquote>
<p>The command to run is taken from the first element of the array <strong>words*/
unless this is overridden by the option /</strong>-c*/. This command/ is run and
its output is compared with a series of patterns. Arguments to be passed
to the command can be specified at the end after all the other
arguments. The patterns to try in order are given by the arguments
<em>label/*=*/pattern; if the output of `command arg</em> …&#39; contains
<em>pattern, then label is selected as the label</em> for the command variant.
If none of the patterns match, the final command label is selected and
status 1 is returned.</p>
<p>
If the `*-b*/ builtin-label&#39; is given, the command is tested to/ see if
it is provided as a shell builtin, possibly autoloaded; if so, the label
<em>builtin-label is selected as the label for the variant.</em></p>
<p>
If the `*-r*/ name&#39; is given, the label picked is stored in/ the
parameter named <em>name.</em></p>
<p>
The results are also cached in the *_cmd_variant*/ associative array/
indexed by the name of the command run.</p>
</blockquote>
<dl>
<dt>
*_regex_arguments*/ name spec …/
</dt>
<dd>
<p>This function generates a
completion function <em>name which matches</em> the specifications <em>specs, a
set of regular expressions as</em> described below. After running
*_regex_arguments*/, the function/ <em>name should be called as a normal
completion function.</em> The pattern to be matched is given by the
contents of the *words*/ array up to the current cursor position
joined together/ with null characters; no quotation is applied.</p>
<p>
The arguments are grouped as sets of alternatives separated by
`*|*/&#39;,/ which are tried one after the other until one matches. Each
alternative consists of a one or more specifications which are tried
left to right, with each pattern matched being stripped in turn from
the command line being tested, until all of the group succeeds or
until one fails; in the latter case, the next alternative is tried.
This structure can be repeated to arbitrary depth by using
parentheses; matching proceeds from inside to outside.</p>
<p>
A special procedure is applied if no test succeeds but the remaining
command line string contains no null character (implying the remaining
word is the one for which completions are to be generated). The
completion target is restricted to the remaining word and any <em>actions
for the corresponding patterns are executed. In this case,</em> nothing is
stripped from the command line string. The order of evaluation of the
<em>actions can be determined by the /*tag-order* style; the various
formats supported by <strong>_alternative</strong></em> can be used/ in <em>action. The
descr is used for setting up the array</em> parameter *expl*/./</p>
<p>
Specification arguments take one of following forms, in which
metacharacters such as `*(<strong><em>&#39;, `</em></strong>)*/&#39;, `/*#*/&#39; and `/*|*/&#39;/ should be
quoted.</p>
<p>
<strong><em><strong><em>pattern/*</em></strong></em> [/*%*/lookahead/*%*/] [/</strong>-<strong><em>guard]
[</em></strong>:*/tag/*:*/descr/*:*/action]/ This is a single primitive component.
The function tests whether the combined pattern
`*(#b)((#B)*/pattern/*)*/lookahead/***/&#39; matches/ the command line
string. If so, `/guard&#39; is evaluated and/ its return status is
examined to determine if the test has succeeded. The <em>pattern string
`/*[]*</em>&#39; is guaranteed never to match./ The <em>lookahead is not stripped
from the command line before the next</em> pattern is examined.</p>
<blockquote>
<p>The argument starting with *:*/ is used in the same manner as an
argument to/ *_alternative*/./</p>
<p>
A component is used as follows: <em>pattern is tested to</em> see if the
component already exists on the command line. If it does, any
following specifications are examined to find something to complete.
If a component is reached but no such pattern exists yet on the
command line, the string containing the <em>action is used to generate</em>
matches to insert at that point.</p>
</blockquote>
<ul>
<li><strong><em><strong>/pattern/*/+</strong></em> [/*%*/lookahead/*%*/] [/</strong>-<strong><em>guard]
[</em></strong>:*/tag/*:*/descr/*:*/action]/ :: This is similar to
`*/*/pattern/*/*/ …&#39; but the left part of the/ command line string
(i.e. the part already matched by previous patterns) is also
considered part of the completion target.</li>
<li><strong><em><strong><em>pattern</em></strong></em>-*/ [/*%*/lookahead/*%*/] [/</strong>-<strong><em>guard]
[</em></strong>:*/tag/*:*/descr/*:*/action]/ :: This is similar to
`*/*/pattern/*/*/ …&#39; but the actions of the/ current and
previously matched patterns are ignored even if the following
`/pattern&#39; matches the empty string./</li>
<li><strong>(*/ spec /</strong>)* :: Parentheses may be used to groups <em>specs; note
each parenthesis</em> is a single argument to *_regex_arguments*/./</li>
<li><em>spec /*#* :: This allows any number of repetitions of /spec.</em></li>
<li><em>spec spec</em> :: The two <em>specs are to be matched one after the other
as described</em> above.</li>
<li><em>spec /*|*</em> spec/ :: Either of the two <em>specs can be matched.</em></li>
</ul>
<p>The function *_regex_words*/ can be used as a helper function to/
generate matches for a set of alternative words possibly with their
own arguments as a command line argument.</p>
<p>
Examples:</p>
<blockquote>
<pre class="example">
_regex_arguments _tst /$&#39;[^\0]#\0&#39;/ \ 
    /$&#39;[^\0]#\0&#39;/ :&#39;compadd aaa&#39;
</pre>
</blockquote>
<p>
This generates a function *_tst*/ that completes <em><strong>aaa</strong></em> as its only/
argument. The <em>tag and description for the action have been</em> omitted
for brevity (this works but is not recommended in normal use). The
first component matches the command word, which is arbitrary; the
second matches any argument. As the argument is also arbitrary, any
following component would not depend on *aaa*/ being present./</p>
<blockquote>
<pre class="example">
_regex_arguments _tst /$&#39;[^\0]#\0&#39;/ \ 
    /$&#39;aaa\0&#39;/ :&#39;compadd aaa&#39;
</pre>
</blockquote>
<p>
This is a more typical use; it is similar, but any following patterns
would only match if *aaa*/ was present as the first argument./</p>
<blockquote>
<pre class="example">
_regex_arguments _tst /$&#39;[^\0]#\0&#39;/ \( \ 
    /$&#39;aaa\0&#39;/ :&#39;compadd aaa&#39; \ 
    /$&#39;bbb\0&#39;/ :&#39;compadd bbb&#39; \) \#
</pre>
</blockquote>
<p>
In this example, an indefinite number of command arguments may be
completed. Odd arguments are completed as <strong>aaa*/ and even arguments/
as *bbb*/. Completion fails unless the set of <em><strong>aaa</strong></em> and /*bbb</strong>
arguments before the current one is matched correctly.</p>
<blockquote>
<pre class="example">
_regex_arguments _tst /$&#39;[^\0]#\0&#39;/ \ 
    \( /$&#39;aaa\0&#39;/ :&#39;compadd aaa&#39; \| \ 
    /$&#39;bbb\0&#39;/ :&#39;compadd bbb&#39; \) \#
</pre>
</blockquote>
<p>
This is similar, but either *aaa*/ or <em><strong>bbb</strong></em> may be completed for/
any argument. In this case *_regex_words*/ could be used to generate/
a suitable expression for the arguments.</p>
</dd>
<dt>
*_regex_words*/ tag description spec …/
</dt>
<dd>
<p>This function can be used
to generate arguments for the *_regex_arguments*/ command which may be
inserted at any point where/ a set of rules is expected. The <em>tag and
description give a</em> standard tag and description pertaining to the
current context. Each <em>spec contains two or three arguments separated
by a colon: note</em> that there is no leading colon in this case.</p>
<p>
Each <em>spec gives one of a set of words that may be completed at</em> this
point, together with arguments. It is thus roughly equivalent to the
*_arguments*/ function when used in normal (non-regex) completion./</p>
<p>
The part of the <em>spec before the first colon is the word to be</em>
completed. This may contain a ***/; the entire word, before and after/
the ***/ is completed, but only the text before the <em><strong>*</strong></em> is required/
for the context to be matched, so that further arguments may be
completed after the abbreviated form.</p>
<p>
The second part of <em>spec is a description for the word being</em>
completed.</p>
<p>
The optional third part of the <em>spec describes how words following</em>
the one being completed are themselves to be completed. It will be
evaluated in order to avoid problems with quoting. This means that
typically it contains a reference to an array containing previously
generated regex arguments.</p>
<p>
The option *-t*/ term specifies a terminator for the word/ instead of
the usual space. This is handled as an auto-removable suffix in the
manner of the option *-s*/ sep to <em><strong>_values</strong></em>./</p>
<p>
The result of the processing by *_regex_words*/ is placed in the
array/ <strong>reply*/, which should be made local to the calling function./
If the set of words and arguments may be matched repeatedly, a *#</strong>
should be appended to the generated array at that point.</p>
<p>
For example:</p>
<blockquote>
<pre class="example">
local -a reply
_regex_words mydb-commands &#39;mydb commands&#39; \ 
  &#39;add:add an entry to mydb:$mydb_add_cmds&#39; \ 
  &#39;show:show entries in mydb&#39;
_regex_arguments _mydb &#34;$reply[@]&#34;
_mydb &#34;$@&#34;
</pre>
</blockquote>
<p>
This shows a completion function for a command *mydb*/ which takes/
two command arguments, *add*/ and <em><strong>show</strong></em>. <em><strong>show</strong></em> takes no
arguments,/ while the arguments for *add*/ have already been prepared
in an/ array *mydb_add_cmds*/, quite possibly by a previous call to/
*_regex_words*/./</p>
</dd>
<dt>
?
</dt>
<dd>
<p><strong>_requested*/ [ /</strong>-x*/ ] [ <em><strong>-12VJ</strong></em> ] tag [ name descr [ command [
arg … ] ]/ :: This function is called to decide whether a tag
already registered by a call to *_tags*/ (see below) has been
requested by the user and hence/ completion should be performed for
it. It returns status zero if the tag is requested and non-zero
otherwise. The function is typically used as part of a loop over
different tags as follows:</p>
<blockquote>
<pre class="example">
_tags foo bar baz
while _tags; do
  if _requested foo; then
    ... # perform completion for foo
  fi
  ... # test the tags bar and baz in the same way
  ... # exit loop if matches were generated
done
</pre>
</blockquote>
<p>
Note that the test for whether matches were generated is not performed
until the end of the *_tags*/ loop. This is so that the user can set/
the *tag-order*/ style to specify a set of tags to be completed at
the/ same time.</p>
<p>
If <em>name and descr are given, /*_requested*</em> calls the/
*_description*/ function with these arguments together with the
options/ passed to *_requested*/./</p>
<p>
If <em>command is given, the /*_all_labels*</em> function will be called/
immediately with the same arguments. In simple cases this makes it
possible to perform the test for the tag and the matching in one go.
For example:</p>
<blockquote>
<pre class="example">
local expl ret=1
_tags foo bar baz
while _tags; do
  _requested foo expl &#39;description&#39; \ 
      compadd foobar foobaz &amp;&amp; ret=0
  ...
  (( ret )) || break
done
</pre>
</blockquote>
<p>
If the <em>command is not /*compadd*</em>, it must nevertheless be prepared/
to handle the same options.</p>
</dd>
<dt>
*_retrieve_cache*/ cache_identifier/
</dt>
<dd>This function retrieves
completion information from the file given by <em>cache_identifier,
stored in a directory specified by the</em> *cache-path*/ style which
defaults to <em>*~</em>.zcompcache*/. The return status/ is zero if retrieval
was successful. It will only attempt retrieval if the *use-cache*/
style is set, so you can call this function/ without worrying about
whether the user wanted to use the caching layer.

See *_store_cache*/ below for more details./</dd>
<dt>
<strong>_sep_parts</strong>
</dt>
<dd>This function is passed alternating arrays and
separators as arguments. The arrays specify completions for parts of
strings to be separated by the separators. The arrays may be the names
of array parameters or a quoted list of words in parentheses. For
example, with the array `*hosts=(ftp news)*/&#39; the call `/*_sep_parts
&#39;(foo bar)&#39; @ hosts*/&#39; will/ complete the string `*f*/&#39; to `/*foo*/&#39;
and the string `/*b@n*/&#39; to/ `*bar@news*/&#39;./

This function accepts the <strong>compadd*/ options `/</strong>-V*/&#39;, `/*-J*/&#39;,/
`*-1*/&#39;, `/*-2*/&#39;, `/*-n*/&#39;, `/*-X*/&#39;, `/*-M*/&#39;, `/*-P*/&#39;, `/*-S*/&#39;,/
`*-r*/&#39;, `/*-R*/&#39;, and `/*-q*/&#39; and passes them on to the /*compadd*
builtin used to add the matches.</dd>
<dt>
?
</dt>
<dd><strong>_sequence*/ [ /</strong>-s*/ sep ] [ <em><strong>-n</strong></em> max ] [ <em><strong>-d</strong></em> ] function [ <em><strong>-</strong></em>
] …/ :: This function is a wrapper to other functions for completing
items in a separated list. The same function is used to complete each
item in the list. The separator is specified with the <strong>-s*/ option. If
/</strong>-s*/ is/ omitted it will use `*,*/&#39;. Duplicate values are not
matched unless/ *-d*/ is specified. If there is a fixed or maximum
number of items in/ the list, this can be specified with the *-n*/
option./

Common *compadd*/ options are passed on to the function. It is
possible/ to use *compadd*/ directly with <em><strong>_sequence</strong></em>, though
<em><strong>_values</strong></em> may/ be more appropriate in this situation.</dd>
<dt>
*_setup*/ tag [ group ]/
</dt>
<dd>This function sets up the special
parameters used by the completion system appropriately for the <em>tag</em>
given as the first argument. It uses the styles *list-colors*/,/
*list-packed*/, <em><strong>list-rows-first</strong></em>, <em><strong>last-prompt</strong></em>,
<em><strong>accept-exact</strong></em>,/ *menu*/ and <em><strong>force-list</strong></em>./

The optional <em>group supplies the name of the group in which the</em>
matches will be placed. If it is not given, the <em>tag is used as</em> the
group name.

This function is called automatically from <strong>_description</strong> and hence is
not normally called explicitly.</dd>
<dt>
*_store_cache*/ cache_identifier param …/
</dt>
<dd>This function, together
with *_retrieve_cache*/ and/ *_cache_invalid*/, implements a caching
layer which can be used/ in any completion function. Data obtained by
costly operations are stored in parameters; this function then dumps
the values of those parameters to a file. The data can then be
retrieved quickly from that file via *_retrieve_cache*/,/ even in
different instances of the shell.

The <em>cache_identifier specifies the file which the data should be</em>
dumped to. The file is stored in a directory specified by the
*cache-path*/ style which defaults to <em>*~</em>.zcompcache*/. The
remaining/ <em>params arguments are the parameters to dump to the file.</em>

The return status is zero if storage was successful. The function will
only attempt storage if the *use-cache*/ style is set, so you can/
call this function without worrying about whether the user wanted to
use the caching layer.

The completion function may avoid calling *_retrieve_cache*/ when it/
already has the completion data available as parameters. However, in
that case it should call *_cache_invalid*/ to check whether the data
in the parameters and/ in the cache are still valid.

See the _perl_modules completion function for a simple example of the
usage of the caching layer.</dd>
<dt>
<strong>_tags*/ [ [ /</strong>-C*/ name ] tag … ]/
</dt>
<dd>If called with arguments,
these are taken to be the names of tags valid for completions in the
current context. These tags are stored internally and sorted by using
the *tag-order*/ style./

Next, *_tags*/ is called repeatedly without arguments from the same/
completion function. This successively selects the first, second, etc.
set of tags requested by the user. The return status is zero if at
least one of the tags is requested and non-zero otherwise. To test if
a particular tag is to be tried, the *_requested*/ function should be/
called (see above).

If `*-C*/ name&#39; is given, name is temporarily stored in the/ <em>argument
field (the fifth) of the context in the /*curcontext*</em> parameter/
during the call to *_tags*/; the field is restored on exit. This/
allows *_tags*/ to use a more / specific context without having to
change and reset the *curcontext*/ parameter (which has the same
effect)./</dd>
<dt>
<strong>_tilde_files</strong>
</dt>
<dd>Like *_files*/, but resolve leading tildes according
to the rules of/ filename expansion, so the suggested completions
don&#39;t start with a `*~*/&#39; even if the filename on the command-line
does./</dd>
<dt>
?
</dt>
<dd>
<p><strong>_values*/ [ /</strong>-O*/ name ] [ <em><strong>-s</strong></em> sep ] [ <em><strong>-S</strong></em> sep ] [ <em><strong>-wC</strong></em> ]
desc spec …/ :: This is used to complete arbitrary keywords (values)
and their arguments, or lists of such combinations.</p>
<p>
If the first argument is the option `*-O*/ name&#39;, it will be used/ in
the same way as by the <strong>_arguments*/ function. In other words, the/
elements of the /name array will be passed to /*compadd</strong> when
executing an action.</p>
<p>
If the first argument (or the first argument after `*-O*/ name&#39;)/ is
`*-s*/&#39;, the next argument is used as the character that separates/
multiple values. This character is automatically added after each
value in an auto-removable fashion (see below); all values completed
by `*_values -s*/&#39; appear in the same word on the command line,
unlike/ completion using *_arguments*/. If this option is not present,
only a/ single value will be completed per word.</p>
<p>
Normally, *_values*/ will only use the current word to determine/
which values are already present on the command line and hence are not
to be completed again. If the *-w*/ option is given, other arguments/
are examined as well.</p>
<p>
The first non-option argument, <em>desc, is used as a string to print as
a</em> description before listing the values.</p>
<p>
All other arguments describe the possible values and their arguments
in the same format used for the description of options by the
*_arguments*/ function (see above). The only differences are that/ no
minus or plus sign is required at the beginning, values can have only
one argument, and the forms of action beginning with an equal sign are
not supported.</p>
<p>
The character separating a value from its argument can be set using
the option <strong>-S*/ (like /</strong>-s*/, followed by the character to use as
the/ separator in the next argument). By default the equals sign will
be used as the separator between values and arguments.</p>
<p>
Example:</p>
<blockquote>
<pre class="example">
_values -s , &#39;description&#39; \ 
        &#39;*foo[bar]&#39; \ 
        &#39;(two)*one[number]:first count:&#39; \ 
        &#39;two[another number]::second count:(1 2 3)&#39;
</pre>
</blockquote>
<p>
This describes three possible values: `*foo*/&#39;, `/*one*/&#39;, and/
`*two*/&#39;. The first is described as `/*bar*/&#39;, takes no argument / and
may appear more than once. The second is described as `*number*/&#39;, may
appear more than once, and takes one mandatory/ argument described as
`*first count*/&#39;; no action is/ specified, so it will not be
completed. The `*(two)*/&#39; at the beginning says that if the value
`/*one*/&#39; is on/ the line, the value `*two*/&#39; will no longer be
considered a possible/ completion. Finally, the last value (`*two*/&#39;)
is described/ as `*another number*/&#39; and takes an optional argument
described as/ `*second count*/&#39; for which the completions (to appear
after an/ `*=*/&#39;) are `/*1*/&#39;, `/*2*/&#39;, and `/*3*/&#39;. The <em><strong>_values</strong></em>
function/ will complete lists of these values separated by commas.</p>
<p>
Like *_arguments*/, this function temporarily adds another context
name/ component to the arguments element (the fifth) of the current
context while executing the <em>action. Here this name is just the name
of the</em> value for which the argument is completed.</p>
<p>
The style *verbose*/ is used to decide if the descriptions for the/
values (but not those for the arguments) should be printed.</p>
<p>
The associative array *val_args*/ is used to report values and their/
arguments; this works similarly to the *opt_args*/ associative array/
used by *_arguments*/. Hence the function calling <em><strong>_values</strong></em> should/
declare the local parameters *state*/, <em><strong>state_descr</strong></em>, <em><strong>line</strong></em>,/
*context*/ and <em><strong>val_args</strong></em>:/</p>
<blockquote>
<pre class="example">
local context state state_descr line
typeset -A val_args
</pre>
</blockquote>
<p>
when using an action of the form `*-&gt;*/string&#39;. With this/ function
the *context*/ parameter will be set to the name of the/ value whose
argument is to be completed. Note that for *_values*/,/ the *state*/
and <em><strong>state_descr</strong></em> are scalars rather than arrays./ Only a single
matching state is returned.</p>
<p>
Note also that *_values*/ normally adds the character used as the/
separator between values as an auto-removable suffix (similar to a
`*/*/&#39; after a directory). However, this is not possible for a/
`*-&gt;*/string&#39; action as the matches for the argument are/ generated by
the calling function. To get the usual behaviour, the calling function
can add the separator <em>x as a suffix by</em> passing the options `*-qS*/
x&#39; either directly or indirectly to/ *compadd*/./</p>
<p>
The option *-C*/ is treated in the same way as it is by
<em><strong>_arguments</strong></em>./ In that case the parameter *curcontext*/ should be
made local instead / of *context*/ (as described above)./</p>
</dd>
<dt>
?
</dt>
<dd>
<p><strong>_wanted*/ [ /</strong>-x*/ ] [ <em><strong>-C</strong></em> name ] [ <em><strong>-12VJ</strong></em> ] tag name descr
command [ arg …]/ :: In many contexts, completion can only generate
one particular set of matches, usually corresponding to a single tag.
However, it is still necessary to decide whether the user requires
matches of this type. This function is useful in such a case.</p>
<p>
The arguments to *_wanted*/ are the same as those to <em><strong>_requested</strong></em>,/
i.e. arguments to be passed to *_description*/. However, in this case/
the <em>command is not optional; all the processing of tags, including</em>
the loop over both tags and tag labels and the generation of matches,
is carried out automatically by *_wanted*/./</p>
<p>
Hence to offer only one tag and immediately add the corresponding
matches with the given description:</p>
<blockquote>
<pre class="example">
local expl
_wanted tag expl &#39;description&#39; \ 
    compadd -- match1 match2...
</pre>
</blockquote>
<p>
See also the use of *_wanted*/ in the example function in/ the
subsection `Dynamic named directories&#39; in <em>zshexpn(1).</em></p>
<p>
Note that, as for *_requested*/, the command must be able to/ accept
options to be passed down to *compadd*/./</p>
<p>
Like <strong>_tags*/ this function supports the /</strong>-C*/ option to give a/
different name for the argument context field. The *-x*/ option has/
the same meaning as for *_description*/./</p>
</dd>
<dt>
<strong>_widgets*/ [ /</strong>-g*/ pattern ]/
</dt>
<dd>This function completes names of
zle widgets (see the section `Widgets&#39; in /zshzle(1)). The pattern, if
present, is matched against values of the /*$widgets* special
parameter, documented in the section `The zsh/zleparameter Module&#39; in
<em>zshmodules(1).</em></dd>
</dl>
</div>
</div>
<div id="outline-container-headline-20" class="outline-2">
<h2 id="headline-20">
COMPLETION SYSTEM VARIABLES
</h2>
<div id="outline-text-headline-20" class="outline-text-2">
<p>There are some standard variables, initialised by the <strong>_main_complete</strong>
function and then used from other functions.</p>
<p>
The standard variables are:</p>
<p>
<strong>_comp_caller_options</strong> The completion system uses *setopt*/ to set a
number of options. This/ allows functions to be written without concern
for compatibility with every possible combination of user options.
However, sometimes completion needs to know what the user&#39;s option
preferences are. These are saved in the *_comp_caller_options*/
associative array. Option names, spelled/ in lowercase without
underscores, are mapped to one or other of the strings `*on*/&#39; and
`/*off*/&#39;./</p>
<dl>
<dt>
<strong>_comp_priv_prefix</strong>
</dt>
<dd>Completion functions such as <strong>_sudo*/ can set
the /*_comp_priv_prefix</strong> array to a command prefix that may then be
used by *_call_program*/ to/ match the privileges when calling
programs to generate matches.</dd>
</dl>
<p>Two more features are offered by the *_main_complete*/ function. The/
arrays *compprefuncs*/ and <em><strong>comppostfuncs</strong></em> may contain/ names of
functions that are to be called immediately before or after completion
has been tried. A function will only be called once unless it explicitly
reinserts itself into the array.</p>
</div>
</div>
<div id="outline-container-headline-21" class="outline-2">
<h2 id="headline-21">
COMPLETION DIRECTORIES
</h2>
<div id="outline-text-headline-21" class="outline-text-2">
<p>In the source distribution, the files are contained in various
subdirectories of the *Completion*/ directory. They may have been/
installed in the same structure, or into one single function directory.
The following is a description of the files found in the original
directory structure. If you wish to alter an installed file, you will
need to copy it to some directory which appears earlier in your *fpath*/
than the/ standard directory where it appears.</p>
<p>
<strong>Base</strong> The core functions and special completion widgets automatically
bound to keys. You will certainly need most of these, though will
probably not need to alter them. Many of these are documented above.</p>
<dl>
<dt>
<strong>Zsh</strong>
</dt>
<dd>Functions for completing arguments of shell builtin commands
and utility functions for this. Some of these are also used by
functions from the *Unix*/ directory./</dd>
<dt>
<strong>Unix</strong>
</dt>
<dd>Functions for completing arguments of external commands and
suites of commands. They may need modifying for your system, although
in many cases some attempt is made to decide which version of a
command is present. For example, completion for the *mount*/ command
tries to determine the system/ it is running on, while completion for
many other utilities try to decide whether the GNU version of the
command is in use, and hence whether the *–help*/ option is
supported./</dd>
<dt>
*X*/, <em><strong>AIX</strong></em>, <em><strong>BSD</strong></em>, …/
</dt>
<dd>Completion and utility function for
commands available only on some systems. These are not arranged
hierarchically, so, for example, both the *Linux*/ and <em><strong>Debian</strong></em>
directories, as well as the <em><strong>X</strong></em> directory,/ may be useful on your
system.</dd>
</dl>
</div>
</div>


        </main>
        <footer class="container footer">
            <p>Copyright 2024. All rights reserved.</p>

        </footer>

        
        

        
            <script src="/js/main.js"></script>
    </body>
</html>
