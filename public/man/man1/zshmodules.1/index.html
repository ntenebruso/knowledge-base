<!DOCTYPE html>
<html
    lang="en-us"
    dir="ltr"
>
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Manpages - zshmodules.1 | Technical Notes</title>

    <link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/css/syntax.css">
        
        
    </head>
    <body>
        <header class="container header">
            <span class="header__title">Technical Notes</span>
<button id="menuOpenBtn" class="header__menu-open-btn"><i data-lucide="menu"></i></button>

  <nav id="siteNav">
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a href="/notes/">Notes</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/man/">Manpages</a>
    </li>
    <li>
      <a href="/search/">Search</a>
    </li>
    </ul>
    <button id="menuCloseBtn" class="header__menu-close-btn"><i data-lucide="x"></i></button>
  </nav>


        </header>
        <main class="container">
            
    <h1>Manpages - zshmodules.1</h1>
    
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
NAME
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>zshmodules - zsh loadable modules</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
DESCRIPTION
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>Some optional parts of zsh are in modules, separate from the core of the
shell. Each of these modules may be linked in to the shell at build
time, or can be dynamically linked while the shell is running if the
installation supports this feature. Modules are linked at runtime with
the <strong>zmodload</strong> command, see /zshbuiltins/(1).</p>
<p>
The modules that are bundled with the zsh distribution are:</p>
<p>
<strong>zsh/attr</strong> Builtins for manipulating extended attributes (xattr).</p>
<dl>
<dt>
<strong>zsh/cap</strong>
</dt>
<dd>Builtins for manipulating POSIX.1e (POSIX.6) capability
(privilege) sets.</dd>
<dt>
<strong>zsh/clone</strong>
</dt>
<dd>A builtin that can clone a running shell onto another
terminal.</dd>
<dt>
<strong>zsh/compctl</strong>
</dt>
<dd>The <strong>compctl</strong> builtin for controlling completion.</dd>
<dt>
<strong>zsh/complete</strong>
</dt>
<dd>The basic completion code.</dd>
<dt>
<strong>zsh/complist</strong>
</dt>
<dd>Completion listing extensions.</dd>
<dt>
<strong>zsh/computil</strong>
</dt>
<dd>A module with utility builtins needed for the shell
function based completion system.</dd>
<dt>
<strong>zsh/curses</strong>
</dt>
<dd>curses windowing commands</dd>
<dt>
<strong>zsh/datetime</strong>
</dt>
<dd>Some date/time commands and parameters.</dd>
<dt>
<strong>zsh/db/gdbm</strong>
</dt>
<dd>Builtins for managing associative array parameters
tied to GDBM databases.</dd>
<dt>
<strong>zsh/deltochar</strong>
</dt>
<dd>A ZLE function duplicating EMACS&#39; <strong>zap-to-char</strong>.</dd>
<dt>
<strong>zsh/example</strong>
</dt>
<dd>An example of how to write a module.</dd>
<dt>
<strong>zsh/files</strong>
</dt>
<dd>Some basic file manipulation commands as builtins.</dd>
<dt>
<strong>zsh/langinfo</strong>
</dt>
<dd>Interface to locale information.</dd>
<dt>
<strong>zsh/mapfile</strong>
</dt>
<dd>Access to external files via a special associative
array.</dd>
<dt>
<strong>zsh/mathfunc</strong>
</dt>
<dd>Standard scientific functions for use in
mathematical evaluations.</dd>
<dt>
<strong>zsh/nearcolor</strong>
</dt>
<dd>Map colours to the nearest colour in the available
palette.</dd>
<dt>
<strong>zsh/newuser</strong>
</dt>
<dd>Arrange for files for new users to be installed.</dd>
<dt>
<strong>zsh/parameter</strong>
</dt>
<dd>Access to internal hash tables via special
associative arrays.</dd>
<dt>
<strong>zsh/pcre</strong>
</dt>
<dd>Interface to the PCRE library.</dd>
<dt>
<strong>zsh/param/private</strong>
</dt>
<dd>Builtins for managing private-scoped parameters
in function context.</dd>
<dt>
<strong>zsh/regex</strong>
</dt>
<dd>Interface to the POSIX regex library.</dd>
<dt>
<strong>zsh/sched</strong>
</dt>
<dd>A builtin that provides a timed execution facility
within the shell.</dd>
<dt>
<strong>zsh/net/socket</strong>
</dt>
<dd>Manipulation of Unix domain sockets</dd>
<dt>
<strong>zsh/stat</strong>
</dt>
<dd>A builtin command interface to the <strong>stat</strong> system call.</dd>
<dt>
<strong>zsh/system</strong>
</dt>
<dd>A builtin interface to various low-level system
features.</dd>
<dt>
<strong>zsh/net/tcp</strong>
</dt>
<dd>Manipulation of TCP sockets</dd>
<dt>
<strong>zsh/termcap</strong>
</dt>
<dd>Interface to the termcap database.</dd>
<dt>
<strong>zsh/terminfo</strong>
</dt>
<dd>Interface to the terminfo database.</dd>
<dt>
<strong>zsh/watch</strong>
</dt>
<dd>Reporting of login and logout events.</dd>
<dt>
<strong>zsh/zftp</strong>
</dt>
<dd>A builtin FTP client.</dd>
<dt>
<strong>zsh/zle</strong>
</dt>
<dd>The Zsh Line Editor, including the <strong>bindkey</strong> and <strong>vared</strong>
builtins.</dd>
<dt>
<strong>zsh/zleparameter</strong>
</dt>
<dd>Access to internals of the Zsh Line Editor via
parameters.</dd>
<dt>
<strong>zsh/zprof</strong>
</dt>
<dd>A module allowing profiling for shell functions.</dd>
<dt>
<strong>zsh/zpty</strong>
</dt>
<dd>A builtin for starting a command in a pseudo-terminal.</dd>
<dt>
<strong>zsh/zselect</strong>
</dt>
<dd>Block and return when file descriptors are ready.</dd>
<dt>
<strong>zsh/zutil</strong>
</dt>
<dd>Some utility builtins, e.g. the one for supporting
configuration via styles.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
THE ZSH/ATTR MODULE
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>The <strong>zsh/attr</strong> module is used for manipulating extended attributes. The
<strong>-h</strong> option causes all commands to operate on symbolic links instead of
their targets. The builtins in this module are:</p>
<p>
<strong>zgetattr</strong> [ <strong>-h</strong> ] <em>filename</em> <em>attribute</em> [ <em>parameter</em> ] Get the
extended attribute <em>attribute</em> from the specified <em>filename</em>. If the
optional argument <em>parameter</em> is given, the attribute is set on that
parameter instead of being printed to stdout.</p>
<dl>
<dt>
<strong>zsetattr</strong> [ <strong>-h</strong> ] <em>filename</em> <em>attribute</em> <em>value</em>
</dt>
<dd>Set the extended
attribute <em>attribute</em> on the specified <em>filename</em> to <em>value</em>.</dd>
<dt>
<strong>zdelattr</strong> [ <strong>-h</strong> ] <em>filename</em> <em>attribute</em>
</dt>
<dd>Remove the extended
attribute <em>attribute</em> from the specified <em>filename</em>.</dd>
<dt>
<strong>zlistattr</strong> [ <strong>-h</strong> ] <em>filename</em> [ <em>parameter</em> ]
</dt>
<dd>List the extended
attributes currently set on the specified <em>filename</em>. If the optional
argument <em>parameter</em> is given, the list of attributes is set on that
parameter instead of being printed to stdout.</dd>
</dl>
<p><strong>zgetattr</strong> and <strong>zlistattr</strong> allocate memory dynamically. If the attribute
or list of attributes grows between the allocation and the call to get
them, they return 2. On all other errors, 1 is returned. This allows the
calling function to check for this case and retry.</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
THE ZSH/CAP MODULE
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>The <strong>zsh/cap</strong> module is used for manipulating POSIX.1e (POSIX.6)
capability sets. If the operating system does not support this
interface, the builtins defined by this module will do nothing. The
builtins in this module are:</p>
<p>
<strong>cap</strong> [ <em>capabilities</em> ] Change the shell&#39;s process capability sets to
the specified <em>capabilities</em>, otherwise display the shell&#39;s current
capabilities.</p>
<dl>
<dt>
<strong>getcap</strong> <em>filename</em> …
</dt>
<dd>This is a built-in implementation of the
POSIX standard utility. It displays the capability sets on each
specified <em>filename</em>.</dd>
<dt>
<strong>setcap</strong> <em>capabilities</em> <em>filename</em> …
</dt>
<dd>This is a built-in
implementation of the POSIX standard utility. It sets the capability
sets on each specified <em>filename</em> to the specified <em>capabilities</em>.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
THE ZSH/CLONE MODULE
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>The <strong>zsh/clone</strong> module makes available one builtin command:</p>
<p>
<strong>clone</strong> <em>tty</em> Creates a forked instance of the current shell, attached
to the specified <em>tty</em>. In the new shell, the <strong>PID</strong>, <strong>PPID</strong> and <strong>TTY</strong>
special parameters are changed appropriately. <strong>$!</strong> is set to zero in the
new shell, and to the new shell&#39;s PID in the original shell.</p>
<blockquote>
<p>The return status of the builtin is zero in both shells if successful,
and non-zero on error.</p>
<p>
The target of <strong>clone</strong> should be an unused terminal, such as an unused
virtual console or a virtual terminal created by</p>
<blockquote>
<pre class="example">
xterm -e sh -c &#39;trap : INT QUIT TSTP; tty;
        while :; do sleep 100000000; done&#39;
</pre>
</blockquote>
<p>
Some words of explanation are warranted about this long xterm command
line: when doing clone on a pseudo-terminal, some other session
(&#34;session&#34; meant as a unix session group, or SID) is already owning the
terminal. Hence the cloned zsh cannot acquire the pseudo-terminal as a
controlling tty. That means two things:</p>
<p>
· the job control signals will go to the sh-started-by-xterm process
group (that&#39;s why we disable INT QUIT and TSTP with trap; otherwise the
while loop could get suspended or killed)</p>
<dl>
<dt>
·
</dt>
<dd>the cloned shell will have job control disabled, and the job
control keys (control-C, control-\ and control-Z) will not work.</dd>
</dl>
<p>This does not apply when cloning to an <em>unused</em> vc.</p>
<p>
Cloning to a used (and unprepared) terminal will result in two processes
reading simultaneously from the same terminal, with input bytes going
randomly to either process.</p>
<p>
<strong>clone</strong> is mostly useful as a shell built-in replacement for openvt.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-6" class="outline-2">
<h2 id="headline-6">
THE ZSH/COMPCTL MODULE
</h2>
<div id="outline-text-headline-6" class="outline-text-2">
<p>The <strong>zsh/compctl</strong> module makes available two builtin commands.
<strong>compctl</strong>, is the old, deprecated way to control completions for ZLE.
See /zshcompctl/(1). The other builtin command, <strong>compcall</strong> can be used
in user-defined completion widgets, see /zshcompwid/(1).</p>
</div>
</div>
<div id="outline-container-headline-7" class="outline-2">
<h2 id="headline-7">
THE ZSH/COMPLETE MODULE
</h2>
<div id="outline-text-headline-7" class="outline-text-2">
<p>The <strong>zsh/complete</strong> module makes available several builtin commands which
can be used in user-defined completion widgets, see /zshcompwid/(1).</p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-2">
<h2 id="headline-8">
THE ZSH/COMPLIST MODULE
</h2>
<div id="outline-text-headline-8" class="outline-text-2">
<p>The <strong>zsh/complist</strong> module offers three extensions to completion
listings: the ability to highlight matches in such a list, the ability
to scroll through long lists and a different style of menu completion.</p>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
Colored completion listings
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p>Whenever one of the parameters <strong>ZLS_COLORS</strong> or <strong>ZLS_COLOURS</strong> is set and
the <strong>zsh/complist</strong> module is loaded or linked into the shell, completion
lists will be colored. Note, however, that <strong>complist</strong> will not
automatically be loaded if it is not linked in: on systems with dynamic
loading, `*zmodload zsh/complist*&#39; is required.</p>
<p>
The parameters <strong>ZLS_COLORS</strong> and <strong>ZLS_COLOURS</strong> describe how matches are
highlighted. To turn on highlighting an empty value suffices, in which
case all the default values given below will be used. The format of the
value of these parameters is the same as used by the GNU version of the
<strong>ls</strong> command: a colon-separated list of specifications of the form
`/name/*=*/value/&#39;. The <em>name</em> may be one of the following strings, most
of which specify file types for which the <em>value</em> will be used. The
strings and their default values are:</p>
<p>
<strong>no 0</strong> for normal text (i.e. when displaying something other than a
matched file)</p>
<dl>
<dt>
<strong>fi 0</strong>
</dt>
<dd>for regular files</dd>
<dt>
<strong>di 32</strong>
</dt>
<dd>for directories</dd>
<dt>
<strong>ln 36</strong>
</dt>
<dd>for symbolic links. If this has the special value <strong>target</strong>,
symbolic links are dereferenced and the target file used to determine
the display format.</dd>
<dt>
<strong>pi 31</strong>
</dt>
<dd>for named pipes (FIFOs)</dd>
<dt>
<strong>so 33</strong>
</dt>
<dd>for sockets</dd>
<dt>
<strong>bd 44;37</strong>
</dt>
<dd>for block devices</dd>
<dt>
<strong>cd 44;37</strong>
</dt>
<dd>for character devices</dd>
<dt>
<strong>or</strong> <em>none</em>
</dt>
<dd>for a symlink to nonexistent file (default is the value
defined for <strong>ln</strong>)</dd>
<dt>
<strong>mi</strong> <em>none</em>
</dt>
<dd>for a non-existent file (default is the value defined
for <strong>fi</strong>); this code is currently not used</dd>
<dt>
<strong>su 37;41</strong>
</dt>
<dd>for files with setuid bit set</dd>
<dt>
<strong>sg 30;43</strong>
</dt>
<dd>for files with setgid bit set</dd>
<dt>
<strong>tw 30;42</strong>
</dt>
<dd>for world writable directories with sticky bit set</dd>
<dt>
<strong>ow 34;43</strong>
</dt>
<dd>for world writable directories without sticky bit set</dd>
<dt>
<strong>sa</strong> <em>none</em>
</dt>
<dd>for files with an associated suffix alias; this is only
tested after specific suffixes, as described below</dd>
<dt>
<strong>st 37;44</strong>
</dt>
<dd>for directories with sticky bit set but not world
writable</dd>
<dt>
<strong>ex 35</strong>
</dt>
<dd>for executable files</dd>
<dt>
<strong>lc \e[</strong>
</dt>
<dd>for the left code (see below)</dd>
<dt>
<strong>rc m</strong>
</dt>
<dd>for the right code</dd>
<dt>
<strong>tc 0</strong>
</dt>
<dd>for the character indicating the file type printed after
filenames if the <strong>LIST_TYPES</strong> option is set</dd>
<dt>
<strong>sp 0</strong>
</dt>
<dd>for the spaces printed after matches to align the next
column</dd>
<dt>
<strong>ec</strong> <em>none</em>
</dt>
<dd>for the end code</dd>
</dl>
<p>Apart from these strings, the <em>name</em> may also be an asterisk (`***&#39;)
followed by any string. The <em>value</em> given for such a string will be used
for all files whose name ends with the string. The <em>name</em> may also be an
equals sign (`*=*&#39;) followed by a pattern; the <strong>EXTENDED_GLOB</strong> option
will be turned on for evaluation of the pattern. The <em>value</em> given for
this pattern will be used for all matches (not just filenames) whose
display string are matched by the pattern. Definitions for the form with
the leading equal sign take precedence over the values defined for file
types, which in turn take precedence over the form with the leading
asterisk (file extensions).</p>
<p>
The leading-equals form also allows different parts of the displayed
strings to be colored differently. For this, the pattern has to use the
`*(#b)*&#39; globbing flag and pairs of parentheses surrounding the parts of
the strings that are to be colored differently. In this case the <em>value</em>
may consist of more than one color code separated by equal signs. The
first code will be used for all parts for which no explicit code is
specified and the following codes will be used for the parts matched by
the sub-patterns in parentheses. For example, the specification
`*=(#b)(?)*(?)=0=3=7*&#39; will be used for all matches which are at least
two characters long and will use the code `*3*&#39; for the first character,
`*7*&#39; for the last character and `*0*&#39; for the rest.</p>
<p>
All three forms of <em>name</em> may be preceded by a pattern in parentheses.
If this is given, the <em>value</em> will be used only for matches in groups
whose names are matched by the pattern given in the parentheses. For
example, `*(g*)m*=43*&#39; highlights all matches beginning with `*m*&#39; in
groups whose names begin with `*g*&#39; using the color code `*43*&#39;. In case
of the `*lc*&#39;, `*rc*&#39;, and `*ec*&#39; codes, the group pattern is ignored.</p>
<p>
Note also that all patterns are tried in the order in which they appear
in the parameter value until the first one matches which is then used.
Patterns may be matched against completions, descriptions (possibly with
spaces appended for padding), or lines consisting of a completion
followed by a description. For consistent coloring it may be necessary
to use more than one pattern or a pattern with backreferences.</p>
<p>
When printing a match, the code prints the value of <strong>lc</strong>, the value for
the file-type or the last matching specification with a `***&#39;, the value
of <strong>rc</strong>, the string to display for the match itself, and then the value
of <strong>ec</strong> if that is defined or the values of <strong>lc</strong>, <strong>no</strong>, and <strong>rc</strong> if <strong>ec</strong>
is not defined.</p>
<p>
The default values are ISO 6429 (ANSI) compliant and can be used on
vt100 compatible terminals such as <strong>xterm*s. On monochrome terminals the
default values will have no visible effect. The *colors</strong> function from
the contribution can be used to get associative arrays containing the
codes for ANSI terminals (see the section `Other Functions&#39; in
/zshcontrib/(1)). For example, after loading <strong>colors</strong>, one could use
`*$color[red]*&#39; to get the code for foreground color red and
`*$color[bg-green]*&#39; for the code for background color green.</p>
<p>
If the completion system invoked by compinit is used, these parameters
should not be set directly because the system controls them itself.
Instead, the <strong>list-colors</strong> style should be used (see the section
`Completion System Configuration&#39; in /zshcompsys/(1)).</p>
</div>
</div>
<div id="outline-container-headline-10" class="outline-3">
<h3 id="headline-10">
Scrolling in completion listings
</h3>
<div id="outline-text-headline-10" class="outline-text-3">
<p>To enable scrolling through a completion list, the <strong>LISTPROMPT</strong>
parameter must be set. Its value will be used as the prompt; if it is
the empty string, a default prompt will be used. The value may contain
escapes of the form `*%x*&#39;. It supports the escapes `*%B*&#39;, `*%b*&#39;,
`*%S*&#39;, `*%s*&#39;, `*%U*&#39;, `*%u*&#39;, `*%F*&#39;, `*%f*&#39;, `*%K*&#39;, `*%k*&#39; and
`*%{<strong>/…/*%}</strong>&#39; used also in shell prompts as well as three pairs of
additional sequences: a `*%l*&#39; or `*%L*&#39; is replaced by the number of
the last line shown and the total number of lines in the form
`/number/*/*/total/&#39;; a `*%m*&#39; or `*%M*&#39; is replaced with the number of
the last match shown and the total number of matches; and `*%p*&#39; or
`*%P*&#39; is replaced with `*Top*&#39;, `*Bottom*&#39; or the position of the first
line shown in percent of the total number of lines, respectively. In
each of these cases the form with the uppercase letter will be replaced
with a string of fixed width, padded to the right with spaces, while the
lowercase form will not be padded.</p>
<p>
If the parameter <strong>LISTPROMPT</strong> is set, the completion code will not ask
if the list should be shown. Instead it immediately starts displaying
the list, stopping after the first screenful, showing the prompt at the
bottom, waiting for a keypress after temporarily switching to the
<strong>listscroll</strong> keymap. Some of the zle functions have a special meaning
while scrolling lists:</p>
<p>
<strong>send-break</strong> stops listing discarding the key pressed</p>
<p>
<strong>accept-line</strong>, <strong>down-history</strong>, <strong>down-line-or-history</strong></p>
<p>
<strong>down-line-or-search</strong>, <strong>vi-down-line-or-history</strong> scrolls forward one
line</p>
<p>
<strong>complete-word</strong>, <strong>menu-complete</strong>, <strong>expand-or-complete</strong></p>
<p>
<strong>expand-or-complete-prefix</strong>, <strong>menu-complete-or-expand</strong> scrolls forward
one screenful</p>
<dl>
<dt>
<strong>accept-search</strong>
</dt>
<dd>stop listing but take no other action</dd>
</dl>
<p>Every other character stops listing and immediately processes the key as
usual. Any key that is not bound in the <strong>listscroll</strong> keymap or that is
bound to <strong>undefined-key</strong> is looked up in the keymap currently selected.</p>
<p>
As for the <strong>ZLS_COLORS</strong> and <strong>ZLS_COLOURS</strong> parameters, <strong>LISTPROMPT</strong>
should not be set directly when using the shell function based
completion system. Instead, the <strong>list-prompt</strong> style should be used.</p>
</div>
</div>
<div id="outline-container-headline-11" class="outline-3">
<h3 id="headline-11">
Menu selection
</h3>
<div id="outline-text-headline-11" class="outline-text-3">
<p>The <strong>zsh/complist</strong> module also offers an alternative style of selecting
matches from a list, called menu selection, which can be used if the
shell is set up to return to the last prompt after showing a completion
list (see the <strong>ALWAYS_LAST_PROMPT</strong> option in /zshoptions/(1)).</p>
<p>
Menu selection can be invoked directly by the widget <strong>menu-select</strong>
defined by this module. This is a standard ZLE widget that can be bound
to a key in the usual way as described in /zshzle/(1).</p>
<p>
Alternatively, the parameter <strong>MENUSELECT</strong> can be set to an integer,
which gives the minimum number of matches that must be present before
menu selection is automatically turned on. This second method requires
that menu completion be started, either directly from a widget such as
<strong>menu-complete</strong>, or due to one of the options <strong>MENU_COMPLETE</strong> or
<strong>AUTO_MENU</strong> being set. If <strong>MENUSELECT</strong> is set, but is 0, 1 or empty,
menu selection will always be started during an ambiguous menu
completion.</p>
<p>
When using the completion system based on shell functions, the
<strong>MENUSELECT</strong> parameter should not be used (like the <strong>ZLS_COLORS</strong> and
<strong>ZLS_COLOURS</strong> parameters described above). Instead, the <strong>menu</strong> style
should be used with the *select=*/…/ keyword.</p>
<p>
After menu selection is started, the matches will be listed. If there
are more matches than fit on the screen, only the first screenful is
shown. The matches to insert into the command line can be selected from
this list. In the list one match is highlighted using the value for <strong>ma</strong>
from the <strong>ZLS_COLORS</strong> or <strong>ZLS_COLOURS</strong> parameter. The default value for
this is `*7*&#39; which forces the selected match to be highlighted using
standout mode on a vt100-compatible terminal. If neither <strong>ZLS_COLORS</strong>
nor <strong>ZLS_COLOURS</strong> is set, the same terminal control sequence as for the
`*%S*&#39; escape in prompts is used.</p>
<p>
If there are more matches than fit on the screen and the parameter
<strong>MENUPROMPT</strong> is set, its value will be shown below the matches. It
supports the same escape sequences as <strong>LISTPROMPT</strong>, but the number of
the match or line shown will be that of the one where the mark is
placed. If its value is the empty string, a default prompt will be used.</p>
<p>
The <strong>MENUSCROLL</strong> parameter can be used to specify how the list is
scrolled. If the parameter is unset, this is done line by line, if it is
set to `*0*&#39; (zero), the list will scroll half the number of lines of
the screen. If the value is positive, it gives the number of lines to
scroll and if it is negative, the list will be scrolled the number of
lines of the screen minus the (absolute) value.</p>
<p>
As for the <strong>ZLS_COLORS</strong>, <strong>ZLS_COLOURS</strong> and <strong>LISTPROMPT</strong> parameters,
neither <strong>MENUPROMPT</strong> nor <strong>MENUSCROLL</strong> should be set directly when using
the shell function based completion system. Instead, the <strong>select-prompt</strong>
and <strong>select-scroll</strong> styles should be used.</p>
<p>
The completion code sometimes decides not to show all of the matches in
the list. These hidden matches are either matches for which the
completion function which added them explicitly requested that they not
appear in the list (using the <strong>-n</strong> option of the <strong>compadd</strong> builtin
command) or they are matches which duplicate a string already in the
list (because they differ only in things like prefixes or suffixes that
are not displayed). In the list used for menu selection, however, even
these matches are shown so that it is possible to select them. To
highlight such matches the <strong>hi</strong> and <strong>du</strong> capabilities in the
<strong>ZLS_COLORS</strong> and <strong>ZLS_COLOURS</strong> parameters are supported for hidden
matches of the first and second kind, respectively.</p>
<p>
Selecting matches is done by moving the mark around using the zle
movement functions. When not all matches can be shown on the screen at
the same time, the list will scroll up and down when crossing the top or
bottom line. The following zle functions have special meaning during
menu selection. Note that the following always perform the same task
within the menu selection map and cannot be replaced by user defined
widgets, nor can the set of functions be extended:</p>
<p>
<strong>accept-line</strong>, <strong>accept-search</strong> accept the current match and leave menu
selection (but do not cause the command line to be accepted)</p>
<dl>
<dt>
<strong>send-break</strong>
</dt>
<dd>leaves menu selection and restores the previous
contents of the command line</dd>
<dt>
<strong>redisplay</strong>, <strong>clear-screen</strong>
</dt>
<dd>execute their normal function without
leaving menu selection</dd>
<dt>
<strong>accept-and-hold</strong>, <strong>accept-and-menu-complete</strong>
</dt>
<dd>accept the currently
inserted match and continue selection allowing to select the next
match to insert into the line</dd>
<dt>
<strong>accept-and-infer-next-history</strong>
</dt>
<dd>accepts the current match and then
tries completion with menu selection again; in the case of files this
allows one to select a directory and immediately attempt to complete
files in it; if there are no matches, a message is shown and one can
use <strong>undo</strong> to go back to completion on the previous level, every other
key leaves menu selection (including the other zle functions which are
otherwise special during menu selection)</dd>
<dt>
<strong>undo</strong>
</dt>
<dd>removes matches inserted during the menu selection by one of
the three functions before</dd>
</dl>
<p><strong>down-history</strong>, <strong>down-line-or-history</strong></p>
<p>
<strong>vi-down-line-or-history</strong>, <strong>down-line-or-search</strong> moves the mark one line
down</p>
<p>
<strong>up-history</strong>, <strong>up-line-or-history</strong></p>
<p>
<strong>vi-up-line-or-history</strong>, <strong>up-line-or-search</strong> moves the mark one line up</p>
<dl>
<dt>
<strong>forward-char</strong>, <strong>vi-forward-char</strong>
</dt>
<dd>moves the mark one column right</dd>
<dt>
<strong>backward-char</strong>, <strong>vi-backward-char</strong>
</dt>
<dd>moves the mark one column left</dd>
</dl>
<p><strong>forward-word</strong>, <strong>vi-forward-word</strong></p>
<p>
<strong>vi-forward-word-end</strong>, <strong>emacs-forward-word</strong> moves the mark one screenful
down</p>
<dl>
<dt>
<strong>backward-word</strong>, <strong>vi-backward-word</strong>, <strong>emacs-backward-word</strong>
</dt>
<dd>moves
the mark one screenful up</dd>
<dt>
<strong>vi-forward-blank-word</strong>, <strong>vi-forward-blank-word-end</strong>
</dt>
<dd>moves the mark
to the first line of the next group of matches</dd>
<dt>
<strong>vi-backward-blank-word</strong>
</dt>
<dd>moves the mark to the last line of the
previous group of matches</dd>
<dt>
<strong>beginning-of-history</strong>
</dt>
<dd>moves the mark to the first line</dd>
<dt>
<strong>end-of-history</strong>
</dt>
<dd>moves the mark to the last line</dd>
</dl>
<p><strong>beginning-of-buffer-or-history</strong>, <strong>beginning-of-line</strong></p>
<p>
<strong>beginning-of-line-hist</strong>, <strong>vi-beginning-of-line</strong> moves the mark to the
leftmost column</p>
<p>
<strong>end-of-buffer-or-history</strong>, <strong>end-of-line</strong></p>
<p>
<strong>end-of-line-hist</strong>, <strong>vi-end-of-line</strong> moves the mark to the rightmost
column</p>
<p>
<strong>complete-word</strong>, <strong>menu-complete</strong>, <strong>expand-or-complete</strong></p>
<p>
<strong>expand-or-complete-prefix</strong>, <strong>menu-expand-or-complete</strong> moves the mark to
the next match</p>
<dl>
<dt>
<strong>reverse-menu-complete</strong>
</dt>
<dd>moves the mark to the previous match</dd>
<dt>
<strong>vi-insert</strong>
</dt>
<dd>this toggles between normal and interactive mode; in
interactive mode the keys bound to <strong>self-insert</strong> and
<strong>self-insert-unmeta</strong> insert into the command line as in normal editing
mode but without leaving menu selection; after each character
completion is tried again and the list changes to contain only the new
matches; the completion widgets make the longest unambiguous string be
inserted in the command line and <strong>undo</strong> and <strong>backward-delete-char</strong> go
back to the previous set of matches</dd>
</dl>
<p><strong>history-incremental-search-forward</strong></p>
<p>
<strong>history-incremental-search-backward</strong> this starts incremental searches
in the list of completions displayed; in this mode, <strong>accept-line</strong> only
leaves incremental search, going back to the normal menu selection mode</p>
<p>
All movement functions wrap around at the edges; any other zle function
not listed leaves menu selection and executes that function. It is
possible to make widgets in the above list do the same by using the form
of the widget with a `*.*&#39; in front. For example, the widget
`*.accept-line*&#39; has the effect of leaving menu selection and accepting
the entire command line.</p>
<p>
During this selection the widget uses the keymap <strong>menuselect</strong>. Any key
that is not defined in this keymap or that is bound to <strong>undefined-key</strong>
is looked up in the keymap currently selected. This is used to ensure
that the most important keys used during selection (namely the cursor
keys, return, and TAB) have sensible defaults. However, keys in the
<strong>menuselect</strong> keymap can be modified directly using the <strong>bindkey</strong> builtin
command (see /zshmodules/(1)). For example, to make the return key leave
menu selection without accepting the match currently selected one could
call</p>
<blockquote>
<pre class="example">
bindkey -M menuselect &#39;^M&#39; send-break
</pre>
</blockquote>
<p>
after loading the <strong>zsh/complist</strong> module.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-12" class="outline-2">
<h2 id="headline-12">
THE ZSH/COMPUTIL MODULE
</h2>
<div id="outline-text-headline-12" class="outline-text-2">
<p>The <strong>zsh/computil</strong> module adds several builtin commands that are used by
some of the completion functions in the completion system based on shell
functions (see /zshcompsys/(1) ). Except for <strong>compquote</strong> these builtin
commands are very specialised and thus not very interesting when writing
your own completion functions. In summary, these builtin commands are:</p>
<p>
<strong>comparguments</strong> This is used by the <strong>_arguments</strong> function to do the
argument and command line parsing. Like <strong>compdescribe</strong> it has an option
<strong>-i</strong> to do the parsing and initialize some internal state and various
options to access the state information to decide what should be
completed.</p>
<dl>
<dt>
<strong>compdescribe</strong>
</dt>
<dd>This is used by the <strong>_describe</strong> function to build
the displays for the matches and to get the strings to add as matches
with their options. On the first call one of the options <strong>-i</strong> or <strong>-I</strong>
should be supplied as the first argument. In the first case, display
strings without the descriptions will be generated, in the second
case, the string used to separate the matches from their descriptions
must be given as the second argument and the descriptions (if any)
will be shown. All other arguments are like the definition arguments
to <strong>_describe</strong> itself.

Once <strong>compdescribe</strong> has been called with either the <strong>-i</strong> or the <strong>-I</strong>
option, it can be repeatedly called with the <strong>-g</strong> option and the names
of four parameters as its arguments. This will step through the
different sets of matches and store the value of <strong>compstate[list]</strong> in
the first scalar, the options for <strong>compadd</strong> in the second array, the
matches in the third array, and the strings to be displayed in the
completion listing in the fourth array. The arrays may then be
directly given to <strong>compadd</strong> to register the matches with the
completion code.</dd>
<dt>
<strong>compfiles</strong>
</dt>
<dd>Used by the <strong>_path_files</strong> function to optimize complex
recursive filename generation (globbing). It does three things. With
the <strong>-p</strong> and <strong>-P</strong> options it builds the glob patterns to use,
including the paths already handled and trying to optimize the
patterns with respect to the prefix and suffix from the line and the
match specification currently used. The <strong>-i</strong> option does the directory
tests for the <strong>ignore-parents</strong> style and the <strong>-r</strong> option tests if a
component for some of the matches are equal to the string on the line
and removes all other matches if that is true.</dd>
<dt>
<strong>compgroups</strong>
</dt>
<dd>Used by the <strong>_tags</strong> function to implement the
internals of the <strong>group-order</strong> style. This only takes its arguments as
names of completion groups and creates the groups for it (all six
types: sorted and unsorted, both without removing duplicates, with
removing all duplicates and with removing consecutive duplicates).</dd>
<dt>
<strong>compquote</strong> [ <strong>-p</strong> ] <em>names</em> …
</dt>
<dd>There may be reasons to write
completion functions that have to add the matches using the <strong>-Q</strong>
option to <strong>compadd</strong> and perform quoting themselves. Instead of
interpreting the first character of the <strong>all_quotes</strong> key of the
<strong>compstate</strong> special association and using the <strong>q</strong> flag for parameter
expansions, one can use this builtin command. The arguments are the
names of scalar or array parameters and the values of these parameters
are quoted as needed for the innermost quoting level. If the <strong>-p</strong>
option is given, quoting is done as if there is some prefix before the
values of the parameters, so that a leading equal sign will not be
quoted.

The return status is non-zero in case of an error and zero otherwise.</dd>
</dl>
<p><strong>comptags</strong></p>
<p>
<strong>comptry</strong> These implement the internals of the tags mechanism.</p>
<dl>
<dt>
<strong>compvalues</strong>
</dt>
<dd>Like <strong>comparguments</strong>, but for the <strong>_values</strong> function.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-13" class="outline-2">
<h2 id="headline-13">
THE ZSH/CURSES MODULE
</h2>
<div id="outline-text-headline-13" class="outline-text-2">
<p>The <strong>zsh/curses</strong> module makes available one builtin command and various
parameters.</p>
<div id="outline-container-headline-14" class="outline-3">
<h3 id="headline-14">
Builtin
</h3>
<div id="outline-text-headline-14" class="outline-text-3">
<p><strong>zcurses</strong> <strong>init</strong></p>
<p>
<strong>zcurses</strong> <strong>end</strong></p>
<p>
<strong>zcurses</strong> <strong>addwin</strong> <em>targetwin</em> <em>nlines</em> <em>ncols</em> <em>begin_y</em> <em>begin_x</em> [
<em>parentwin</em> ]</p>
<p>
<strong>zcurses</strong> <strong>delwin</strong> <em>targetwin</em></p>
<p>
<strong>zcurses</strong> <strong>refresh</strong> [ <em>targetwin</em> … ]</p>
<p>
<strong>zcurses</strong> <strong>touch</strong> <em>targetwin</em> …</p>
<p>
<strong>zcurses</strong> <strong>move</strong> <em>targetwin</em> <em>new_y</em> <em>new_x</em></p>
<p>
<strong>zcurses</strong> <strong>clear</strong> <em>targetwin</em> [ <strong>redraw</strong> | <strong>eol</strong> | <strong>bot</strong> ]</p>
<p>
<strong>zcurses</strong> <strong>position</strong> <em>targetwin</em> <em>array</em></p>
<p>
<strong>zcurses</strong> <strong>char</strong> <em>targetwin</em> <em>character</em></p>
<p>
<strong>zcurses</strong> <strong>string</strong> <em>targetwin</em> <em>string</em></p>
<p>
<strong>zcurses</strong> <strong>border</strong> <em>targetwin</em> <em>border</em></p>
<p>
<strong>zcurses</strong> <strong>attr</strong> <em>targetwin</em> [ [*+*|*-*]/attribute/ |
<em>fg_col/*/*/bg_col</em> ] […]</p>
<p>
<strong>zcurses</strong> <strong>bg</strong> <em>targetwin</em> [ [*+*|*-*]/attribute/ | <em>fg_col/*/*/bg_col</em>
​| *@*/char/ ] […]</p>
<p>
<strong>zcurses</strong> <strong>scroll</strong> <em>targetwin</em> [ <strong>on</strong> | <strong>off</strong> | [*+*|*-*]/lines/ ]</p>
<p>
<strong>zcurses</strong> <strong>input</strong> <em>targetwin</em> [ <em>param</em> [ <em>kparam</em> [ <em>mparam</em> ] ] ]</p>
<p>
<strong>zcurses</strong> <strong>mouse</strong> [ <strong>delay</strong> <em>num</em> | [*+*|*-<strong>]*motion</strong> ]</p>
<p>
<strong>zcurses</strong> <strong>timeout</strong> <em>targetwin</em> <em>intval</em></p>
<p>
<strong>zcurses</strong> <strong>querychar</strong> <em>targetwin</em> [ <em>param</em> ]</p>
<p>
<strong>zcurses</strong> <strong>resize</strong> <em>height</em> <em>width</em> [ <strong>endwin</strong> | <strong>nosave</strong> |
<strong>endwin_nosave</strong> ] Manipulate curses windows. All uses of this command
should be bracketed by `*zcurses init*&#39; to initialise use of curses, and
`*zcurses end*&#39; to end it; omitting `*zcurses end*&#39; can cause the
terminal to be in an unwanted state.</p>
<blockquote>
<p>The subcommand <strong>addwin</strong> creates a window with <em>nlines</em> lines and <em>ncols</em>
columns. Its upper left corner will be placed at row <em>begin_y</em> and
column <em>begin_x</em> of the screen. <em>targetwin</em> is a string and refers to
the name of a window that is not currently assigned. Note in particular
the curses convention that vertical values appear before horizontal
values.</p>
<p>
If <strong>addwin</strong> is given an existing window as the final argument, the new
window is created as a subwindow of <em>parentwin</em>. This differs from an
ordinary new window in that the memory of the window contents is shared
with the parent&#39;s memory. Subwindows must be deleted before their
parent. Note that the coordinates of subwindows are relative to the
screen, not the parent, as with other windows.</p>
<p>
Use the subcommand <strong>delwin</strong> to delete a window created with <strong>addwin</strong>.
Note that <strong>end</strong> does <em>not</em> implicitly delete windows, and that <strong>delwin</strong>
does not erase the screen image of the window.</p>
<p>
The window corresponding to the full visible screen is called <strong>stdscr</strong>;
it always exists after `*zcurses init*&#39; and cannot be delete with
<strong>delwin</strong>.</p>
<p>
The subcommand <strong>refresh</strong> will refresh window <em>targetwin</em>; this is
necessary to make any pending changes (such as characters you have
prepared for output with <strong>char</strong>) visible on the screen. <strong>refresh</strong>
without an argument causes the screen to be cleared and redrawn. If
multiple windows are given, the screen is updated once at the end.</p>
<p>
The subcommand <strong>touch</strong> marks the /targetwin/s listed as changed. This is
necessary before <strong>refresh*ing windows if a window that was in front of
another window (which may be *stdscr</strong>) is deleted.</p>
<p>
The subcommand <strong>move</strong> moves the cursor position in <em>targetwin</em> to new
coordinates <em>new_y</em> and <em>new_x</em>. Note that the subcommand <strong>string</strong> (but
not the subcommand <strong>char</strong>) advances the cursor position over the
characters added.</p>
<p>
The subcommand <strong>clear</strong> erases the contents of <em>targetwin</em>. One (and no
more than one) of three options may be specified. With the option
<strong>redraw</strong>, in addition the next <strong>refresh</strong> of <em>targetwin</em> will cause the
screen to be cleared and repainted. With the option <strong>eol</strong>, <em>targetwin</em>
is only cleared to the end of the current cursor line. With the option
<strong>bot</strong>, <em>targetwin</em> is cleared to the end of the window, i.e everything
to the right and below the cursor is cleared.</p>
<p>
The subcommand <strong>position</strong> writes various positions associated with
<em>targetwin</em> into the array named <em>array</em>. These are, in order:</p>
<dl>
<dt>
-
</dt>
<dd>The y and x coordinates of the cursor relative to the top left of
<em>targetwin</em></dd>
<dt>
-
</dt>
<dd>The y and x coordinates of the top left of <em>targetwin</em> on the
screen</dd>
<dt>
-
</dt>
<dd>The size of <em>targetwin</em> in y and x dimensions.</dd>
</dl>
<p>Outputting characters and strings are achieved by <strong>char</strong> and <strong>string</strong>
respectively.</p>
<p>
To draw a border around window <em>targetwin</em>, use <strong>border</strong>. Note that the
border is not subsequently handled specially: in other words, the border
is simply a set of characters output at the edge of the window. Hence it
can be overwritten, can scroll off the window, etc.</p>
<p>
The subcommand <strong>attr</strong> will set <em>targetwin</em>&#39;s attributes or
foreground/background color pair for any successive character output.
Each <em>attribute</em> given on the line may be prepended by a <strong>+</strong> to set or a
<strong>-</strong> to unset that attribute; <strong>+</strong> is assumed if absent. The attributes
supported are <strong>blink</strong>, <strong>bold</strong>, <strong>dim</strong>, <strong>reverse</strong>, <strong>standout</strong>, and
<strong>underline</strong>.</p>
<p>
Each <em>fg_col/*/*/bg_col</em> attribute (to be read as `/fg_col/ on
<em>bg_col</em>&#39;) sets the foreground and background color for character
output. The color <strong>default</strong> is sometimes available (in particular if the
library is ncurses), specifying the foreground or background color with
which the terminal started. The color pair <strong>default/default</strong> is always
available. To use more than the 8 named colors (red, green, etc.)
construct the <em>fg_col/*/*/bg_col</em> pairs where <em>fg_col</em> and <em>bg_col</em> are
decimal integers, e.g <strong>128/200</strong>. The maximum color value is 254 if the
terminal supports 256 colors.</p>
<p>
<strong>bg</strong> overrides the color and other attributes of all characters in the
window. Its usual use is to set the background initially, but it will
overwrite the attributes of any characters at the time when it is
called. In addition to the arguments allowed with <strong>attr</strong>, an argument
*@*/char/ specifies a character to be shown in otherwise blank areas of
the window. Owing to limitations of curses this cannot be a multibyte
character (use of ASCII characters only is recommended). As the
specified set of attributes override the existing background, turning
attributes off in the arguments is not useful, though this does not
cause an error.</p>
<p>
The subcommand <strong>scroll</strong> can be used with <strong>on</strong> or <strong>off</strong> to enabled or
disable scrolling of a window when the cursor would otherwise move below
the window due to typing or output. It can also be used with a positive
or negative integer to scroll the window up or down the given number of
lines without changing the current cursor position (which therefore
appears to move in the opposite direction relative to the window). In
the second case, if scrolling is <strong>off</strong> it is temporarily turned <strong>on</strong> to
allow the window to be scrolled.</p>
<p>
The subcommand <strong>input</strong> reads a single character from the window without
echoing it back. If <em>param</em> is supplied the character is assigned to the
parameter <em>param</em>, else it is assigned to the parameter <strong>REPLY</strong>.</p>
<p>
If both <em>param</em> and <em>kparam</em> are supplied, the key is read in `keypad&#39;
mode. In this mode special keys such as function keys and arrow keys
return the name of the key in the parameter <em>kparam</em>. The key names are
the macros defined in the <strong>curses.h</strong> or <strong>ncurses.h</strong> with the prefix
`*KEY_*&#39; removed; see also the description of the parameter
<strong>zcurses_keycodes</strong> below. Other keys cause a value to be set in <em>param</em>
as before. On a successful return only one of <em>param</em> or <em>kparam</em>
contains a non-empty string; the other is set to an empty string.</p>
<p>
If <em>mparam</em> is also supplied, <strong>input</strong> attempts to handle mouse input.
This is only available with the ncurses library; mouse handling can be
detected by checking for the exit status of `*zcurses mouse*&#39; with no
arguments. If a mouse button is clicked (or double- or triple-clicked,
or pressed or released with a configurable delay from being clicked)
then <em>kparam</em> is set to the string <strong>MOUSE</strong>, and <em>mparam</em> is set to an
array consisting of the following elements:</p>
<dl>
<dt>
-
</dt>
<dd>An identifier to discriminate different input devices; this is
only rarely useful.</dd>
<dt>
-
</dt>
<dd>The x, y and z coordinates of the mouse click relative to the
full screen, as three elements in that order (i.e. the y coordinate
is, unusually, after the x coordinate). The z coordinate is only
available for a few unusual input devices and is otherwise set to
zero.</dd>
<dt>
-
</dt>
<dd>Any events that occurred as separate items; usually there will be
just one. An event consists of <strong>PRESSED</strong>, <strong>RELEASED</strong>, <strong>CLICKED</strong>,
<strong>DOUBLE_CLICKED</strong> or <strong>TRIPLE_CLICKED</strong> followed immediately (in the same
element) by the number of the button.</dd>
<dt>
-
</dt>
<dd>If the shift key was pressed, the string <strong>SHIFT</strong>.</dd>
<dt>
-
</dt>
<dd>If the control key was pressed, the string <strong>CTRL</strong>.</dd>
<dt>
-
</dt>
<dd>If the alt key was pressed, the string <strong>ALT</strong>.</dd>
</dl>
<p>Not all mouse events may be passed through to the terminal window; most
terminal emulators handle some mouse events themselves. Note that the
ncurses manual implies that using input both with and without mouse
handling may cause the mouse cursor to appear and disappear.</p>
<p>
The subcommand <strong>mouse</strong> can be used to configure the use of the mouse.
There is no window argument; mouse options are global. `*zcurses mouse*&#39;
with no arguments returns status 0 if mouse handling is possible, else
status 1. Otherwise, the possible arguments (which may be combined on
the same command line) are as follows. <strong>delay</strong> <em>num</em> sets the maximum
delay in milliseconds between press and release events to be considered
as a click; the value 0 disables click resolution, and the default is
one sixth of a second. <strong>motion</strong> proceeded by an optional `*+*&#39; (the
default) or <strong>-</strong> turns on or off reporting of mouse motion in addition to
clicks, presses and releases, which are always reported. However, it
appears reports for mouse motion are not currently implemented.</p>
<p>
The subcommand <strong>timeout</strong> specifies a timeout value for input from
<em>targetwin</em>. If <em>intval</em> is negative, `*zcurses input*&#39; waits
indefinitely for a character to be typed; this is the default. If
<em>intval</em> is zero, `*zcurses input*&#39; returns immediately; if there is
typeahead it is returned, else no input is done and status 1 is
returned. If <em>intval</em> is positive, `*zcurses input*&#39; waits <em>intval</em>
milliseconds for input and if there is none at the end of that period
returns status 1.</p>
<p>
The subcommand <strong>querychar</strong> queries the character at the current cursor
position. The return values are stored in the array named <em>param</em> if
supplied, else in the array <strong>reply</strong>. The first value is the character
(which may be a multibyte character if the system supports them); the
second is the color pair in the usual <em>fg_col/*/*/bg_col</em> notation, or
<strong>0</strong> if color is not supported. Any attributes other than color that
apply to the character, as set with the subcommand <strong>attr</strong>, appear as
additional elements.</p>
<p>
The subcommand <strong>resize</strong> resizes <strong>stdscr</strong> and all windows to given
dimensions (windows that stick out from the new dimensions are resized
down). The underlying curses extension (<strong>resize_term call</strong>) can be
unavailable. To verify, zeroes can be used for <em>height</em> and <em>width</em>. If
the result of the subcommand is <strong>0</strong>, resize_term is available (<strong>2</strong>
otherwise). Tests show that resizing can be normally accomplished by
calling <strong>zcurses end</strong> and <strong>zcurses refresh</strong>. The <strong>resize</strong> subcommand is
provided for versatility. Multiple system configurations have been
checked and <strong>zcurses end</strong> and <strong>zcurses</strong> refresh are still needed for
correct terminal state after resize. To invoke them with <strong>resize</strong>, use
<em>endwin</em> argument. Using <em>nosave</em> argument will cause new terminal state
to not be saved internally by <strong>zcurses</strong>. This is also provided for
versatility and should normally be not needed.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-15" class="outline-3">
<h3 id="headline-15">
Parameters
</h3>
<div id="outline-text-headline-15" class="outline-text-3">
<p><strong>ZCURSES_COLORS</strong> Readonly integer. The maximum number of colors the
terminal supports. This value is initialised by the curses library and
is not available until the first time <strong>zcurses init</strong> is run.</p>
<dl>
<dt>
<strong>ZCURSES_COLOR_PAIRS</strong>
</dt>
<dd>Readonly integer. The maximum number of color
pairs <em>fg_col/*/*/bg_col</em> that may be defined in `*zcurses attr*&#39;
commands; note this limit applies to all color pairs that have been
used whether or not they are currently active. This value is
initialised by the curses library and is not available until the first
time <strong>zcurses</strong> init is run.</dd>
<dt>
<strong>zcurses_attrs</strong>
</dt>
<dd>Readonly array. The attributes supported by
<strong>zsh/curses</strong>; available as soon as the module is loaded.</dd>
<dt>
<strong>zcurses_colors</strong>
</dt>
<dd>Readonly array. The colors supported by
<strong>zsh/curses</strong>; available as soon as the module is loaded.</dd>
<dt>
<strong>zcurses_keycodes</strong>
</dt>
<dd>Readonly array. The values that may be returned
in the second parameter supplied to `*zcurses input*&#39; in the order in
which they are defined internally by curses. Not all function keys are
listed, only <strong>F0</strong>; curses reserves space for <strong>F0</strong> up to <strong>F63</strong>.</dd>
<dt>
<strong>zcurses_windows</strong>
</dt>
<dd>Readonly array. The current list of windows, i.e.
all windows that have been created with `*zcurses addwin*&#39; and not
removed with `*zcurses delwin*&#39;.</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-16" class="outline-2">
<h2 id="headline-16">
THE ZSH/DATETIME MODULE
</h2>
<div id="outline-text-headline-16" class="outline-text-2">
<p>The <strong>zsh/datetime</strong> module makes available one builtin command:</p>
<p>
<strong>strftime</strong> [ <strong>-s</strong> <em>scalar</em> | <strong>-n</strong> ] <em>format</em> [ <em>epochtime</em> [
<em>nanoseconds</em> ] ]</p>
<p>
<strong>strftime</strong> <strong>-r</strong> [ <strong>-q</strong> ] [ <strong>-s</strong> <em>scalar</em> | <strong>-n</strong> ] <em>format</em> <em>timestring</em>
Output the date in the <em>format</em> specified. With no <em>epochtime</em>, the
current system date/time is used; optionally, <em>epochtime</em> may be used to
specify the number of seconds since the epoch, and <em>nanoseconds</em> may
additionally be used to specify the number of nanoseconds past the
second (otherwise that number is assumed to be 0). See /strftime/(3) for
details. The zsh extensions described in the section EXPANSION OF PROMPT
SEQUENCES in /zshmisc/(1) are also available.</p>
<blockquote>
<p><strong>-n</strong> Suppress printing a newline after the formatted string.</p>
<dl>
<dt>
<strong>-q</strong>
</dt>
<dd>Run quietly; suppress printing of all error messages described
below. Errors for invalid <em>epochtime</em> values are always printed.</dd>
<dt>
<strong>-r</strong>
</dt>
<dd>With the option <strong>-r</strong> (reverse), use <em>format</em> to parse the
input string <em>timestring</em> and output the number of seconds since the
epoch at which the time occurred. The parsing is implemented by the
system function <strong>strptime</strong>; see /strptime/(3). This means that zsh
format extensions are not available, but for reverse lookup they are
not required.

In most implementations of <strong>strftime</strong> any timezone in the <em>timestring</em>
is ignored and the local timezone declared by the <strong>TZ</strong> environment
variable is used; other parameters are set to zero if not present.

If <em>timestring</em> does not match <em>format</em> the command returns status 1
and prints an error message. If <em>timestring</em> matches <em>format</em> but not
all characters in <em>timestring</em> were used, the conversion succeeds but
also prints an error message.

If either of the system functions <strong>strptime</strong> or <strong>mktime</strong> is not
available, status 2 is returned and an error message is printed.</dd>
<dt>
<strong>-s</strong> <em>scalar</em>
</dt>
<dd>Assign the date string (or epoch time in seconds if
<strong>-r</strong> is given) to <em>scalar</em> instead of printing it.</dd>
</dl>
<p>Note that depending on the system&#39;s declared integral time type,
<strong>strftime</strong> may produce incorrect results for epoch times greater than
2147483647 which corresponds to 2038-01-19 03:14:07 +0000.</p>
</blockquote>
<p>
The <strong>zsh/datetime</strong> module makes available several parameters; all are
readonly:</p>
<p>
<strong>EPOCHREALTIME</strong> A floating point value representing the number of
seconds since the epoch. The notional accuracy is to nanoseconds if the
<strong>clock_gettime</strong> call is available and to microseconds otherwise, but in
practice the range of double precision floating point and shell
scheduling latencies may be significant effects.</p>
<dl>
<dt>
<strong>EPOCHSECONDS</strong>
</dt>
<dd>An integer value representing the number of seconds
since the epoch.</dd>
<dt>
<strong>epochtime</strong>
</dt>
<dd>
<p>An array value containing the number of seconds since
the epoch in the first element and the remainder of the time since the
epoch in nanoseconds in the second element. To ensure the two elements
are consistent the array should be copied or otherwise referenced as a
single substitution before the values are used. The following idiom
may be used:</p>
<blockquote>
<pre class="example">
for secs nsecs in $epochtime; do
  ...
done
</pre>
</blockquote>
</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-17" class="outline-2">
<h2 id="headline-17">
THE ZSH/DB/GDBM MODULE
</h2>
<div id="outline-text-headline-17" class="outline-text-2">
<p>The <strong>zsh/db/gdbm</strong> module is used to create &#34;tied&#34; associative arrays
that interface to database files. If the GDBM interface is not
available, the builtins defined by this module will report an error.
This module is also intended as a prototype for creating additional
database interfaces, so the <strong>ztie</strong> builtin may move to a more generic
module in the future.</p>
<p>
The builtins in this module are:</p>
<p>
<strong>ztie -d db/gdbm -f</strong> <em>filename</em> [ <strong>-r</strong> ] <em>arrayname</em> Open the GDBM
database identified by <em>filename</em> and, if successful, create the
associative array <em>arrayname</em> linked to the file. To create a local tied
array, the parameter must first be declared, so commands similar to the
following would be executed inside a function scope:</p>
<blockquote>
<blockquote>
<pre class="example">
local -A sampledb
ztie -d db/gdbm -f sample.gdbm sampledb
</pre>
</blockquote>
<p>
The <strong>-r</strong> option opens the database file for reading only, creating a
parameter with the readonly attribute. Without this option, using
`*ztie*&#39; on a file for which the user does not have write permission is
an error. If writable, the database is opened synchronously so fields
changed in <em>arrayname</em> are immediately written to <em>filename</em>.</p>
<p>
Changes to the file modes <em>filename</em> after it has been opened do not
alter the state of <em>arrayname</em>, but `*typeset -r* <em>arrayname</em>&#39; works as
expected.</p>
</blockquote>
<dl>
<dt>
<strong>zuntie</strong> [ <strong>-u</strong> ] <em>arrayname</em> …
</dt>
<dd>Close the GDBM database
associated with each <em>arrayname</em> and then unset the parameter. The
<strong>-u</strong> option forces an unset of parameters made readonly with `*ztie
-r*&#39;.

This happens automatically if the parameter is explicitly unset or its
local scope (function) ends. Note that a readonly parameter may not be
explicitly unset, so the only way to unset a global parameter created
with `*ztie -r*&#39; is to use `*zuntie -u*&#39;.</dd>
<dt>
<strong>zgdbmpath</strong> <em>parametername</em>
</dt>
<dd>Put path to database file assigned to
<em>parametername</em> into <strong>REPLY</strong> scalar.</dd>
<dt>
<strong>zgdbm_tied</strong>
</dt>
<dd>Array holding names of all tied parameters.</dd>
</dl>
<p>The fields of an associative array tied to GDBM are neither cached nor
otherwise stored in memory, they are read from or written to the
database on each reference. Thus, for example, the values in a readonly
array may be changed by a second writer of the same database file.</p>
</div>
</div>
<div id="outline-container-headline-18" class="outline-2">
<h2 id="headline-18">
THE ZSH/DELTOCHAR MODULE
</h2>
<div id="outline-text-headline-18" class="outline-text-2">
<p>The <strong>zsh/deltochar</strong> module makes available two ZLE functions:</p>
<p>
<strong>delete-to-char</strong> Read a character from the keyboard, and delete from the
cursor position up to and including the next (or, with repeat count <em>n</em>,
the /n/th) instance of that character. Negative repeat counts mean
delete backwards.</p>
<dl>
<dt>
<strong>zap-to-char</strong>
</dt>
<dd>This behaves like <strong>delete-to-char</strong>, except that the
final occurrence of the character itself is not deleted.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-19" class="outline-2">
<h2 id="headline-19">
THE ZSH/EXAMPLE MODULE
</h2>
<div id="outline-text-headline-19" class="outline-text-2">
<p>The <strong>zsh/example</strong> module makes available one builtin command:</p>
<p>
<strong>example</strong> [ <strong>-flags</strong> ] [ <em>args</em> … ] Displays the flags and arguments
it is invoked with.</p>
<p>
The purpose of the module is to serve as an example of how to write a
module.</p>
</div>
</div>
<div id="outline-container-headline-20" class="outline-2">
<h2 id="headline-20">
THE ZSH/FILES MODULE
</h2>
<div id="outline-text-headline-20" class="outline-text-2">
<p>The <strong>zsh/files</strong> module makes available some common commands for file
manipulation as builtins; these commands are probably not needed for
many normal situations but can be useful in emergency recovery
situations with constrained resources. The commands do not implement all
features now required by relevant standards committees.</p>
<p>
For all commands, a variant beginning <strong>zf_</strong> is also available and loaded
automatically. Using the features capability of zmodload will let you
load only those names you want. Note that it&#39;s possible to load only the
builtins with zsh-specific names using the following command:</p>
<blockquote>
<pre class="example">
zmodload -m -F zsh/files b:zf_\*
</pre>
</blockquote>
<p>
The commands loaded by default are:</p>
<p>
<strong>chgrp</strong> [ <strong>-hRs</strong> ] <em>group</em> <em>filename</em> … Changes group of files
specified. This is equivalent to <strong>chown</strong> with a <em>user-spec</em> argument of
`*:*/group/&#39;.</p>
<dl>
<dt>
<strong>chmod</strong> [ <strong>-Rs</strong> ] <em>mode</em> <em>filename</em> …
</dt>
<dd>Changes mode of files
specified.

The specified <em>mode</em> must be in octal.

The <strong>-R</strong> option causes <strong>chmod</strong> to recursively descend into
directories, changing the mode of all files in the directory after
changing the mode of the directory itself.

The <strong>-s</strong> option is a zsh extension to <strong>chmod</strong> functionality. It
enables paranoid behaviour, intended to avoid security problems
involving a <strong>chmod</strong> being tricked into affecting files other than the
ones intended. It will refuse to follow symbolic links, so that (for
example) ``*chmod 600 /tmp/foo/passwd*&#39;&#39; can&#39;t accidentally chmod
<strong>/etc/passwd</strong> if <strong>/tmp/foo</strong> happens to be a link to <strong>/etc</strong>. It will
also check where it is after leaving directories, so that a recursive
chmod of a deep directory tree can&#39;t end up recursively chmoding
<strong>/usr</strong> as a result of directories being moved up the tree.</dd>
<dt>
<strong>chown</strong> [ <strong>-hRs</strong> ] <em>user-spec</em> <em>filename</em> …
</dt>
<dd>
<p>Changes ownership and
group of files specified.</p>
<p>
The <em>user-spec</em> can be in four forms:</p>
<dl>
<dt>
<em>user</em>
</dt>
<dd>change owner to <em>user</em>; do not change group</dd>
<dt>
/user/*::*
</dt>
<dd>change owner to <em>user</em>; do not change group</dd>
<dt>
/user/*:*
</dt>
<dd>change owner to <em>user</em>; change group to <em>user</em>&#39;s
primary group</dd>
<dt>
<em>user/*:*/group</em>
</dt>
<dd>change owner to <em>user</em>; change group to <em>group</em></dd>
<dt>
*:*/group/
</dt>
<dd>do not change owner; change group to <em>group</em></dd>
</dl>
<p>In each case, the `*:*&#39; may instead be a `*.*&#39;. The rule is that if
there is a `*:*&#39; then the separator is `*:*&#39;, otherwise if there is a
`*.*&#39; then the separator is `*.*&#39;, otherwise there is no separator.</p>
<p>
Each of <em>user</em> and <em>group</em> may be either a username (or group name, as
appropriate) or a decimal user ID (group ID). Interpretation as a name
takes precedence, if there is an all-numeric username (or group name).</p>
<p>
If the target is a symbolic link, the <strong>-h</strong> option causes <strong>chown</strong> to
set the ownership of the link instead of its target.</p>
<p>
The <strong>-R</strong> option causes <strong>chown</strong> to recursively descend into
directories, changing the ownership of all files in the directory
after changing the ownership of the directory itself.</p>
<p>
The <strong>-s</strong> option is a zsh extension to <strong>chown</strong> functionality. It
enables paranoid behaviour, intended to avoid security problems
involving a <strong>chown</strong> being tricked into affecting files other than the
ones intended. It will refuse to follow symbolic links, so that (for
example) ``*chown luser /tmp/foo/passwd*&#39;&#39; can&#39;t accidentally chown
<strong>/etc/passwd</strong> if <strong>/tmp/foo</strong> happens to be a link to <strong>/etc</strong>. It will
also check where it is after leaving directories, so that a recursive
chown of a deep directory tree can&#39;t end up recursively chowning
<strong>/usr</strong> as a result of directories being moved up the tree.</p>
</dd>
</dl>
<p><strong>ln</strong> [ <strong>-dfhins</strong> ] <em>filename</em> <em>dest</em></p>
<p>
<strong>ln</strong> [ <strong>-dfhins</strong> ] <em>filename</em> … <em>dir</em> Creates hard (or, with <strong>-s</strong>,
symbolic) links. In the first form, the specified <em>dest/ination is
created, as a link to the specified /filename</em>. In the second form, each
of the /filename/s is taken in turn, and linked to a pathname in the
specified /dir/ectory that has the same last pathname component.</p>
<blockquote>
<p>Normally, <strong>ln</strong> will not attempt to create hard links to directories.
This check can be overridden using the <strong>-d</strong> option. Typically only the
super-user can actually succeed in creating hard links to directories.
This does not apply to symbolic links in any case.</p>
<p>
By default, existing files cannot be replaced by links. The <strong>-i</strong> option
causes the user to be queried about replacing existing files. The <strong>-f</strong>
option causes existing files to be silently deleted, without querying.
<strong>-f</strong> takes precedence.</p>
<p>
The <strong>-h</strong> and <strong>-n</strong> options are identical and both exist for
compatibility; either one indicates that if the target is a symlink then
it should not be dereferenced. Typically this is used in combination
with <strong>-sf</strong> so that if an existing link points to a directory then it
will be removed, instead of followed. If this option is used with
multiple filenames and the target is a symbolic link pointing to a
directory then the result is an error.</p>
</blockquote>
<dl>
<dt>
<strong>mkdir</strong> [ <strong>-p</strong> ] [ <strong>-m</strong> <em>mode</em> ] <em>dir</em> …
</dt>
<dd>Creates directories.
With the <strong>-p</strong> option, non-existing parent directories are first
created if necessary, and there will be no complaint if the directory
already exists. The <strong>-m</strong> option can be used to specify (in octal) a
set of file permissions for the created directories, otherwise mode
777 modified by the current <strong>umask</strong> (see /umask/(2)) is used.</dd>
</dl>
<p><strong>mv</strong> [ <strong>-fi</strong> ] <em>filename</em> <em>dest</em></p>
<p>
<strong>mv</strong> [ <strong>-fi</strong> ] <em>filename</em> … <em>dir</em> Moves files. In the first form, the
specified <em>filename</em> is moved to the specified /dest/ination. In the
second form, each of the /filename/s is taken in turn, and moved to a
pathname in the specified /dir/ectory that has the same last pathname
component.</p>
<blockquote>
<p>By default, the user will be queried before replacing any file that the
user cannot write to, but writable files will be silently removed. The
<strong>-i</strong> option causes the user to be queried about replacing any existing
files. The <strong>-f</strong> option causes any existing files to be silently deleted,
without querying. <strong>-f</strong> takes precedence.</p>
<p>
Note that this <strong>mv</strong> will not move files across devices. Historical
versions of <strong>mv</strong>, when actual renaming is impossible, fall back on
copying and removing files; if this behaviour is desired, use <strong>cp</strong> and
<strong>rm</strong> manually. This may change in a future version.</p>
</blockquote>
<dl>
<dt>
<strong>rm</strong> [ <strong>-dfiRrs</strong> ] <em>filename</em> …
</dt>
<dd>Removes files and directories
specified.

Normally, <strong>rm</strong> will not remove directories (except with the <strong>-R</strong> or
<strong>-r</strong> options). The <strong>-d</strong> option causes <strong>rm</strong> to try removing directories
with <strong>unlink</strong> (see /unlink/(2)), the same method used for files.
Typically only the super-user can actually succeed in unlinking
directories in this way. <strong>-d</strong> takes precedence over <strong>-R</strong> and <strong>-r</strong>.

By default, the user will be queried before removing any file that the
user cannot write to, but writable files will be silently removed. The
<strong>-i</strong> option causes the user to be queried about removing any files.
The <strong>-f</strong> option causes files to be silently deleted, without querying,
and suppresses all error indications. <strong>-f</strong> takes precedence.

The <strong>-R</strong> and <strong>-r</strong> options cause <strong>rm</strong> to recursively descend into
directories, deleting all files in the directory before removing the
directory with the <strong>rmdir</strong> system call (see /rmdir/(2)).

The <strong>-s</strong> option is a zsh extension to <strong>rm</strong> functionality. It enables
paranoid behaviour, intended to avoid common security problems
involving a root-run <strong>rm</strong> being tricked into removing files other than
the ones intended. It will refuse to follow symbolic links, so that
(for example) ``*rm /tmp/foo/passwd*&#39;&#39; can&#39;t accidentally remove
<strong>/etc/passwd</strong> if <strong>/tmp/foo</strong> happens to be a link to <strong>/etc</strong>. It will
also check where it is after leaving directories, so that a recursive
removal of a deep directory tree can&#39;t end up recursively removing
<strong>/usr</strong> as a result of directories being moved up the tree.</dd>
<dt>
<strong>rmdir</strong> <em>dir</em> …
</dt>
<dd>Removes empty directories specified.</dd>
<dt>
<strong>sync</strong>
</dt>
<dd>Calls the system call of the same name (see /sync/(2)),
which flushes dirty buffers to disk. It might return before the I/O
has actually been completed.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-21" class="outline-2">
<h2 id="headline-21">
THE ZSH/LANGINFO MODULE
</h2>
<div id="outline-text-headline-21" class="outline-text-2">
<p>The <strong>zsh/langinfo</strong> module makes available one parameter:</p>
<p>
<strong>langinfo</strong> An associative array that maps langinfo elements to their
values.</p>
<blockquote>
<p>Your implementation may support a number of the following keys:</p>
<p>
<strong>CODESET</strong>, <strong>D_T_FMT</strong>, <strong>D_FMT</strong>, <strong>T_FMT</strong>, <strong>RADIXCHAR</strong>, <strong>THOUSEP</strong>,
<strong>YESEXPR</strong>, <strong>NOEXPR</strong>, <strong>CRNCYSTR</strong>, <strong>ABDAY<sub>1..7</sub></strong>, <strong>DAY<sub>1..7</sub></strong>,
<strong>ABMON<sub>1..12</sub></strong>, <strong>MON<sub>1..12</sub></strong>, <strong>T_FMT_AMPM</strong>, <strong>AM_STR</strong>, <strong>PM_STR</strong>, <strong>ERA</strong>,
<strong>ERA_D_FMT</strong>, <strong>ERA_D_T_FMT</strong>, <strong>ERA_T_FMT</strong>, <strong>ALT_DIGITS</strong></p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-22" class="outline-2">
<h2 id="headline-22">
THE ZSH/MAPFILE MODULE
</h2>
<div id="outline-text-headline-22" class="outline-text-2">
<p>The <strong>zsh/mapfile</strong> module provides one special associative array
parameter of the same name.</p>
<p>
<strong>mapfile</strong> This associative array takes as keys the names of files; the
resulting value is the content of the file. The value is treated
identically to any other text coming from a parameter. The value may
also be assigned to, in which case the file in question is written
(whether or not it originally existed); or an element may be unset,
which will delete the file in question. For example, `*vared
&#39;mapfile[myfile]&#39;<strong>&#39; works as expected, editing the file `*myfile</strong>&#39;.</p>
<blockquote>
<p>When the array is accessed as a whole, the keys are the names of files
in the current directory, and the values are empty (to save a huge
overhead in memory). Thus <strong>${(k)mapfile}</strong> has the same effect as the
glob operator <strong>*(D)</strong>, since files beginning with a dot are not special.
Care must be taken with expressions such as <strong>rm ${(k)mapfile}</strong>, which
will delete every file in the current directory without the usual `*rm
​**&#39; test.</p>
<p>
The parameter <strong>mapfile</strong> may be made read-only; in that case, files
referenced may not be written or deleted.</p>
<p>
A file may conveniently be read into an array as one line per element
with the form `/array/*=(&#34;${(f@)mapfile[*/filename/*]}&#34;)*&#39;. The double
quotes and the `*@*&#39; are necessary to prevent empty lines from being
removed. Note that if the file ends with a newline, the shell will split
on the final newline, generating an additional empty field; this can be
suppressed by using
`/array/*=(&#34;${(f@)${mapfile[*/filename/*]%$&#39;\n&#39;}}&#34;)*&#39;.</p>
</blockquote>
<div id="outline-container-headline-23" class="outline-3">
<h3 id="headline-23">
Limitations
</h3>
<div id="outline-text-headline-23" class="outline-text-3">
<p>Although reading and writing of the file in question is efficiently
handled, zsh&#39;s internal memory management may be arbitrarily baroque;
however, <strong>mapfile</strong> is usually very much more efficient than anything
involving a loop. Note in particular that the whole contents of the file
will always reside physically in memory when accessed (possibly multiple
times, due to standard parameter substitution operations). In
particular, this means handling of sufficiently long files (greater than
the machine&#39;s swap space, or than the range of the pointer type) will be
incorrect.</p>
<p>
No errors are printed or flagged for non-existent, unreadable, or
unwritable files, as the parameter mechanism is too low in the shell
execution hierarchy to make this convenient.</p>
<p>
It is unfortunate that the mechanism for loading modules does not yet
allow the user to specify the name of the shell parameter to be given
the special behaviour.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-24" class="outline-2">
<h2 id="headline-24">
THE ZSH/MATHFUNC MODULE
</h2>
<div id="outline-text-headline-24" class="outline-text-2">
<p>The <strong>zsh/mathfunc</strong> module provides standard mathematical functions for
use when evaluating mathematical formulae. The syntax agrees with normal
C and FORTRAN conventions, for example,</p>
<blockquote>
<pre class="example">
(( f = sin(0.3) ))
</pre>
</blockquote>
<p>
assigns the sine of 0.3 to the parameter f.</p>
<p>
Most functions take floating point arguments and return a floating point
value. However, any necessary conversions from or to integer type will
be performed automatically by the shell. Apart from <strong>atan</strong> with a second
argument and the <strong>abs</strong>, <strong>int</strong> and <strong>float</strong> functions, all functions
behave as noted in the manual page for the corresponding C function,
except that any arguments out of range for the function in question will
be detected by the shell and an error reported.</p>
<p>
The following functions take a single floating point argument: <strong>acos</strong>,
<strong>acosh</strong>, <strong>asin</strong>, <strong>asinh</strong>, <strong>atan</strong>, <strong>atanh</strong>, <strong>cbrt</strong>, <strong>ceil</strong>, <strong>cos</strong>,
<strong>cosh</strong>, <strong>erf</strong>, <strong>erfc</strong>, <strong>exp</strong>, <strong>expm1</strong>, <strong>fabs</strong>, <strong>floor</strong>, <strong>gamma</strong>, <strong>j0</strong>,
<strong>j1</strong>, <strong>lgamma</strong>, <strong>log</strong>, <strong>log10</strong>, <strong>log1p</strong>, <strong>log2</strong>, <strong>logb</strong>, <strong>sin</strong>, <strong>sinh</strong>,
<strong>sqrt</strong>, <strong>tan</strong>, <strong>tanh</strong>, <strong>y0</strong>, <strong>y1</strong>. The <strong>atan</strong> function can optionally
take a second argument, in which case it behaves like the C function
<strong>atan2</strong>. The <strong>ilogb</strong> function takes a single floating point argument,
but returns an integer.</p>
<p>
The function <strong>signgam</strong> takes no arguments, and returns an integer, which
is the C variable of the same name, as described in /gamma/(3). Note
that it is therefore only useful immediately after a call to <strong>gamma</strong> or
<strong>lgamma</strong>. Note also that `*signgam()*&#39; and `*signgam*&#39; are distinct
expressions.</p>
<p>
The functions <strong>min</strong>, <strong>max</strong>, and <strong>sum</strong> are defined not in this module but
in the <strong>zmathfunc</strong> autoloadable function, described in the section
`Mathematical Functions&#39; in /zshcontrib/(1).</p>
<p>
The following functions take two floating point arguments: <strong>copysign</strong>,
<strong>fmod</strong>, <strong>hypot</strong>, <strong>nextafter</strong>.</p>
<p>
The following take an integer first argument and a floating point second
argument: <strong>jn</strong>, <strong>yn</strong>.</p>
<p>
The following take a floating point first argument and an integer second
argument: <strong>ldexp</strong>, <strong>scalb</strong>.</p>
<p>
The function <strong>abs</strong> does not convert the type of its single argument; it
returns the absolute value of either a floating point number or an
integer. The functions <strong>float</strong> and <strong>int</strong> convert their arguments into a
floating point or integer value (by truncation) respectively.</p>
<p>
Note that the C <strong>pow</strong> function is available in ordinary math evaluation
as the `****&#39; operator and is not provided here.</p>
<p>
The function <strong>rand48</strong> is available if your system&#39;s mathematical library
has the function <strong>erand48(3)</strong>. It returns a pseudo-random floating point
number between 0 and 1. It takes a single string optional argument.</p>
<p>
If the argument is not present, the random number seed is initialised by
three calls to the <strong>rand(3)</strong> function — this produces the same random
numbers as the next three values of <strong>$RANDOM</strong>.</p>
<p>
If the argument is present, it gives the name of a scalar parameter
where the current random number seed will be stored. On the first call,
the value must contain at least twelve hexadecimal digits (the remainder
of the string is ignored), or the seed will be initialised in the same
manner as for a call to <strong>rand48</strong> with no argument. Subsequent calls to
*rand48*(<em>param</em>) will then maintain the seed in the parameter <em>param</em>
as a string of twelve hexadecimal digits, with no base signifier. The
random number sequences for different parameters are completely
independent, and are also independent from that used by calls to
<strong>rand48</strong> with no argument.</p>
<p>
For example, consider</p>
<blockquote>
<pre class="example">
print $(( rand48(seed) ))
print $(( rand48() ))
print $(( rand48(seed) ))
</pre>
</blockquote>
<p>
Assuming <strong>$seed</strong> does not exist, it will be initialised by the first
call. In the second call, the default seed is initialised; note,
however, that because of the properties of <strong>rand()</strong> there is a
correlation between the seeds used for the two initialisations, so for
more secure uses, you should generate your own 12-byte seed. The third
call returns to the same sequence of random numbers used in the first
call, unaffected by the intervening <strong>rand48()</strong>.</p>
</div>
</div>
<div id="outline-container-headline-25" class="outline-2">
<h2 id="headline-25">
THE ZSH/NEARCOLOR MODULE
</h2>
<div id="outline-text-headline-25" class="outline-text-2">
<p>The <strong>zsh/nearcolor</strong> module replaces colours specified as hex triplets
with the nearest colour in the 88 or 256 colour palettes that are widely
used by terminal emulators. By default, 24-bit true colour escape codes
are generated when colours are specified using hex triplets. These are
not supported by all terminals. The purpose of this module is to make it
easier to define colour preferences in a form that can work across a
range of terminal emulators.</p>
<p>
Aside from the default colour, the ANSI standard for terminal escape
codes provides for eight colours. The bright attribute brings this to
sixteen. These basic colours are commonly used in terminal applications
due to being widely supported. Expanded 88 and 256 colour palettes are
also common and, while the first sixteen colours vary somewhat between
terminals and configurations, these add a generally consistent and
predictable set of colours.</p>
<p>
In order to use the <strong>zsh/nearcolor</strong> module, it only needs to be loaded.
Thereafter, whenever a colour is specified using a hex triplet, it will
be compared against each of the available colours and the closest will
be selected. The first sixteen colours are never matched in this process
due to being unpredictable.</p>
<p>
It isn&#39;t possible to reliably detect support for true colour in the
terminal emulator. It is therefore recommended to be selective in
loading the <strong>zsh/nearcolor</strong> module. For example, the following checks
the <strong>COLORTERM</strong> environment variable:</p>
<blockquote>
<pre class="example">
[[ $COLORTERM = *(24bit|truecolor)* ]] || zmodload zsh/nearcolor
</pre>
</blockquote>
<p>
Note that some terminals accept the true color escape codes but map them
internally to a more limited palette in a similar manner to the
<strong>zsh/nearcolor</strong> module.</p>
</div>
</div>
<div id="outline-container-headline-26" class="outline-2">
<h2 id="headline-26">
THE ZSH/NEWUSER MODULE
</h2>
<div id="outline-text-headline-26" class="outline-text-2">
<p>The <strong>zsh/newuser</strong> module is loaded at boot if it is available, the <strong>RCS</strong>
option is set, and the <strong>PRIVILEGED</strong> option is not set (all three are
true by default). This takes place immediately after commands in the
global <strong>zshenv</strong> file (typically <strong>/etc/zshenv</strong>), if any, have been
executed. If the module is not available it is silently ignored by the
shell; the module may safely be removed from <strong>$MODULE_PATH</strong> by the
administrator if it is not required.</p>
<p>
On loading, the module tests if any of the start-up files <strong>.zshenv</strong>,
<strong>.zprofile</strong>, <strong>.zshrc</strong> or <strong>.zlogin</strong> exist in the directory given by the
environment variable <strong>ZDOTDIR</strong>, or the user&#39;s home directory if that is
not set. The test is not performed and the module halts processing if
the shell was in an emulation mode (i.e. had been invoked as some other
shell than zsh).</p>
<p>
If none of the start-up files were found, the module then looks for the
file <strong>newuser</strong> first in a sitewide directory, usually the parent
directory of the <strong>site-functions</strong> directory, and if that is not found
the module searches in a version-specific directory, usually the parent
of the <strong>functions</strong> directory containing version-specific functions.
(These directories can be configured when zsh is built using the
<strong>–enable-site-scriptdir=*/dir/ and *–enable-scriptdir=*/dir/ flags to
*configure</strong>, respectively; the defaults are <em>prefix/*/share/zsh* and
/prefix/*/share/zsh/$ZSH_VERSION* where the default /prefix</em> is
<strong>/usr/local</strong>.)</p>
<p>
If the file <strong>newuser</strong> is found, it is then sourced in the same manner as
a start-up file. The file is expected to contain code to install
start-up files for the user, however any valid shell code will be
executed.</p>
<p>
The <strong>zsh/newuser</strong> module is then unconditionally unloaded.</p>
<p>
Note that it is possible to achieve exactly the same effect as the
<strong>zsh/newuser</strong> module by adding code to <strong>/etc/zshenv</strong>. The module exists
simply to allow the shell to make arrangements for new users without the
need for intervention by package maintainers and system administrators.</p>
<p>
The script supplied with the module invokes the shell function
<strong>zsh-newuser-install</strong>. This may be invoked directly by the user even if
the <strong>zsh/newuser</strong> module is disabled. Note, however, that if the module
is not installed the function will not be installed either. The function
is documented in the section `User Configuration Functions&#39; in
/zshcontrib/(1).</p>
</div>
</div>
<div id="outline-container-headline-27" class="outline-2">
<h2 id="headline-27">
THE ZSH/PARAMETER MODULE
</h2>
<div id="outline-text-headline-27" class="outline-text-2">
<p>The <strong>zsh/parameter</strong> module gives access to some of the internal hash
tables used by the shell by defining some special parameters.</p>
<p>
<strong>options</strong> The keys for this associative array are the names of the
options that can be set and unset using the <strong>setopt</strong> and <strong>unsetopt</strong>
builtins. The value of each key is either the string <strong>on</strong> if the option
is currently set, or the string <strong>off</strong> if the option is unset. Setting a
key to one of these strings is like setting or unsetting the option,
respectively. Unsetting a key in this array is like setting it to the
value <strong>off</strong>.</p>
<dl>
<dt>
<strong>commands</strong>
</dt>
<dd>This array gives access to the command hash table. The
keys are the names of external commands, the values are the pathnames
of the files that would be executed when the command would be invoked.
Setting a key in this array defines a new entry in this table in the
same way as with the <strong>hash</strong> builtin. Unsetting a key as in `*unset*
&#34;commands[foo]&#34;&#39; removes the entry for the given key from the command
hash table.</dd>
<dt>
<strong>functions</strong>
</dt>
<dd>This associative array maps names of enabled functions
to their definitions. Setting a key in it is like defining a function
with the name given by the key and the body given by the value.
Unsetting a key removes the definition for the function named by the
key.</dd>
<dt>
<strong>dis_functions</strong>
</dt>
<dd>Like <strong>functions</strong> but for disabled functions.</dd>
<dt>
<strong>functions_source</strong>
</dt>
<dd>This readonly associative array maps names of
enabled functions to the name of the file containing the source of the
function.

For an autoloaded function that has already been loaded, or marked for
autoload with an absolute path, or that has had its path resolved with
`*functions -r*&#39;, this is the file found for autoloading, resolved to
an absolute path.

For a function defined within the body of a script or sourced file,
this is the name of that file. In this case, this is the exact path
originally used to that file, which may be a relative path.

For any other function, including any defined at an interactive prompt
or an autoload function whose path has not yet been resolved, this is
the empty string. However, the hash element is reported as defined
just so long as the function is present: the keys to this hash are the
same as those to <strong>$functions</strong>.</dd>
<dt>
<strong>dis_functions_source</strong>
</dt>
<dd>Like <strong>functions_source</strong> but for disabled
functions.</dd>
<dt>
<strong>builtins</strong>
</dt>
<dd>This associative array gives information about the
builtin commands currently enabled. The keys are the names of the
builtin commands and the values are either `*undefined*&#39; for builtin
commands that will automatically be loaded from a module if invoked or
`*defined*&#39; for builtin commands that are already loaded.</dd>
<dt>
<strong>dis_builtins</strong>
</dt>
<dd>Like <strong>builtins</strong> but for disabled builtin commands.</dd>
<dt>
<strong>reswords</strong>
</dt>
<dd>This array contains the enabled reserved words.</dd>
<dt>
<strong>dis_reswords</strong>
</dt>
<dd>Like <strong>reswords</strong> but for disabled reserved words.</dd>
<dt>
<strong>patchars</strong>
</dt>
<dd>This array contains the enabled pattern characters.</dd>
<dt>
<strong>dis_patchars</strong>
</dt>
<dd>Like <strong>patchars</strong> but for disabled pattern characters.</dd>
<dt>
<strong>aliases</strong>
</dt>
<dd>This maps the names of the regular aliases currently
enabled to their expansions.</dd>
<dt>
<strong>dis_aliases</strong>
</dt>
<dd>Like <strong>aliases</strong> but for disabled regular aliases.</dd>
<dt>
<strong>galiases</strong>
</dt>
<dd>Like <strong>aliases</strong>, but for global aliases.</dd>
<dt>
<strong>dis_galiases</strong>
</dt>
<dd>Like <strong>galiases</strong> but for disabled global aliases.</dd>
<dt>
<strong>saliases</strong>
</dt>
<dd>Like <strong>raliases</strong>, but for suffix aliases.</dd>
<dt>
<strong>dis_saliases</strong>
</dt>
<dd>Like <strong>saliases</strong> but for disabled suffix aliases.</dd>
<dt>
<strong>parameters</strong>
</dt>
<dd>The keys in this associative array are the names of
the parameters currently defined. The values are strings describing
the type of the parameter, in the same format used by the <strong>t</strong>
parameter flag, see /zshexpn/(1) . Setting or unsetting keys in this
array is not possible.</dd>
<dt>
<strong>modules</strong>
</dt>
<dd>An associative array giving information about modules.
The keys are the names of the modules loaded, registered to be
autoloaded, or aliased. The value says which state the named module is
in and is one of the strings `*loaded*&#39;, `*autoloaded*&#39;, or
`*alias:*/name/&#39;, where <em>name</em> is the name the module is aliased to.

Setting or unsetting keys in this array is not possible.</dd>
<dt>
<strong>dirstack</strong>
</dt>
<dd>A normal array holding the elements of the directory
stack. Note that the output of the <strong>dirs</strong> builtin command includes one
more directory, the current working directory.</dd>
<dt>
<strong>history</strong>
</dt>
<dd>This associative array maps history event numbers to the
full history lines. Although it is presented as an associative array,
the array of all values (<strong>${history[@]}</strong>) is guaranteed to be returned
in order from most recent to oldest history event, that is, by
decreasing history event number.</dd>
<dt>
<strong>historywords</strong>
</dt>
<dd>A special array containing the words stored in the
history. These also appear in most to least recent order.</dd>
<dt>
<strong>jobdirs</strong>
</dt>
<dd>This associative array maps job numbers to the
directories from which the job was started (which may not be the
current directory of the job).

The keys of the associative arrays are usually valid job numbers, and
these are the values output with, for example, <strong>${(k)jobdirs}</strong>.
Non-numeric job references may be used when looking up a value; for
example, <strong>${jobdirs[%+]}</strong> refers to the current job.

See the <strong>jobs</strong> builtin for how job information is provided in a
subshell.</dd>
<dt>
<strong>jobtexts</strong>
</dt>
<dd>This associative array maps job numbers to the texts of
the command lines that were used to start the jobs.

Handling of the keys of the associative array is as described for
<strong>jobdirs</strong> above.

See the <strong>jobs</strong> builtin for how job information is provided in a
subshell.</dd>
<dt>
<strong>jobstates</strong>
</dt>
<dd>This associative array gives information about the
states of the jobs currently known. The keys are the job numbers and
the values are strings of the form
`/job-state/*:*/mark/*:*/pid/*=*/state/…&#39;. The <em>job-state</em> gives the
state the whole job is currently in, one of `*running*&#39;,
`*suspended*&#39;, or `*done*&#39;. The <em>mark</em> is `*+*&#39; for the current job,
`*-<strong>&#39; for the previous job and empty otherwise. This is followed by
one `</strong>:*/pid/*=*/state/&#39; for every process in the job. The <em>pid/s are,
of course, the process IDs and the /state</em> describes the state of that
process.

Handling of the keys of the associative array is as described for
<strong>jobdirs</strong> above.

See the <strong>jobs</strong> builtin for how job information is provided in a
subshell.</dd>
<dt>
<strong>nameddirs</strong>
</dt>
<dd>This associative array maps the names of named
directories to the pathnames they stand for.</dd>
<dt>
<strong>userdirs</strong>
</dt>
<dd>This associative array maps user names to the pathnames
of their home directories.</dd>
<dt>
<strong>usergroups</strong>
</dt>
<dd>This associative array maps names of system groups of
which the current user is a member to the corresponding group
identifiers. The contents are the same as the groups output by the
<strong>id</strong> command.</dd>
<dt>
<strong>funcfiletrace</strong>
</dt>
<dd>This array contains the absolute line numbers and
corresponding file names for the point where the current function,
sourced file, or (if <strong>EVAL_LINENO</strong> is set) <strong>eval</strong> command was called.
The array is of the same length as <strong>funcsourcetrace</strong> and <strong>functrace</strong>,
but differs from <strong>funcsourcetrace</strong> in that the line and file are the
point of call, not the point of definition, and differs from
<strong>functrace</strong> in that all values are absolute line numbers in files,
rather than relative to the start of a function, if any.</dd>
<dt>
<strong>funcsourcetrace</strong>
</dt>
<dd>This array contains the file names and line
numbers of the points where the functions, sourced files, and (if
<strong>EVAL_LINENO</strong> is set) <strong>eval</strong> commands currently being executed were
defined. The line number is the line where the `*function* <em>name</em>&#39; or
`/name/ <strong>()</strong>&#39; started. In the case of an autoloaded function the line
number is reported as zero. The format of each element is
<em>filename/*:*/lineno</em>.

For functions autoloaded from a file in native zsh format, where only
the body of the function occurs in the file, or for files that have
been executed by the <strong>source</strong> or `*.*&#39; builtins, the trace information
is shown as <em>filename/*:*/0</em>, since the entire file is the definition.
The source file name is resolved to an absolute path when the function
is loaded or the path to it otherwise resolved.

Most users will be interested in the information in the
<strong>funcfiletrace</strong> array instead.</dd>
<dt>
<strong>funcstack</strong>
</dt>
<dd>This array contains the names of the functions, sourced
files, and (if <strong>EVAL_LINENO</strong> is set) <strong>eval</strong> commands. currently being
executed. The first element is the name of the function using the
parameter.

The standard shell array <strong>zsh_eval_context</strong> can be used to determine
the type of shell construct being executed at each depth: note,
however, that is in the opposite order, with the most recent item
last, and it is more detailed, for example including an entry for
<strong>toplevel</strong>, the main shell code being executed either interactively or
from a script, which is not present in <strong>$funcstack</strong>.</dd>
<dt>
<strong>functrace</strong>
</dt>
<dd>This array contains the names and line numbers of the
callers corresponding to the functions currently being executed. The
format of each element is <em>name/*:*/lineno</em>. Callers are also shown
for sourced files; the caller is the point where the <strong>source</strong> or `*.*&#39;
command was executed.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-28" class="outline-2">
<h2 id="headline-28">
THE ZSH/PCRE MODULE
</h2>
<div id="outline-text-headline-28" class="outline-text-2">
<p>The <strong>zsh/pcre</strong> module makes some commands available as builtins:</p>
<p>
<strong>pcre_compile</strong> [ <strong>-aimxs</strong> ] <em>PCRE</em> Compiles a perl-compatible regular
expression.</p>
<blockquote>
<p>Option <strong>-a</strong> will force the pattern to be anchored. Option <strong>-i</strong> will
compile a case-insensitive pattern. Option <strong>-m</strong> will compile a
multi-line pattern; that is, <strong>^</strong> and <strong>$</strong> will match newlines within the
pattern. Option <strong>-x</strong> will compile an extended pattern, wherein
whitespace and <strong>#</strong> comments are ignored. Option <strong>-s</strong> makes the dot
metacharacter match all characters, including those that indicate
newline.</p>
</blockquote>
<dl>
<dt>
<strong>pcre_study</strong>
</dt>
<dd>Studies the previously-compiled PCRE which may result
in faster matching.</dd>
<dt>
?
</dt>
<dd>
<p><strong>pcre_match</strong> [ <strong>-v</strong> <em>var</em> ] [ <strong>-a</strong> <em>arr</em> ] [ <strong>-n</strong> <em>offset</em> ] [ <strong>-b</strong> ]
<em>string</em> :: Returns successfully if <strong>string</strong> matches the
previously-compiled PCRE.</p>
<p>
Upon successful match, if the expression captures substrings within
parentheses, <strong>pcre_match</strong> will set the array <strong>match</strong> to those
substrings, unless the <strong>-a</strong> option is given, in which case it will set
the array <em>arr</em>. Similarly, the variable <strong>MATCH</strong> will be set to the
entire matched portion of the string, unless the <strong>-v</strong> option is given,
in which case the variable <em>var</em> will be set. No variables are altered
if there is no successful match. A <strong>-n</strong> option starts searching for a
match from the byte <em>offset</em> position in <em>string</em>. If the <strong>-b</strong> option
is given, the variable <strong>ZPCRE_OP</strong> will be set to an offset pair
string, representing the byte offset positions of the entire matched
portion within the <em>string</em>. For example, a <strong>ZPCRE_OP</strong> set to &#34;32 45&#34;
indicates that the matched portion began on byte offset 32 and ended
on byte offset 44. Here, byte offset position 45 is the position
directly after the matched portion. Keep in mind that the byte
position isn&#39;t necessarily the same as the character position when
UTF-8 characters are involved. Consequently, the byte offset positions
are only to be relied on in the context of using them for subsequent
searches on <em>string</em>, using an offset position as an argument to the
<strong>-n</strong> option. This is mostly used to implement the &#34;find all
non-overlapping matches&#34; functionality.</p>
<p>
A simple example of &#34;find all non-overlapping matches&#34;:</p>
<blockquote>
<pre class="example">
string=&#34;The following zip codes: 78884 90210 99513&#34;
pcre_compile -m &#34;\d{5}&#34;
accum=()
pcre_match -b -- $string
while [[ $? -eq 0 ]] do
    b=($=ZPCRE_OP)
    accum+=$MATCH
    pcre_match -b -n $b[2] -- $string
done
print -l $accum
</pre>
</blockquote>
</dd>
</dl>
<p>The <strong>zsh/pcre</strong> module makes available the following test condition:</p>
<p>
<em>expr</em> <strong>-pcre-match</strong> <em>pcre</em> Matches a string against a perl-compatible
regular expression.</p>
<blockquote>
<p>For example,</p>
<blockquote>
<pre class="example">
[[ &#34;$text&#34; -pcre-match ^d+$ ]] &amp;&amp;
print text variable contains only &#34;d&#39;s&#34;.
</pre>
</blockquote>
<p>
If the <strong>REMATCH_PCRE</strong> option is set, the <strong>=~</strong> operator is equivalent to
<strong>-pcre-match</strong>, and the <strong>NO_CASE_MATCH</strong> option may be used. Note that
<strong>NO_CASE_MATCH</strong> never applies to the <strong>pcre_match</strong> builtin, instead use
the <strong>-i</strong> switch of <strong>pcre_compile</strong>.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-29" class="outline-2">
<h2 id="headline-29">
THE ZSH/PARAM/PRIVATE MODULE
</h2>
<div id="outline-text-headline-29" class="outline-text-2">
<p>The <strong>zsh/param/private</strong> module is used to create parameters whose scope
is limited to the current function body, and <em>not</em> to other functions
called by the current function.</p>
<p>
This module provides a single autoloaded builtin:</p>
<p>
<strong>private</strong> [ {<strong>+*|</strong>-<strong>}*AHUahlmrtux</strong> ] [ {<strong>+*|</strong>-<strong>}*EFLRZi</strong> [ <em>n</em> ] ] [
<em>name</em>[*=*/value/] … ] The <strong>private</strong> builtin accepts all the same
options and arguments as <strong>local</strong> (/zshbuiltins/(1)) except for the
`*-T*&#39; option. Tied parameters may not be made private.</p>
<blockquote>
<p>The `*-p*&#39; option is presently a no-op because the state of private
parameters cannot reliably be reloaded. This also applies to printing
private parameters with `*typeset -p*&#39;.</p>
<p>
If used at the top level (outside a function scope), <strong>private</strong> creates a
normal parameter in the same manner as <strong>declare</strong> or <strong>typeset</strong>. A warning
about this is printed if <strong>WARN_CREATE_GLOBAL</strong> is set (/zshoptions/(1)).
Used inside a function scope, <strong>private</strong> creates a local parameter
similar to one declared with <strong>local</strong>, except having special properties
noted below.</p>
<p>
Special parameters which expose or manipulate internal shell state, such
as <strong>ARGC</strong>, <strong>argv</strong>, <strong>COLUMNS</strong>, <strong>LINES</strong>, <strong>UID</strong>, <strong>EUID</strong>, <strong>IFS</strong>, <strong>PROMPT</strong>,
<strong>RANDOM</strong>, <strong>SECONDS</strong>, etc., cannot be made private unless the `*-h*&#39;
option is used to hide the special meaning of the parameter. This may
change in the future.</p>
</blockquote>
<p>
As with other <strong>typeset</strong> equivalents, <strong>private</strong> is both a builtin and a
reserved word, so arrays may be assigned with parenthesized word list
<em>name/*=(*/value</em>…*)* syntax. However, the reserved word `*private*&#39;
is not available until <strong>zsh/param/private</strong> is loaded, so care must be
taken with order of execution and parsing for function definitions which
use <strong>private</strong>. To compensate for this, the module also adds the option
`*-P*&#39; to the `*local*&#39; builtin to declare private parameters.</p>
<p>
For example, this construction fails if <strong>zsh/param/private</strong> has not yet
been loaded when `*bad_declaration*&#39; is defined:</p>
<blockquote>
<pre class="example">
bad_declaration() {
  zmodload zsh/param/private
  private array=( one two three )
}
</pre>
</blockquote>
<p>
This construction works because <strong>local</strong> is already a keyword, and the
module is loaded before the statement is executed:</p>
<blockquote>
<pre class="example">
good_declaration() {
  zmodload zsh/param/private
  local -P array=( one two three )
}
</pre>
</blockquote>
<p>
The following is usable in scripts but may have trouble with <strong>autoload</strong>:</p>
<blockquote>
<pre class="example">
zmodload zsh/param/private
iffy_declaration() {
  private array=( one two three )
}
</pre>
</blockquote>
<p>
The <strong>private</strong> builtin may always be used with scalar assignments and for
declarations without assignments.</p>
<p>
Parameters declared with <strong>private</strong> have the following properties:</p>
<p>
· Within the function body where it is declared, the parameter behaves
as a local, except as noted above for tied or special parameters.</p>
<dl>
<dt>
·
</dt>
<dd>The type of a parameter declared private cannot be changed in the
scope where it was declared, even if the parameter is unset. Thus an
array cannot be assigned to a private scalar, etc.</dd>
<dt>
·
</dt>
<dd>Within any other function called by the declaring function, the
private parameter does <em>NOT</em> hide other parameters of the same name,
so for example a global parameter of the same name is visible and may
be assigned or unset. This includes calls to anonymous functions,
although that may also change in the future. However, the private name
may not be created outside the local scope when it was not previously
declared.</dd>
<dt>
·
</dt>
<dd>An exported private remains in the environment of inner scopes
but appears unset for the current shell in those scopes. Generally,
exporting private parameters should be avoided.</dd>
</dl>
<p>Note that this differs from the static scope defined by compiled
languages derived from C, in that the a new call to the same function
creates a new scope, i.e., the parameter is still associated with the
call stack rather than with the function definition. It differs from ksh
`*typeset -S*&#39; because the syntax used to define the function has no
bearing on whether the parameter scope is respected.</p>
</div>
</div>
<div id="outline-container-headline-30" class="outline-2">
<h2 id="headline-30">
THE ZSH/REGEX MODULE
</h2>
<div id="outline-text-headline-30" class="outline-text-2">
<p>The <strong>zsh/regex</strong> module makes available the following test condition:</p>
<p>
<em>expr</em> <strong>-regex-match</strong> <em>regex</em> Matches a string against a POSIX extended
regular expression. On successful match, matched portion of the string
will normally be placed in the <strong>MATCH</strong> variable. If there are any
capturing parentheses within the regex, then the <strong>match</strong> array variable
will contain those. If the match is not successful, then the variables
will not be altered.</p>
<blockquote>
<p>For example,</p>
<blockquote>
<pre class="example">
[[ alphabetical -regex-match ^a([^a]+)a([^a]+)a ]] &amp;&amp;
print -l $MATCH X $match
</pre>
</blockquote>
<p>
If the option <strong>REMATCH_PCRE</strong> is not set, then the <strong>=~</strong> operator will
automatically load this module as needed and will invoke the
<strong>-regex-match</strong> operator.</p>
<p>
If <strong>BASH_REMATCH</strong> is set, then the array <strong>BASH_REMATCH</strong> will be set
instead of <strong>MATCH</strong> and <strong>match</strong>.</p>
<p>
Note that the <strong>zsh/regex</strong> module logic relies on the host system. The
same <em>expr</em> and <em>regex</em> pair could produce different results on
different platforms if a <em>regex</em> with non-standard syntax is given.</p>
<p>
For example, no syntax for matching a word boundary is defined in the
POSIX extended regular expression standard. GNU <strong>libc</strong> and BSD <strong>libc</strong>
both provide such syntaxes as extensions (<strong>\b</strong> and <strong><a href=":&lt;:">:&lt;:</a>*/</strong><a href=":&gt;:">:&gt;:</a>*
respectively), but neither of these syntaxes is supported by both of
these implementations.</p>
<p>
Refer to the /regcomp/(3) and /re_format/(7) manual pages on your system
for locally-supported syntax.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-31" class="outline-2">
<h2 id="headline-31">
THE ZSH/SCHED MODULE
</h2>
<div id="outline-text-headline-31" class="outline-text-2">
<p>The <strong>zsh/sched</strong> module makes available one builtin command and one
parameter.</p>
<p>
<strong>sched</strong> [*-o*] [*+*]/hh/*:*/mm/[*:*/ss/] <em>command</em> …</p>
<p>
<strong>sched</strong> [*-o*] [*+*]/seconds/ <em>command</em> …</p>
<p>
<strong>sched</strong> [ *-*/item/ ] Make an entry in the scheduled list of commands to
execute. The time may be specified in either absolute or relative time,
and either as hours, minutes and (optionally) seconds separated by a
colon, or seconds alone. An absolute number of seconds indicates the
time since the epoch (1970/01/01 00:00); this is useful in combination
with the features in the <strong>zsh/datetime</strong> module, see the zsh/datetime
module entry in /zshmodules/(1).</p>
<blockquote>
<p>With no arguments, prints the list of scheduled commands. If the
scheduled command has the <strong>-o</strong> flag set, this is shown at the start of
the command.</p>
<p>
With the argument `*-*/item/&#39;, removes the given item from the list. The
numbering of the list is continuous and entries are in time order, so
the numbering can change when entries are added or deleted.</p>
<p>
Commands are executed either immediately before a prompt, or while the
shell&#39;s line editor is waiting for input. In the latter case it is
useful to be able to produce output that does not interfere with the
line being edited. Providing the option <strong>-o</strong> causes the shell to clear
the command line before the event and redraw it afterwards. This should
be used with any scheduled event that produces visible output to the
terminal; it is not needed, for example, with output that updates a
terminal emulator&#39;s title bar.</p>
<p>
To effect changes to the editor buffer when an event executes, use the
`*zle*&#39; command with no arguments to test whether the editor is active,
and if it is, then use `*zle */widget/&#39; to access the editor via the
named <em>widget</em>.</p>
<p>
The <strong>sched</strong> builtin is not made available by default when the shell
starts in a mode emulating another shell. It can be made available with
the command `*zmodload -F zsh/sched b:sched*&#39;.</p>
</blockquote>
<p>
<strong>zsh_scheduled_events</strong> A readonly array corresponding to the events
scheduled by the <strong>sched</strong> builtin. The indices of the array correspond to
the numbers shown when <strong>sched</strong> is run with no arguments (provided that
the <strong>KSH_ARRAYS</strong> option is not set). The value of the array consists of
the scheduled time in seconds since the epoch (see the section `The
zsh/datetime Module&#39; for facilities for using this number), followed by
a colon, followed by any options (which may be empty but will be
preceded by a `*-*&#39; otherwise), followed by a colon, followed by the
command to be executed.</p>
<blockquote>
<p>The <strong>sched</strong> builtin should be used for manipulating the events. Note
that this will have an immediate effect on the contents of the array, so
that indices may become invalid.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-32" class="outline-2">
<h2 id="headline-32">
THE ZSH/NET/SOCKET MODULE
</h2>
<div id="outline-text-headline-32" class="outline-text-2">
<p>The <strong>zsh/net/socket</strong> module makes available one builtin command:</p>
<p>
<strong>zsocket</strong> [ <strong>-altv</strong> ] [ <strong>-d</strong> <em>fd</em> ] [ <em>args</em> ] <strong>zsocket</strong> is implemented
as a builtin to allow full use of shell command line editing, file I/O,
and job control mechanisms.</p>
<div id="outline-container-headline-33" class="outline-3">
<h3 id="headline-33">
Outbound Connections
</h3>
<div id="outline-text-headline-33" class="outline-text-3">
<p><strong>zsocket</strong> [ <strong>-v</strong> ] [ <strong>-d</strong> <em>fd</em> ] <em>filename</em> Open a new Unix domain
connection to <em>filename</em>. The shell parameter <strong>REPLY</strong> will be set to the
file descriptor associated with that connection. Currently, only stream
connections are supported.</p>
<blockquote>
<p>If <strong>-d</strong> is specified, its argument will be taken as the target file
descriptor for the connection.</p>
<p>
In order to elicit more verbose output, use <strong>-v</strong>.</p>
<p>
File descriptors can be closed with normal shell syntax when no longer
needed, for example:</p>
<blockquote>
<pre class="example">
exec {REPLY}&gt;&amp;-
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-34" class="outline-3">
<h3 id="headline-34">
Inbound Connections
</h3>
<div id="outline-text-headline-34" class="outline-text-3">
<p><strong>zsocket</strong> <strong>-l</strong> [ <strong>-v</strong> ] [ <strong>-d</strong> <em>fd</em> ] <em>filename</em> <strong>zsocket -l</strong> will open
a socket listening on <em>filename</em>. The shell parameter <strong>REPLY</strong> will be
set to the file descriptor associated with that listener. The file
descriptor remains open in subshells and forked external executables.</p>
<blockquote>
<p>If <strong>-d</strong> is specified, its argument will be taken as the target file
descriptor for the connection.</p>
<p>
In order to elicit more verbose output, use <strong>-v</strong>.</p>
</blockquote>
<dl>
<dt>
<strong>zsocket</strong> <strong>-a</strong> [ <strong>-tv</strong> ] [ <strong>-d</strong> <em>targetfd</em> ] <em>listenfd</em>
</dt>
<dd><strong>zsocket
-a</strong> will accept an incoming connection to the socket associated with
<em>listenfd</em>. The shell parameter <strong>REPLY</strong> will be set to the file
descriptor associated with the inbound connection. The file descriptor
remains open in subshells and forked external executables.

If <strong>-d</strong> is specified, its argument will be taken as the target file
descriptor for the connection.

If <strong>-t</strong> is specified, <strong>zsocket</strong> will return if no incoming connection
is pending. Otherwise it will wait for one.

In order to elicit more verbose output, use <strong>-v</strong>.</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-35" class="outline-2">
<h2 id="headline-35">
THE ZSH/STAT MODULE
</h2>
<div id="outline-text-headline-35" class="outline-text-2">
<p>The <strong>zsh/stat</strong> module makes available one builtin command under two
possible names:</p>
<p>
<strong>zstat *[ *-gnNolLtTrs</strong> ] [ <strong>-f</strong> <em>fd</em> ] [ <strong>-H</strong> <em>hash</em> ] [ <strong>-A</strong> <em>array</em> ]
[ <strong>-F</strong> <em>fmt</em> ]</p>
</div>
</div>
<div id="outline-container-headline-36" class="outline-2">
<h2 id="headline-36">
*[ *+*/element/ ] [ <em>file</em> … ]
</h2>
<div id="outline-text-headline-36" class="outline-text-2">
<p>
<strong>stat</strong> <em>…</em> The command acts as a front end to the <strong>stat</strong> system call
(see /stat/(2)). The same command is provided with two names; as the
name <strong>stat</strong> is often used by an external command it is recommended that
only the <strong>zstat</strong> form of the command is used. This can be arranged by
loading the module with the command `*zmodload -F zsh/stat* b:zstat&#39;.</p>
<blockquote>
<p>If the <strong>stat</strong> call fails, the appropriate system error message printed
and status 1 is returned. The fields of <strong>struct stat</strong> give information
about the files provided as arguments to the command. In addition to
those available from the <strong>stat</strong> call, an extra element `*link*&#39; is
provided. These elements are:</p>
<p>
<strong>device</strong> The number of the device on which the file resides.</p>
<dl>
<dt>
<strong>inode</strong>
</dt>
<dd>The unique number of the file on this device (`/inode/&#39;
number).</dd>
<dt>
<strong>mode</strong>
</dt>
<dd>The mode of the file; that is, the file&#39;s type and access
permissions. With the <strong>-s</strong> option, this will be returned as a string
corresponding to the first column in the display of the <strong>ls -l</strong>
command.</dd>
<dt>
<strong>nlink</strong>
</dt>
<dd>The number of hard links to the file.</dd>
<dt>
<strong>uid</strong>
</dt>
<dd>The user ID of the owner of the file. With the <strong>-s</strong> option,
this is displayed as a user name.</dd>
<dt>
<strong>gid</strong>
</dt>
<dd>The group ID of the file. With the <strong>-s</strong> option, this is
displayed as a group name.</dd>
<dt>
<strong>rdev</strong>
</dt>
<dd>The raw device number. This is only useful for special
devices.</dd>
<dt>
<strong>size</strong>
</dt>
<dd>The size of the file in bytes.</dd>
</dl>
<p><strong>atime</strong></p>
<p>
<strong>mtime</strong></p>
<p>
<strong>ctime</strong> The last access, modification and inode change times of the
file, respectively, as the number of seconds since midnight GMT on 1st
January, 1970. With the <strong>-s</strong> option, these are printed as strings for
the local time zone; the format can be altered with the <strong>-F</strong> option, and
with the <strong>-g</strong> option the times are in GMT.</p>
<dl>
<dt>
<strong>blksize</strong>
</dt>
<dd>The number of bytes in one allocation block on the device
on which the file resides.</dd>
<dt>
<strong>block</strong>
</dt>
<dd>The number of disk blocks used by the file.</dd>
<dt>
<strong>link</strong>
</dt>
<dd>If the file is a link and the <strong>-L</strong> option is in effect, this
contains the name of the file linked to, otherwise it is empty. Note
that if this element is selected (``*zstat +link*&#39;&#39;) then the <strong>-L</strong>
option is automatically used.</dd>
</dl>
<p>A particular element may be selected by including its name preceded by a
`*+*&#39; in the option list; only one element is allowed. The element may
be shortened to any unique set of leading characters. Otherwise, all
elements will be shown for all files.</p>
<p>
Options:</p>
<p>
<strong>-A</strong> <em>array</em> Instead of displaying the results on standard output,
assign them to an <em>array</em>, one <strong>struct stat</strong> element per array element
for each file in order. In this case neither the name of the element nor
the name of the files appears in <em>array</em> unless the <strong>-t</strong> or <strong>-n</strong> options
were given, respectively. If <strong>-t</strong> is given, the element name appears as
a prefix to the appropriate array element; if <strong>-n</strong> is given, the file
name appears as a separate array element preceding all the others. Other
formatting options are respected.</p>
<dl>
<dt>
<strong>-H</strong> <em>hash</em>
</dt>
<dd>Similar to <strong>-A</strong>, but instead assign the values to
<em>hash</em>. The keys are the elements listed above. If the <strong>-n</strong> option is
provided then the name of the file is included in the hash with key
<strong>name</strong>.</dd>
<dt>
<strong>-f</strong> <em>fd</em>
</dt>
<dd>Use the file on file descriptor <em>fd</em> instead of named
files; no list of file names is allowed in this case.</dd>
<dt>
<strong>-F</strong> <em>fmt</em>
</dt>
<dd>Supplies a <strong>strftime</strong> (see /strftime/(3)) string for the
formatting of the time elements. The format string supports all of the
zsh extensions described in the section EXPANSION OF PROMPT SEQUENCES
in /zshmisc/(1). In particular, <strong>-F %s.%N</strong> can be used to show
timestamps with nanosecond precision if supported by the system. The
<strong>-s</strong> option is implied.</dd>
<dt>
<strong>-g</strong>
</dt>
<dd>Show the time elements in the GMT time zone. The <strong>-s</strong> option
is implied.</dd>
<dt>
<strong>-l</strong>
</dt>
<dd>List the names of the type elements (to standard output or an
array as appropriate) and return immediately; arguments, and options
other than <strong>-A</strong>, are ignored.</dd>
<dt>
<strong>-L</strong>
</dt>
<dd>Perform an <strong>lstat</strong> (see /lstat/(2)) rather than a <strong>stat</strong>
system call. In this case, if the file is a link, information about
the link itself rather than the target file is returned. This option
is required to make the <strong>link</strong> element useful. It&#39;s important to note
that this is the exact opposite from /ls/(1), etc.</dd>
<dt>
<strong>-n</strong>
</dt>
<dd>Always show the names of files. Usually these are only shown
when output is to standard output and there is more than one file in
the list.</dd>
<dt>
<strong>-N</strong>
</dt>
<dd>Never show the names of files.</dd>
<dt>
<strong>-o</strong>
</dt>
<dd>If a raw file mode is printed, show it in octal, which is more
useful for human consumption than the default of decimal. A leading
zero will be printed in this case. Note that this does not affect
whether a raw or formatted file mode is shown, which is controlled by
the <strong>-r</strong> and <strong>-s</strong> options, nor whether a mode is shown at all.</dd>
<dt>
<strong>-r</strong>
</dt>
<dd>Print raw data (the default format) alongside string data (the
<strong>-s</strong> format); the string data appears in parentheses after the raw
data.</dd>
<dt>
<strong>-s</strong>
</dt>
<dd>Print <strong>mode</strong>, <strong>uid</strong>, <strong>gid</strong> and the three time elements as
strings instead of numbers. In each case the format is like that of
<strong>ls -l</strong>.</dd>
<dt>
<strong>-t</strong>
</dt>
<dd>Always show the type names for the elements of <strong>struct stat</strong>.
Usually these are only shown when output is to standard output and no
individual element has been selected.</dd>
<dt>
<strong>-T</strong>
</dt>
<dd>Never show the type names of the <strong>struct stat</strong> elements.</dd>
</dl>
</blockquote>
</div>
</div>
<div id="outline-container-headline-37" class="outline-2">
<h2 id="headline-37">
THE ZSH/SYSTEM MODULE
</h2>
<div id="outline-text-headline-37" class="outline-text-2">
<p>The <strong>zsh/system</strong> module makes available various builtin commands and
parameters.</p>
<div id="outline-container-headline-38" class="outline-3">
<h3 id="headline-38">
Builtins
</h3>
<div id="outline-text-headline-38" class="outline-text-3">
<p><strong>syserror</strong> [ <strong>-e</strong> <em>errvar</em> ] [ <strong>-p</strong> <em>prefix</em> ] [ <em>errno</em> | <em>errname</em> ]
This command prints out the error message associated with <em>errno</em>, a
system error number, followed by a newline to standard error.</p>
<blockquote>
<p>Instead of the error number, a name <em>errname</em>, for example <strong>ENOENT</strong>, may
be used. The set of names is the same as the contents of the array
<strong>errnos</strong>, see below.</p>
<p>
If the string <em>prefix</em> is given, it is printed in front of the error
message, with no intervening space.</p>
<p>
If <em>errvar</em> is supplied, the entire message, without a newline, is
assigned to the parameter names <em>errvar</em> and nothing is output.</p>
<p>
A return status of 0 indicates the message was successfully printed
(although it may not be useful if the error number was out of the
system&#39;s range), a return status of 1 indicates an error in the
parameters, and a return status of 2 indicates the error name was not
recognised (no message is printed for this).</p>
</blockquote>
<p>
<strong>sysopen</strong> [ <strong>-arw</strong> ] [ <strong>-m</strong> <em>permissions</em> ] [ <strong>-o</strong> <em>options</em> ]</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-39" class="outline-2">
<h2 id="headline-39">
-u* <em>fd</em> <em>file</em> This command opens a file. The <strong>-r</strong>, <strong>-w</strong> and <strong>-a</strong>
</h2>
<div id="outline-text-headline-39" class="outline-text-2">
<p>flags indicate whether the file should be opened for reading, writing
and appending, respectively. The <strong>-m</strong> option allows the initial
permissions to use when creating a file to be specified in octal form.
The file descriptor is specified with <strong>-u</strong>. Either an explicit file
descriptor in the range 0 to 9 can be specified or a variable name can
be given to which the file descriptor number will be assigned.</p>
<blockquote>
<p>The <strong>-o</strong> option allows various system specific options to be specified
as a comma-separated list. The following is a list of possible options.
Note that, depending on the system, some may not be available.</p>
<p>
<strong>cloexec</strong> mark file to be closed when other programs are executed (else
the file descriptor remains open in subshells and forked external
executables)</p>
<p>
<strong>create</strong></p>
<p>
<strong>creat</strong> create file if it does not exist</p>
<dl>
<dt>
<strong>excl</strong>
</dt>
<dd>create file, error if it already exists</dd>
<dt>
<strong>noatime</strong>
</dt>
<dd>suppress updating of the file atime</dd>
<dt>
<strong>nofollow</strong>
</dt>
<dd>fail if <em>file</em> is a symbolic link</dd>
<dt>
<strong>nonblock</strong>
</dt>
<dd>the file is opened in nonblocking mode</dd>
<dt>
<strong>sync</strong>
</dt>
<dd>request that writes wait until data has been physically
written</dd>
</dl>
<p><strong>truncate</strong></p>
<p>
<strong>trunc</strong> truncate file to size 0</p>
<p>
To close the file, use one of the following:</p>
<blockquote>
<pre class="example">
exec {fd}&lt;&amp;-
exec {fd}&gt;&amp;-
</pre>
</blockquote>
</blockquote>
<p>
<strong>sysread [ -c */countvar/</strong> ] [ -i <strong><em>infd</em></strong> ] [ -o <strong><em>outfd</em></strong> ]*</p>
</div>
</div>
<div id="outline-container-headline-40" class="outline-2">
<h2 id="headline-40">
[ -s <strong><em>bufsize</em></strong> ] [ -t <strong><em>timeout</em></strong> ] [ <strong><em>param</em></strong> ]* Perform a single
</h2>
<div id="outline-text-headline-40" class="outline-text-2">
<p>system read from file descriptor /infd/*, or zero if* that is not given.
The result of the read is stored in /param/* or* <strong>REPLY if that is not
given. If */countvar/</strong> is given, the number* of bytes read is assigned
to the parameter named by /countvar/*.*</p>
<blockquote>
<p>The maximum number of bytes read is /bufsize/* or 8192 if that is not*
given, however the command returns as soon as any number of bytes was
successfully read.</p>
<p>
If /timeout/* is given, it specifies a timeout in seconds, which may* be
zero to poll the file descriptor. This is handled by the <strong>poll</strong> system
call if available, otherwise the <strong>select system call if</strong> available.</p>
<p>
If /outfd/* is given, an attempt is made to write all the bytes just*
read to the file descriptor /outfd/*. If this fails, because of a*
system error other than <strong>EINTR or because of an internal zsh error</strong>
during an interrupt, the bytes read but not written are stored in the
parameter named by /param/* if supplied (no default is used in this*
case), and the number of bytes read but not written is stored in the
parameter named by /countvar/* if that is supplied. If it was*
successful, /countvar/* contains the full number of bytes transferred,*
as usual, and /param/* is not set.*</p>
<p>
The error <strong>EINTR (interrupted system call) is handled internally so</strong>
that shell interrupts are transparent to the caller. Any other error
causes a return.</p>
<p>
The possible return statuses are</p>
<p>
0 At least one byte of data was successfully read and, if appropriate,
written.</p>
<dl>
<dt>
1
</dt>
<dd>There was an error in the parameters to the command. This is the
only error for which a message is printed to standard error.</dd>
<dt>
2
</dt>
<dd>There was an error on the read, or on polling the input file
descriptor for a timeout. The parameter <strong>ERRNO gives the error.</strong></dd>
<dt>
3
</dt>
<dd>Data were successfully read, but there was an error writing them
to /outfd/*. The parameter ERRNO gives the error.*</dd>
<dt>
4
</dt>
<dd>The attempt to read timed out. Note this does not set <strong>ERRNO as
this</strong> is not a system error.</dd>
<dt>
5
</dt>
<dd>No system error occurred, but zero bytes were read. This usually
indicates end of file. The parameters are set according to the usual
rules; no write to /outfd/* is attempted.*</dd>
</dl>
</blockquote>
<dl>
<dt>
<strong>sysseek [ -u */fd/</strong> ] [ -w start|end|current ] */offset/
</dt>
<dd>The
current file position at which future reads and writes will take place
is adjusted to the specified byte offset. The /offset/* is evaluated
as a math* expression. The <strong>-u option allows the file descriptor to be
specified. By</strong> default the offset is specified relative to the start
or the file but, with the <strong>-w option, it is possible to specify that
the offset should be relative to</strong> the current position or the end of
the file.</dd>
<dt>
<strong>syswrite [ -c */countvar/</strong> ] [ -o <strong><em>outfd</em></strong> ] */data/
</dt>
<dd>The data (a
single string of bytes) are written to the file descriptor /outfd/*,
or 1 if that is not given, using the write system call.* Multiple
write operations may be used if the first does not write all the data.

If /countvar/* is given, the number of byte written is stored in the*
parameter named by /countvar/*; this may not be the full length of*
/data/* if an error occurred.*

The error <strong>EINTR (interrupted system call) is handled internally by</strong>
retrying; otherwise an error causes the command to return. For
example, if the file descriptor is set to non-blocking output, an
error <strong>EAGAIN (on some systems, EWOULDBLOCK) may result in the
command</strong> returning early.

The return status may be 0 for success, 1 for an error in the
parameters to the command, or 2 for an error on the write; no error
message is printed in the last case, but the parameter <strong>ERRNO will
reflect</strong> the error that occurred.</dd>
</dl>
<p><strong>zsystem flock [ -t */timeout/</strong> ] [ -i <strong><em>interval</em></strong> ] [ -f <strong><em>var</em></strong> ]
[-er] */file/</p>
<p>
<strong>zsystem flock -u */fd_expr/ The builtin *zsystem&#39;s subcommand flock
performs advisory file</strong> locking (via the /fcntl/*(2) system call) over
the entire contents* of the given file. This form of locking requires
the processes accessing the file to cooperate; its most obvious use is
between two instances of the shell itself.</p>
<blockquote>
<p>In the first form the named /file/*, which must already exist, is*
locked by opening a file descriptor to the file and applying a lock to
the file descriptor. The lock terminates when the shell process that
created the lock exits; it is therefore often convenient to create file
locks within subshells, since the lock is automatically released when
the subshell exits. Note that use of the <strong>print builtin with the</strong> <strong>-u
option will, as a side effect, release the lock, as will redirection</strong> to
the file in the shell holding the lock. To work around this use a
subshell, e.g. `*(print message) &gt;&gt; <strong><em>file</em></strong>&#39;. Status 0 is* returned if
the lock succeeds, else status 1.</p>
<p>
In the second form the file descriptor given by the arithmetic
expression /fd_expr/* is closed, releasing a lock. The file descriptor*
can be queried by using the `*-f <strong><em>var</em></strong>&#39; form during the lock;* on a
successful lock, the shell variable /var/* is set to the file*
descriptor used for locking. The lock will be released if the file
descriptor is closed by any other means, for example using `*exec
{<strong><em>var</em></strong>}&gt;&amp;-&#39;; however, the form described here performs* a safety check
that the file descriptor is in use for file locking.</p>
<p>
By default the shell waits indefinitely for the lock to succeed. The
option <strong>-t */timeout/</strong> specifies a timeout for the lock in* seconds;
fractional seconds are allowed. During this period, the shell will
attempt to lock the file every /interval/* seconds* if the <strong>-i
*/interval/</strong> option is given, otherwise once a second.* (This
/interval/* is shortened before the last attempt if needed,* so that the
shell waits only until the /timeout/* and not longer.)* If the attempt
times out, status 2 is returned.</p>
<p>
(Note: /timeout/* is limited to 2^30-1 seconds (about 34 years), and*
/interval/* to 0.999 * LONG_MAX microseconds (only about 35 minutes* on
32-bit systems).)</p>
<p>
If the option <strong>-e is given, the file descriptor for the lock is</strong>
preserved when the shell uses <strong>exec to start a new process;</strong> otherwise
it is closed at that point and the lock released.</p>
<p>
If the option <strong>-r is given, the lock is only for reading, otherwise</strong> it
is for reading and writing. The file descriptor is opened accordingly.</p>
</blockquote>
<dl>
<dt>
*zsystem supports */subcommand/
</dt>
<dd>The builtin <strong>zsystem&#39;s subcommand
supports tests whether a</strong> given subcommand is supported. It returns
status 0 if so, else status 1. It operates silently unless there was a
syntax error (i.e. the wrong number of arguments), in which case
status 255 is returned. Status 1 can indicate one of two things:
<em>subcommand</em> is known but not supported by the current operating
system, or /subcommand/* is not known (possibly because this is an
older* version of the shell before it was implemented).</dd>
</dl>
<div id="outline-container-headline-41" class="outline-3">
<h3 id="headline-41">
Math Functions
</h3>
<div id="outline-text-headline-41" class="outline-text-3">
<p><strong>systell(*/fd/</strong>)* The systell math function returns the current file
position for the file descriptor passed as an argument.</p>
</div>
</div>
<div id="outline-container-headline-42" class="outline-3">
<h3 id="headline-42">
Parameters
</h3>
<div id="outline-text-headline-42" class="outline-text-3">
<p><strong>errnos</strong> A readonly array of the names of errors defined on the system.
These are typically macros defined in C by including the system header
file <strong>errno.h*/. The index of each name (assuming the option
/*KSH_ARRAYS</strong> is unset) corresponds to the error number. Error numbers
<em>num</em> before the last known error which have no name are given the name
*E*/num in the array./</p>
<blockquote>
<p>Note that aliases for errors are not handled; only the canonical name is
used.</p>
</blockquote>
<dl>
<dt>
<strong>sysparams</strong>
</dt>
<dd>
<p>A readonly associative array. The keys are:</p>
<p>
<strong>pid</strong> Returns the process ID of the current process, even in
subshells. Compare *$$*/, which returns the process ID of the main
shell process./</p>
<dl>
<dt>
<strong>ppid</strong>
</dt>
<dd>Returns the current process ID of the parent of the
current process, even in subshells. Compare *$PPID*/, which returns
the process ID of the/ initial parent of the main shell process.</dd>
<dt>
<strong>procsubstpid</strong>
</dt>
<dd>Returns the process ID of the last process started
for process substitution, i.e. the <strong>&lt;(*/…/</strong>)*/ and/ <strong>&gt;(*/…/</strong>)*/
expansions./</dd>
</dl>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-43" class="outline-2">
<h2 id="headline-43">
THE ZSH/NET/TCP MODULE
</h2>
<div id="outline-text-headline-43" class="outline-text-2">
<p>The *zsh/net/tcp*/ module makes available one builtin command:/</p>
<p>
<strong>ztcp*/ [ /</strong>-acflLtv*/ ] [ <em><strong>-d</strong></em> fd ] [ args ]/ *ztcp*/ is implemented
as a builtin to allow full use of shell/ command line editing, file I/O,
and job control mechanisms.</p>
<blockquote>
<p>If *ztcp*/ is run with no options, it will output/ the contents of its
session table.</p>
<p>
If it is run with only the option *-L*/, it will output the contents of/
the session table in a format suitable for automatic parsing. The option
is ignored if given with a command to open or close a session. The
output consists of a set of lines, one per session, each containing the
following elements separated by spaces:</p>
<p>
File descriptor The file descriptor in use for the connection. For
normal inbound (*I*/)/ and outbound (*O*/) connections this may be read
and written by the usual/ shell mechanisms. However, it should only be
close with `*ztcp -c*/&#39;./</p>
<dl>
<dt>
Connection type
</dt>
<dd>
<p>A letter indicating how the session was created:</p>
<p>
<strong>Z</strong> A session created with the *zftp*/ command./</p>
<dl>
<dt>
<strong>L</strong>
</dt>
<dd>A connection opened for listening with `*ztcp -l*/&#39;./</dd>
<dt>
<strong>I</strong>
</dt>
<dd>An inbound connection accepted with `*ztcp -a*/&#39;./</dd>
<dt>
<strong>O</strong>
</dt>
<dd>An outbound connection created with `*ztcp*/ host …&#39;./</dd>
</dl>
</dd>
<dt>
The local host
</dt>
<dd>This is usually set to an all-zero IP address as the
address of the localhost is irrelevant.</dd>
<dt>
The local port
</dt>
<dd>This is likely to be zero unless the connection is
for listening.</dd>
<dt>
The remote host
</dt>
<dd>This is the fully qualified domain name of the
peer, if available, else an IP address. It is an all-zero IP address
for a session opened for listening.</dd>
<dt>
The remote port
</dt>
<dd>This is zero for a connection opened for listening.</dd>
</dl>
</blockquote>
<div id="outline-container-headline-44" class="outline-3">
<h3 id="headline-44">
Outbound Connections
</h3>
<div id="outline-text-headline-44" class="outline-text-3">
<p><strong>ztcp*/ [ /</strong>-v*/ ] [ <em><strong>-d</strong></em> fd ] host [ port ]/ Open a new TCP
connection to <em>host. If the port is</em> omitted, it will default to
port 23. The connection will be added to the session table and the shell
parameter *REPLY*/ will be set to the file descriptor associated/ with
that connection.</p>
<blockquote>
<p>If *-d*/ is specified, its argument will be taken as the target file/
descriptor for the connection.</p>
<p>
In order to elicit more verbose output, use *-v*/./</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-45" class="outline-3">
<h3 id="headline-45">
Inbound Connections
</h3>
<div id="outline-text-headline-45" class="outline-text-3">
<p><strong>ztcp*/ /</strong>-l*/ [ <em><strong>-v</strong></em> ] [ <em><strong>-d</strong></em> fd ] port/ *ztcp -l*/ will open a
socket listening on TCP/ <em>port. The socket will be added to the</em> session
table and the shell parameter <strong>REPLY</strong> will be set to the file descriptor
associated with that listener.</p>
<blockquote>
<p>If *-d*/ is specified, its argument will be taken as the target file/
descriptor for the connection.</p>
<p>
In order to elicit more verbose output, use *-v*/./</p>
</blockquote>
<dl>
<dt>
<strong>ztcp*/ /</strong>-a*/ [ <em><strong>-tv</strong></em> ] [ <em><strong>-d</strong></em> targetfd ] listenfd/
</dt>
<dd>*ztcp -a*/
will accept an incoming connection/ to the port associated with
<em>listenfd.</em> The connection will be added to the session table and the
shell parameter *REPLY*/ will/ be set to the file descriptor
associated with the inbound connection.

If *-d*/ is specified, its argument/ will be taken as the target file
descriptor for the connection.

If *-t*/ is specified, <em><strong>ztcp</strong></em> will return/ if no incoming connection
is pending. Otherwise it will wait for one.

In order to elicit more verbose output, use *-v*/./</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-46" class="outline-3">
<h3 id="headline-46">
Closing Connections
</h3>
<div id="outline-text-headline-46" class="outline-text-3">
<p><strong>ztcp*/ /</strong>-cf*/ [ <em><strong>-v</strong></em> ] [ fd ]/</p>
<p>
<strong>ztcp*/ /</strong>-c*/ [ <em><strong>-v</strong></em> ] [ fd ]/ *ztcp -c*/ will close the socket
associated/ with <em>fd. The socket will be removed from the</em> session
table. If <em>fd is not specified,</em> *ztcp*/ will close everything in the
session table./</p>
<blockquote>
<p>Normally, sockets registered by zftp (see <em>zshmodules(1)</em> ) cannot be
closed this way. In order to force such a socket closed, use *-f*/./</p>
<p>
In order to elicit more verbose output, use *-v*/./</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-47" class="outline-3">
<h3 id="headline-47">
Example
</h3>
<div id="outline-text-headline-47" class="outline-text-3">
<p>Here is how to create a TCP connection between two instances of zsh. We
need to pick an unassigned port; here we use the randomly chosen 5123.</p>
<p>
On *host1*/,/</p>
<blockquote>
<pre class="example">
zmodload zsh/net/tcp
ztcp -l 5123
listenfd=$REPLY
ztcp -a $listenfd
fd=$REPLY
</pre>
</blockquote>
<p>
The second from last command blocks until there is an incoming
connection.</p>
<p>
Now create a connection from *host2*/ (which may, of course, be the
same/ machine):</p>
<blockquote>
<pre class="example">
zmodload zsh/net/tcp
ztcp host1 5123
fd=$REPLY
</pre>
</blockquote>
<p>
Now on each host, *$fd*/ contains a file descriptor for talking to the/
other. For example, on *host1*/:/</p>
<blockquote>
<pre class="example">
print This is a message &gt;&amp;$fd
</pre>
</blockquote>
<p>
and on *host2*/:/</p>
<blockquote>
<pre class="example">
read -r line &lt;&amp;$fd; print -r - $line
</pre>
</blockquote>
<p>
prints `*This is a message*/&#39;./</p>
<p>
To tidy up, on *host1*/:/</p>
<blockquote>
<pre class="example">
ztcp -c $listenfd
ztcp -c $fd
</pre>
</blockquote>
<p>
and on <strong>host2</strong></p>
<blockquote>
<pre class="example">
ztcp -c $fd
</pre>
</blockquote>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-48" class="outline-2">
<h2 id="headline-48">
THE ZSH/TERMCAP MODULE
</h2>
<div id="outline-text-headline-48" class="outline-text-2">
<p>The *zsh/termcap*/ module makes available one builtin command:/</p>
<p>
*echotc*/ cap [ arg … ]/ Output the termcap value corresponding to the
capability <em>cap, with optional arguments.</em></p>
<p>
The *zsh/termcap*/ module makes available one parameter:/</p>
<p>
<strong>termcap</strong> An associative array that maps termcap capability codes to
their values.</p>
</div>
</div>
<div id="outline-container-headline-49" class="outline-2">
<h2 id="headline-49">
THE ZSH/TERMINFO MODULE
</h2>
<div id="outline-text-headline-49" class="outline-text-2">
<p>The *zsh/terminfo*/ module makes available one builtin command:/</p>
<p>
*echoti*/ cap [ arg ]/ Output the terminfo value corresponding to the
capability <em>cap, instantiated with arg if applicable.</em></p>
<p>
The *zsh/terminfo*/ module makes available one parameter:/</p>
<p>
<strong>terminfo</strong> An associative array that maps terminfo capability names to
their values.</p>
</div>
</div>
<div id="outline-container-headline-50" class="outline-2">
<h2 id="headline-50">
THE ZSH/WATCH MODULE
</h2>
<div id="outline-text-headline-50" class="outline-text-2">
<p>The *zsh/watch*/ module can be used to report when specific users log in
or/ out. This is controlled via the following parameters.</p>
<p>
<strong>LOGCHECK</strong> The interval in seconds between checks for login/logout
activity using the *watch*/ parameter./</p>
<dl>
<dt>
*watch*/ &lt;S&gt; &lt;Z&gt; (<em><strong>WATCH</strong></em> &lt;S&gt;)/
</dt>
<dd>
<p>An array (colon-separated list)
of login/logout events to report.</p>
<p>
If it contains the single word `*all*/&#39;, then all login/logout events/
are reported. If it contains the single word `*notme*/&#39;, then all/
events are reported as with `*all*/&#39; except <em><strong>$USERNAME</strong></em>./</p>
<p>
An entry in this list may consist of a username, an `*@*/&#39; followed by
a remote hostname,/ and a `*%*/&#39; followed by a line (tty). Any of
these may/ be a pattern (be sure to quote this during the assignment
to *watch*/ so that it does not immediately perform file generation);/
the setting of the *EXTENDED_GLOB*/ option is respected./ Any or all
of these components may be present in an entry; if a login/logout
event matches all of them, it is reported.</p>
<p>
For example, with the *EXTENDED_GLOB*/ option set, the following:/</p>
<blockquote>
<pre class="example">
watch=(&#39;^(pws|barts)&#39;)
</pre>
</blockquote>
<p>
causes reports for activity associated with any user other than <strong>pws</strong>
or *barts*/./</p>
</dd>
<dt>
<strong>WATCHFMT</strong>
</dt>
<dd>
<p>The format of login/logout reports if the *watch*/
parameter is set./ Default is `*%n has %a %l from %m*/&#39;./ Recognizes
the following escape sequences:</p>
<p>
<strong>%n</strong> The name of the user that logged in/out.</p>
<dl>
<dt>
<strong>%a</strong>
</dt>
<dd>The observed action, i.e. &#34;logged on&#34; or &#34;logged off&#34;.</dd>
<dt>
<strong>%l</strong>
</dt>
<dd>The line (tty) the user is logged in on.</dd>
<dt>
<strong>%M</strong>
</dt>
<dd>The full hostname of the remote host.</dd>
<dt>
<strong>%m</strong>
</dt>
<dd>The hostname up to the first `*.*/&#39;. If only the/ IP address
is available or the utmp field contains the name of an X-windows
display, the whole name is printed.

<em>NOTE:</em> The `*%m*/&#39; and `/*%M*/&#39; escapes will work only if there is
a host name/ field in the utmp on your machine. Otherwise they are
treated as ordinary strings.</dd>
<dt>
<strong>%F{*/color/</strong>}*/ (<em><strong>%f</strong></em>)/
</dt>
<dd>Start (stop) using a different
foreground color.</dd>
<dt>
<strong>%K{*/color/</strong>}*/ (<em><strong>%k</strong></em>)/
</dt>
<dd>Start (stop) using a different
background color.</dd>
<dt>
*%S*/ (<em><strong>%s</strong></em>)/
</dt>
<dd>Start (stop) standout mode.</dd>
<dt>
*%U*/ (<em><strong>%u</strong></em>)/
</dt>
<dd>Start (stop) underline mode.</dd>
<dt>
*%B*/ (<em><strong>%b</strong></em>)/
</dt>
<dd>Start (stop) boldface mode.</dd>
</dl>
<p><strong>%t</strong></p>
<p>
<strong>%@</strong> The time, in 12-hour, am/pm format.</p>
<dl>
<dt>
<strong>%T</strong>
</dt>
<dd>The time, in 24-hour format.</dd>
<dt>
<strong>%w</strong>
</dt>
<dd>The date in `/day/*-*/dd&#39; format./</dd>
<dt>
<strong>%W</strong>
</dt>
<dd>The date in `/mm/*/*/dd/*/*/yy&#39; format./</dd>
<dt>
<strong>%D</strong>
</dt>
<dd>The date in `/yy/*-<strong><em>mm</em></strong>-*/dd&#39; format./</dd>
<dt>
<strong>%D{*/string/</strong>}*
</dt>
<dd>The date formatted as <em>string using the
/*strftime*</em> function, with/ zsh extensions as described by
EXPANSION OF PROMPT SEQUENCES in <em>zshmisc(1).</em></dd>
<dt>
<strong>%(*/x/</strong>:*/true-text/*:*/false-text/*)*
</dt>
<dd>Specifies a ternary
expression. The character following the <em>x is</em> arbitrary; the same
character is used to separate the text for the &#34;true&#34; result from
that for the &#34;false&#34; result. Both the separator and the right
parenthesis may be escaped with a backslash. Ternary expressions may
be nested.

The test character <em>x may be any one of `/*l*</em>&#39;, `/*n*/&#39;, `/*m*/&#39;/
or `*M*/&#39;, which indicate a `true&#39; result if the corresponding/
escape sequence would return a non-empty value; or it may be
`*a*/&#39;,/ which indicates a `true&#39; result if the watched user has
logged in, or `false&#39; if he has logged out. Other characters
evaluate to neither true nor false; the entire expression is omitted
in this case.

If the result is `true&#39;, then the <em>true-text</em> is formatted according
to the rules above and printed, and the <em>false-text is skipped.</em> If
`false&#39;, the <em>true-text is skipped and the false-text</em> is formatted
and printed. Either or both of the branches may be empty, but both
separators must be present in any case.</dd>
</dl>
</dd>
</dl>
<p>Furthermore, the *zsh/watch*/ module makes available one builtin/
command:</p>
<p>
<strong>log</strong> List all users currently logged in who are affected by the current
setting of the *watch*/ parameter./</p>
</div>
</div>
<div id="outline-container-headline-51" class="outline-2">
<h2 id="headline-51">
THE ZSH/ZFTP MODULE
</h2>
<div id="outline-text-headline-51" class="outline-text-2">
<p>The *zsh/zftp*/ module makes available one builtin command:/</p>
<p>
*zftp*/ subcommand [ args ]/ The *zsh/zftp*/ module is a client for FTP
(file transfer protocol). It/ is implemented as a builtin to allow full
use of shell command line editing, file I/O, and job control mechanisms.
Often, users will access it via shell functions providing a more
powerful interface; a set is provided with the *zsh*/ distribution and
is described in/ <em>zshzftpsys(1). However, the /*zftp*</em> command is
entirely usable in its/ own right.</p>
<blockquote>
<p>All commands consist of the command name *zftp*/ followed by the name/
of a subcommand. These are listed below. The return status of each
subcommand is supposed to reflect the success or failure of the remote
operation. See a description of the variable *ZFTP_VERBOSE*/ for/ more
information on how responses from the server may be printed.</p>
</blockquote>
<div id="outline-container-headline-52" class="outline-3">
<h3 id="headline-52">
Subcommands
</h3>
<div id="outline-text-headline-52" class="outline-text-3">
<p><strong>open*/ host[/</strong>:*/port] [ user [ password [ account ] ] ]/ Open a new
FTP session to <em>host, which may be the name of a TCP/IP</em> connected host
or an IP number in the standard dot notation. If the argument is in the
form <em>host/*:*/port, open a connection to</em> TCP port <em>port instead of the
standard FTP port 21. This may be</em> the name of a TCP service or a
number: see the description of *ZFTP_PORT*/ below for more information./</p>
<blockquote>
<p>If IPv6 addresses in colon format are used, the <em>host should be</em>
surrounded by quoted square brackets to distinguish it from the <em>port,</em>
for example *&#39;[fe80::203:baff:fe02:8b56]&#39;*/. For consistency this is/
allowed with all forms of <em>host.</em></p>
<p>
Remaining arguments are passed to the *login*/ subcommand. Note that/ if
no arguments beyond <em>host are supplied, /*open*</em> will not/ automatically
call *login*/. If no arguments at all are supplied,/ *open*/ will use
the parameters set by the <em><strong>params</strong></em> subcommand./</p>
<p>
After a successful open, the shell variables *ZFTP_HOST*/,
<em><strong>ZFTP_PORT</strong></em>,/ *ZFTP_IP*/ and <em><strong>ZFTP_SYSTEM</strong></em> are available; see
`Variables&#39;/ below.</p>
</blockquote>
<p>
*login*/ [ name [ password [ account ] ] ]/</p>
<p>
*user*/ [ name [ password [ account ] ] ]/ Login the user <em>name with
parameters password and account.</em> Any of the parameters can be omitted,
and will be read from standard input if needed (/name is always needed).
If / standard input is a terminal, a prompt for each one will be printed
on standard error and <em>password will not be echoed. If any of the</em>
parameters are not used, a warning message is printed.</p>
<blockquote>
<p>After a successful login, the shell variables *ZFTP_USER*/,/
*ZFTP_ACCOUNT*/ and <em><strong>ZFTP_PWD</strong></em> are available; see `Variables&#39;/ below.</p>
<p>
This command may be re-issued when a user is already logged in, and the
server will first be reinitialized for a new user.</p>
</blockquote>
<p>
*params*/ [ host [ user [ password [ account ] ] ] ]/</p>
<p>
<strong>params*/ /</strong>-* Store the given parameters for a later *open*/ command
with no/ arguments. Only those given on the command line will be
remembered. If no arguments are given, the parameters currently set are
printed, although the password will appear as a line of stars; the
return status is one if no parameters were set, zero otherwise.</p>
<blockquote>
<p>Any of the parameters may be specified as a `*?*/&#39;, which/ may need to
be quoted to protect it from shell expansion. In this case, the
appropriate parameter will be read from stdin as with the <strong>login*/
subcommand, including special handling of password. If the/ `</strong>?*/&#39; is
followed by a string, that is used as the prompt for reading the/
parameter instead of the default message (any necessary punctuation and
whitespace should be included at the end of the prompt). The first
letter of the parameter (only) may be quoted with a `*\*/&#39;; hence an
argument/ <strong>&#34;\\$word&#34;*/ guarantees that the string from the shell
parameter /*$word</strong> will be treated literally, whether or not it begins
with a `*?*/&#39;./</p>
<p>
If instead a single `*-*/&#39; is given, the existing parameters, if any,/
are deleted. In that case, calling *open*/ with no arguments will/ cause
an error.</p>
<p>
The list of parameters is not deleted after a *close*/, however it/ will
be deleted if the *zsh/zftp*/ module is unloaded./</p>
<p>
For example,</p>
<blockquote>
<pre class="example">
zftp params ftp.elsewhere.xx juser &#39;?Password for juser: &#39;
</pre>
</blockquote>
<p>
will store the host *ftp.elsewhere.xx*/ and the user <em><strong>juser</strong></em> and/ then
prompt the user for the corresponding password with the given prompt.</p>
</blockquote>
<dl>
<dt>
<strong>test</strong>
</dt>
<dd>Test the connection; if the server has reported that it has
closed the connection (maybe due to a timeout), return status 2; if no
connection was open anyway, return status 1; else return status 0. The
<strong>test*/ subcommand is/ silent, apart from messages printed by the
*$ZFTP_VERBOSE</strong> mechanism, or error messages if the connection closes.
There is no network overhead for this test.

The test is only supported on systems with either the <strong>select(2)*/ or/
*poll(2)*/ system calls; otherwise the message `/*not</strong> supported on
this system/&#39; is printed instead./

The *test*/ subcommand will automatically be called at the start of
any/ other subcommand for the current session when a connection is
open.</dd>
<dt>
*cd*/ directory/
</dt>
<dd>Change the remote directory to <em>directory. Also
alters the shell</em> variable *ZFTP_PWD*/./</dd>
<dt>
<strong>cdup</strong>
</dt>
<dd>Change the remote directory to the one higher in the
directory tree. Note that *cd ..*/ will also work correctly on
non-UNIX systems./</dd>
<dt>
*dir*/ [ arg … ]/
</dt>
<dd>Give a (verbose) listing of the remote
directory. The <em>args are</em> passed directly to the server. The command&#39;s
behaviour is implementation dependent, but a UNIX server will
typically interpret <em>args as</em> arguments to the *ls*/ command and with
no arguments return the/ result of `*ls -l*/&#39;. The directory is listed
to standard output./</dd>
<dt>
*ls*/ [ arg … ]/
</dt>
<dd>Give a (short) listing of the remote directory.
With no <em>arg,</em> produces a raw list of the files in the directory, one
per line. Otherwise, up to vagaries of the server implementation,
behaves similar to *dir*/./</dd>
<dt>
*type*/ [ type ]/
</dt>
<dd>Change the type for the transfer to <em>type, or
print the current type</em> if <em>type is absent. The allowed values are
`/*A*</em>&#39; (ASCII),/ `*I*/&#39; (Image, i.e. binary), or `/*B*/&#39; (a synonym
for `/*I*/&#39;)./

The FTP default for a transfer is ASCII. However, if *zftp*/ finds/
that the remote host is a UNIX machine with 8-bit byes, it will
automatically switch to using binary for file transfers upon *open*/.
This can subsequently be overridden./

The transfer type is only passed to the remote host when a data
connection is established; this command involves no network overhead.</dd>
<dt>
<strong>ascii</strong>
</dt>
<dd>The same as *type A*/./</dd>
<dt>
<strong>binary</strong>
</dt>
<dd>The same as *type I*/./</dd>
<dt>
*mode*/ [ <em><strong>S</strong></em> | <em><strong>B</strong></em> ]/
</dt>
<dd>Set the mode type to stream (*S*/) or
block (<em><strong>B</strong></em>). Stream mode is/ the default; block mode is not widely
supported.</dd>
</dl>
<p>*remote*/ file …/</p>
<p>
*local*/ [ file … ]/ Print the size and last modification time of the
remote or local files. If there is more than one item on the list, the
name of the file is printed first. The first number is the file size,
the second is the last modification time of the file in the format
*CCYYMMDDhhmmSS*/ consisting of year, month, date, hour, minutes and/
seconds in GMT. Note that this format, including the length, is
guaranteed, so that time strings can be directly compared via the *[[*/
builtin&#39;s <em><strong>&lt;</strong></em> and <em><strong>&gt;</strong></em> operators, even if they are too long/ to be
represented as integers.</p>
<blockquote>
<p>Not all servers support the commands for retrieving this information. In
that case, the *remote*/ command will print nothing and return/ status
2, compared with status 1 for a file not found.</p>
<p>
The *local*/ command (but not <em><strong>remote</strong></em>) may be used with no/
arguments, in which case the information comes from examining file
descriptor zero. This is the same file as seen by a *put*/ command/ with
no further redirection.</p>
</blockquote>
<dl>
<dt>
*get*/ file …/
</dt>
<dd>Retrieve all <em>files from the server, concatenating
them</em> and sending them to standard output.</dd>
<dt>
*put*/ file …/
</dt>
<dd>For each <em>file, read a file from standard input
and send that to</em> the remote host with the given name.</dd>
<dt>
*append*/ file …/
</dt>
<dd>As *put*/, but if the remote file already
exists, data is/ appended to it instead of overwriting it.</dd>
</dl>
<p>*getat*/ file point/</p>
<p>
*putat*/ file point/</p>
<p>
*appendat*/ file point/ Versions of *get*/, <em><strong>put</strong></em> and <em><strong>append</strong></em> which
will start the/ transfer at the given <em>point in the remote file. This
is</em> useful for appending to an incomplete local file. However, note that
this ability is not universally supported by servers (and is not quite
the behaviour specified by the standard).</p>
<dl>
<dt>
*delete*/ file …/
</dt>
<dd>Delete the list of files on the server.</dd>
<dt>
*mkdir*/ directory/
</dt>
<dd>Create a new directory <em>directory on the
server.</em></dd>
<dt>
*rmdir*/ directory/
</dt>
<dd>Delete the directory <em>directory on the server.</em></dd>
<dt>
*rename*/ old-name new-name/
</dt>
<dd>Rename file <em>old-name to new-name on
the server.</em></dd>
<dt>
*site*/ arg …/
</dt>
<dd>Send a host-specific command to the server. You
will probably only need this if instructed by the server to use it.</dd>
<dt>
*quote*/ arg …/
</dt>
<dd>Send the raw FTP command sequence to the server.
You should be familiar with the FTP command set as defined in RFC959
before doing this. Useful commands may include *STAT*/ and <em><strong>HELP</strong></em>.
Note also/ the mechanism for returning messages as described for the
variable *ZFTP_VERBOSE*/ below, in particular that all messages from
the/ control connection are sent to standard error.</dd>
</dl>
<p><strong>close</strong></p>
<p>
<strong>quit</strong> Close the current data connection. This unsets the shell
parameters *ZFTP_HOST*/, <em><strong>ZFTP_PORT</strong></em>, <em><strong>ZFTP_IP</strong></em>, <em><strong>ZFTP_SYSTEM</strong></em>,
<em><strong>ZFTP_USER</strong></em>,/ *ZFTP_ACCOUNT*/, <em><strong>ZFTP_PWD</strong></em>, <em><strong>ZFTP_TYPE</strong></em> and
<em><strong>ZFTP_MODE</strong></em>./</p>
<dl>
<dt>
*session*/ [ sessname ]/
</dt>
<dd>Allows multiple FTP sessions to be used at
once. The name of the session is an arbitrary string of characters;
the default session is called `*default*/&#39;. If this command is called
without an argument, it will list/ all the current sessions; with an
argument, it will either switch to the existing session called
<em>sessname, or create a new session of that name.</em>

Each session remembers the status of the connection, the set of
connection-specific shell parameters (the same set as are unset when a
connection closes, as given in the description of *close*/), and any
user/ parameters specified with the *params*/ subcommand. Changing to
a/ previous session restores those values; changing to a new session
initialises them in the same way as if *zftp*/ had just been loaded.
The/ name of the current session is given by the parameter
*ZFTP_SESSION*/./</dd>
<dt>
*rmsession*/ [ sessname ]/
</dt>
<dd>Delete a session; if a name is not
given, the current session is deleted. If the current session is
deleted, the earliest existing session becomes the new current
session, otherwise the current session is not changed. If the session
being deleted is the only one, a new session called `*default*/&#39; is
created and becomes the current session; note that this is/ a new
session even if the session being deleted is also called `*default*/&#39;.
It is recommended that sessions not be deleted while/ background
commands which use *zftp*/ are still active./</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-53" class="outline-3">
<h3 id="headline-53">
Parameters
</h3>
<div id="outline-text-headline-53" class="outline-text-3">
<p>The following shell parameters are used by *zftp*/. Currently none/ of
them are special.</p>
<p>
<strong>ZFTP_TMOUT</strong> Integer. The time in seconds to wait for a network
operation to complete before returning an error. If this is not set when
the module is loaded, it will be given the default value 60. A value of
zero turns off timeouts. If a timeout occurs on the control connection
it will be closed. Use a larger value if this occurs too frequently.</p>
<dl>
<dt>
<strong>ZFTP_IP</strong>
</dt>
<dd>Readonly. The IP address of the current connection in dot
notation.</dd>
<dt>
<strong>ZFTP_HOST</strong>
</dt>
<dd>Readonly. The hostname of the current remote server. If
the host was opened as an IP number, *ZFTP_HOST*/ contains that
instead; this/ saves the overhead for a name lookup, as IP numbers are
most commonly used when a nameserver is unavailable.</dd>
<dt>
<strong>ZFTP_PORT</strong>
</dt>
<dd>Readonly. The number of the remote TCP port to which
the connection is open (even if the port was originally specified as a
named service). Usually this is the standard FTP port, 21.

In the unlikely event that your system does not have the appropriate
conversion functions, this appears in network byte order. If your
system is little-endian, the port then consists of two swapped bytes
and the standard port will be reported as 5376. In that case, numeric
ports passed to *zftp open*/ will also need to be in this format./</dd>
<dt>
<strong>ZFTP_SYSTEM</strong>
</dt>
<dd>Readonly. The system type string returned by the
server in response to an FTP *SYST*/ request. The most interesting
case is a string/ beginning *&#34;UNIX Type: L8&#34;*/, which ensures maximum
compatibility/ with a local UNIX host.</dd>
<dt>
<strong>ZFTP_TYPE</strong>
</dt>
<dd>Readonly. The type to be used for data transfers ,
either `*A*/&#39; or/ `*I*/&#39;. Use the <em><strong>type</strong></em> subcommand to change this./</dd>
<dt>
<strong>ZFTP_USER</strong>
</dt>
<dd>Readonly. The username currently logged in, if any.</dd>
<dt>
<strong>ZFTP_ACCOUNT</strong>
</dt>
<dd>Readonly. The account name of the current user, if
any. Most servers do not require an account name.</dd>
<dt>
<strong>ZFTP_PWD</strong>
</dt>
<dd>Readonly. The current directory on the server.</dd>
<dt>
<strong>ZFTP_CODE</strong>
</dt>
<dd>Readonly. The three digit code of the last FTP reply
from the server as a string. This can still be read after the
connection is closed, and is not changed when the current session
changes.</dd>
<dt>
<strong>ZFTP_REPLY</strong>
</dt>
<dd>Readonly. The last line of the last reply sent by the
server. This can still be read after the connection is closed, and is
not changed when the current session changes.</dd>
<dt>
<strong>ZFTP_SESSION</strong>
</dt>
<dd>Readonly. The name of the current FTP session; see
the description of the *session*/ subcommand./</dd>
<dt>
<strong>ZFTP_PREFS</strong>
</dt>
<dd>
<p>A string of preferences for altering aspects of
*zftp*/&#39;s behaviour./ Each preference is a single character. The
following are defined:</p>
<p>
<strong>P</strong> Passive: attempt to make the remote server initiate data
transfers. This is slightly more efficient than sendport mode. If the
letter *S*/ occurs later in the string, <em><strong>zftp</strong></em> will use sendport
mode if/ passive mode is not available.</p>
<dl>
<dt>
<strong>S</strong>
</dt>
<dd>Sendport: initiate transfers by the FTP *PORT*/ command. If
this/ occurs before any *P*/ in the string, passive mode will never
be/ attempted.</dd>
<dt>
<strong>D</strong>
</dt>
<dd>Dumb: use only the bare minimum of FTP commands. This
prevents the variables *ZFTP_SYSTEM*/ and <em><strong>ZFTP_PWD</strong></em> from being
set, and/ will mean all connections default to ASCII type. It may
prevent *ZFTP_SIZE*/ from being set during a transfer if the server/
does not send it anyway (many servers do).</dd>
</dl>
<p>If *ZFTP_PREFS*/ is not set when <em><strong>zftp</strong></em> is loaded, it will be set to
a/ default of `*PS*/&#39;, i.e. use passive mode if available, otherwise/
fall back to sendport mode.</p>
</dd>
<dt>
<strong>ZFTP_VERBOSE</strong>
</dt>
<dd>
<p>A string of digits between 0 and 5 inclusive,
specifying which responses from the server should be printed. All
responses go to standard error. If any of the numbers 1 to 5 appear in
the string, raw responses from the server with reply codes beginning
with that digit will be printed to standard error. The first digit of
the three digit reply code is defined by RFC959 to correspond to:</p>
<ol>
<li>A positive preliminary reply.</li>
</ol>
<dl>
<dt>
2.
</dt>
<dd>A positive completion reply.</dd>
<dt>
3.
</dt>
<dd>A positive intermediate reply.</dd>
<dt>
4.
</dt>
<dd>A transient negative completion reply.</dd>
<dt>
5.
</dt>
<dd>A permanent negative completion reply.</dd>
</dl>
<p>It should be noted that, for unknown reasons, the reply `Service not
available&#39;, which forces termination of a connection, is classified as
421, i.e. `transient negative&#39;, an interesting interpretation of the
word `transient&#39;.</p>
<p>
The code 0 is special: it indicates that all but the last line of
multiline replies read from the server will be printed to standard
error in a processed format. By convention, servers use this mechanism
for sending information for the user to read. The appropriate reply
code, if it matches the same response, takes priority.</p>
<p>
If *ZFTP_VERBOSE*/ is not set when <em><strong>zftp</strong></em> is loaded, it will be/ set
to the default value *450*/, i.e., messages destined for the user/ and
all errors will be printed. A null string is valid and specifies that
no messages should be printed.</p>
</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-54" class="outline-3">
<h3 id="headline-54">
Functions
</h3>
<div id="outline-text-headline-54" class="outline-text-3">
<p><strong>zftp_chpwd</strong> If this function is set by the user, it is called every
time the directory changes on the server, including when a user is
logged in, or when a connection is closed. In the last case, <strong>$ZFTP_PWD</strong>
will be unset; otherwise it will reflect the new directory.</p>
<dl>
<dt>
<strong>zftp_progress</strong>
</dt>
<dd>
<p>If this function is set by the user, it will be
called during a *get*/, <em><strong>put</strong></em> or <em><strong>append</strong></em> operation each time
sufficient data/ has been received from the host. During a *get*/, the
data is sent/ to standard output, so it is vital that this function
should write to standard error or directly to the terminal, <em>not to
standard</em> output.</p>
<p>
When it is called with a transfer in progress, the following
additional shell parameters are set:</p>
<p>
<strong>ZFTP_FILE</strong> The name of the remote file being transferred from or to.</p>
<dl>
<dt>
<strong>ZFTP_TRANSFER</strong>
</dt>
<dd>A *G*/ for a <em><strong>get</strong></em> operation and a <em><strong>P</strong></em> for a
<em><strong>put</strong></em> operation./</dd>
<dt>
<strong>ZFTP_SIZE</strong>
</dt>
<dd>The total size of the complete file being
transferred: the same as the first value provided by the *remote*/
and <em><strong>local</strong></em> subcommands for a particular file./ If the server
cannot supply this value for a remote file being retrieved, it will
not be set. If input is from a pipe the value may be incorrect and
correspond simply to a full pipe buffer.</dd>
<dt>
<strong>ZFTP_COUNT</strong>
</dt>
<dd>The amount of data so far transferred; a number
between zero and *$ZFTP_SIZE*/, if that is set. This number is
always available./</dd>
</dl>
<p>The function is initially called with *ZFTP_TRANSFER*/ set/
appropriately and *ZFTP_COUNT*/ set to zero. After the transfer is/
finished, the function will be called one more time with
*ZFTP_TRANSFER*/ set to <em><strong>GF</strong></em> or <em><strong>PF</strong></em>, in case it wishes to tidy/
up. It is otherwise never called twice with the same value of
*ZFTP_COUNT*/./</p>
<p>
Sometimes the progress meter may cause disruption. It is up to the
user to decide whether the function should be defined and to use
*unfunction*/ when necessary./</p>
</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-55" class="outline-3">
<h3 id="headline-55">
Problems
</h3>
<div id="outline-text-headline-55" class="outline-text-3">
<p>A connection may not be opened in the left hand side of a pipe as this
occurs in a subshell and the file information is not updated in the main
shell. In the case of type or mode changes or closing the connection in
a subshell, the information is returned but variables are not updated
until the next call to *zftp*/. Other status changes in subshells will
not be/ reflected by changes to the variables (but should be otherwise
harmless).</p>
<p>
Deleting sessions while a *zftp*/ command is active in the background
can/ have unexpected effects, even if it does not use the session being
deleted. This is because all shell subprocesses share information on the
state of all connections, and deleting a session changes the ordering of
that information.</p>
<p>
On some operating systems, the control connection is not valid after a
fork(), so that operations in subshells, on the left hand side of a
pipeline, or in the background are not possible, as they should be. This
is presumably a bug in the operating system.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-56" class="outline-2">
<h2 id="headline-56">
THE ZSH/ZLE MODULE
</h2>
<div id="outline-text-headline-56" class="outline-text-2">
<p>The *zsh/zle*/ module contains the Zsh Line Editor. See/ <em>zshzle(1).</em></p>
</div>
</div>
<div id="outline-container-headline-57" class="outline-2">
<h2 id="headline-57">
THE ZSH/ZLEPARAMETER MODULE
</h2>
<div id="outline-text-headline-57" class="outline-text-2">
<p>The *zsh/zleparameter*/ module defines two special parameters that can
be / used to access internal information of the Zsh Line Editor (see
<em>zshzle(1)).</em></p>
<p>
<strong>keymaps</strong> This array contains the names of the keymaps currently
defined.</p>
<dl>
<dt>
<strong>widgets</strong>
</dt>
<dd>This associative array contains one entry per widget. The
name of the widget is the key and the value gives information about
the widget. It is either the string `*builtin*/&#39; for builtin widgets,/
a string of the form `*user:*/name&#39; for user-defined widgets,/ where
<em>name is the name of the shell function implementing the widget,</em> a
string of the form `*completion:*/type/*:*/name&#39;/ for completion
widgets, or a null value if the widget is not yet fully defined. In
the penultimate case, <em>type is the name of the builtin widget the</em>
completion widget imitates in its behavior and <em>name is the name</em> of
the shell function implementing the completion widget.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-58" class="outline-2">
<h2 id="headline-58">
THE ZSH/ZPROF MODULE
</h2>
<div id="outline-text-headline-58" class="outline-text-2">
<p>When loaded, the <strong>zsh/zprof*/ causes shell functions to be profiled./
The profiling results can be obtained with the *zprof</strong> builtin command
made available by this module. There is no way to turn profiling off
other than unloading the module.</p>
<p>
<strong>zprof*/ [ /</strong>-c*/ ]/ Without the *-c*/ option, <em><strong>zprof</strong></em> lists profiling
results to/ standard output. The format is comparable to that of
commands like *gprof*/./</p>
<blockquote>
<p>At the top there is a summary listing all functions that were called at
least once. This summary is sorted in decreasing order of the amount of
time spent in each. The lines contain the number of the function in
order, which is used in other parts of the list in suffixes of the form
`*[*/num/*]*/&#39;, then the number of calls made to the function./ The next
three columns list the time in milliseconds spent in the function and
its descendants, the average time in milliseconds spent in the function
and its descendants per call and the percentage of time spent in all
shell functions used in this function and its descendants. The following
three columns give the same information, but counting only the time
spent in the function itself. The final column shows the name of the
function.</p>
<p>
After the summary, detailed information about every function that was
invoked is listed, sorted in decreasing order of the amount of time
spent in each function and its descendants. Each of these entries
consists of descriptions for the functions that called the function
described, the function itself, and the functions that were called from
it. The description for the function itself has the same format as in
the summary (and shows the same information). The other lines don&#39;t show
the number of the function at the beginning and have their function
named indented to make it easier to distinguish the line showing the
function described in the section from the surrounding lines.</p>
<p>
The information shown in this case is almost the same as in the summary,
but only refers to the call hierarchy being displayed. For example, for
a calling function the column showing the total running time lists the
time spent in the described function and its descendants only for the
times when it was called from that particular calling function.
Likewise, for a called function, this columns lists the total time spent
in the called function and its descendants only for the times when it
was called from the function described.</p>
<p>
Also in this case, the column showing the number of calls to a function
also shows a slash and then the total number of invocations made to the
called function.</p>
<p>
As long as the *zsh/zprof*/ module is loaded, profiling will be done
and/ multiple invocations of the *zprof*/ builtin command will show the/
times and numbers of calls since the module was loaded. With the *-c*/
option, the <em><strong>zprof</strong></em> builtin command will reset its internal/ counters
and will not show the listing.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-59" class="outline-2">
<h2 id="headline-59">
THE ZSH/ZPTY MODULE
</h2>
<div id="outline-text-headline-59" class="outline-text-2">
<p>The *zsh/zpty*/ module offers one builtin:/</p>
<p>
<strong>zpty*/ [ /</strong>-e*/ ] [ <em><strong>-b</strong></em> ] name [ arg … ]/ The arguments following
<em>name are concatenated with spaces between,</em> then executed as a command,
as if passed to the *eval*/ builtin. The/ command runs under a newly
assigned pseudo-terminal; this is useful for running commands
non-interactively which expect an interactive environment. The <em>name is
not part of the command, but is used to</em> refer to this command in later
calls to *zpty*/./</p>
<blockquote>
<p>With the *-e*/ option, the pseudo-terminal is set up so that input/
characters are echoed.</p>
<p>
With the *-b*/ option, input to and output from the pseudo-terminal are/
made non-blocking.</p>
<p>
The shell parameter *REPLY*/ is set to the file descriptor assigned to/
the master side of the pseudo-terminal. This allows the terminal to be
monitored with ZLE descriptor handlers (see <em>zshzle(1)) or manipulated
with /*sysread*</em> and/ <strong>syswrite*/ (see THE ZSH/SYSTEM MODULE in
zshmodules(1)). Warning: Use of /*sysread</strong> and <strong>syswrite*/ is not
recommended; use <em><strong>zpty -r</strong></em> and /*zpty -w</strong> unless you know exactly what
you are doing.</p>
</blockquote>
<dl>
<dt>
<strong>zpty*/ /</strong>-d*/ [ name … ]/
</dt>
<dd>The second form, with the *-d*/
option, is used to delete commands/ previously started, by supplying a
list of their <em>names. If no</em> <em>name is given, all commands are deleted.
Deleting a command causes</em> the HUP signal to be sent to the
corresponding process.</dd>
<dt>
<strong>zpty*/ /</strong>-w*/ [ <em><strong>-n</strong></em> ] name [ string … ]/
</dt>
<dd>The *-w*/ option can
be used to send the to command name the given/ <em>strings as input
(separated by spaces). If the /*-n*</em> option is/ <em>not given, a newline
is added at the end.</em>

If no <em>string is provided, the standard input is copied to the</em>
pseudo-terminal; this may stop before copying the full input if the
pseudo-terminal is non-blocking. The exact input is always copied: the
*-n*/ option is not applied./

Note that the command under the pseudo-terminal sees this input as if
it were typed, so beware when sending special tty driver characters
such as word-erase, line-kill, and end-of-file.</dd>
<dt>
<strong>zpty*/ /</strong>-r*/ [ <em><strong>-mt</strong></em> ] name [ param [ pattern ] ]/
</dt>
<dd>The *-r*/
option can be used to read the output of the command name./ With only
a <em>name argument, the output read is copied to the standard</em> output.
Unless the pseudo-terminal is non-blocking, copying continues until
the command under the pseudo-terminal exits; when non-blocking, only
as much output as is immediately available is copied. The return
status is zero if any output is copied.

When also given a <em>param argument, at most one line is read and
stored</em> in the parameter named <em>param. Less than a full line may be
read if</em> the pseudo-terminal is non-blocking. The return status is
zero if at least one character is stored in <em>param.</em>

If a <em>pattern is given as well, output is read until the whole string</em>
read matches the <em>pattern, even in the non-blocking case. The return</em>
status is zero if the string read matches the pattern, or if the
command has exited but at least one character could still be read. If
the option *-m*/ is present, the return status is zero only if the
pattern matches./ As of this writing, a maximum of one megabyte of
output can be consumed this way; if a full megabyte is read without
matching the pattern, the return status is non-zero.

In all cases, the return status is non-zero if nothing could be read,
and is *2*/ if this is because the command has finished./

If the <strong>-r*/ option is combined with the /</strong>-t*/ option, <em><strong>zpty</strong></em>
tests/ whether output is available before trying to read. If no output
is available, *zpty*/ immediately returns the status <em><strong>1</strong></em>. When used/
with a <em>pattern, the behaviour on a failed poll is similar to</em> when
the command has exited: the return value is zero if at least one
character could still be read even if the pattern failed to match.</dd>
<dt>
<strong>zpty*/ /</strong>-t*/ name/
</dt>
<dd>The <strong>-t*/ option without the /</strong>-r*/ option can
be used to test/ whether the command <em>name is still running. It
returns a zero</em> status if the command is running and a non-zero value
otherwise.</dd>
<dt>
<strong>zpty*/ [ /</strong>-L*/ ]/
</dt>
<dd>The last form, without any arguments, is used
to list the commands currently defined. If the *-L*/ option is given,
this is done in the/ form of calls to the *zpty*/ builtin./</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-60" class="outline-2">
<h2 id="headline-60">
THE ZSH/ZSELECT MODULE
</h2>
<div id="outline-text-headline-60" class="outline-text-2">
<p>The *zsh/zselect*/ module makes available one builtin command:/</p>
<p>
<strong>zselect*/ [ /</strong>-rwe*/ ] [ <em><strong>-t</strong></em> timeout ] [ <em><strong>-a</strong></em> array ] [ <em><strong>-A</strong></em>
assoc ] [ fd … ]/ The *zselect*/ builtin is a front-end to the
`select&#39; system call, which/ blocks until a file descriptor is ready for
reading or writing, or has an error condition, with an optional timeout.
If this is not available on your system, the command prints an error
message and returns status 2 (normal errors return status 1). For more
information, see your system&#39;s documentation for <em>select(3). Note there
is no connection with the</em> shell builtin of the same name.</p>
<blockquote>
<p>Arguments and options may be intermingled in any order. Non-option
arguments are file descriptors, which must be decimal integers. By
default, file descriptors are to be tested for reading, i.e. <strong>zselect</strong>
will return when data is available to be read from the file descriptor,
or more precisely, when a read operation from the file descriptor will
not block. After a <strong>-r*/, /</strong>-w*/ and <em><strong>-e</strong></em>, the given file descriptors
are/ to be tested for reading, writing, or error conditions. These
options and an arbitrary list of file descriptors may be given in any
order.</p>
<p>
(The presence of an `error condition&#39; is not well defined in the
documentation for many implementations of the select system call.
According to recent versions of the POSIX specification, it is really an
<em>exception condition, of which the only standard example is out-of-band</em>
data received on a socket. So zsh users are unlikely to find the <strong>-e</strong>
option useful.)</p>
<p>
The option `*-t*/ timeout&#39; specifies a timeout in hundredths of a/
second. This may be zero, in which case the file descriptors will simply
be polled and *zselect*/ will return immediately. It is possible to
call/ zselect with no file descriptors and a non-zero timeout for use as
a finer-grained replacement for `sleep&#39;; note, however, the return
status is always 1 for a timeout.</p>
<p>
The option `*-a*/ array&#39; indicates that array should be set to/ indicate
the file descriptor(s) which are ready. If the option is not given, the
array *reply*/ will be used for this purpose. The array will/ contain a
string similar to the arguments for *zselect*/. For example,/</p>
<blockquote>
<pre class="example">
zselect -t 0 -r 0 -w 1
</pre>
</blockquote>
<p>
might return immediately with status 0 and <strong>$reply*/ containing `/</strong>-r 0
-w* 1/&#39; to show that both file descriptors are ready for the requested/
operations.</p>
<p>
The option `*-A*/ assoc&#39; indicates that the associative array/ <em>assoc
should be set to indicate the file descriptor(s)</em> which are ready. This
option overrides the option *-a*/, nor will/ *reply*/ be modified. The
keys of <em><strong>assoc</strong></em> are the file descriptors, and/ the corresponding
values are any of the characters `*rwe*/&#39; to indicate/ the condition.</p>
<p>
The command returns status 0 if some file descriptors are ready for
reading. If the operation timed out, or a timeout of 0 was given and no
file descriptors were ready, or there was an error, it returns status 1
and the array will not be set (nor modified in any way). If there was an
error in the select operation the appropriate error message is printed.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-61" class="outline-2">
<h2 id="headline-61">
THE ZSH/ZUTIL MODULE
</h2>
<div id="outline-text-headline-61" class="outline-text-2">
<p>The *zsh/zutil*/ module only adds some builtins:/</p>
<p>
<strong>zstyle*/ [ /</strong>-L*/ [ metapattern [ style ] ] ]/</p>
<p>
<strong>zstyle*/ [ /</strong>-e*/ | <em><strong>-</strong></em> | <em><strong>–</strong></em> ] pattern style string …/</p>
<p>
*zstyle -d*/ [ pattern [ style … ] ]/</p>
<p>
*zstyle -g*/ name [ pattern [ style ] ]/</p>
<p>
*zstyle -*/{<em><strong>a*/|/*b*/|/*s</strong></em>} context style name [ sep ]/</p>
<p>
*zstyle -*/{<em><strong>T*/|/*t</strong></em>} context style [ string … ]/</p>
<p>
*zstyle -m*/ context style pattern/ This builtin command is used to
define and lookup styles. Styles are pairs of names and values, where
the values consist of any number of strings. They are stored together
with patterns and lookup is done by giving a string, called the
`/context&#39;, which is matched against the/ patterns. The definition
stored for the most specific pattern that matches will be returned.</p>
<blockquote>
<p>A pattern is considered to be more specific than another if it contains
more components (substrings separated by colons) or if the patterns for
the components are more specific, where simple strings are considered to
be more specific than patterns and complex patterns are considered to be
more specific than the pattern `***/&#39;. A `/***/&#39; in the pattern will
match zero or more characters/ in the context; colons are not treated
specially in this regard. If two patterns are equally specific, the tie
is broken in favour of the pattern that was defined first.</p>
<p>
<em>Example</em></p>
<p>
For example, a fictional `*weather*/&#39; plugin might state in its
documentation/ that it looks up the *preferred-precipitation*/ style
under the/
`*:weather:*/continent/*:*/day-of-the-week/*:*/phase-of-the-moon&#39;
context./ According to this, you might set the following in your
*zshrc*/:/</p>
<blockquote>
<pre class="example">
zstyle &#39;:weather:europe:*&#39; preferred-precipitation rain
zstyle &#39;:weather:*:Sunday:*&#39; preferred-precipitation snow
</pre>
</blockquote>
<p>
Then the plugin would run under the hood a command such as</p>
<blockquote>
<pre class="example">
zstyle -s &#34;:weather:${continent}:${day_of_week}:${moon_phase}&#34; preferred-precipitation REPLY
</pre>
</blockquote>
<p>
in order to retrieve your preference into the scalar variable
*$REPLY*/./ On Sundays *$REPLY*/ would be set to `/*snow*/&#39;; in Europe
it would be set/ to `*rain*/&#39;; and on Sundays in Europe it would be set
to `/*snow*/&#39; again,/ because the patterns `*:weather:europe:**/&#39; and
`/*:weather:*:Sunday:**/&#39; both/ match the <em>context argument to /*zstyle
-s*</em>, are equally specific, and the/ latter is more specific (because it
has more colon-separated components).</p>
<p>
<em>Usage</em></p>
<p>
The forms that operate on patterns are the following.</p>
<p>
<strong>zstyle*/ [ /</strong>-L*/ [ metapattern [ style ] ] ]/ Without arguments, lists
style definitions. Styles are shown in alphabetic order and patterns are
shown in the order *zstyle*/ will test them./</p>
<blockquote>
<p>If the *-L*/ option is given, listing is done in the form of calls to/
*zstyle*/. The optional first argument, metapattern, is a pattern which/
will be matched against the string supplied as <em>pattern when the style
was</em> defined. Note: this means, for example, `*zstyle -L
&#34;:completion:*&#34;<strong><em>&#39; will</em> match any supplied pattern beginning
`</strong>:completion:*/&#39;, not/ just <strong>&#34;:completion:</strong>&#34;<strong>/: use
/</strong>&#39;:completion:\*&#39;*/ to match that./ The optional second argument limits
the output to a specific <em>style (not a</em> pattern). *-L*/ is not
compatible with any other options./</p>
</blockquote>
<ul>
<li><strong>zstyle*/ [ /</strong>-<strong>/ | /</strong>–<strong>/ | /</strong>-e*/ ] pattern style string
…/ :: Defines the given <em>style for the pattern with the strings as</em>
the value. If the *-e*/ option is given, the strings will be/
concatenated (separated by spaces) and the resulting string will be
evaluated (in the same way as it is done by the *eval*/ builtin/
command) when the style is looked up. In this case the parameter
`*reply*/&#39; must be assigned to set the strings returned after the/
evaluation. Before evaluating the value, *reply*/ is unset, and/ if it
is still unset after the evaluation, the style is treated as if it
were not set.</li>
<li>*zstyle -d*/ [ pattern [ style … ] ]/ :: Delete style definitions.
Without arguments all definitions are deleted, with a <em>pattern all
definitions for that pattern are deleted and if</em> any <em>styles are
given, then only those styles are deleted for the</em> <em>pattern.</em></li>
<li>*zstyle -g*/ name [ pattern [ style ] ]/ :: Retrieve a style
definition. The <em>name is</em> used as the name of an array in which the
results are stored. Without any further arguments, all patterns
defined are returned. With a /pattern the styles defined for that
pattern are returned and with / both a <em>pattern and a style, the value
strings of that</em> combination is returned.</li>
</ul>
<p>The other forms can be used to look up or test styles for a given
context.</p>
<p>
*zstyle -s*/ context style name [ sep ]/ The parameter <em>name is set to
the value of the style interpreted as a</em> string. If the value contains
several strings they are concatenated with spaces (or with the <em>sep
string if that is given) between them.</em></p>
<blockquote>
<p>Return *0*/ if the style is set, <em><strong>1</strong></em> otherwise./</p>
</blockquote>
<dl>
<dt>
*zstyle -b*/ context style name/
</dt>
<dd>The value is stored in <em>name as a
boolean, i.e. as the string</em> `*yes*/&#39; if the value has only one string
and that string is equal to one/ of `*yes*/&#39;, `/*true*/&#39;, `/*on*/&#39;, or
`/*1*/&#39;. If the value is any other/ string or has more than one
string, the parameter is set to `*no*/&#39;./

Return *0*/ if name is set to `/*yes*/&#39;, <em><strong>1</strong></em> otherwise./</dd>
<dt>
*zstyle -a*/ context style name/
</dt>
<dd>The value is stored in /name as an
array. If name is declared / as an associative array, the first,
third, etc. strings are used as the keys and the other strings are
used as the values.

Return *0*/ if the style is set, <em><strong>1</strong></em> otherwise./</dd>
</dl>
<p>*zstyle -t*/ context style [ string … ]/</p>
<p>
*zstyle -T*/ context style [ string … ]/ Test the value of a style,
i.e. the *-t*/ option only returns a status/ (sets *$?*/). Without any
string the return status is zero if the/ style is defined for at least
one matching pattern, has only one string in its value, and that is
equal to one of `*true*/&#39;, `/*yes*/&#39;, `/*on*/&#39; or/ `*1*/&#39;. If any
strings are given the status is zero if and only if/ at least one of the
<em>strings is equal to at least one of the strings</em> in the value. If the
style is defined but doesn&#39;t match, the return status is *1*/. If the
style is not defined, the status is <em><strong>2</strong></em>./</p>
<blockquote>
<p>The <strong>-T*/ option tests the values of the style like /</strong>-t*/, but it/
returns status zero (rather than *2*/) if the style is not defined for
any/ matching pattern.</p>
</blockquote>
<dl>
<dt>
*zstyle -m*/ context style pattern/
</dt>
<dd>Match a value. Returns status
zero if the <em>pattern matches at least one of the strings in the
value.</em></dd>
</dl>
</blockquote>
<p>
*zformat -f*/ param format spec …/</p>
<p>
*zformat -F*/ param format spec …/</p>
<p>
*zformat -a*/ array sep spec …/ This builtin provides different forms
of formatting. The first form is selected with the *-f*/ option. In this
case the format/ string will be modified by replacing sequences starting
with a percent sign in it with strings from the <em>specs. Each spec should
be</em> of the form `/char/*:*/string&#39; which will cause every/ appearance of
the sequence `*%*/char&#39; in format to be replaced / by the <em>string. The
`/*%*</em>&#39; sequence may also contain optional/ minimum and maximum field
width specifications between the `*%*/&#39; and / the `/char&#39; in the form
`/*%*/min/*.*/max/*c*/&#39;,/ i.e. the minimum field width is given first
and if the maximum field width is used, it has to be preceded by a dot.
Specifying a minimum field width makes the result be padded with spaces
to the right if the <em>string is shorter than the requested width. Padding
to the left</em> can be achieved by giving a negative minimum field width.
If a maximum field width is specified, the <em>string will be truncated
after that</em> many characters. After all `*%*/&#39; sequences for the given
specs/ have been processed, the resulting string is stored in the
parameter <em>param.</em></p>
<blockquote>
<p>The *%*/-escapes also understand ternary expressions in the form used
by/ prompts. The *%*/ is followed by a `/*(*/&#39; and then an ordinary/
format specifier character as described above. There may be a set of
digits either before or after the `*(*/&#39;; these specify a test/ number,
which defaults to zero. Negative numbers are also allowed. An arbitrary
delimiter character follows the format specifier, which is followed by a
piece of `true&#39; text, the delimiter character again, a piece of `false&#39;
text, and a closing parenthesis. The complete expression (without the
digits) thus looks like `*%(<strong><em>X</em></strong>.*/text1/*.*/text2/*)*/&#39;, except that/
the `*.*/&#39; character is arbitrary. The value given for the format/
specifier in the <em>char/*:*/string expressions is evaluated as a</em>
mathematical expression, and compared with the test number. If they are
the same, <em>text1 is output, else text2 is output. A parenthesis</em> may be
escaped in <em>text2 as /*%)*</em>. Either of text1 or/ <em>text2 may contain
nested /*%*</em>-escapes./</p>
<p>
For example:</p>
<blockquote>
<pre class="example">
zformat -f REPLY &#34;The answer is &#39;%3(c.yes.no)&#39;.&#34; c:3
</pre>
</blockquote>
<p>
outputs &#34;The answer is &#39;yes&#39;.&#34; to *REPLY*/ since the value for the
format/ specifier *c*/ is 3, agreeing with the digit argument to the
ternary/ expression.</p>
<p>
With <strong>-F*/ instead of /</strong>-f*/, ternary expressions choose between the/
`true&#39; or `false&#39; text on the basis of whether the format specifier is
present and non-empty. A test number indicates a minimum width for the
value given in the format specifier. Negative numbers reverse this, so
the test is for whether the value exceeds a maximum width.</p>
<p>
The form, using the <strong>-a*/ option, can be used for aligning/ strings.
Here, the <em>specs are of the form</em> `/left/</strong>:*/right&#39; where `left&#39; and
`right&#39; are/ arbitrary strings. These strings are modified by replacing
the colons by the /sep string and padding the left strings with spaces /
to the right so that the <em>sep strings in the result (and hence the /
/right strings after them) are all aligned if the strings are</em> printed
below each other. All strings without a colon are left unchanged and all
strings with an empty <em>right string have the</em> trailing colon removed. In
both cases the lengths of the strings are not used to determine how the
other strings are to be aligned. A colon in the <em>left string can be
escaped with a backslash.</em> The resulting strings are stored in the
<em>array.</em></p>
</blockquote>
<dl>
<dt>
<strong>zregexparse</strong>
</dt>
<dd>This implements some internals of the
*_regex_arguments*/ function./</dd>
<dt>
?
</dt>
<dd>
<p><strong>zparseopts*/ [ /</strong>-D*/ <em><strong>-E</strong></em> <em><strong>-F</strong></em> <em><strong>-K</strong></em> <em><strong>-M</strong></em> ] [ <em><strong>-a</strong></em> array ]
[ <em><strong>-A</strong></em> assoc ] [ <em><strong>-</strong></em> ] spec …/ :: This builtin simplifies the
parsing of options in positional parameters, i.e. the set of arguments
given by *$**/. Each spec describes one/ option and must be of the
form `/opt[/*=*/array]&#39;. If an option/ described by <em>opt is found in
the positional parameters it is copied</em> into the <em>array specified with
the /*-a*</em> option; if the optional/ `*=*/array&#39; is given, it is
instead copied into that array, which/ should be declared as a normal
array and never as an associative array.</p>
<p>
Note that it is an error to give any <em>spec without an</em> `*=*/array&#39;
unless one of the <em><strong>-a</strong></em> or <em><strong>-A</strong></em> options is used./</p>
<p>
Unless the <strong>-E*/ option is given, parsing stops at the first string/
that isn&#39;t described by one of the /specs. Even with /</strong>-E*/,/ parsing
always stops at a positional parameter equal to `*-<strong><em>&#39; or</em> `</strong>–<strong>/&#39;.
See also /</strong>-F*/./</p>
<p>
The <em>opt description must be one of the following. Any of the special</em>
characters can appear in the option name provided it is preceded by a
backslash.</p>
<p>
<em>name</em></p>
<p>
<em>name/*+* The /name is the name of the option without the leading
`/*-*</em>&#39;. To/ specify a GNU-style long option, one of the usual two
leading `*-<strong><em>&#39; must</em> be included in <em>name; for example, a `</em></strong>–file*/&#39;
option is/ represented by a <em>name of `/*-file*</em>&#39;./</p>
<blockquote>
<p>If a `*+*/&#39; appears after name, the option is appended to array/ each
time it is found in the positional parameters; without the `*+*/&#39;/
only the <em>last occurrence of the option is preserved.</em></p>
<p>
If one of these forms is used, the option takes no argument, so
parsing stops if the next positional parameter does not also begin
with `*-*/&#39;/ (unless the *-E*/ option is used)./</p>
</blockquote>
<p>
/name/*:*</p>
<p>
/name/*:-*</p>
<p>
/name/*::* If one or two colons are given, the option takes an
argument; with one colon, the argument is mandatory and with two
colons it is optional. The argument is appended to the <em>array after
the option itself.</em></p>
<blockquote>
<p>An optional argument is put into the same array element as the option
name (note that this makes empty strings as arguments
indistinguishable). A mandatory argument is added as a separate
element unless the `*:-*/&#39; form/ is used, in which case the argument
is put into the same element.</p>
<p>
A `*+*/&#39; as described above may appear between the name and the/ first
colon.</p>
</blockquote>
<p>
In all cases, option-arguments must appear either immediately
following the option in the same positional parameter or in the next
one. Even an optional argument may appear in the next parameter,
unless it begins with a `*-*/&#39;./ There is no special handling of
`*=*/&#39; as with GNU-style argument parsers;/ given the <em>spec
`/*-foo:*</em>&#39;, the positional parameter `/*–foo=bar*/&#39;/ is parsed as
`*–foo*/&#39; with an argument of `/*=bar*/&#39;./</p>
<p>
When the names of two options that take no arguments overlap, the
longest one wins, so that parsing for the <em>specs `/*-foo -foobar*</em>&#39;
(for example) is/ unambiguous. However, due to the aforementioned
handling of option-arguments, ambiguities may arise when at least one
overlapping <em>spec takes an</em> argument, as in `*-foo: -foobar*/&#39;. In
that case, the last matching/ <em>spec wins.</em></p>
<p>
The options of <strong>zparseopts*/ itself cannot be stacked because, for/
example, the stack `</strong>-DEK*/&#39; is indistinguishable from a spec for/ the
GNU-style long option `*–DEK*/&#39;. The options of /*zparseopts* itself
are:</p>
<p>
*-a*/ array/ As described above, this names the default array in which
to store the recognised options.</p>
<dl>
<dt>
*-A*/ assoc/
</dt>
<dd>If this is given, the options and their values are
also put into an associative array with the option names as keys and
the arguments (if any) as the values.</dd>
<dt>
<strong>-D</strong>
</dt>
<dd>If this option is given, all options found are removed from
the positional parameters of the calling shell or shell function, up
to but not including any not described by the <em>specs. If the first
such parameter is `/*-*</em>&#39;/ or `*–*/&#39;, it is removed as well. This
is similar to using the/ *shift*/ builtin./</dd>
<dt>
<strong>-E</strong>
</dt>
<dd>This changes the parsing rules to <em>not stop at the first
string</em> that isn&#39;t described by one of the <em>specs. It can be used to
test</em> for or (if used together with *-D*/) extract options and
their/ arguments, ignoring all other options and arguments that may
be in the positional parameters. As indicated above, parsing still
stops at the first `*-<strong><em>&#39; or `</em></strong>–*/&#39; not described by a spec, but
it is not/ removed when used with *-D*/./</dd>
<dt>
<strong>-F</strong>
</dt>
<dd>If this option is given, *zparseopts*/ immediately stops at
the first/ option-like parameter not described by one of the <em>specs,
prints an</em> error message, and returns status 1. Removal (<strong>-D*/) and
extraction/ (</strong>-E*/) are not performed, and option arrays are not
updated. This/ provides basic validation for the given options.

Note that the appearance in the positional parameters of an option
without its required argument always aborts parsing and returns an
error as described above regardless of whether this option is used.</dd>
<dt>
<strong>-K</strong>
</dt>
<dd>With this option, the arrays specified with the *-a*/ option
and with the/ `*=*/array&#39; forms are kept unchanged when none of the
specs for/ them is used. Otherwise the entire array is replaced when
any of the <em>specs is used. Individual elements of associative arrays
specified</em> with the <strong>-A*/ option are preserved by /</strong>-K*/. This
allows assignment of/ default values to arrays before calling
*zparseopts*/./</dd>
<dt>
<strong>-M</strong>
</dt>
<dd>This changes the assignment rules to implement a map among
equivalent option names. If any <em>spec uses the `/*=*/array&#39; form,
the</em> string <em>array is interpreted as the name of another spec,</em>
which is used to choose where to store the values. If no other
<em>spec</em> is found, the values are stored as usual. This changes only
the way the values are stored, not the way *$**/ is parsed, so
results may be/ unpredictable if the `/name/*+*/&#39; specifier is used
inconsistently./</dd>
</dl>
<p>For example,</p>
<blockquote>
<pre class="example">
set -- -a -bx -c y -cz baz -cend
zparseopts a=foo b:=bar c+:=bar
</pre>
</blockquote>
<p>
will have the effect of</p>
<blockquote>
<pre class="example">
foo=(-a)
bar=(-b x -c y -c z)
</pre>
</blockquote>
<p>
The arguments from `*baz*/&#39; on will not be used./</p>
<p>
As an example for the *-E*/ option, consider:/</p>
<blockquote>
<pre class="example">
set -- -a x -b y -c z arg1 arg2
zparseopts -E -D b:=bar
</pre>
</blockquote>
<p>
will have the effect of</p>
<blockquote>
<pre class="example">
bar=(-b y)
set -- -a x -c z arg1 arg2
</pre>
</blockquote>
<p>
I.e., the option *-b*/ and its arguments are taken from the/
positional parameters and put into the array *bar*/./</p>
<p>
The *-M*/ option can be used like this:/</p>
<blockquote>
<pre class="example">
set -- -a -bx -c y -cz baz -cend
zparseopts -A bar -M a=foo b+: c:=b
</pre>
</blockquote>
<p>
to have the effect of</p>
<blockquote>
<pre class="example">
foo=(-a)
bar=(-a &#39;&#39; -b xyz)
</pre>
</blockquote>
</dd>
</dl>
</div>
</div>


        </main>
        <footer class="container footer">
            <p>Copyright 2024. All rights reserved.</p>

        </footer>

        
        

        
            <script src="/js/main.js"></script>
    </body>
</html>
