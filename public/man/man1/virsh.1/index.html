<!DOCTYPE html>
<html
    lang="en-us"
    dir="ltr"
>
    <head>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Manpages - virsh.1 | Technical Notes</title>

      <link rel="stylesheet" href="/css/main.min.a9ecaac9d4f7845fc2de4738f7709cab0bd1c3d19c3466fadd637a6987603257.css" integrity="sha256-qeyqydT3hF/C3kc493CcqwvRw9GcNGb63WN6aYdgMlc=" crossorigin="anonymous">


<link rel="stylesheet" href="/css/syntax.css">
        
        
    </head>
    <body>
        <header class="container header">
            <span class="header__title">Technical Notes</span>
<button id="menuOpenBtn" class="header__menu-open-btn"><i data-lucide="menu"></i></button>

  <nav id="siteNav">
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a href="/notes/">Notes</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/man/">Manpages</a>
    </li>
    <li>
      <a href="/search/">Search</a>
    </li>
    </ul>
    <button id="menuCloseBtn" class="header__menu-close-btn"><i data-lucide="x"></i></button>
  </nav>


        </header>
        <main class="container">
            
    <h1>Manpages - virsh.1</h1>
    
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
NAME
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>virsh - management user interface</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
SYNOPSIS
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p><strong>virsh</strong> [/OPTION/]… [/COMMAND_STRING/]</p>
<p>
<strong>virsh</strong> [/OPTION/]… <em>COMMAND</em> [/ARG/]…</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
DESCRIPTION
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>The <strong>virsh</strong> program is the main interface for managing virsh guest
domains. The program can be used to create, pause, and shutdown domains.
It can also be used to list current domains. Libvirt is a C toolkit to
interact with the virtualization capabilities of recent versions of
Linux (and other OSes). It is free software available under the GNU
Lesser General Public License. Virtualization of the Linux Operating
System means the ability to run multiple instances of Operating Systems
concurrently on a single hardware system where the basic resources are
driven by a Linux instance. The library aims at providing a long term
stable C API. It currently supports Xen, QEMU, KVM, LXC, OpenVZ,
VirtualBox and VMware ESX.</p>
<p>
The basic structure of most virsh usage is:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh [OPTION]... &lt;command&gt; &lt;domain&gt; [ARG]...
</pre>
</blockquote>
</blockquote>
<p>
Where <em>command</em> is one of the commands listed below; <em>domain</em> is the
numeric domain id, or the domain name, or the domain UUID; and <em>ARGS</em>
are command specific options. There are a few exceptions to this rule in
the cases where the command in question acts on all domains, the entire
machine, or directly on the xen hypervisor. Those exceptions will be
clear for each of those commands. Note: it is permissible to give
numeric names to domains, however, doing so will result in a domain that
can only be identified by domain id. In other words, if a numeric value
is supplied it will be interpreted as a domain id, not as a name. Any
<em>command</em> starting with <strong>#</strong> is treated as a comment and silently
ignored, all other unrecognized <em>commands</em> are diagnosed.</p>
<p>
The <strong>virsh</strong> program can be used either to run one <em>COMMAND</em> by giving
the command and its arguments on the shell command line, or a
<em>COMMAND_STRING</em> which is a single shell argument consisting of multiple
<em>COMMAND</em> actions and their arguments joined with whitespace and
separated by semicolons or newlines between commands, where unquoted
backslash-newline pairs are elided. Within <em>COMMAND_STRING</em>, virsh
understands the same single, double, and backslash escapes as the shell,
although you must add another layer of shell escaping in creating the
single shell argument, and any word starting with unquoted <em>#</em> begins a
comment that ends at newline. If no command is given in the command
line, <strong>virsh</strong> will then start a minimal interpreter waiting for your
commands, and the <strong>quit</strong> command will then exit the program.</p>
<p>
The <strong>virsh</strong> program understands the following <em>OPTIONS</em>.</p>
<p>
<strong>-c</strong>, <strong>–connect</strong> <em>URI</em></p>
<p>
Connect to the specified <em>URI</em>, as if by the <strong>connect</strong> command, instead
of the default connection.</p>
<p>
<strong>-d</strong>, <strong>–debug</strong> <em>LEVEL</em></p>
<p>
Enable debug messages at integer <em>LEVEL</em> and above. <em>LEVEL</em> can range
from 0 to 4 (default). See the documentation of <strong>VIRSH_DEBUG</strong>
environment variable below for the description of each <em>LEVEL</em>.</p>
<blockquote>
<ul>
<li><strong>-e</strong>, <strong>–escape</strong> <em>string</em></li>
</ul>
</blockquote>
<p>
Set alternative escape sequence for <em>console</em> command. By default,
telnet&#39;s <strong>^]</strong> is used. Allowed characters when using hat notation are:
alphabetic character, @, [, ], , ^, _.</p>
<blockquote>
<ul>
<li><strong>-h</strong>, <strong>–help</strong></li>
</ul>
</blockquote>
<p>
Ignore all other arguments, and behave as if the <strong>help</strong> command were
given instead.</p>
<blockquote>
<ul>
<li><strong>-k</strong>, <strong>–keepalive-interval</strong> <em>INTERVAL</em></li>
</ul>
</blockquote>
<p>
Set an <em>INTERVAL</em> (in seconds) for sending keepalive messages to check
whether connection to the server is still alive. Setting the interval to
0 disables client keepalive mechanism.</p>
<blockquote>
<ul>
<li><strong>-K</strong>, <strong>–keepalive-count</strong> <em>COUNT</em></li>
</ul>
</blockquote>
<p>
Set a number of times keepalive message can be sent without getting an
answer from the server without marking the connection dead. There is no
effect to this setting in case the <em>INTERVAL</em> is set to 0.</p>
<blockquote>
<ul>
<li><strong>-l</strong>, <strong>–log</strong> <em>FILE</em></li>
</ul>
</blockquote>
<p>
Output logging details to <em>FILE</em>.</p>
<blockquote>
<ul>
<li><strong>-q</strong>, <strong>–quiet</strong></li>
</ul>
</blockquote>
<p>
Avoid extra informational messages.</p>
<blockquote>
<ul>
<li><strong>-r</strong>, <strong>–readonly</strong></li>
</ul>
</blockquote>
<p>
Make the initial connection read-only, as if by the <em>–readonly</em> option
of the <strong>connect</strong> command.</p>
<blockquote>
<ul>
<li><strong>-t</strong>, <strong>–timing</strong></li>
</ul>
</blockquote>
<p>
Output elapsed time information for each command.</p>
<blockquote>
<ul>
<li><strong>-v</strong>, <strong>–version[=short]</strong></li>
</ul>
</blockquote>
<p>
Ignore all other arguments, and prints the version of the libvirt
library virsh is coming from</p>
<blockquote>
<ul>
<li><strong>-V</strong>, <strong>–version=long</strong></li>
</ul>
</blockquote>
<p>
Ignore all other arguments, and prints the version of the libvirt
library virsh is coming from and which options and driver are compiled
in.</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
NOTES
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>Most <strong>virsh</strong> operations rely upon the libvirt library being able to
connect to an already running libvirtd service. This can usually be done
using the command <strong>service libvirtd start</strong>.</p>
<p>
Most <strong>virsh</strong> commands require root privileges to run due to the
communications channels used to talk to the hypervisor. Running as non
root will return an error.</p>
<p>
Most <strong>virsh</strong> commands act synchronously, except maybe shutdown, setvcpus
and setmem. In those cases the fact that the <strong>virsh</strong> program returned,
may not mean the action is complete and you must poll periodically to
detect that the guest completed the operation.</p>
<p>
<strong>virsh</strong> strives for backward compatibility. Although the <strong>help</strong> command
only lists the preferred usage of a command, if an older version of
<strong>virsh</strong> supported an alternate spelling of a command or option (such as
<em>–tunnelled</em> instead of <em>–tunneled</em>), then scripts using that older
spelling will continue to work.</p>
<p>
Several <strong>virsh</strong> commands take an optionally scaled integer; if no scale
is provided, then the default is listed in the command (for historical
reasons, some commands default to bytes, while other commands default to
kibibytes). The following case-insensitive suffixes can be used to
select a specific scale:</p>
<blockquote>
<blockquote>
<pre class="example">
b, byte  byte      1
KB       kilobyte  1,000
k, KiB   kibibyte  1,024
MB       megabyte  1,000,000
M, MiB   mebibyte  1,048,576
GB       gigabyte  1,000,000,000
G, GiB   gibibyte  1,073,741,824
TB       terabyte  1,000,000,000,000
T, TiB   tebibyte  1,099,511,627,776
PB       petabyte  1,000,000,000,000,000
P, PiB   pebibyte  1,125,899,906,842,624
EB       exabyte   1,000,000,000,000,000,000
E, EiB   exbibyte  1,152,921,504,606,846,976
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
GENERIC COMMANDS
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>The following commands are generic i.e. not specific to a domain.</p>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
help
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
help [command-or-group]
</pre>
</blockquote>
</blockquote>
<p>
This lists each of the virsh commands. When used without options, all
commands are listed, one per line, grouped into related categories,
displaying the keyword for each group.</p>
<p>
To display only commands for a specific group, give the keyword for that
group as an option. For example:</p>
<p>
<strong>Example 1:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
virsh # help host

Host and Hypervisor (help keyword &#39;host&#39;):
    capabilities                   capabilities
    cpu-models                     show the CPU models for an architecture
    connect                        (re)connect to hypervisor
    freecell                       NUMA free memory
    hostname                       print the hypervisor hostname
    qemu-attach                    Attach to existing QEMU process
    qemu-monitor-command           QEMU Monitor Command
    qemu-agent-command             QEMU Guest Agent Command
    sysinfo                        print the hypervisor sysinfo
    uri                            print the hypervisor canonical URI
</pre>
</blockquote>
</blockquote>
<p>
To display detailed information for a specific command, give its name as
the option instead. For example:</p>
<p>
<strong>Example 2:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
virsh # help list
  NAME
    list - list domains

  SYNOPSIS
    list [--inactive] [--all]

  DESCRIPTION
    Returns list of domains.

  OPTIONS
    --inactive       list inactive domains
    --all            list inactive &amp; active domains
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-7" class="outline-3">
<h3 id="headline-7">
quit, exit
</h3>
<div id="outline-text-headline-7" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
quit
exit
</pre>
</blockquote>
</blockquote>
<p>
quit this interactive terminal</p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
version
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
version [--daemon]
</pre>
</blockquote>
</blockquote>
<p>
Will print out the major version info about what this built from. If
<em>–daemon</em> is specified then the version of the libvirt daemon is
included in the output.</p>
<p>
<strong>Example:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
$ virsh version
Compiled against library: libvirt 1.2.3
Using library: libvirt 1.2.3
Using API: QEMU 1.2.3
Running hypervisor: QEMU 2.0.50

$ virsh version --daemon
Compiled against library: libvirt 1.2.3
Using library: libvirt 1.2.3
Using API: QEMU 1.2.3
Running hypervisor: QEMU 2.0.50
Running against daemon: 1.2.6
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
cd
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
cd [directory]
</pre>
</blockquote>
</blockquote>
<p>
Will change current directory to <em>directory</em>. The default directory for
the <strong>cd</strong> command is the home directory or, if there is no <em>HOME</em>
variable in the environment, the root directory.</p>
</div>
</div>
<div id="outline-container-headline-10" class="outline-3">
<h3 id="headline-10">
pwd
</h3>
<div id="outline-text-headline-10" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pwd
</pre>
</blockquote>
</blockquote>
<p>
Will print the current directory.</p>
</div>
</div>
<div id="outline-container-headline-11" class="outline-3">
<h3 id="headline-11">
connect
</h3>
<div id="outline-text-headline-11" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
connect [URI] [--readonly]
</pre>
</blockquote>
</blockquote>
<p>
(Re)-Connect to the hypervisor. When the shell is first started, this is
automatically run with the <em>URI</em> parameter requested by the <strong>-c</strong> option
on the command line. The <em>URI</em> parameter specifies how to connect to the
hypervisor. The URI docs &lt;<a href="https://libvirt.org/uri.html">https://libvirt.org/uri.html</a>&gt; list the values
supported, but the most common are:</p>
<blockquote>
<ul>
<li>xen:///system</li>
</ul>
<p>this is used to connect to the local Xen hypervisor</p>
<ul>
<li>qemu:///system</li>
</ul>
<p>connect locally as root to the daemon supervising QEMU and KVM domains</p>
<ul>
<li>qemu:///session</li>
</ul>
<p>connect locally as a normal user to his own set of QEMU and KVM domains</p>
<ul>
<li>lxc:///system</li>
</ul>
<p>connect to a local linux container</p>
</blockquote>
<p>
To find the currently used URI, check the <em>uri</em> command documented
below.</p>
<p>
For remote access see the URI docs &lt;<a href="https://libvirt.org/uri.html">https://libvirt.org/uri.html</a>&gt; on how
to make URIs. The <em>–readonly</em> option allows for read-only connection</p>
</div>
</div>
<div id="outline-container-headline-12" class="outline-3">
<h3 id="headline-12">
uri
</h3>
<div id="outline-text-headline-12" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
uri
</pre>
</blockquote>
</blockquote>
<p>
Prints the hypervisor canonical URI, can be useful in shell mode.</p>
</div>
</div>
<div id="outline-container-headline-13" class="outline-3">
<h3 id="headline-13">
hostname
</h3>
<div id="outline-text-headline-13" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
hostname
</pre>
</blockquote>
</blockquote>
<p>
Print the hypervisor hostname.</p>
</div>
</div>
<div id="outline-container-headline-14" class="outline-3">
<h3 id="headline-14">
sysinfo
</h3>
<div id="outline-text-headline-14" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
sysinfo
</pre>
</blockquote>
</blockquote>
<p>
Print the XML representation of the hypervisor sysinfo, if available.</p>
</div>
</div>
<div id="outline-container-headline-15" class="outline-3">
<h3 id="headline-15">
nodeinfo
</h3>
<div id="outline-text-headline-15" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodeinfo
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the node, like number and type of CPU,
and size of the physical memory. The output corresponds to virNodeInfo
structure. Specifically, the &#34;CPU socket(s)&#34; field means number of CPU
sockets per NUMA cell. The information libvirt displays is dependent
upon what each architecture may provide.</p>
</div>
</div>
<div id="outline-container-headline-16" class="outline-3">
<h3 id="headline-16">
nodecpumap
</h3>
<div id="outline-text-headline-16" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodecpumap [--pretty]
</pre>
</blockquote>
</blockquote>
<p>
Displays the node&#39;s total number of CPUs, the number of online CPUs and
the list of online CPUs.</p>
<p>
With <em>–pretty</em> the online CPUs are printed as a range instead of a
list.</p>
</div>
</div>
<div id="outline-container-headline-17" class="outline-3">
<h3 id="headline-17">
nodecpustats
</h3>
<div id="outline-text-headline-17" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodecpustats [cpu] [--percent]
</pre>
</blockquote>
</blockquote>
<p>
Returns cpu stats of the node. If <em>cpu</em> is specified, this will print
the specified cpu statistics only. If <em>–percent</em> is specified, this
will print the percentage of each kind of cpu statistics during 1
second.</p>
</div>
</div>
<div id="outline-container-headline-18" class="outline-3">
<h3 id="headline-18">
nodememstats
</h3>
<div id="outline-text-headline-18" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodememstats [cell]
</pre>
</blockquote>
</blockquote>
<p>
Returns memory stats of the node. If <em>cell</em> is specified, this will
print the specified cell statistics only.</p>
</div>
</div>
<div id="outline-container-headline-19" class="outline-3">
<h3 id="headline-19">
nodesevinfo
</h3>
<div id="outline-text-headline-19" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodesevinfo
</pre>
</blockquote>
</blockquote>
<p>
Reports information about the AMD SEV launch security features for the
node, if any. Some of this information is also reported in the domain
capabilities XML document.</p>
</div>
</div>
<div id="outline-container-headline-20" class="outline-3">
<h3 id="headline-20">
nodesuspend
</h3>
<div id="outline-text-headline-20" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodesuspend [target] [duration]
</pre>
</blockquote>
</blockquote>
<p>
Puts the node (host machine) into a system-wide sleep state and schedule
the node&#39;s Real-Time-Clock interrupt to resume the node after the time
duration specified by <em>duration</em> is out. <em>target</em> specifies the state to
which the host will be suspended to, it can be &#34;mem&#34; (suspend to RAM),
&#34;disk&#34; (suspend to disk), or &#34;hybrid&#34; (suspend to both RAM and disk).
<em>duration</em> specifies the time duration in seconds for which the host has
to be suspended, it should be at least 60 seconds.</p>
</div>
</div>
<div id="outline-container-headline-21" class="outline-3">
<h3 id="headline-21">
node-memory-tune
</h3>
<div id="outline-text-headline-21" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
node-memory-tune [shm-pages-to-scan] [shm-sleep-millisecs] [shm-merge-across-nodes]
</pre>
</blockquote>
</blockquote>
<p>
Allows you to display or set the node memory parameters.
<em>shm-pages-to-scan</em> can be used to set the number of pages to scan
before the shared memory service goes to sleep; <em>shm-sleep-millisecs</em>
can be used to set the number of millisecs the shared memory service
should sleep before next scan; <em>shm-merge-across-nodes</em> specifies if
pages from different numa nodes can be merged. When set to 0, only pages
which physically reside in the memory area of same NUMA node can be
merged. When set to 1, pages from all nodes can be merged. Default to 1.</p>
<p>
<strong>Note</strong>: Currently the &#34;shared memory service&#34; only means KSM (Kernel
Samepage Merging).</p>
</div>
</div>
<div id="outline-container-headline-22" class="outline-3">
<h3 id="headline-22">
capabilities
</h3>
<div id="outline-text-headline-22" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
capabilities [--xpath EXPRESSION] [--wrap]
</pre>
</blockquote>
</blockquote>
<p>
Print an XML document describing the capabilities of the hypervisor we
are currently connected to. This includes a section on the host
capabilities in terms of CPU and features, and a set of description for
each kind of guest which can be virtualized. For a more complete
description see:</p>
<p>
&lt;<a href="https://libvirt.org/formatcaps.html">https://libvirt.org/formatcaps.html</a>&gt;</p>
<p>
The XML also show the NUMA topology information if available.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-23" class="outline-3">
<h3 id="headline-23">
domcapabilities
</h3>
<div id="outline-text-headline-23" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domcapabilities [virttype] [emulatorbin] [arch] [machine]
                [--xpath EXPRESSION] [--wrap]
</pre>
</blockquote>
</blockquote>
<p>
Print an XML document describing the domain capabilities for the
hypervisor we are connected to using information either sourced from an
existing domain or taken from the <strong>virsh capabilities</strong> output. This may
be useful if you intend to create a new domain and are curious if for
instance it could make use of VFIO by creating a domain for the
hypervisor with a specific emulator and architecture.</p>
<p>
Each hypervisor will have different requirements regarding which options
are required and which are optional. A hypervisor can support providing
a default value for any of the options.</p>
<p>
The <em>virttype</em> option specifies the virtualization type used. The value
to be used is either from the &#39;type&#39; attribute of the &lt;domain/&gt; top
level element from the domain XML or the &#39;type&#39; attribute found within
each &lt;guest/&gt; element from the <strong>virsh capabilities</strong> output. The
<em>emulatorbin</em> option specifies the path to the emulator. The value to be
used is either the &lt;emulator&gt; element in the domain XML or the <strong>virsh
capabilities</strong> output. The <em>arch</em> option specifies the architecture to be
used for the domain. The value to be used is either the &#34;arch&#34; attribute
from the domain&#39;s XML &lt;os/&gt; element and &lt;type/&gt; subelement or the &#34;name&#34;
attribute of an &lt;arch/&gt; element from the <strong>virsh capabililites</strong> output.
The <em>machine</em> specifies the machine type for the emulator. The value to
be used is either the &#34;machine&#34; attribute from the domain&#39;s XML &lt;os/&gt;
element and &lt;type/&gt; subelement or one from a list of machines from the
<strong>virsh capabilities</strong> output for a specific architecture and domain type.</p>
<p>
For the QEMU hypervisor, a <em>virttype</em> of either &#39;qemu&#39; or &#39;kvm&#39; must be
supplied along with either the <em>emulatorbin</em> or <em>arch</em> in order to
generate output for the default <em>machine</em>. Supplying a <em>machine</em> value
will generate output for the specific machine.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-24" class="outline-3">
<h3 id="headline-24">
pool-capabilities
</h3>
<div id="outline-text-headline-24" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-capabilities
</pre>
</blockquote>
</blockquote>
<p>
Print an XML document describing the storage pool capabilities for the
connected storage driver. This may be useful if you intend to create a
new storage pool and need to know the available pool types and supported
storage pool source and target volume formats as well as the required
source elements to create the pool.</p>
</div>
</div>
<div id="outline-container-headline-25" class="outline-3">
<h3 id="headline-25">
inject-nmi
</h3>
<div id="outline-text-headline-25" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
inject-nmi domain
</pre>
</blockquote>
</blockquote>
<p>
Inject NMI to the guest.</p>
</div>
</div>
<div id="outline-container-headline-26" class="outline-3">
<h3 id="headline-26">
list
</h3>
<div id="outline-text-headline-26" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
list [--inactive | --all]
     [--managed-save] [--title]
     { [--table] | --name | --uuid | --id }
     [--persistent] [--transient]
     [--with-managed-save] [--without-managed-save]
     [--autostart] [--no-autostart]
     [--with-snapshot] [--without-snapshot]
     [--with-checkpoint] [--without-checkpoint]
     [--state-running] [--state-paused]
     [--state-shutoff] [--state-other]
</pre>
</blockquote>
</blockquote>
<p>
Prints information about existing domains. If no options are specified
it prints out information about running domains.</p>
<p>
<strong>Example 1:</strong></p>
<p>
An example format for the list is as follows:</p>
<blockquote>
<blockquote>
<pre class="example">
``virsh`` list
  Id    Name                           State
----------------------------------------------------
  0     Domain-0                       running
  2     fedora                         paused
</pre>
</blockquote>
</blockquote>
<p>
Name is the name of the domain. ID the domain numeric id. State is the
run state (see below).</p>
<p>
<strong>STATES</strong></p>
<p>
The State field lists what state each domain is currently in. A domain
can be in one of the following possible states:</p>
<blockquote>
<ul>
<li><strong>running</strong></li>
</ul>
<p>The domain is currently running on a CPU</p>
<ul>
<li><strong>idle</strong></li>
</ul>
<p>The domain is idle, and not running or runnable. This can be caused
because the domain is waiting on IO (a traditional wait state) or has
gone to sleep because there was nothing else for it to do.</p>
<ul>
<li><strong>paused</strong></li>
</ul>
<p>The domain has been paused, usually occurring through the administrator
running <strong>virsh suspend</strong>. When in a paused state the domain will still
consume allocated resources like memory, but will not be eligible for
scheduling by the hypervisor.</p>
<ul>
<li><strong>in shutdown</strong></li>
</ul>
<p>The domain is in the process of shutting down, i.e. the guest operating
system has been notified and should be in the process of stopping its
operations gracefully.</p>
<ul>
<li><strong>shut off</strong></li>
</ul>
<p>The domain is not running. Usually this indicates the domain has been
shut down completely, or has not been started.</p>
<ul>
<li><strong>crashed</strong></li>
</ul>
<p>The domain has crashed, which is always a violent ending. Usually this
state can only occur if the domain has been configured not to restart on
crash.</p>
<ul>
<li><strong>pmsuspended</strong></li>
</ul>
<p>The domain has been suspended by guest power management, e.g. entered
into s3 state.</p>
</blockquote>
<p>
Normally only active domains are listed. To list inactive domains
specify <em>–inactive</em> or <em>–all</em> to list both active and inactive
domains.</p>
<p>
<strong>Filtering</strong></p>
<p>
To further filter the list of domains you may specify one or more of
filtering flags supported by the <strong>list</strong> command. These flags are grouped
by function. Specifying one or more flags from a group enables the
filter group. Note that some combinations of flags may yield no results.
Supported filtering flags and groups:</p>
</div>
</div>
<div id="outline-container-headline-27" class="outline-3">
<h3 id="headline-27">
Persistence
</h3>
<div id="outline-text-headline-27" class="outline-text-3">
<p>Flag <em>–persistent</em> is used to include persistent guests in the returned
list. To include transient guests specify <em>–transient</em>.</p>
</div>
</div>
<div id="outline-container-headline-28" class="outline-3">
<h3 id="headline-28">
Existence of managed save image
</h3>
<div id="outline-text-headline-28" class="outline-text-3">
<p>To list domains having a managed save image specify flag
<em>–with-managed-save</em>. For domains that don&#39;t have a managed save image
specify <em>–without-managed-save</em>.</p>
</div>
</div>
<div id="outline-container-headline-29" class="outline-3">
<h3 id="headline-29">
Domain state
</h3>
<div id="outline-text-headline-29" class="outline-text-3">
<p>The following filter flags select a domain by its state:
<em>–state-running</em> for running domains, <em>–state-paused</em> for paused
domains, <em>–state-shutoff</em> for turned off domains and <em>–state-other</em>
for all other states as a fallback.</p>
</div>
</div>
<div id="outline-container-headline-30" class="outline-3">
<h3 id="headline-30">
Autostarting domains
</h3>
<div id="outline-text-headline-30" class="outline-text-3">
<p>To list autostarting domains use the flag <em>–autostart</em>. To list domains
with this feature disabled use <em>–no-autostart</em>.</p>
</div>
</div>
<div id="outline-container-headline-31" class="outline-3">
<h3 id="headline-31">
Snapshot existence
</h3>
<div id="outline-text-headline-31" class="outline-text-3">
<p>Domains that have snapshot images can be listed using flag
<em>–with-snapshot</em>, domains without a snapshot <em>–without-snapshot</em>.</p>
</div>
</div>
<div id="outline-container-headline-32" class="outline-3">
<h3 id="headline-32">
Checkpoint existence
</h3>
<div id="outline-text-headline-32" class="outline-text-3">
<p>Domains that have checkpoints can be listed using flag
<em>–with-checkpoint</em>, domains without a checkpoint
<em>–without-checkpoint</em>.</p>
<p>
When talking to older servers, this command is forced to use a series of
API calls with an inherent race, where a domain might not be listed or
might appear more than once if it changed state between calls while the
list was being collected. Newer servers do not have this problem.</p>
<p>
If <em>–managed-save</em> is specified, then domains that have managed save
state (only possible if they are in the <strong>shut off</strong> state, so you need to
specify <em>–inactive</em> or <em>–all</em> to actually list them) will instead show
as <strong>saved</strong> in the listing. This flag is usable only with the default
<em>–table</em> output. Note that this flag does not filter the list of
domains.</p>
<p>
If <em>–name</em> is specified, domain names are printed instead of the table
formatted one per line. If <em>–uuid</em> is specified domain&#39;s UUID&#39;s are
printed instead of names. If <em>–id</em> is specified then domain&#39;s ID&#39;s are
printed indead of names. However, it is possible to combine <em>–name</em>,
<em>–uuid</em> and <em>–id</em> to select only desired fields for printing. Flag
<em>–table</em> specifies that the legacy table-formatted output should be
used, but it is mutually exclusive with <em>–name</em>, <em>–uuid</em> and <em>–id</em>.
This is the default and will be used if neither of <em>–name</em>, <em>–uuid</em> or
<em>–id</em> is specified. If neither <em>–name</em> nor <em>–uuid</em> is specified, but
<em>–id</em> is, then only active domains are listed, even with the <em>–all</em>
parameter as otherwise the output would just contain bunch of lines with
just <em>-1</em>.</p>
<p>
If <em>–title</em> is specified, then the short domain description (title) is
printed in an extra column. This flag is usable only with the default
<em>–table</em> output.</p>
<p>
<strong>Example 2:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
$ virsh list --title
  Id    Name        State      Title
 -------------------------------------------
  0     Domain-0    running    Mailserver 1
  2     fedora      paused
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-33" class="outline-3">
<h3 id="headline-33">
freecell
</h3>
<div id="outline-text-headline-33" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
freecell [{ [--cellno] cellno | --all }]
</pre>
</blockquote>
</blockquote>
<p>
Prints the available amount of memory on the machine or within a NUMA
cell. The freecell command can provide one of three different displays
of available memory on the machine depending on the options specified.
With no options, it displays the total free memory on the machine. With
the –all option, it displays the free memory in each cell and the total
free memory on the machine. Finally, with a numeric argument or with
–cellno plus a cell number it will display the free memory for the
specified cell only.</p>
</div>
</div>
<div id="outline-container-headline-34" class="outline-3">
<h3 id="headline-34">
freepages
</h3>
<div id="outline-text-headline-34" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
freepages [{ [--cellno] cellno [--pagesize] pagesize |     --all }]
</pre>
</blockquote>
</blockquote>
<p>
Prints the available amount of pages within a NUMA cell. <em>cellno</em> refers
to the NUMA cell you&#39;re interested in. <em>pagesize</em> is a scaled integer
(see <strong>NOTES</strong> above). Alternatively, if <em>–all</em> is used, info on each
possible combination of NUMA cell and page size is printed out.</p>
</div>
</div>
<div id="outline-container-headline-35" class="outline-3">
<h3 id="headline-35">
allocpages
</h3>
<div id="outline-text-headline-35" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
allocpages [--pagesize] pagesize [--pagecount] pagecount [[--cellno] cellno] [--add] [--all]
</pre>
</blockquote>
</blockquote>
<p>
Change the size of pages pool of <em>pagesize</em> on the host. If <em>–add</em> is
specified, then <em>pagecount</em> pages are added into the pool. However, if
<em>–add</em> wasn&#39;t specified, then the <em>pagecount</em> is taken as the new
absolute size of the pool (this may be used to free some pages and size
the pool down). The <em>cellno</em> modifier can be used to narrow the
modification down to a single host NUMA cell. On the other end of
spectrum lies <em>–all</em> which executes the modification on all NUMA cells.</p>
</div>
</div>
<div id="outline-container-headline-36" class="outline-3">
<h3 id="headline-36">
cpu-baseline
</h3>
<div id="outline-text-headline-36" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
cpu-baseline FILE [--features] [--migratable]
</pre>
</blockquote>
</blockquote>
<p>
Compute baseline CPU which will be supported by all host CPUs given in
&lt;file&gt;. (See <strong>hypervisor-cpu-baseline</strong> command to get a CPU which can be
provided by a specific hypervisor.) The list of host CPUs is built by
extracting all &lt;cpu&gt; elements from the &lt;file&gt;. Thus, the &lt;file&gt; can
contain either a set of &lt;cpu&gt; elements separated by new lines or even a
set of complete &lt;capabilities&gt; elements printed by <strong>capabilities</strong>
command. If <em>–features</em> is specified, then the resulting XML
description will explicitly include all features that make up the CPU,
without this option features that are part of the CPU model will not be
listed in the XML description. If <em>–migratable</em> is specified, features
that block migration will not be included in the resulting CPU.</p>
</div>
</div>
<div id="outline-container-headline-37" class="outline-3">
<h3 id="headline-37">
cpu-compare
</h3>
<div id="outline-text-headline-37" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
cpu-compare FILE [--error] [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Compare CPU definition from XML &lt;file&gt; with host CPU. (See
<strong>hypervisor-cpu-compare</strong> command for comparing the CPU definition with
the CPU which a specific hypervisor is able to provide on the host.) The
XML &lt;file&gt; may contain either host or guest CPU definition. The host CPU
definition is the &lt;cpu&gt; element and its contents as printed by
<strong>capabilities</strong> command. The guest CPU definition is the &lt;cpu&gt; element
and its contents from domain XML definition or the CPU definition
created from the host CPU model found in domain capabilities XML
(printed by <strong>domcapabilities</strong> command). In addition to the &lt;cpu&gt; element
itself, this command accepts full domain XML, capabilities XML, or
domain capabilities XML containing the CPU definition. For more
information on guest CPU definition see:
<a href="https://libvirt.org/formatdomain.html#elementsCPU">https://libvirt.org/formatdomain.html#elementsCPU</a>
&lt;<a href="https://libvirt.org/formatdomain.html#cpu-model-and-topology">https://libvirt.org/formatdomain.html#cpu-model-and-topology</a>&gt; . If
<em>–error</em> is specified, the command will return an error when the given
CPU is incompatible with host CPU and a message providing more details
about the incompatibility will be printed out. If <em>–validate</em> is
specified, validates the format of the XML document against an internal
RNG schema.</p>
</div>
</div>
<div id="outline-container-headline-38" class="outline-3">
<h3 id="headline-38">
cpu-models
</h3>
<div id="outline-text-headline-38" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
cpu-models arch
</pre>
</blockquote>
</blockquote>
<p>
Print the list of CPU models known by libvirt for the specified
architecture. Whether a specific hypervisor is able to create a domain
which uses any of the printed CPU models is a separate question which
can be answered by looking at the domain capabilities XML returned by
<strong>domcapabilities</strong> command. Moreover, for some architectures libvirt does
not know any CPU models and the usable CPU models are only limited by
the hypervisor. This command will print that all CPU models are accepted
for these architectures and the actual list of supported CPU models can
be checked in the domain capabilities XML.</p>
</div>
</div>
<div id="outline-container-headline-39" class="outline-3">
<h3 id="headline-39">
hypervisor-cpu-compare
</h3>
<div id="outline-text-headline-39" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
hypervisor-cpu-compare FILE [virttype] [emulator] [arch] [machine] [--error] [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Compare CPU definition from XML &lt;file&gt; with the CPU the hypervisor is
able to provide on the host. (This is different from <strong>cpu-compare</strong> which
compares the CPU definition with the host CPU without considering any
specific hypervisor and its abilities.)</p>
<p>
The XML <em>FILE</em> may contain either a host or guest CPU definition. The
host CPU definition is the &lt;cpu&gt; element and its contents as printed by
the <strong>capabilities</strong> command. The guest CPU definition is the &lt;cpu&gt;
element and its contents from the domain XML definition or the CPU
definition created from the host CPU model found in the domain
capabilities XML (printed by the <strong>domcapabilities</strong> command). In addition
to the &lt;cpu&gt; element itself, this command accepts full domain XML,
capabilities XML, or domain capabilities XML containing the CPU
definition. For more information on guest CPU definition see:
<a href="https://libvirt.org/formatdomain.html#elementsCPU">https://libvirt.org/formatdomain.html#elementsCPU</a>
&lt;<a href="https://libvirt.org/formatdomain.html#cpu-model-and-topology">https://libvirt.org/formatdomain.html#cpu-model-and-topology</a>&gt; .</p>
<p>
The <em>virttype</em> option specifies the virtualization type (usable in the
&#39;type&#39; attribute of the &lt;domain&gt; top level element from the domain XML).
<em>emulator</em> specifies the path to the emulator, <em>arch</em> specifies the CPU
architecture, and <em>machine</em> specifies the machine type. If <em>–error</em> is
specified, the command will return an error when the given CPU is
incompatible with the host CPU and a message providing more details
about the incompatibility will be printed out. If <em>–validate</em> is
specified, validates the format of the XML document against an internal
RNG schema.</p>
</div>
</div>
<div id="outline-container-headline-40" class="outline-3">
<h3 id="headline-40">
hypervisor-cpu-baseline
</h3>
<div id="outline-text-headline-40" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
hypervisor-cpu-baseline [FILE] [virttype] [emulator] [arch] [machine]
   [--features] [--migratable] [model]
</pre>
</blockquote>
</blockquote>
<p>
Compute a baseline CPU which will be compatible with all CPUs defined in
an XML <em>file</em> and with the CPU the hypervisor is able to provide on the
host. (This is different from <strong>cpu-baseline</strong> which does not consider any
hypervisor abilities when computing the baseline CPU.)</p>
<p>
As an alternative for <em>FILE</em> in case the XML would only contain a CPU
model with no additional features the CPU model name itself can be
passed as <em>model</em>. Exactly one of <em>FILE</em> and <em>model</em> must be used.</p>
<p>
The XML <em>FILE</em> may contain either host or guest CPU definitions
describing the host CPU model. The host CPU definition is the &lt;cpu&gt;
element and its contents as printed by <strong>capabilities</strong> command. The guest
CPU definition may be created from the host CPU model found in domain
capabilities XML (printed by <strong>domcapabilities</strong> command). In addition to
the &lt;cpu&gt; elements, this command accepts full capabilities XMLs, or
domain capabilities XMLs containing the CPU definitions. It is
recommended to use only the CPU definitions from domain capabilities, as
on some architectures using the host CPU definition may either fail or
provide unexpected results.</p>
<p>
When <em>FILE</em> contains only a single CPU definition, the command will
print the same CPU with restrictions imposed by the capabilities of the
hypervisor. Specifically, running the <strong>virsh hypervisor-cpu-baseline</strong>
command with no additional options on the result of <strong>virsh
domcapabilities</strong> will transform the host CPU model from domain
capabilities XML to a form directly usable in domain XML. Running the
command with <em>model</em> (or <em>FILE</em> containing just a single CPU definition
with model and no feature elements) which is marked as unusable in
<strong>virsh domcapabilities</strong> will provide a list of features that block this
CPU model from being usable.</p>
<p>
The <em>virttype</em> option specifies the virtualization type (usable in the
&#39;type&#39; attribute of the &lt;domain&gt; top level element from the domain XML).
<em>emulator</em> specifies the path to the emulator, <em>arch</em> specifies the CPU
architecture, and <em>machine</em> specifies the machine type. If <em>–features</em>
is specified, then the resulting XML description will explicitly include
all features that make up the CPU, without this option features that are
part of the CPU model will not be listed in the XML description. If
<em>–migratable</em> is specified, features that block migration will not be
included in the resulting CPU.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-41" class="outline-2">
<h2 id="headline-41">
DOMAIN COMMANDS
</h2>
<div id="outline-text-headline-41" class="outline-text-2">
<p>The following commands manipulate domains directly, as stated previously
most commands take domain as the first parameter. The <em>domain</em> can be
specified as a short integer, a name or a full UUID.</p>
<div id="outline-container-headline-42" class="outline-3">
<h3 id="headline-42">
autostart
</h3>
<div id="outline-text-headline-42" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
autostart [--disable] domain
</pre>
</blockquote>
</blockquote>
<p>
Configure a domain to be automatically started at boot.</p>
<p>
The option <em>–disable</em> disables autostarting.</p>
</div>
</div>
<div id="outline-container-headline-43" class="outline-3">
<h3 id="headline-43">
blkdeviotune
</h3>
<div id="outline-text-headline-43" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blkdeviotune domain device [[--config] [--live] | [--current]]
   [[total-bytes-sec] | [read-bytes-sec] [write-bytes-sec]]
   [[total-iops-sec] | [read-iops-sec] [write-iops-sec]]
   [[total-bytes-sec-max] | [read-bytes-sec-max] [write-bytes-sec-max]]
   [[total-iops-sec-max] | [read-iops-sec-max] [write-iops-sec-max]]
   [[total-bytes-sec-max-length] |
    [read-bytes-sec-max-length] [write-bytes-sec-max-length]]
   [[total-iops-sec-max-length] |
    [read-iops-sec-max-length] [write-iops-sec-max-length]]
   [size-iops-sec] [group-name]
</pre>
</blockquote>
</blockquote>
<p>
Set or query the block disk io parameters for a block device of
<em>domain</em>. <em>device</em> specifies a unique target name (&lt;target dev=&#39;name&#39;/&gt;)
or source file (&lt;source file=&#39;name&#39;<em>&gt;) for one of the disk devices
attached to /domain</em> (see also <strong>domblklist</strong> for listing these names).</p>
<p>
If no limit is specified, it will query current I/O limits setting.
Otherwise, alter the limits with these flags: <em>–total-bytes-sec</em>
specifies total throughput limit as a scaled integer, the default being
bytes per second if no suffix is specified. <em>–read-bytes-sec</em> specifies
read throughput limit as a scaled integer, the default being bytes per
second if no suffix is specified. <em>–write-bytes-sec</em> specifies write
throughput limit as a scaled integer, the default being bytes per second
if no suffix is specified. <em>–total-iops-sec</em> specifies total I/O
operations limit per second. <em>–read-iops-sec</em> specifies read I/O
operations limit per second. <em>–write-iops-sec</em> specifies write I/O
operations limit per second. <em>–total-bytes-sec-max</em> specifies maximum
total throughput limit as a scaled integer, the default being bytes per
second if no suffix is specified <em>–read-bytes-sec-max</em> specifies
maximum read throughput limit as a scaled integer, the default being
bytes per second if no suffix is specified. <em>–write-bytes-sec-max</em>
specifies maximum write throughput limit as a scaled integer, the
default being bytes per second if no suffix is specified.
<em>–total-iops-sec-max</em> specifies maximum total I/O operations limit per
second. <em>–read-iops-sec-max</em> specifies maximum read I/O operations
limit per second. <em>–write-iops-sec-max</em> specifies maximum write I/O
operations limit per second. <em>–total-bytes-sec-max-length</em> specifies
duration in seconds to allow maximum total throughput limit.
<em>–read-bytes-sec-max-length</em> specifies duration in seconds to allow
maximum read throughput limit. <em>–write-bytes-sec-max-length</em> specifies
duration in seconds to allow maximum write throughput limit.
<em>–total-iops-sec-max-length</em> specifies duration in seconds to allow
maximum total I/O operations limit. <em>–read-iops-sec-max-length</em>
specifies duration in seconds to allow maximum read I/O operations
limit. <em>–write-iops-sec-max-length</em> specifies duration in seconds to
allow maximum write I/O operations limit. <em>–size-iops-sec</em> specifies
size I/O operations limit per second. <em>–group-name</em> specifies group
name to share I/O quota between multiple drives. For a QEMU domain, if
no name is provided, then the default is to have a single group for each
<em>device</em>.</p>
<p>
Older versions of virsh only accepted these options with underscore
instead of dash, as in <em>–total_bytes_sec</em>.</p>
<p>
Bytes and iops values are independent, but setting only one value (such
as –read-bytes-sec) resets the other two in that category to unlimited.
An explicit 0 also clears any limit. A non-zero value for a given total
cannot be mixed with non-zero values for read or write.</p>
<p>
It is up to the hypervisor to determine how to handle the length values.
For the QEMU hypervisor, if an I/O limit value or maximum value is set,
then the default value of 1 second will be displayed. Supplying a 0 will
reset the value back to the default.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. When setting the disk io
parameters both <em>–live</em> and <em>–config</em> flags may be given, but
<em>–current</em> is exclusive. For querying only one of <em>–live</em>, <em>–config</em>
or <em>–current</em> can be specified. If no flag is specified, behavior is
different depending on hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-44" class="outline-3">
<h3 id="headline-44">
blkiotune
</h3>
<div id="outline-text-headline-44" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blkiotune domain [--weight weight] [--device-weights device-weights]
   [--device-read-iops-sec device-read-iops-sec]
   [--device-write-iops-sec device-write-iops-sec]
   [--device-read-bytes-sec device-read-bytes-sec]
   [--device-write-bytes-sec device-write-bytes-sec]
   [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Display or set the blkio parameters. QEMU/KVM supports <em>–weight</em>.
<em>–weight</em> is in range [100, 1000]. After kernel 2.6.39, the value could
be in the range [10, 1000].</p>
<p>
<strong>device-weights</strong> is a single string listing one or more device/weight
pairs, in the format of /path/to/device,weight,/path/to/device,weight.
Each weight is in the range [100, 1000], [10, 1000] after kernel 2.6.39,
or the value 0 to remove that device from per-device listings. Only the
devices listed in the string are modified; any existing per-device
weights for other devices remain unchanged.</p>
<p>
<strong>device-read-iops-sec</strong> is a single string listing one or more
device/read_iops_sec pairs, int the format of
/path/to/device,read_iops_sec,/path/to/device,read_iops_sec. Each
read_iops_sec is a number which type is unsigned int, value 0 to remove
that device from per-device listing. Only the devices listed in the
string are modified; any existing per-device read_iops_sec for other
devices remain unchanged.</p>
<p>
<strong>device-write-iops-sec</strong> is a single string listing one or more
device/write_iops_sec pairs, int the format of
/path/to/device,write_iops_sec,/path/to/device,write_iops_sec. Each
write_iops_sec is a number which type is unsigned int, value 0 to remove
that device from per-device listing. Only the devices listed in the
string are modified; any existing per-device write_iops_sec for other
devices remain unchanged.</p>
<p>
<strong>device-read-bytes-sec</strong> is a single string listing one or more
device/read_bytes_sec pairs, int the format of
/path/to/device,read_bytes_sec,/path/to/device,read_bytes_sec. Each
read_bytes_sec is a number which type is unsigned long long, value 0 to
remove that device from per-device listing. Only the devices listed in
the string are modified; any existing per-device read_bytes_sec for
other devices remain unchanged.</p>
<p>
<strong>device-write-bytes-sec</strong> is a single string listing one or more
device/write_bytes_sec pairs, int the format of
/path/to/device,write_bytes_sec,/path/to/device,write_bytes_sec. Each
write_bytes_sec is a number which type is unsigned long long, value 0 to
remove that device from per-device listing. Only the devices listed in
the string are modified; any existing per-device write_bytes_sec for
other devices remain unchanged.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-45" class="outline-3">
<h3 id="headline-45">
blockcommit
</h3>
<div id="outline-text-headline-45" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blockcommit domain path [bandwidth] [--bytes] [base]
   [--shallow] [top] [--delete] [--keep-relative]
   [--wait [--async] [--verbose]] [--timeout seconds]
   [--active] [{--pivot | --keep-overlay}]
</pre>
</blockquote>
</blockquote>
<p>
Reduce the length of a backing image chain, by committing changes at the
top of the chain (snapshot or delta files) into backing images. By
default, this command attempts to flatten the entire chain. If <em>base</em>
and/or <em>top</em> are specified as files within the backing chain, then the
operation is constrained to committing just that portion of the chain;
<em>–shallow</em> can be used instead of <em>base</em> to specify the immediate
backing file of the resulting top image to be committed. The files being
committed are rendered invalid, possibly as soon as the operation
starts; using the <em>–delete</em> flag will attempt to remove these
invalidated files at the successful completion of the commit operation.
When the <em>–keep-relative</em> flag is used, the backing file paths will be
kept relative.</p>
<p>
When <em>top</em> is omitted or specified as the active image, it is also
possible to specify <em>–active</em> to trigger a two-phase active commit. In
the first phase, <em>top</em> is copied into <em>base</em> and the job can only be
canceled, with top still containing data not yet in base. In the second
phase, <em>top</em> and <em>base</em> remain identical until a call to <strong>blockjob</strong> with
the <em>–abort</em> flag (keeping top as the active image that tracks changes
from that point in time) or the <em>–pivot</em> flag (making base the new
active image and invalidating top).</p>
<p>
By default, this command returns as soon as possible, and data for the
entire disk is committed in the background; the progress of the
operation can be checked with <strong>blockjob</strong>. However, if <em>–wait</em> is
specified, then this command will block until the operation completes
(or for <em>–active</em>, enters the second phase), or until the operation is
canceled because the optional <em>timeout</em> in seconds elapses or SIGINT is
sent (usually with <strong>Ctrl-C</strong>). Using <em>–verbose</em> along with <em>–wait</em> will
produce periodic status updates. If job cancellation is triggered,
<em>–async</em> will return control to the user as fast as possible, otherwise
the command may continue to block a little while longer until the job is
done cleaning up. Using <em>–pivot</em> is shorthand for combining <em>–active</em>
<em>–wait</em> with an automatic <strong>blockjob</strong> <em>–pivot</em>; and using
<em>–keep-overlay</em> is shorthand for combining <em>–active</em> <em>–wait</em> with an
automatic <strong>blockjob</strong> <em>–abort</em>.</p>
<p>
<em>path</em> specifies fully-qualified path of the disk; it corresponds to a
unique target name (&lt;target dev=&#39;name&#39;<em>&gt;) or source file (&lt;source
file=&#39;name&#39;/&gt;) for one of the disk devices attached to /domain</em> (see
also <strong>domblklist</strong> for listing these names). <em>bandwidth</em> specifies
copying bandwidth limit in MiB/s, although for QEMU, it may be non-zero
only for an online domain. For further information on the <em>bandwidth</em>
argument see the corresponding section for the <strong>blockjob</strong> command.</p>
</div>
</div>
<div id="outline-container-headline-46" class="outline-3">
<h3 id="headline-46">
blockcopy
</h3>
<div id="outline-text-headline-46" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blockcopy domain path { dest [format] [--blockdev] | --xml file }
   [--shallow] [--reuse-external] [bandwidth]
   [--wait [--async] [--verbose]] [{--pivot | --finish}]
   [--timeout seconds] [granularity] [buf-size] [--bytes]
   [--transient-job] [--synchronous-writes] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Copy a disk backing image chain to a destination. Either <em>dest</em> as the
destination file name, or <em>–xml</em> with the name of an XML file
containing a top-level &lt;disk&gt; element describing the destination, must
be present. Additionally, if <em>dest</em> is given, <em>format</em> should be
specified to declare the format of the destination (if <em>format</em> is
omitted, then libvirt will reuse the format of the source, or with
<em>–reuse-external</em> will be forced to probe the destination format, which
could be a potential security hole). The command supports <em>–raw</em> as a
boolean flag synonym for <em>–format=raw</em>. When using <em>dest</em>, the
destination is treated as a regular file unless <em>–blockdev</em> is used to
signal that it is a block device. By default, this command flattens the
entire chain; but if <em>–shallow</em> is specified, the copy shares the
backing chain.</p>
<p>
If <em>–reuse-external</em> is specified, then the destination must exist and
have sufficient space to hold the copy. If <em>–shallow</em> is used in
conjunction with <em>–reuse-external</em> then the pre-created image must have
guest visible contents identical to guest visible contents of the
backing file of the original image. This may be used to modify the
backing file names on the destination.</p>
<p>
By default, the copy job runs in the background, and consists of two
phases. Initially, the job must copy all data from the source, and
during this phase, the job can only be canceled to revert back to the
source disk, with no guarantees about the destination. After this phase
completes, both the source and the destination remain mirrored until a
call to <strong>blockjob</strong> with the <em>–abort</em> and <em>–pivot</em> flags pivots over to
the copy, or a call without <em>–pivot</em> leaves the destination as a
faithful copy of that point in time. However, if <em>–wait</em> is specified,
then this command will block until the mirroring phase begins, or cancel
the operation if the optional <em>timeout</em> in seconds elapses or SIGINT is
sent (usually with <strong>Ctrl-C</strong>). Using <em>–verbose</em> along with <em>–wait</em> will
produce periodic status updates. Using <em>–pivot</em> (similar to <strong>blockjob</strong>
<em>–pivot</em>) or <em>–finish</em> (similar to <strong>blockjob</strong> <em>–abort</em>) implies
<em>–wait</em>, and will additionally end the job cleanly rather than leaving
things in the mirroring phase. If job cancellation is triggered by
timeout or by <em>–finish</em>, <em>–async</em> will return control to the user as
fast as possible, otherwise the command may continue to block a little
while longer until the job has actually cancelled.</p>
<p>
<em>path</em> specifies fully-qualified path of the disk. <em>bandwidth</em> specifies
copying bandwidth limit in MiB/s. Specifying a negative value is
interpreted as an unsigned long long value that might be essentially
unlimited, but more likely would overflow; it is safer to use 0 for that
purpose. For further information on the <em>bandwidth</em> argument see the
corresponding section for the <strong>blockjob</strong> command. Specifying
<em>granularity</em> allows fine-tuning of the granularity that will be copied
when a dirty region is detected; larger values trigger less I/O overhead
but may end up copying more data overall (the default value is usually
correct); hypervisors may restrict this to be a power of two or fall
within a certain range. Specifying <em>buf-size</em> will control how much data
can be simultaneously in-flight during the copy; larger values use more
memory but may allow faster completion (the default value is usually
correct).</p>
<p>
<em>–transient-job</em> allows specifying that the user does not require the
job to be recovered if the VM crashes or is turned off before the job
completes. This flag removes the restriction of copy jobs to transient
domains if that restriction is applied by the hypervisor.</p>
<p>
If <em>–synchronous-writes</em> is specified the block job will wait for guest
writes to be propagated both to the original image and to the
destination of the copy so that it&#39;s guaranteed that the job converges
if the destination storage is slower. This may impact performance of
writes while the blockjob is running.</p>
<p>
If <em>–print-xml</em> is specified, then the XML used to start the block copy
job is printed instead of starting the job.</p>
</div>
</div>
<div id="outline-container-headline-47" class="outline-3">
<h3 id="headline-47">
blockjob
</h3>
<div id="outline-text-headline-47" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blockjob domain path { [--abort] [--async] [--pivot] |
   [--info] [--raw] [--bytes] | [bandwidth] }
</pre>
</blockquote>
</blockquote>
<p>
Manage active block operations. There are three mutually-exclusive
modes: <em>–info</em>, <em>bandwidth</em>, and <em>–abort</em>. <em>–async</em> and <em>–pivot</em>
imply abort mode; <em>–raw</em> implies info mode; and if no mode was given,
<em>–info</em> mode is assumed.</p>
<p>
<em>path</em> specifies fully-qualified path of the disk; it corresponds to a
unique target name (&lt;target dev=&#39;name&#39;<em>&gt;) or source file (&lt;source
file=&#39;name&#39;/&gt;) for one of the disk devices attached to /domain</em> (see
also <strong>domblklist</strong> for listing these names).</p>
<p>
In <em>–abort</em> mode, the active job on the specified disk will be aborted.
If <em>–async</em> is also specified, this command will return immediately,
rather than waiting for the cancellation to complete. If <em>–pivot</em> is
specified, this requests that an active copy or active commit job be
pivoted over to the new image.</p>
<p>
In <em>–info</em> mode, the active job information on the specified disk will
be printed. By default, the output is a single human-readable summary
line; this format may change in future versions. Adding <em>–raw</em> lists
each field of the struct, in a stable format. If the <em>–bytes</em> flag is
set, then the command errors out if the server could not supply bytes/s
resolution; when omitting the flag, raw output is listed in MiB/s and
human-readable output automatically selects the best resolution
supported by the server.</p>
<p>
<em>bandwidth</em> can be used to set bandwidth limit for the active job in
MiB/s. If <em>–bytes</em> is specified then the bandwidth value is interpreted
in bytes/s. Specifying a negative value is interpreted as an unsigned
long value or essentially unlimited. The hypervisor can choose whether
to reject the value or convert it to the maximum value allowed.
Optionally a scaled positive number may be used as bandwidth (see
<strong>NOTES</strong> above). Using <em>–bytes</em> with a scaled value permits a finer
granularity to be selected. A scaled value used without <em>–bytes</em> will
be rounded down to MiB/s. Note that the <em>–bytes</em> may be unsupported by
the hypervisor.</p>
<p>
Note that the progress reported for blockjobs corresponding to a
pull-mode backup don&#39;t report progress of the backup but rather usage of
temporary space required for the backup.</p>
</div>
</div>
<div id="outline-container-headline-48" class="outline-3">
<h3 id="headline-48">
blockpull
</h3>
<div id="outline-text-headline-48" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blockpull domain path [bandwidth] [--bytes] [base]
   [--wait [--verbose] [--timeout seconds] [--async]]
   [--keep-relative]
</pre>
</blockquote>
</blockquote>
<p>
Populate a disk from its backing image chain. By default, this command
flattens the entire chain; but if <em>base</em> is specified, containing the
name of one of the backing files in the chain, then that file becomes
the new backing file and only the intermediate portion of the chain is
pulled. Once all requested data from the backing image chain has been
pulled, the disk no longer depends on that portion of the backing chain.</p>
<p>
By default, this command returns as soon as possible, and data for the
entire disk is pulled in the background; the progress of the operation
can be checked with <strong>blockjob</strong>. However, if <em>–wait</em> is specified, then
this command will block until the operation completes, or cancel the
operation if the optional <em>timeout</em> in seconds elapses or SIGINT is sent
(usually with <strong>Ctrl-C</strong>). Using <em>–verbose</em> along with <em>–wait</em> will
produce periodic status updates. If job cancellation is triggered,
<em>–async</em> will return control to the user as fast as possible, otherwise
the command may continue to block a little while longer until the job is
done cleaning up.</p>
<p>
Using the <em>–keep-relative</em> flag will keep the backing chain names
relative.</p>
<p>
<em>path</em> specifies fully-qualified path of the disk; it corresponds to a
unique target name (&lt;target dev=&#39;name&#39;<em>&gt;) or source file (&lt;source
file=&#39;name&#39;/&gt;) for one of the disk devices attached to /domain</em> (see
also <strong>domblklist</strong> for listing these names). <em>bandwidth</em> specifies
copying bandwidth limit in MiB/s. For further information on the
<em>bandwidth</em> argument see the corresponding section for the <strong>blockjob</strong>
command.</p>
</div>
</div>
<div id="outline-container-headline-49" class="outline-3">
<h3 id="headline-49">
blockresize
</h3>
<div id="outline-text-headline-49" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
blockresize domain path ([size] | [--capacity])
</pre>
</blockquote>
</blockquote>
<p>
Resize a block device of domain while the domain is running, <em>path</em>
specifies the absolute path of the block device; it corresponds to a
unique target name (&lt;target dev=&#39;name&#39;<em>&gt;) or source file (&lt;source
file=&#39;name&#39;/&gt;) for one of the disk devices attached to /domain</em> (see
also <strong>domblklist</strong> for listing these names).</p>
<p>
For image formats without metadata (raw) stored inside fixed-size
storage (e.g. block devices) the –capacity flag can be used to resize
the device to the full size of the backing device.</p>
<p>
<em>size</em> is a scaled integer (see <strong>NOTES</strong> above) which defaults to KiB
(blocks of 1024 bytes) if there is no suffix. You must use a suffix of
&#34;B&#34; to get bytes (note that for historical reasons, this differs from
<strong>vol-resize</strong> which defaults to bytes without a suffix).</p>
</div>
</div>
<div id="outline-container-headline-50" class="outline-3">
<h3 id="headline-50">
console
</h3>
<div id="outline-text-headline-50" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
console domain [devname] [--safe] [--force] [--resume]
</pre>
</blockquote>
</blockquote>
<p>
Connect the virtual serial console for the guest. The optional <em>devname</em>
parameter refers to the device alias of an alternate console, serial or
parallel device configured for the guest. If omitted, the primary
console will be opened.</p>
<p>
If the flag <em>–safe</em> is specified, the connection is only attempted if
the driver supports safe console handling. This flag specifies that the
server has to ensure exclusive access to console devices. Optionally the
<em>–force</em> flag may be specified, requesting to disconnect any existing
sessions, such as in a case of a broken connection.</p>
<p>
If the flag <em>–resume</em> is specified then the guest is resumed after
connecting to the console.</p>
</div>
</div>
<div id="outline-container-headline-51" class="outline-3">
<h3 id="headline-51">
cpu-stats
</h3>
<div id="outline-text-headline-51" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
cpu-stats domain [--total] [start] [count]
</pre>
</blockquote>
</blockquote>
<p>
Provide cpu statistics information of a domain. The domain should be
running. Default it shows stats for all CPUs, and a total. Use <em>–total</em>
for only the total stats, <em>start</em> for only the per-cpu stats of the CPUs
from <em>start</em>, <em>count</em> for only <em>count</em> CPUs&#39; stats.</p>
</div>
</div>
<div id="outline-container-headline-52" class="outline-3">
<h3 id="headline-52">
create
</h3>
<div id="outline-text-headline-52" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
create FILE [--console] [--paused] [--autodestroy]
   [--pass-fds N,M,...] [--validate] [--reset-nvram]
</pre>
</blockquote>
</blockquote>
<p>
Create a domain from an XML &lt;file&gt;. Optionally, <em>–validate</em> option can
be passed to validate the format of the input XML file against an
internal RNG schema (identical to using virt-xml-validate(1) tool).
Domains created using this command are going to be either transient
(temporary ones that will vanish once destroyed) or existing persistent
guests that will run with one-time use configuration, leaving the
persistent XML untouched (this can come handy during an automated
testing of various configurations all based on the original XML). See
the example below for usage demonstration.</p>
<p>
The domain will be paused if the <em>–paused</em> option is used and supported
by the driver; otherwise it will be running. If <em>–console</em> is
requested, attach to the console after creation. If <em>–autodestroy</em> is
requested, then the guest will be automatically destroyed when virsh
closes its connection to libvirt, or otherwise exits.</p>
<p>
If <em>–pass-fds</em> is specified, the argument is a comma separated list of
open file descriptors which should be pass on into the guest. The file
descriptors will be re-numbered in the guest, starting from 3. This is
only supported with container based virtualization.</p>
<p>
If <em>–reset-nvram</em> is specified, any existing NVRAM file will be deleted
and re-initialized from its pristine template.</p>
<p>
<strong>Example:</strong></p>
<blockquote>
<ol>
<li>
<p>prepare a template from an existing domain (skip directly to 3a if
writing one from scratch)</p>
<blockquote>
<pre class="example">
# virsh dumpxml &lt;domain&gt; &gt; domain.xml
</pre>
</blockquote>
</li>
<li value="2">
<p>edit the template using an editor of your choice and:</p>
<ol>
<li>DO CHANGE! &lt;name&gt; and &lt;uuid&gt; (&lt;uuid&gt; can also be removed), or</li>
<li>DON&#39;T CHANGE! either &lt;name&gt; or &lt;uuid&gt;</li>
</ol>
</li>
</ol>
<blockquote>
<blockquote>
<pre class="example">
# $EDITOR domain.xml
</pre>
</blockquote>
</blockquote>
<ol>
<li value="3">
<p>create a domain from domain.xml, depending on whether following
2a or 2b respectively:</p>
<ol>
<li>the domain is going to be transient</li>
<li>an existing persistent guest will run with a modified one-time
configuration</li>
</ol>
</li>
</ol>
<blockquote>
<blockquote>
<pre class="example">
# virsh create domain.xml
</pre>
</blockquote>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-53" class="outline-3">
<h3 id="headline-53">
define
</h3>
<div id="outline-text-headline-53" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
define FILE [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Define a domain from an XML &lt;file&gt;. Optionally, the format of the input
XML file can be validated against an internal RNG schema with
<em>–validate</em> (identical to using virt-xml-validate(1) tool). The domain
definition is registered but not started. If domain is already running,
the changes will take effect on the next boot.</p>
</div>
</div>
<div id="outline-container-headline-54" class="outline-3">
<h3 id="headline-54">
desc
</h3>
<div id="outline-text-headline-54" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
desc domain [[--live] [--config] |
   [--current]] [--title] [--edit] [--new-desc
   New description or title message]
</pre>
</blockquote>
</blockquote>
<p>
Show or modify description and title of a domain. These values are user
fields that allow storing arbitrary textual data to allow easy
identification of domains. Title should be short, although it&#39;s not
enforced. (See also <strong>metadata</strong> that works with XML based domain
metadata.)</p>
<p>
Flags <em>–live</em> or <em>–config</em> select whether this command works on live
or persistent definitions of the domain. If both <em>–live</em> and <em>–config</em>
are specified, the <em>–config</em> option takes precedence on getting the
current description and both live configuration and config are updated
while setting the description. <em>–current</em> is exclusive and implied if
none of these was specified.</p>
<p>
Flag <em>–edit</em> specifies that an editor with the contents of current
description or title should be opened and the contents saved back
afterwards.</p>
<p>
Flag <em>–title</em> selects operation on the title field instead of
description.</p>
<p>
If neither of <em>–edit</em> and <em>–new-desc</em> are specified the note or
description is displayed instead of being modified.</p>
</div>
</div>
<div id="outline-container-headline-55" class="outline-3">
<h3 id="headline-55">
destroy
</h3>
<div id="outline-text-headline-55" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
destroy domain [--graceful] [--remove-logs]
</pre>
</blockquote>
</blockquote>
<p>
Immediately terminate the domain <em>domain</em>. This doesn&#39;t give the domain
OS any chance to react, and it&#39;s the equivalent of ripping the power
cord out on a physical machine. In most cases you will want to use the
<strong>shutdown</strong> command instead. However, this does not delete any storage
volumes used by the guest, and if the domain is persistent, it can be
restarted later.</p>
<p>
If <em>domain</em> is transient, then the metadata of any snapshots will be
lost once the guest stops running, but the snapshot contents still
exist, and a new domain with the same name and UUID can restore the
snapshot metadata with <strong>snapshot-create</strong>. Similarly, the metadata of any
checkpoints will be lost, but can be restored with <strong>checkpoint-create</strong>.</p>
<p>
If <em>–graceful</em> is specified, don&#39;t resort to extreme measures (e.g.
SIGKILL) when the guest doesn&#39;t stop after a reasonable timeout; return
an error instead.</p>
<p>
If <em>–remove-logs</em> is specified, remove per <em>domain</em> log files. Not all
deployment configuration can be supported.</p>
<p>
In case of QEMU the flag is only supported if virlogd is used to handle
QEMU process output. Otherwise the flag is ignored.</p>
</div>
</div>
<div id="outline-container-headline-56" class="outline-3">
<h3 id="headline-56">
domblkerror
</h3>
<div id="outline-text-headline-56" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domblkerror domain
</pre>
</blockquote>
</blockquote>
<p>
Show errors on block devices. This command usually comes handy when
<strong>domstate</strong> command says that a domain was paused due to I/O error. The
<strong>domblkerror</strong> command lists all block devices in error state and the
error seen on each of them.</p>
</div>
</div>
<div id="outline-container-headline-57" class="outline-3">
<h3 id="headline-57">
domblkinfo
</h3>
<div id="outline-text-headline-57" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domblkinfo domain [block-device --all] [--human]
</pre>
</blockquote>
</blockquote>
<p>
Get block device size info for a domain. A <em>block-device</em> corresponds to
a unique target name (&lt;target dev=&#39;name&#39;<em>&gt;) or source file (&lt;source
file=&#39;name&#39;/&gt;) for one of the disk devices attached to /domain</em> (see
also <strong>domblklist</strong> for listing these names). If <em>–human</em> is set, the
output will have a human readable output. If <em>–all</em> is set, the output
will be a table showing all block devices size info associated with
<em>domain</em>. The <em>–all</em> option takes precedence of the others.</p>
</div>
</div>
<div id="outline-container-headline-58" class="outline-3">
<h3 id="headline-58">
domblklist
</h3>
<div id="outline-text-headline-58" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domblklist domain [--inactive] [--details]
</pre>
</blockquote>
</blockquote>
<p>
Print a table showing the brief information of all block devices
associated with <em>domain</em>. If <em>–inactive</em> is specified, query the block
devices that will be used on the next boot, rather than those currently
in use by a running domain. If <em>–details</em> is specified, disk type and
device value will also be printed. Other contexts that require a block
device name (such as <em>domblkinfo</em> or <em>snapshot-create</em> for disk
snapshots) will accept either target or unique source names printed by
this command.</p>
</div>
</div>
<div id="outline-container-headline-59" class="outline-3">
<h3 id="headline-59">
domblkstat
</h3>
<div id="outline-text-headline-59" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domblkstat domain [block-device] [--human]
</pre>
</blockquote>
</blockquote>
<p>
Get device block stats for a running domain. A <em>block-device</em>
corresponds to a unique target name (&lt;target dev=&#39;name&#39;/&gt;) or source
file (&lt;source file=&#39;name&#39;<em>&gt;) for one of the disk devices attached to
/domain</em> (see also <strong>domblklist</strong> for listing these names). On a LXC or
QEMU domain, omitting the <em>block-device</em> yields device block stats
summarily for the entire domain.</p>
<p>
Use <em>–human</em> for a more human readable output.</p>
<p>
Availability of these fields depends on hypervisor. Unsupported fields
are missing from the output. Other fields may appear if communicating
with a newer version of libvirtd.</p>
<p>
Explanation of fields (fields appear in the following order):</p>
<blockquote>
<ul>
<li>rd_req - count of read operations</li>
<li>rd_bytes - count of read bytes</li>
<li>wr_req - count of write operations</li>
<li>wr_bytes - count of written bytes</li>
<li>errs - error count</li>
<li>flush_operations - count of flush operations</li>
<li>rd_total_times - total time read operations took (ns)</li>
<li>wr_total_times - total time write operations took (ns)</li>
<li>flush_total_times - total time flush operations took (ns)</li>
<li>&lt;– other fields provided by hypervisor –&gt;</li>
</ul>
</blockquote>
</div>
</div>
<div id="outline-container-headline-60" class="outline-3">
<h3 id="headline-60">
domblkthreshold
</h3>
<div id="outline-text-headline-60" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domblkthreshold domain dev threshold
</pre>
</blockquote>
</blockquote>
<p>
Set the threshold value for delivering the block-threshold event. <em>dev</em>
specifies the disk device target or backing chain element of given
device using the &#39;target[1]&#39; syntax. <em>threshold</em> is a scaled value of
the offset. If the block device should write beyond that offset the
event will be delivered.</p>
</div>
</div>
<div id="outline-container-headline-61" class="outline-3">
<h3 id="headline-61">
domcontrol
</h3>
<div id="outline-text-headline-61" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domcontrol domain
</pre>
</blockquote>
</blockquote>
<p>
Returns state of an interface to VMM used to control a domain. For
states other than &#34;ok&#34; or &#34;error&#34; the command also prints number of
seconds elapsed since the control interface entered its current state.</p>
</div>
</div>
<div id="outline-container-headline-62" class="outline-3">
<h3 id="headline-62">
domdirtyrate-calc
</h3>
<div id="outline-text-headline-62" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domdirtyrate-calc &lt;domain&gt; [--seconds &lt;sec&gt;]
   --mode=[page-sampling | dirty-bitmap | dirty-ring]
</pre>
</blockquote>
</blockquote>
<p>
Calculate an active domain&#39;s memory dirty rate which may be expected by
user in order to decide whether it&#39;s proper to be migrated out or not.
The <strong>seconds</strong> parameter can be used to calculate dirty rate in a
specific time which allows 60s at most now and would be default to 1s if
missing. These three <em>page-sampling, dirty-bitmap, dirty-ring</em> modes are
mutually exclusive and alternative when specify calculation mode,
<em>page-sampling</em> is the default mode if missing. The calculated dirty
rate information is available by calling &#39;domstats –dirtyrate&#39;.</p>
</div>
</div>
<div id="outline-container-headline-63" class="outline-3">
<h3 id="headline-63">
domdisplay
</h3>
<div id="outline-text-headline-63" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domdisplay domain [--include-password] [[--type] type] [--all]
</pre>
</blockquote>
</blockquote>
<p>
Output a URI which can be used to connect to the graphical display of
the domain via VNC, SPICE or RDP. The particular graphical display type
can be selected using the <strong>type</strong> parameter (e.g. &#34;vnc&#34;, &#34;spice&#34;, &#34;rdp&#34;).
If <em>–include-password</em> is specified, the SPICE channel password will be
included in the URI. If <em>–all</em> is specified, then all show all possible
graphical displays, for a VM could have more than one graphical
displays.</p>
</div>
</div>
<div id="outline-container-headline-64" class="outline-3">
<h3 id="headline-64">
domdisplay-reload
</h3>
<div id="outline-text-headline-64" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domdisplay-reload &lt;domain&gt; [--type &lt;type&gt;]
</pre>
</blockquote>
</blockquote>
<p>
Reload the domain&#39;s graphical display. This reloads its TLS certificates
without restarting the domain. <strong>type</strong> can be any constant from the
<em>virDomainGraphicsReloadType</em> enum. By default any supported type is
reloaded (so far only VNC).</p>
</div>
</div>
<div id="outline-container-headline-65" class="outline-3">
<h3 id="headline-65">
domfsfreeze
</h3>
<div id="outline-text-headline-65" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domfsfreeze domain [[--mountpoint] mountpoint...]
</pre>
</blockquote>
</blockquote>
<p>
Freeze mounted filesystems within a running domain to prepare for
consistent snapshots.</p>
<p>
The <em>–mountpoint</em> option takes a parameter <strong>mountpoint</strong>, which is a
mount point path of the filesystem to be frozen. This option can occur
multiple times. If this is not specified, every mounted filesystem is
frozen.</p>
<p>
Note: <strong>snapshot-create</strong> command has a <em>–quiesce</em> option to freeze and
thaw the filesystems automatically to keep snapshots consistent.
<strong>domfsfreeze</strong> command is only needed when a user wants to utilize the
native snapshot features of storage devices not supported by libvirt.</p>
</div>
</div>
<div id="outline-container-headline-66" class="outline-3">
<h3 id="headline-66">
domfsinfo
</h3>
<div id="outline-text-headline-66" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domfsinfo domain
</pre>
</blockquote>
</blockquote>
<p>
Show a list of mounted filesystems within the running domain. The list
contains mountpoints, names of a mounted device in the guest, filesystem
types, and unique target names used in the domain XML (&lt;target
dev=&#39;name&#39;/&gt;).</p>
<p>
Note that this command requires a guest agent configured and running in
the domain&#39;s guest OS.</p>
</div>
</div>
<div id="outline-container-headline-67" class="outline-3">
<h3 id="headline-67">
domfsthaw
</h3>
<div id="outline-text-headline-67" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domfsthaw domain [[--mountpoint] mountpoint...]
</pre>
</blockquote>
</blockquote>
<p>
Thaw mounted filesystems within a running domain, which have been frozen
by domfsfreeze command.</p>
<p>
The <em>–mountpoint</em> option takes a parameter <strong>mountpoint</strong>, which is a
mount point path of the filesystem to be thawed. This option can occur
multiple times. If this is not specified, every mounted filesystem is
thawed.</p>
</div>
</div>
<div id="outline-container-headline-68" class="outline-3">
<h3 id="headline-68">
domfstrim
</h3>
<div id="outline-text-headline-68" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domfstrim domain [--minimum bytes] [--mountpoint mountPoint]
</pre>
</blockquote>
</blockquote>
<p>
Issue a fstrim command on all mounted filesystems within a running
domain. It discards blocks which are not in use by the filesystem. If
<em>–minimum</em> <strong>bytes</strong> is specified, it tells guest kernel length of
contiguous free range. Smaller than this may be ignored (this is a hint
and the guest may not respect it). By increasing this value, the fstrim
operation will complete more quickly for filesystems with badly
fragmented free space, although not all blocks will be discarded. The
default value is zero, meaning &#34;discard every free block&#34;. Moreover, if
a user wants to trim only one mount point, it can be specified via
optional <em>–mountpoint</em> parameter.</p>
</div>
</div>
<div id="outline-container-headline-69" class="outline-3">
<h3 id="headline-69">
domhostname
</h3>
<div id="outline-text-headline-69" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domhostname domain [--source lease|agent]
</pre>
</blockquote>
</blockquote>
<p>
Returns the hostname of a domain, if the hypervisor makes it available.</p>
<p>
The <em>–source</em> argument specifies what data source to use for the
hostnames, currently &#39;lease&#39; to read DHCP leases or &#39;agent&#39; to query the
guest OS via an agent. If unspecified, driver returns the default method
available (some drivers support only one type of source).</p>
</div>
</div>
<div id="outline-container-headline-70" class="outline-3">
<h3 id="headline-70">
domid
</h3>
<div id="outline-text-headline-70" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domid domain-name-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Convert a domain name (or UUID) to a domain id</p>
</div>
</div>
<div id="outline-container-headline-71" class="outline-3">
<h3 id="headline-71">
domif-getlink
</h3>
<div id="outline-text-headline-71" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domif-getlink domain interface-device [--config]
</pre>
</blockquote>
</blockquote>
<p>
Query link state of the domain&#39;s virtual interface. If <em>–config</em> is
specified, query the persistent configuration, for compatibility
purposes, <em>–persistent</em> is alias of <em>–config</em>.</p>
<p>
<em>interface-device</em> can be the interface&#39;s target name or the MAC
address.</p>
</div>
</div>
<div id="outline-container-headline-72" class="outline-3">
<h3 id="headline-72">
domif-setlink
</h3>
<div id="outline-text-headline-72" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domif-setlink domain interface-device state [--config] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Modify link state of the domain&#39;s virtual interface. Possible values for
state are &#34;up&#34; and &#34;down&#34;. If <em>–config</em> is specified, only the
persistent configuration of the domain is modified, for compatibility
purposes, <em>–persistent</em> is alias of <em>–config</em>. <em>interface-device</em> can
be the interface&#39;s target name or the MAC address.</p>
<p>
If <em>–print-xml</em> is specified, then the XML used to update the interface
is printed instead.</p>
</div>
</div>
<div id="outline-container-headline-73" class="outline-3">
<h3 id="headline-73">
domifaddr
</h3>
<div id="outline-text-headline-73" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domifaddr domain [interface] [--full]
   [--source lease|agent|arp]
</pre>
</blockquote>
</blockquote>
<p>
Get a list of interfaces of a running domain along with their IP and MAC
addresses, or limited output just for one interface if <em>interface</em> is
specified. Note that <em>interface</em> can be driver dependent, it can be the
name within guest OS or the name you would see in domain XML. Moreover,
the whole command may require a guest agent to be configured for the
queried domain under some hypervisors, notably QEMU.</p>
<p>
If <em>–full</em> is specified, the interface name and MAC address is always
displayed when the interface has multiple IP addresses or aliases;
otherwise, only the interface name and MAC address is displayed for the
first name and MAC address with &#34;-&#34; for the others using the same name
and MAC address.</p>
<p>
The <em>–source</em> argument specifies what data source to use for the
addresses, currently &#39;lease&#39; to read DHCP leases, &#39;agent&#39; to query the
guest OS via an agent, or &#39;arp&#39; to get IP from host&#39;s arp tables. If
unspecified, &#39;lease&#39; is the default.</p>
</div>
</div>
<div id="outline-container-headline-74" class="outline-3">
<h3 id="headline-74">
backup-begin
</h3>
<div id="outline-text-headline-74" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
backup-begin domain [backupxml] [checkpointxml] [--reuse-external]
</pre>
</blockquote>
</blockquote>
<p>
Begin a new backup job. If <em>backupxml</em> is omitted, this defaults to a
full backup using a push model to filenames generated by libvirt;
supplying XML allows fine-tuning such as requesting an incremental
backup relative to an earlier checkpoint, controlling which disks
participate or which filenames are involved, or requesting the use of a
pull model backup. The <em>backup-dumpxml</em> command shows any resulting
values assigned by libvirt. For more information on backup XML, see:
&lt;<a href="https://libvirt.org/formatbackup.html">https://libvirt.org/formatbackup.html</a>&gt;</p>
<p>
If <em>–reuse-external</em> is used it instructs libvirt to reuse temporary
and output files provided by the user in <em>backupxml</em>.</p>
<p>
If <em>checkpointxml</em> is specified, a second file with a top-level element
of <em>domaincheckpoint</em> is used to create a simultaneous checkpoint, for
doing a later incremental backup relative to the time the backup was
created. See <em>checkpoint-create</em> for more details on checkpoints.</p>
<p>
This command returns as soon as possible, and the backup job runs in the
background; the progress of a push model backup can be checked with
<em>domjobinfo</em> or by waiting for an event with <em>event</em> (the progress of a
pull model backup is under the control of whatever third party connects
to the NBD export). The job is ended with <em>domjobabort</em>.</p>
</div>
</div>
<div id="outline-container-headline-75" class="outline-3">
<h3 id="headline-75">
backup-dumpxml
</h3>
<div id="outline-text-headline-75" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
backup-dumpxml [--xpath EXPRESSION] [--wrap] domain
</pre>
</blockquote>
</blockquote>
<p>
Output XML describing the current backup job.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-76" class="outline-3">
<h3 id="headline-76">
domiflist
</h3>
<div id="outline-text-headline-76" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domiflist domain [--inactive]
</pre>
</blockquote>
</blockquote>
<p>
Print a table showing the brief information of all virtual interfaces
associated with <em>domain</em>. If <em>–inactive</em> is specified, query the
virtual interfaces that will be used on the next boot, rather than those
currently in use by a running domain. Other contexts that require a MAC
address of virtual interface (such as <em>detach-interface</em> or
<em>domif-setlink</em>) will accept the MAC address printed by this command.</p>
</div>
</div>
<div id="outline-container-headline-77" class="outline-3">
<h3 id="headline-77">
domifstat
</h3>
<div id="outline-text-headline-77" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domifstat domain interface-device
</pre>
</blockquote>
</blockquote>
<p>
Get network interface stats for a running domain. The network interface
stats are only available for interfaces that have a physical source
interface. This does not include, for example, a &#39;user&#39; interface type
since it is a virtual LAN with NAT to the outside world.
<em>interface-device</em> can be the interface target by name or MAC address.
Please note, for an unmanaged <em>ethernet</em> type returned stats might have
RX/TX swapped.</p>
</div>
</div>
<div id="outline-container-headline-78" class="outline-3">
<h3 id="headline-78">
domiftune
</h3>
<div id="outline-text-headline-78" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domiftune domain interface-device [[--config] [--live] | [--current]]
   [*--inbound average,peak,burst,floor*]
   [*--outbound average,peak,burst*]
</pre>
</blockquote>
</blockquote>
<p>
Set or query the domain&#39;s network interface&#39;s bandwidth parameters.
<em>interface-device</em> can be the interface&#39;s target name (&lt;target
dev=&#39;name&#39;/&gt;), or the MAC address.</p>
<p>
If no <em>–inbound</em> or <em>–outbound</em> is specified, this command will query
and show the bandwidth settings. Otherwise, it will set the inbound or
outbound bandwidth. <em>average,peak,burst,floor</em> is the same as in command
<em>attach-interface</em>. Values for <em>average</em>, <em>peak</em> and <em>floor</em> are
expressed in kilobytes per second, while <em>burst</em> is expressed in
kilobytes in a single burst at <em>peak</em> speed as described in the Network
XML documentation at
&lt;<a href="https://libvirt.org/formatnetwork.html#quality-of-service">https://libvirt.org/formatnetwork.html#quality-of-service</a>&gt; .</p>
<p>
To clear inbound or outbound settings, use <em>–inbound</em> or <em>–outbound</em>
respectfully with average value of zero.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-79" class="outline-3">
<h3 id="headline-79">
dominfo
</h3>
<div id="outline-text-headline-79" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dominfo domain
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the domain.</p>
</div>
</div>
<div id="outline-container-headline-80" class="outline-3">
<h3 id="headline-80">
domjobabort
</h3>
<div id="outline-text-headline-80" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domjobabort domain [--postcopy]
</pre>
</blockquote>
</blockquote>
<p>
Abort the currently running domain job.</p>
<p>
When the job to be aborted is a migration which entered post-copy mode,
it cannot be aborted as none of the hosts involved in migration has a
complete state of the domain. Optional <em>–postcopy</em> can be used to
interrupt such migration although doing so may effectively suspend the
domain until the migration is resumed (see also <em>–postcopy-resume</em>
option of <strong>migrate</strong>).</p>
</div>
</div>
<div id="outline-container-headline-81" class="outline-3">
<h3 id="headline-81">
domjobinfo
</h3>
<div id="outline-text-headline-81" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domjobinfo domain [--completed [--keep-completed]] [--anystats] [--rawstats]
</pre>
</blockquote>
</blockquote>
<p>
Returns information about jobs running on a domain. <em>–completed</em> tells
virsh to return information about a recently finished job. Statistics of
a completed job are automatically destroyed once read (unless
<em>–keep-completed</em> is used) or when libvirtd is restarted.</p>
<p>
Normally only statistics for running and successful completed jobs are
printed. <em>–anystats</em> can be used to also display statistics for failed
jobs.</p>
<p>
In case <em>–rawstats</em> is used, all fields are printed as received from
the server without any attempts to interpret the data. The &#34;Job type:&#34;
field is special, since it&#39;s reported by the API and not part of stats.</p>
<p>
Note that time information returned for completed migrations may be
completely irrelevant unless both source and destination hosts have
synchronized time (i.e., NTP daemon is running on both of them).</p>
</div>
</div>
<div id="outline-container-headline-82" class="outline-3">
<h3 id="headline-82">
domlaunchsecinfo
</h3>
<div id="outline-text-headline-82" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domlaunchsecinfo domain
</pre>
</blockquote>
</blockquote>
<p>
Returns information about the launch security parameters associated with
a running domain.</p>
<p>
The set of parameters reported will vary depending on which type of
launch security protection is active. If none is active, no parameters
will be reported.</p>
</div>
</div>
<div id="outline-container-headline-83" class="outline-3">
<h3 id="headline-83">
domsetlaunchsecstate
</h3>
<div id="outline-text-headline-83" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domsetlaunchsecstate domain --secrethdr hdr-filename
    --secret secret-filename [--set-address address]
</pre>
</blockquote>
</blockquote>
<p>
Set a launch security secret in the guest&#39;s memory. The guest must have
a launchSecurity type enabled in its configuration and be in a paused
state. On success, the guest can be transitioned to a running state. On
failure, the guest should be destroyed.</p>
<p>
<em>–secrethdr</em> specifies a filename containing the base64-encoded secret
header. The header includes artifacts needed by the hypervisor firmware
to recover the plain text of the launch secret. <em>–secret</em> specifies the
filename containing the base64-encoded encrypted launch secret.</p>
<p>
The <em>–set-address</em> option can be used to specify a physical address
within the guest&#39;s memory to set the secret. If not specified, the
address will be determined by the hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-84" class="outline-3">
<h3 id="headline-84">
dommemstat
</h3>
<div id="outline-text-headline-84" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dommemstat domain [--period seconds] [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Get memory stats for a running domain.</p>
<p>
Availability of these fields depends on hypervisor. Unsupported fields
are missing from the output. Other fields may appear if communicating
with a newer version of libvirtd.</p>
<p>
Explanation of fields:</p>
<blockquote>
<ul>
<li><strong>swap_in</strong> - The amount of data read from swap space (in KiB)</li>
<li><strong>swap_out</strong> - The amount of memory written out to swap space (in KiB)</li>
<li><strong>major_fault</strong> - The number of page faults where disk IO was required</li>
<li><strong>minor_fault</strong> - The number of other page faults</li>
<li><strong>unused</strong> - The amount of memory left unused by the system (in KiB)</li>
<li><strong>available</strong> - The amount of usable memory as seen by the domain (in
KiB)</li>
<li><strong>actual</strong> - Current balloon value (in KiB)</li>
<li><strong>rss</strong> - Resident Set Size of the running domain&#39;s process (in KiB)</li>
<li><strong>usable</strong> - The amount of memory which can be reclaimed by balloon
without causing host swapping (in KiB)</li>
<li><strong>last-update</strong> - Timestamp of the last update of statistics (in
seconds)</li>
<li><strong>disk_caches</strong> - The amount of memory that can be reclaimed without
additional I/O, typically disk caches (in KiB)</li>
<li><strong>hugetlb_pgalloc</strong> - The number of successful huge page allocations
initiated from within the domain</li>
<li><strong>hugetlb_pgfail</strong> - The number of failed huge page allocations
initiated from within the domain</li>
</ul>
</blockquote>
<p>
For QEMU/KVM with a memory balloon, setting the optional <em>–period</em> to a
value larger than 0 in seconds will allow the balloon driver to return
additional statistics which will be displayed by subsequent <strong>dommemstat</strong>
commands. Setting the <em>–period</em> to 0 will stop the balloon driver
collection, but does not clear the statistics in the balloon driver.
Requires at least QEMU/KVM 1.5 to be running on the host.</p>
<p>
The <em>–live</em>, <em>–config</em>, and <em>–current</em> flags are only valid when
using the <em>–period</em> option in order to set the collection period for
the balloon driver. If <em>–live</em> is specified, only the running guest
collection period is affected. If <em>–config</em> is specified, affect the
next start of a persistent guest. If <em>–current</em> is specified, it is
equivalent to either <em>–live</em> or <em>–config</em>, depending on the current
state of the guest.</p>
<p>
Both <em>–live</em> and <em>–config</em> flags may be given, but <em>–current</em> is
exclusive. If no flag is specified, behavior is different depending on
the guest state.</p>
</div>
</div>
<div id="outline-container-headline-85" class="outline-3">
<h3 id="headline-85">
domname
</h3>
<div id="outline-text-headline-85" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domname domain-id-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Convert a domain Id (or UUID) to domain name</p>
</div>
</div>
<div id="outline-container-headline-86" class="outline-3">
<h3 id="headline-86">
dompmsuspend
</h3>
<div id="outline-text-headline-86" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dompmsuspend domain target [--duration]
</pre>
</blockquote>
</blockquote>
<p>
Suspend a running domain into one of these states (possible <em>target</em>
values):</p>
<blockquote>
<ul>
<li><strong>mem</strong> - equivalent of S3 ACPI state</li>
<li><strong>disk</strong> - equivalent of S4 ACPI state</li>
<li><strong>hybrid</strong> - RAM is saved to disk but not powered off</li>
</ul>
</blockquote>
<p>
The <em>–duration</em> argument specifies number of seconds before the domain
is woken up after it was suspended (see also <strong>dompmwakeup</strong>). Default is
0 for unlimited suspend time. (This feature isn&#39;t currently supported by
any hypervisor driver and 0 should be used.).</p>
<p>
Note that this command requires a guest agent configured and running in
the domain&#39;s guest OS.</p>
<p>
Beware that at least for QEMU, the domain&#39;s process will be terminated
when target disk is used and a new process will be launched when libvirt
is asked to wake up the domain. As a result of this, any runtime
changes, such as device hotplug or memory settings, are lost unless such
changes were made with <em>–config</em> flag.</p>
</div>
</div>
<div id="outline-container-headline-87" class="outline-3">
<h3 id="headline-87">
dompmwakeup
</h3>
<div id="outline-text-headline-87" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dompmwakeup domain
</pre>
</blockquote>
</blockquote>
<p>
Wakeup a domain from pmsuspended state (either suspended by dompmsuspend
or from the guest itself). Injects a wakeup into the guest that is in
pmsuspended state, rather than waiting for the previously requested
duration (if any) to elapse. This operation does not necessarily fail if
the domain is running.</p>
</div>
</div>
<div id="outline-container-headline-88" class="outline-3">
<h3 id="headline-88">
domrename
</h3>
<div id="outline-text-headline-88" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domrename domain new-name
</pre>
</blockquote>
</blockquote>
<p>
Rename a domain. This command changes current domain name to the new
name specified in the second argument.</p>
<p>
<strong>Note</strong>: Domain must be inactive.</p>
</div>
</div>
<div id="outline-container-headline-89" class="outline-3">
<h3 id="headline-89">
domstate
</h3>
<div id="outline-text-headline-89" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domstate domain [--reason]
</pre>
</blockquote>
</blockquote>
<p>
Returns state about a domain. <em>–reason</em> tells virsh to also print
reason for the state.</p>
</div>
</div>
<div id="outline-container-headline-90" class="outline-3">
<h3 id="headline-90">
domstats
</h3>
<div id="outline-text-headline-90" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domstats [--raw] [--enforce] [--backing] [--nowait] [--state]
   [--cpu-total] [--balloon] [--vcpu] [--interface]
   [--block] [--perf] [--iothread] [--memory] [--dirtyrate] [--vm]
   [[--list-active] [--list-inactive]
    [--list-persistent] [--list-transient] [--list-running]y
    [--list-paused] [--list-shutoff] [--list-other]] | [domain ...]
</pre>
</blockquote>
</blockquote>
<p>
Get statistics for multiple or all domains. Without any argument this
command prints all available statistics for all domains.</p>
<p>
The list of domains to gather stats for can be either limited by listing
the domains as a space separated list, or by specifying one of the
filtering flags <em>–list-NNN</em>. (The approaches can&#39;t be combined.)</p>
<p>
By default some of the returned fields may be converted to more human
friendly values by a set of pretty-printers. To suppress this behavior
use the <em>–raw</em> flag.</p>
<p>
The individual statistics groups are selectable via specific flags. By
default all supported statistics groups are returned. Supported
statistics groups flags are: <em>–state</em>, <em>–cpu-total</em>, <em>–balloon</em>,
<em>–vcpu</em>, <em>–interface</em>, <em>–block</em>, <em>–perf</em>, <em>–iothread</em>, <em>–memory</em>,
<em>–dirtyrate</em>, <em>–vm</em>.</p>
<p>
Note that - depending on the hypervisor type and version or the domain
state - not all of the following statistics may be returned.</p>
<p>
When selecting the <em>–state</em> group the following fields are returned:</p>
<blockquote>
<ul>
<li><strong>state.state</strong> - state of the VM, returned as number from
virDomainState enum</li>
<li><strong>state.reason</strong> - reason for entering given state, returned as int from
virDomain*Reason enum corresponding to given state</li>
</ul>
</blockquote>
<p>
<em>–cpu-total</em> returns:</p>
<blockquote>
<ul>
<li><strong>cpu.time</strong> - total cpu time spent for this domain in nanoseconds</li>
<li><strong>cpu.user</strong> - user cpu time spent in nanoseconds</li>
<li><strong>cpu.system</strong> - system cpu time spent in nanoseconds</li>
<li><strong>cpu.haltpoll.success.time</strong> - cpu halt polling success time spent in
nanoseconds</li>
<li><strong>cpu.haltpoll.fail.time</strong> - cpu halt polling fail time spent in
nanoseconds</li>
<li><strong>cpu.cache.monitor.count</strong> - the number of cache monitors for this
domain</li>
<li><strong>cpu.cache.monitor.&lt;num&gt;.name</strong> - the name of cache monitor &lt;num&gt;</li>
<li><strong>cpu.cache.monitor.&lt;num&gt;.vcpus</strong> - vcpu list of cache monitor &lt;num&gt;</li>
<li><strong>cpu.cache.monitor.&lt;num&gt;.bank.count</strong> - the number of cache banks in
cache monitor &lt;num&gt;</li>
<li><strong>cpu.cache.monitor.&lt;num&gt;.bank.&lt;index&gt;.id</strong> - host allocated cache id
for bank &lt;index&gt; in cache monitor &lt;num&gt;</li>
<li><strong>cpu.cache.monitor.&lt;num&gt;.bank.&lt;index&gt;.bytes</strong> - the number of bytes of
last level cache that the domain is using on cache bank &lt;index&gt;</li>
</ul>
</blockquote>
<p>
<em>–balloon</em> returns:</p>
<blockquote>
<ul>
<li><strong>balloon.current</strong> - the memory in KiB currently used</li>
<li><strong>balloon.maximum</strong> - the maximum memory in KiB allowed</li>
<li><strong>balloon.swap_in</strong> - the amount of data read from swap space (in KiB)</li>
<li><strong>balloon.swap_out</strong> - the amount of memory written out to swap space
(in KiB)</li>
<li><strong>balloon.major_fault</strong> - the number of page faults when disk IO was
required</li>
<li><strong>balloon.minor_fault</strong> - the number of other page faults</li>
<li><strong>balloon.unused</strong> - the amount of memory left unused by the system (in
KiB)</li>
<li><strong>balloon.available</strong> - the amount of usable memory as seen by the
domain (in KiB)</li>
<li><strong>balloon.rss</strong> - Resident Set Size of running domain&#39;s process (in KiB)</li>
<li><strong>balloon.usable</strong> - the amount of memory which can be reclaimed by
balloon without causing host swapping (in KiB)</li>
<li><strong>balloon.last-update</strong> - timestamp of the last update of statistics (in
seconds)</li>
<li><strong>balloon.disk_caches</strong> - the amount of memory that can be reclaimed
without additional I/O, typically disk (in KiB)</li>
<li><strong>balloon.hugetlb_pgalloc</strong> - the number of successful huge page
allocations from inside the domain via virtio balloon</li>
<li><strong>balloon.hugetlb_pgfail</strong> - the number of failed huge page allocations
from inside the domain via virtio balloon</li>
</ul>
</blockquote>
<p>
<em>–vcpu</em> returns:</p>
<blockquote>
<ul>
<li><strong>vcpu.current</strong> - current number of online virtual CPUs</li>
<li><strong>vcpu.maximum</strong> - maximum number of online virtual CPUs</li>
<li><strong>vcpu.&lt;num&gt;.state</strong> - state of the virtual CPU &lt;num&gt;, as number from
virVcpuState enum</li>
<li><strong>vcpu.&lt;num&gt;.time</strong> - virtual cpu time spent by virtual CPU &lt;num&gt; (in
microseconds)</li>
<li><strong>vcpu.&lt;num&gt;.wait</strong> - virtual cpu time spent by virtual CPU &lt;num&gt;
waiting on I/O (in microseconds)</li>
<li><strong>vcpu.&lt;num&gt;.halted</strong> - virtual CPU &lt;num&gt; is halted: yes or no (may
indicate the processor is idle or even disabled, depending on the
architecture)</li>
<li><strong>vcpu.&lt;num&gt;.delay</strong> - time the vCPU &lt;num&gt; thread was enqueued by the
host scheduler, but was waiting in the queue instead of running.
Exposed to the VM as a steal time.</li>
</ul>
</blockquote>
<p>
This group of statistics also reports additional hypervisor-originating
per-vCPU stats. The hypervisor-specific statistics in this group have
the following naming scheme:</p>
<blockquote>
<blockquote>
<p><strong>vcpu.&lt;num&gt;.$NAME.$TYPE</strong></p>
<blockquote>
<dl>
<dt>
<strong><strong>$NAME</strong></strong>
</dt>
<dd>name of the statistics field provided by the hypervisor</dd>
<dt>
<strong><strong>$TYPE</strong></strong>
</dt>
<dd>
<p>Type of the value. The following types are returned:</p>
<dl>
<dt>
<strong><strong>cur</strong></strong>
</dt>
<dd>current instant value</dd>
<dt>
<strong><strong>sum</strong></strong>
</dt>
<dd>aggregate value</dd>
<dt>
<strong><strong>max</strong></strong>
</dt>
<dd>peak value</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>
The returned value may be either an unsigned long long or a boolean.
Meaning is hypervisor specific. Please see the disclaimer for the <em>–vm</em>
group which also consists of hypervisor-specific stats.</p>
</blockquote>
</blockquote>
<p>
<em>–interface</em> returns:</p>
<blockquote>
<ul>
<li><strong>net.count</strong> - number of network interfaces on this domain</li>
<li><strong>net.&lt;num&gt;.name</strong> - name of the interface &lt;num&gt;</li>
<li><strong>net.&lt;num&gt;.rx.bytes</strong> - number of bytes received</li>
<li><strong>net.&lt;num&gt;.rx.pkts</strong> - number of packets received</li>
<li><strong>net.&lt;num&gt;.rx.errs</strong> - number of receive errors</li>
<li><strong>net.&lt;num&gt;.rx.drop</strong> - number of receive packets dropped</li>
<li><strong>net.&lt;num&gt;.tx.bytes</strong> - number of bytes transmitted</li>
<li><strong>net.&lt;num&gt;.tx.pkts</strong> - number of packets transmitted</li>
<li><strong>net.&lt;num&gt;.tx.errs</strong> - number of transmission errors</li>
<li><strong>net.&lt;num&gt;.tx.drop</strong> - number of transmit packets dropped</li>
</ul>
</blockquote>
<p>
<em>–perf</em> returns the statistics of all enabled perf events:</p>
<blockquote>
<ul>
<li><strong>perf.cmt</strong> - the cache usage in Byte currently used</li>
<li><strong>perf.mbmt</strong> - total system bandwidth from one level of cache</li>
<li><strong>perf.mbml</strong> - bandwidth of memory traffic for a memory controller</li>
<li><strong>perf.cpu_cycles</strong> - the count of cpu cycles (total/elapsed)</li>
<li><strong>perf.instructions</strong> - the count of instructions</li>
<li><strong>perf.cache_references</strong> - the count of cache hits</li>
<li><strong>perf.cache_misses</strong> - the count of caches misses</li>
<li><strong>perf.branch_instructions</strong> - the count of branch instructions</li>
<li><strong>perf.branch_misses</strong> - the count of branch misses</li>
<li><strong>perf.bus_cycles</strong> - the count of bus cycles</li>
<li><strong>perf.stalled_cycles_frontend</strong> - the count of stalled frontend cpu
cycles</li>
<li><strong>perf.stalled_cycles_backend</strong> - the count of stalled backend cpu
cycles</li>
<li><strong>perf.ref_cpu_cycles</strong> - the count of ref cpu cycles</li>
<li><strong>perf.cpu_clock</strong> - the count of cpu clock time</li>
<li><strong>perf.task_clock</strong> - the count of task clock time</li>
<li><strong>perf.page_faults</strong> - the count of page faults</li>
<li><strong>perf.context_switches</strong> - the count of context switches</li>
<li><strong>perf.cpu_migrations</strong> - the count of cpu migrations</li>
<li><strong>perf.page_faults_min</strong> - the count of minor page faults</li>
<li><strong>perf.page_faults_maj</strong> - the count of major page faults</li>
<li><strong>perf.alignment_faults</strong> - the count of alignment faults</li>
<li><strong>perf.emulation_faults</strong> - the count of emulation faults</li>
</ul>
</blockquote>
<p>
See the <strong>perf</strong> command for more details about each event.</p>
<p>
<em>–block</em> returns information about disks associated with each domain.
Using the <em>–backing</em> flag extends this information to cover all
resources in the backing chain, rather than the default of limiting
information to the active layer for each guest disk. Information listed
includes:</p>
<blockquote>
<ul>
<li><strong>block.count</strong> - number of block devices being listed</li>
<li><strong>block.&lt;num&gt;.name</strong> - name of the target of the block device &lt;num&gt; (the
same name for multiple entries if <em>–backing</em> is present)</li>
<li><strong>block.&lt;num&gt;.backingIndex</strong> - when <em>–backing</em> is present, matches up
with the &lt;backingStore&gt; index listed in domain XML for backing files</li>
<li><strong>block.&lt;num&gt;.path</strong> - file source of block device &lt;num&gt;, if it is a
local file or block device</li>
<li><strong>block.&lt;num&gt;.rd.reqs</strong> - number of read requests</li>
<li><strong>block.&lt;num&gt;.rd.bytes</strong> - number of read bytes</li>
<li><strong>block.&lt;num&gt;.rd.times</strong> - total time (ns) spent on reads</li>
<li><strong>block.&lt;num&gt;.wr.reqs</strong> - number of write requests</li>
<li><strong>block.&lt;num&gt;.wr.bytes</strong> - number of written bytes</li>
<li><strong>block.&lt;num&gt;.wr.times</strong> - total time (ns) spent on writes</li>
<li><strong>block.&lt;num&gt;.fl.reqs</strong> - total flush requests</li>
<li><strong>block.&lt;num&gt;.fl.times</strong> - total time (ns) spent on cache flushing</li>
<li><strong>block.&lt;num&gt;.errors</strong> - Xen only: the &#39;oo_req&#39; value</li>
<li><strong>block.&lt;num&gt;.allocation</strong> - offset of highest written sector in bytes</li>
<li><strong>block.&lt;num&gt;.capacity</strong> - logical size of source file in bytes</li>
<li><strong>block.&lt;num&gt;.physical</strong> - physical size of source file in bytes</li>
<li><strong>block.&lt;num&gt;.threshold</strong> - threshold (in bytes) for delivering the
VIR_DOMAIN_EVENT_ID_BLOCK_THRESHOLD event. See domblkthreshold.</li>
</ul>
</blockquote>
<p>
<em>–iothread</em> returns information about IOThreads on the running guest if
supported by the hypervisor.</p>
<p>
The &#34;poll-max-ns&#34; for each thread is the maximum nanoseconds to allow
each polling interval to occur. A polling interval is a period of time
allowed for a thread to process data before being the guest gives up its
CPU quantum back to the host. A value set too small will not allow the
IOThread to run long enough on a CPU to process data. A value set too
high will consume too much CPU time per IOThread failing to allow other
threads running on the CPU to get time. The polling interval is not
available for statistical purposes.</p>
<blockquote>
<ul>
<li>
<ul>
<li><strong>*iothread.count</strong> - maximum number of IOThreads in the subsequent
list* :: as unsigned int. Each IOThread in the list will will use
it&#39;s iothread_id value as the &lt;id&gt;. There may be fewer &lt;id&gt; entries
than the iothread.count value if the polling values are not
supported.</li>
</ul>
</li>
<li><strong>iothread.&lt;id&gt;.poll-max-ns</strong> - maximum polling time in nanoseconds used
by the &lt;id&gt; IOThread. A value of 0 (zero) indicates polling is
disabled.</li>
<li><strong>iothread.&lt;id&gt;.poll-grow</strong> - polling time grow value. A value of 0
(zero) growth is managed by the hypervisor.</li>
<li><strong>iothread.&lt;id&gt;.poll-shrink</strong> - polling time shrink value. A value of
(zero) indicates shrink is managed by hypervisor.</li>
</ul>
</blockquote>
<p>
<em>–memory</em> returns:</p>
<blockquote>
<ul>
<li><strong>memory.bandwidth.monitor.count</strong> - the number of memory bandwidth
monitors for this domain</li>
<li><strong>memory.bandwidth.monitor.&lt;num&gt;.name</strong> - the name of monitor &lt;num&gt;</li>
<li><strong>memory.bandwidth.monitor.&lt;num&gt;.vcpus</strong> - the vcpu list of monitor
&lt;num&gt;</li>
<li>
<ul>
<li><strong>*memory.bandwidth.monitor.&lt;num&gt;.node.count</strong> - the number of
memory* :: controller in monitor &lt;num&gt;</li>
</ul>
</li>
<li><strong>memory.bandwidth.monitor.&lt;num&gt;.node.&lt;index&gt;.id</strong> - host allocated
memory controller id for controller &lt;index&gt; of monitor &lt;num&gt;</li>
<li><strong>memory.bandwidth.monitor.&lt;num&gt;.node.&lt;index&gt;.bytes.local</strong> - the
accumulative bytes consumed by @vcpus that passing through the memory
controller in the same processor that the scheduled host CPU belongs
to.</li>
<li><strong>memory.bandwidth.monitor.&lt;num&gt;.node.&lt;index&gt;.bytes.total</strong> - the total
bytes consumed by @vcpus that passing through all memory controllers,
either local or remote controller.</li>
</ul>
</blockquote>
<p>
<em>–dirtyrate</em> returns:</p>
<blockquote>
<ul>
<li><strong>dirtyrate.calc_status</strong> - the status of last memory dirty rate
calculation, returned as number from virDomainDirtyRateStatus enum.</li>
<li><strong>dirtyrate.calc_start_time</strong> - the start time of last memory dirty rate
calculation.</li>
<li><strong>dirtyrate.calc_period</strong> - the period of last memory dirty rate
calculation.</li>
<li><strong>dirtyrate.megabytes_per_second</strong> - the calculated memory dirty rate in
MiB/s.</li>
<li><strong>dirtyrate.calc_mode</strong> - the calculation mode used last measurement
(<strong>page-sampling*/*dirty-bitmap*/*dirty-ring</strong>)</li>
<li><strong>dirtyrate.vcpu.&lt;num&gt;.megabytes_per_second</strong> - the calculated memory
dirty rate for a virtual cpu in MiB/s</li>
</ul>
</blockquote>
<p>
<em>–vm</em> returns:</p>
<p>
The <em>–vm</em> option enables reporting of hypervisor-specific statistics.
Naming and meaning of the fields is entirely hypervisor dependent.</p>
<p>
The statistics in this group have the following naming scheme:</p>
<blockquote>
<blockquote>
<p><strong>vm.$NAME.$TYPE</strong></p>
<blockquote>
<dl>
<dt>
<strong><strong>$NAME</strong></strong>
</dt>
<dd>name of the statistics field provided by the hypervisor</dd>
<dt>
<strong><strong>$TYPE</strong></strong>
</dt>
<dd>
<p>Type of the value. The following types are returned:</p>
<dl>
<dt>
<strong><strong>cur</strong></strong>
</dt>
<dd>current instant value</dd>
<dt>
<strong><strong>sum</strong></strong>
</dt>
<dd>aggregate value</dd>
<dt>
<strong><strong>max</strong></strong>
</dt>
<dd>peak value</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>
The returned value may be either an unsigned long long or a boolean.</p>
<p>
<strong>WARNING</strong>: The stats reported in this group are runtime-collected and
hypervisor originated, thus fall outside of the usual stable API
policies of libvirt.</p>
<p>
Libvirt can&#39;t guarantee that the statistics reported from the outside
source will be present in further versions of the hypervisor, or that
naming or meaning will stay consistent. Changes to existing fields,
however, are expected to be rare.</p>
</blockquote>
</blockquote>
<p>
Selecting a specific statistics groups doesn&#39;t guarantee that the daemon
supports the selected group of stats. Flag <em>–enforce</em> forces the
command to fail if the daemon doesn&#39;t support the selected group.</p>
<p>
When collecting stats libvirtd may wait for some time if there&#39;s already
another job running on given domain for it to finish. This may cause
unnecessary delay in delivering stats. Using <em>–nowait</em> suppresses this
behaviour. On the other hand some statistics might be missing for such
domain.</p>
</div>
</div>
<div id="outline-container-headline-91" class="outline-3">
<h3 id="headline-91">
domtime
</h3>
<div id="outline-text-headline-91" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domtime domain { [--now] [--pretty] [--sync] [--time time] }
</pre>
</blockquote>
</blockquote>
<p>
Gets or sets the domain&#39;s system time. When run without any arguments
(but <em>domain</em>), the current domain&#39;s system time is printed out. The
<em>–pretty</em> modifier can be used to print the time in more human readable
form.</p>
<p>
When <em>–time</em> <strong>time</strong> is specified, the domain&#39;s time is not gotten but
set instead. The <em>–now</em> modifier acts like if it was an alias for
<em>–time</em> <strong>$now</strong>, which means it sets the time that is currently on the
host virsh is running at. In both cases (setting and getting), time is
in seconds relative to Epoch of 1970-01-01 in UTC. The <em>–sync</em> modifies
the set behavior a bit: The time passed is ignored, but the time to set
is read from domain&#39;s RTC instead. Please note, that some hypervisors
may require a guest agent to be configured in order to get or set the
guest time.</p>
</div>
</div>
<div id="outline-container-headline-92" class="outline-3">
<h3 id="headline-92">
domuuid
</h3>
<div id="outline-text-headline-92" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domuuid domain-name-or-id
</pre>
</blockquote>
</blockquote>
<p>
Convert a domain name or id to domain UUID</p>
</div>
</div>
<div id="outline-container-headline-93" class="outline-3">
<h3 id="headline-93">
domxml-from-native
</h3>
<div id="outline-text-headline-93" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domxml-from-native format config
</pre>
</blockquote>
</blockquote>
<p>
Convert the file <em>config</em> in the native guest configuration format named
by <em>format</em> to a domain XML format. For QEMU/KVM hypervisor, the
<em>format</em> argument must be <strong>qemu-argv</strong>. For Xen hypervisor, the <em>format</em>
argument may be <strong>xen-xm</strong>, <strong>xen-xl</strong>, or <strong>xen-sxpr</strong>. For LXC hypervisor,
the <em>format</em> argument must be <strong>lxc-tools</strong>. For VMware/ESX hypervisor,
the <em>format</em> argument must be <strong>vmware-vmx</strong>. For the Bhyve hypervisor,
the <em>format</em> argument must be <strong>bhyve-argv</strong>.</p>
</div>
</div>
<div id="outline-container-headline-94" class="outline-3">
<h3 id="headline-94">
domxml-to-native
</h3>
<div id="outline-text-headline-94" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
domxml-to-native format { [--xml] xml | --domain domain-name-or-id-or-uuid }
</pre>
</blockquote>
</blockquote>
<p>
Convert the file <em>xml</em> into domain XML format or convert an existing
<em>–domain</em> to the native guest configuration format named by <em>format</em>.
The <em>xml</em> and <em>–domain</em> arguments are mutually exclusive. For the types
of <em>format</em> argument, refer to <strong>domxml-from-native</strong>.</p>
</div>
</div>
<div id="outline-container-headline-95" class="outline-3">
<h3 id="headline-95">
dump
</h3>
<div id="outline-text-headline-95" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dump domain corefilepath [--bypass-cache]
   { [--live] | [--crash] | [--reset] }
   [--verbose] [--memory-only] [--format string]
</pre>
</blockquote>
</blockquote>
<p>
Dumps the core of a domain to a file for analysis. If <em>–live</em> is
specified, the domain continues to run until the core dump is complete,
rather than pausing up front. If <em>–crash</em> is specified, the domain is
halted with a crashed status, rather than merely left in a paused state.
If <em>–reset</em> is specified, the domain is reset after successful dump.
Note, these three switches are mutually exclusive. If <em>–bypass-cache</em>
is specified, the save will avoid the file system cache, although this
may slow down the operation. If <em>–memory-only</em> is specified, the file
is elf file, and will only include domain&#39;s memory and cpu common
register value. It is very useful if the domain uses host devices
directly. <em>–format</em> <em>string</em> is used to specify the format of
&#39;memory-only&#39; dump, and <em>string</em> can be one of: elf,
kdump-zlib(kdump-compressed format with zlib-compressed),
kdump-lzo(kdump-compressed format with lzo-compressed),
kdump-snappy(kdump-compressed format with snappy-compressed),
win-dmp(Windows full crashdump format).</p>
<p>
The progress may be monitored using <strong>domjobinfo</strong> virsh command and
canceled with <strong>domjobabort</strong> command (sent by another virsh instance).
Another option is to send SIGINT (usually with <strong>Ctrl-C</strong>) to the virsh
process running <strong>dump</strong> command. <em>–verbose</em> displays the progress of
dump.</p>
<p>
NOTE: Some hypervisors may require the user to manually ensure proper
permissions on file and path specified by argument <em>corefilepath</em>.</p>
<p>
NOTE: Crash dump in a old kvmdump format is being obsolete and cannot be
loaded and processed by crash utility since its version 6.1.0. A
–memory-only option is required in order to produce valid ELF file
which can be later processed by the crash utility.</p>
</div>
</div>
<div id="outline-container-headline-96" class="outline-3">
<h3 id="headline-96">
dumpxml
</h3>
<div id="outline-text-headline-96" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dumpxml [--inactive] [--security-info] [--update-cpu] [--migratable]
        [--xpath EXPRESSION] [--wrap] domain
</pre>
</blockquote>
</blockquote>
<p>
Output the domain information as an XML dump to stdout, this format can
be used by the <strong>create</strong> command. Additional options affecting the XML
dump may be used. <em>–inactive</em> tells virsh to dump domain configuration
that will be used on next start of the domain as opposed to the current
domain configuration. Using <em>–security-info</em> will also include security
sensitive information in the XML dump. <em>–update-cpu</em> updates domain CPU
requirements according to host CPU. With <em>–migratable</em> one can request
an XML that is suitable for migrations, i.e., compatible with older
libvirt releases and possibly amended with internal run-time options.
This option may automatically enable other options (<em>–update-cpu</em>,
<em>–security-info</em>, …) as necessary.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-97" class="outline-3">
<h3 id="headline-97">
edit
</h3>
<div id="outline-text-headline-97" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
edit domain
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration file for a domain, which will affect the next
boot of the guest.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh dumpxml --inactive --security-info domain &gt; domain.xml
vi domain.xml (or make changes with your other text editor)
virsh define domain.xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-98" class="outline-3">
<h3 id="headline-98">
emulatorpin
</h3>
<div id="outline-text-headline-98" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
emulatorpin domain [cpulist] [[--live] [--config]  | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Query or change the pinning of domain&#39;s emulator threads to host
physical CPUs.</p>
<p>
See <strong>vcpupin</strong> for <em>cpulist</em>.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given if <em>cpulist</em> is present, but <em>–current</em>
is exclusive. If no flag is specified, behavior is different depending
on hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-99" class="outline-3">
<h3 id="headline-99">
event
</h3>
<div id="outline-text-headline-99" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
event {[domain] { event | --all } [--loop] [--timeout seconds] [--timestamp] | --list}
</pre>
</blockquote>
</blockquote>
<p>
Wait for a class of domain events to occur, and print appropriate
details of events as they happen. The events can optionally be filtered
by <em>domain</em>. Using <em>–list</em> as the only argument will provide a list of
possible <em>event</em> values known by this client, although the connection
might not allow registering for all these events. It is also possible to
use <em>–all</em> instead of <em>event</em> to register for all possible event types
at once.</p>
<p>
By default, this command is one-shot, and returns success once an event
occurs; you can send SIGINT (usually via <strong>Ctrl-C</strong>) to quit immediately.
If <em>–timeout</em> is specified, the command gives up waiting for events
after <em>seconds</em> have elapsed. With <em>–loop</em>, the command prints all
events until a timeout or interrupt key.</p>
<p>
When <em>–timestamp</em> is used, a human-readable timestamp will be printed
before the event.</p>
</div>
</div>
<div id="outline-container-headline-100" class="outline-3">
<h3 id="headline-100">
get-user-sshkeys
</h3>
<div id="outline-text-headline-100" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
get-user-sshkeys domain user
</pre>
</blockquote>
</blockquote>
<p>
Print SSH authorized keys for given <em>user</em> in the guest <em>domain</em>. Please
note, that an entry in the file has internal structure as defined by
<em>sshd(8)</em> and virsh/libvirt does handle keys as opaque strings, i.e.
does not interpret them.</p>
</div>
</div>
<div id="outline-container-headline-101" class="outline-3">
<h3 id="headline-101">
guest-agent-timeout
</h3>
<div id="outline-text-headline-101" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
guest-agent-timeout domain [--timeout value]
</pre>
</blockquote>
</blockquote>
<p>
Set how long to wait for a response from guest agent commands. By
default, agent commands block forever waiting for a response. <strong>value</strong>
must be a positive value (wait for given amount of seconds) or one of
the following values:</p>
<blockquote>
<ul>
<li>-2 - block forever waiting for a result (used when –timeout is
omitted),</li>
<li>-1 - reset timeout to the default value (currently defined as 5
seconds in libvirt daemon),</li>
<li>0 - do not wait at all,</li>
</ul>
</blockquote>
</div>
</div>
<div id="outline-container-headline-102" class="outline-3">
<h3 id="headline-102">
guestinfo
</h3>
<div id="outline-text-headline-102" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
guestinfo domain [--user] [--os] [--timezone] [--hostname] [--filesystem]
   [--disk] [--interface]
</pre>
</blockquote>
</blockquote>
<p>
Print information about the guest from the point of view of the guest
agent. Note that this command requires a guest agent to be configured
and running in the domain&#39;s guest OS.</p>
<p>
When run without any arguments, this command prints all information
types that are supported by the guest agent at that point, omitting
unavailable ones. Success is always reported in this case.</p>
<p>
You can limit the types of information that are returned by specifying
one or more flags. Available information types flags are <em>–user</em>,
<em>–os</em>, <em>–timezone</em>, <em>–hostname</em>, <em>–filesystem</em>, <em>–disk</em> and
<em>–interface</em>. If an explicitly requested information type is not
supported by the guest agent at that point, the processes will provide
an exit code of 1.</p>
<p>
Note that depending on the hypervisor type and the version of the guest
agent running within the domain, not all of the following information
may be returned.</p>
<p>
When selecting the <em>–user</em> information type, the following fields may
be returned:</p>
<blockquote>
<ul>
<li><strong>user.count</strong> - the number of active users on this domain</li>
<li><strong>user.&lt;num&gt;.name</strong> - username of user &lt;num&gt;</li>
<li><strong>user.&lt;num&gt;.domain</strong> - domain of the user &lt;num&gt; (may only be present on
certain guets types)</li>
<li><strong>user.&lt;num&gt;.login-time</strong> - the login time of user &lt;num&gt; in milliseconds
since the epoch</li>
</ul>
</blockquote>
<p>
<em>–os</em> returns:</p>
<blockquote>
<ul>
<li><strong>os.id</strong> - a string identifying the operating system</li>
<li><strong>os.name</strong> - the name of the operating system</li>
<li><strong>os.pretty-name</strong> - a pretty name for the operating system</li>
<li><strong>os.version</strong> - the version of the operating system</li>
<li><strong>os.version-id</strong> - the version id of the operating system</li>
<li><strong>os.kernel-release</strong> - the release of the operating system kernel</li>
<li><strong>os.kernel-version</strong> - the version of the operating system kernel</li>
<li><strong>os.machine</strong> - the machine hardware name</li>
<li><strong>os.variant</strong> - a specific variant or edition of the operating system</li>
<li><strong>os.variant-id</strong> - the id for a specific variant or edition of the
operating system</li>
</ul>
</blockquote>
<p>
<em>–timezone</em> returns:</p>
<blockquote>
<ul>
<li><strong>timezone.name</strong> - the name of the timezone</li>
<li><strong>timezone.offset</strong> - the offset to UTC in seconds</li>
</ul>
</blockquote>
<p>
<em>–hostname</em> returns:</p>
<blockquote>
<ul>
<li><strong>hostname</strong> - the hostname of the domain</li>
</ul>
</blockquote>
<p>
<em>–filesystem</em> returns:</p>
<blockquote>
<ul>
<li><strong>fs.count</strong> - the number of filesystems defined on this domain</li>
<li><strong>fs.&lt;num&gt;.mountpoint</strong> - the path to the mount point for filesystem
&lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.name</strong> - device name in the guest (e.g. <strong>sda1</strong>) for
filesystem &lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.fstype</strong> - the type of filesystem &lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.total-bytes</strong> - the total size of filesystem &lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.used-bytes</strong> - the number of bytes used in filesystem &lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.disk.count</strong> - the number of disks targeted by filesystem
&lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.disk.&lt;num&gt;.alias</strong> - the device alias of disk &lt;num&gt; (e.g.
sda)</li>
<li><strong>fs.&lt;num&gt;.disk.&lt;num&gt;.serial</strong> - the serial number of disk &lt;num&gt;</li>
<li><strong>fs.&lt;num&gt;.disk.&lt;num&gt;.device</strong> - the device node of disk &lt;num&gt;</li>
</ul>
</blockquote>
<p>
<em>–disk</em> returns:</p>
<blockquote>
<ul>
<li><strong>disk.count</strong> - the number of disks defined on this domain</li>
<li><strong>disk.&lt;num&gt;.name</strong> - device node (Linux) or device UNC (Windows)</li>
<li><strong>disk.&lt;num&gt;.partition</strong> - whether this is a partition or disk</li>
<li><strong>disk.&lt;num&gt;.dependency.count</strong> - the number of device dependencies</li>
<li><strong>disk.&lt;num&gt;.dependency.&lt;num&gt;.name</strong> - a dependency name</li>
<li><strong>disk.&lt;num&gt;.serial</strong> - optional disk serial number</li>
<li><strong>disk.&lt;num&gt;.alias</strong> - the device alias of the disk (e.g. sda)</li>
<li><strong>disk.&lt;num&gt;.guest_alias</strong> - optional alias assigned to the disk</li>
</ul>
</blockquote>
<p>
<em>–interface</em> returns: * <strong>if.count</strong> - the number of interfaces defined
on this domain * <strong>if.&lt;num&gt;.name</strong> - name in the guest (e.g. <strong>eth0</strong>) for
interface &lt;num&gt; * <strong>if.&lt;num&gt;.hwaddr</strong> - hardware address in the guest for
interface &lt;num&gt; * <strong>if.&lt;num&gt;.addr.count</strong> - the number of IP addresses of
interface &lt;num&gt; * <strong>if.&lt;num&gt;.addr.&lt;num1&gt;.type</strong> - the IP address type of
addr &lt;num1&gt; (e.g. ipv4) * <strong>if.&lt;num&gt;.addr.&lt;num1&gt;.addr</strong> - the IP address
of addr &lt;num1&gt; * <strong>if.&lt;num&gt;.addr.&lt;num1&gt;.prefix</strong> - the prefix of IP
address of addr &lt;num1&gt;</p>
</div>
</div>
<div id="outline-container-headline-103" class="outline-3">
<h3 id="headline-103">
guestvcpus
</h3>
<div id="outline-text-headline-103" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
guestvcpus domain [[--enable] | [--disable]] [cpulist]
</pre>
</blockquote>
</blockquote>
<p>
Query or change state of vCPUs from guest&#39;s point of view using the
guest agent. When invoked without <em>cpulist</em> the guest is queried for
available guest vCPUs, their state and possibility to be offlined.</p>
<p>
If <em>cpulist</em> is provided then one of <em>–enable</em> or <em>–disable</em> must be
provided too. The desired operation is then executed on the domain.</p>
<p>
See <strong>vcpupin</strong> for information on <em>cpulist</em>.</p>
</div>
</div>
<div id="outline-container-headline-104" class="outline-3">
<h3 id="headline-104">
iothreadadd
</h3>
<div id="outline-text-headline-104" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iothreadadd domain iothread_id [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Add a new IOThread to the domain using the specified <em>iothread_id</em>. If
the <em>iothread_id</em> already exists, the command will fail. The
<em>iothread_id</em> must be greater than zero.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If the guest is not
running an error is returned. If <em>–config</em> is specified, affect the
next start of a persistent guest. If <em>–current</em> is specified, it is
equivalent to either <em>–live</em> or <em>–config</em>, depending on the current
state of the guest.</p>
</div>
</div>
<div id="outline-container-headline-105" class="outline-3">
<h3 id="headline-105">
iothreaddel
</h3>
<div id="outline-text-headline-105" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iothreaddel domain iothread_id [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Delete an IOThread from the domain using the specified <em>iothread_id</em>. If
an IOThread is currently assigned to a disk resource such as via the
<strong>attach-disk</strong> command, then the attempt to remove the IOThread will
fail. If the <em>iothread_id</em> does not exist an error will occur.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If the guest is not
running an error is returned. If <em>–config</em> is specified, affect the
next start of a persistent guest. If <em>–current</em> is specified, it is
equivalent to either <em>–live</em> or <em>–config</em>, depending on the current
state of the guest.</p>
</div>
</div>
<div id="outline-container-headline-106" class="outline-3">
<h3 id="headline-106">
iothreadinfo
</h3>
<div id="outline-text-headline-106" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iothreadinfo domain [[--live] [--config] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Display basic domain IOThreads information including the IOThread ID and
the CPU Affinity for each IOThread.</p>
<p>
If <em>–live</em> is specified, get the IOThreads data from the running guest.
If the guest is not running, an error is returned. If <em>–config</em> is
specified, get the IOThreads data from the next start of a persistent
guest. If <em>–current</em> is specified or <em>–live</em> and <em>–config</em> are not
specified, then get the IOThread data based on the current guest state,
which can either be live or offline.</p>
</div>
</div>
<div id="outline-container-headline-107" class="outline-3">
<h3 id="headline-107">
iothreadpin
</h3>
<div id="outline-text-headline-107" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iothreadpin domain iothread cpulist [[--live] [--config] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Change the pinning of a domain IOThread to host physical CPUs. In order
to retrieve a list of all IOThreads, use <strong>iothreadinfo</strong>. To pin an
<em>iothread</em> specify the <em>cpulist</em> desired for the IOThread ID as listed
in the <strong>iothreadinfo</strong> output.</p>
<p>
<em>cpulist</em> is a list of physical CPU numbers. Its syntax is a comma
separated list and a special markup using &#39;-&#39; and &#39;^&#39; (ex. &#39;0-4&#39;,
&#39;0-3,^2&#39;) can also be allowed. The &#39;-&#39; denotes the range and the &#39;^&#39;
denotes exclusive. If you want to reset iothreadpin setting, that is, to
pin an <em>iothread</em> to all physical cpus, simply specify &#39;r&#39; as a
<em>cpulist</em>.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If the guest is not
running, an error is returned. If <em>–config</em> is specified, affect the
next start of a persistent guest. If <em>–current</em> is specified, it is
equivalent to either <em>–live</em> or <em>–config</em>, depending on the current
state of the guest. Both <em>–live</em> and <em>–config</em> flags may be given if
<em>cpulist</em> is present, but <em>–current</em> is exclusive. If no flag is
specified, behavior is different depending on hypervisor.</p>
<p>
<strong>Note</strong>: The expression is sequentially evaluated, so &#34;0-15,^8&#34; is
identical to &#34;9-14,0-7,15&#34; but not identical to &#34;^8,0-15&#34;.</p>
</div>
</div>
<div id="outline-container-headline-108" class="outline-3">
<h3 id="headline-108">
iothreadset
</h3>
<div id="outline-text-headline-108" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iothreadset domain iothread_id [[--poll-max-ns ns] [--poll-grow factor]
   [--poll-shrink divisor] [--thread-pool-min value]
   [--thread-pool-max value]]
   [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Modifies an existing iothread of the domain using the specified
<em>iothread_id</em>. The <em>–poll-max-ns</em> provides the maximum polling interval
to be allowed for an IOThread in ns. If a 0 (zero) is provided, then
polling for the IOThread is disabled. The <em>–poll-grow</em> is the factor by
which the current polling time will be adjusted in order to reach the
maximum polling time. If a 0 (zero) is provided, then the default factor
will be used. The <em>–poll-shrink</em> is the quotient by which the current
polling time will be reduced in order to get below the maximum polling
interval. If a 0 (zero) is provided, then the default quotient will be
used. The polling values are purely dynamic for a running guest. Saving,
destroying, stopping, etc. the guest will result in the polling values
returning to hypervisor defaults at the next start, restore, etc.</p>
<p>
The <em>–thread-pool-min</em> and <em>–thread-pool-max</em> options then set lower
and upper bound, respectively of number of threads in worker pool of
given iothread. For changes to an inactive configuration -1 can be
specified to remove corresponding boundary from the domain
configuration. For changes to a running guest it&#39;s recommended to set
the upper boundary first (<em>–thread-pool-max</em>) and only after that set
the lower boundary (<em>–thread-pool-min</em>). It is allowed for the lower
boundary to be the same as the upper boundary, however it&#39;s not allowed
for the upper boundary to be value of zero.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If the guest is not
running an error is returned. If <em>–current</em> is specified or <em>–live</em> is
not specified, then handle as if <em>–live</em> was specified. (Where
&#34;current&#34; here means whatever the present guest state is: live or
offline.)</p>
</div>
</div>
<div id="outline-container-headline-109" class="outline-3">
<h3 id="headline-109">
managedsave
</h3>
<div id="outline-text-headline-109" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
managedsave domain [--bypass-cache] [{--running | --paused}] [--verbose]
</pre>
</blockquote>
</blockquote>
<p>
Save and destroy (stop) a running domain, so it can be restarted from
the same state at a later time. When the virsh <strong>start</strong> command is next
run for the domain, it will automatically be started from this saved
state. If <em>–bypass-cache</em> is specified, the save will avoid the file
system cache, although this may slow down the operation.</p>
<p>
The progress may be monitored using <strong>domjobinfo</strong> virsh command and
canceled with <strong>domjobabort</strong> command (sent by another virsh instance).
Another option is to send SIGINT (usually with <strong>Ctrl-C</strong>) to the virsh
process running <strong>managedsave</strong> command. <em>–verbose</em> displays the progress
of save.</p>
<p>
Normally, starting a managed save will decide between running or paused
based on the state the domain was in when the save was done; passing
either the <em>–running</em> or <em>–paused</em> flag will allow overriding which
state the <strong>start</strong> should use.</p>
<p>
The <strong>dominfo</strong> command can be used to query whether a domain currently
has any managed save image.</p>
</div>
</div>
<div id="outline-container-headline-110" class="outline-3">
<h3 id="headline-110">
managedsave-define
</h3>
<div id="outline-text-headline-110" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
managedsave-define domain xml [{--running | --paused}]
</pre>
</blockquote>
</blockquote>
<p>
Update the domain XML that will be used when <em>domain</em> is later started.
The <em>xml</em> argument must be a file name containing the alternative XML,
with changes only in the host-specific portions of the domain XML. For
example, it can be used to change disk file paths.</p>
<p>
The managed save image records whether the domain should be started to a
running or paused state. Normally, this command does not alter the
recorded state; passing either the <em>–running</em> or <em>–paused</em> flag will
allow overriding which state the <strong>start</strong> should use.</p>
</div>
</div>
<div id="outline-container-headline-111" class="outline-3">
<h3 id="headline-111">
managedsave-dumpxml
</h3>
<div id="outline-text-headline-111" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
managedsave-dumpxml [--security-info] [--xpath EXPRESSION] [--wrap] domain
</pre>
</blockquote>
</blockquote>
<p>
Extract the domain XML that was in effect at the time the saved state
file <em>file</em> was created with the <strong>managedsave</strong> command. Using
<em>–security-info</em> will also include security sensitive information.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-112" class="outline-3">
<h3 id="headline-112">
managedsave-edit
</h3>
<div id="outline-text-headline-112" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
managedsave-edit domain [{--running | --paused}]
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration associated with a saved state file of a
<em>domain</em> was created by the <strong>managedsave</strong> command.</p>
<p>
The managed save image records whether the domain should be started to a
running or paused state. Normally, this command does not alter the
recorded state; passing either the <em>–running</em> or <em>–paused</em> flag will
allow overriding which state the <strong>restore</strong> should use.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh managedsave-dumpxml domain-name &gt; state-file.xml
vi state-file.xml (or make changes with your other text editor)
virsh managedsave-define domain-name state-file-xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-113" class="outline-3">
<h3 id="headline-113">
managedsave-remove
</h3>
<div id="outline-text-headline-113" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
managedsave-remove domain
</pre>
</blockquote>
</blockquote>
<p>
Remove the <strong>managedsave</strong> state file for a domain, if it exists. This
ensures the domain will do a full boot the next time it is started.</p>
</div>
</div>
<div id="outline-container-headline-114" class="outline-3">
<h3 id="headline-114">
maxvcpus
</h3>
<div id="outline-text-headline-114" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
maxvcpus [type]
</pre>
</blockquote>
</blockquote>
<p>
Provide the maximum number of virtual CPUs supported for a guest VM on
this connection. If provided, the <em>type</em> parameter must be a valid type
attribute for the &lt;domain&gt; element of XML.</p>
</div>
</div>
<div id="outline-container-headline-115" class="outline-3">
<h3 id="headline-115">
memtune
</h3>
<div id="outline-text-headline-115" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
memtune domain [--hard-limit size] [--soft-limit size] [--swap-hard-limit size]
   [--min-guarantee size] [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Allows you to display or set the domain memory parameters. Without
flags, the current settings are displayed; with a flag, the appropriate
limit is adjusted if supported by the hypervisor. LXC and QEMU/KVM
support <em>–hard-limit</em>, <em>–soft-limit</em>, and <em>–swap-hard-limit</em>.
<em>–min-guarantee</em> is supported only by ESX hypervisor. Each of these
limits are scaled integers (see <strong>NOTES</strong> above), with a default of
kibibytes (blocks of 1024 bytes) if no suffix is present. Libvirt rounds
up to the nearest kibibyte. Some hypervisors require a larger
granularity than KiB, and requests that are not an even multiple will be
rounded up. For example, vSphere/ESX rounds the parameter up to
mebibytes (1024 kibibytes).</p>
<p>
If <em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor.</p>
<p>
For QEMU/KVM, the parameters are applied to the QEMU process as a whole.
Thus, when counting them, one needs to add up guest RAM, guest video
RAM, and some memory overhead of QEMU itself. The last piece is hard to
determine so one needs guess and try.</p>
<p>
For LXC, the displayed hard_limit value is the current memory setting
from the XML or the results from a <strong>virsh setmem</strong> command.</p>
<blockquote>
<ul>
<li><em>–hard-limit</em></li>
</ul>
<p>The maximum memory the guest can use.</p>
<ul>
<li><em>–soft-limit</em></li>
</ul>
<p>The memory limit to enforce during memory contention.</p>
<ul>
<li><em>–swap-hard-limit</em></li>
</ul>
<p>The maximum memory plus swap the guest can use. This has to be more than
hard-limit value provided.</p>
<ul>
<li><em>–min-guarantee</em></li>
</ul>
<p>The guaranteed minimum memory allocation for the guest.</p>
</blockquote>
<p>
Specifying -1 as a value for these limits is interpreted as unlimited.</p>
</div>
</div>
<div id="outline-container-headline-116" class="outline-3">
<h3 id="headline-116">
metadata
</h3>
<div id="outline-text-headline-116" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
metadata domain [[--live] [--config] | [--current]]
   [--edit] [uri] [key] [set] [--remove]
</pre>
</blockquote>
</blockquote>
<p>
Show or modify custom XML metadata of a domain. The metadata is a user
defined XML that allows storing arbitrary XML data in the domain
definition. Multiple separate custom metadata pieces can be stored in
the domain XML. The pieces are identified by a private XML namespace
provided via the <em>uri</em> argument. (See also <strong>desc</strong> that works with
textual metadata of a domain.)</p>
<p>
Flags <em>–live</em> or <em>–config</em> select whether this command works on live
or persistent definitions of the domain. If both <em>–live</em> and <em>–config</em>
are specified, the <em>–config</em> option takes precedence on getting the
current description and both live configuration and config are updated
while setting the description. <em>–current</em> is exclusive and implied if
none of these was specified.</p>
<p>
Flag <em>–remove</em> specifies that the metadata element specified by the
<em>uri</em> argument should be removed rather than updated.</p>
<p>
Flag <em>–edit</em> specifies that an editor with the metadata identified by
the <em>uri</em> argument should be opened and the contents saved back
afterwards. Otherwise the new contents can be provided via the <em>set</em>
argument.</p>
<p>
When setting metadata via <em>–edit</em> or <em>set</em> the <em>key</em> argument must be
specified and is used to prefix the custom elements to bind them to the
private namespace.</p>
<p>
If neither of <em>–edit</em> and <em>set</em> are specified the XML metadata
corresponding to the <em>uri</em> namespace is displayed instead of being
modified.</p>
</div>
</div>
<div id="outline-container-headline-117" class="outline-3">
<h3 id="headline-117">
migrate
</h3>
<div id="outline-text-headline-117" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate [--live] [--offline] [--direct] [--p2p [--tunnelled]]
   [--persistent] [--undefinesource] [--suspend] [--copy-storage-all]
   [--copy-storage-inc] [--change-protection] [--unsafe] [--verbose]
   [--rdma-pin-all] [--abort-on-error] [--postcopy]
   [--postcopy-after-precopy] [--postcopy-resume] [--zerocopy]
   domain desturi [migrateuri] [graphicsuri] [listen-address] [dname]
   [--timeout seconds [--timeout-suspend | --timeout-postcopy]]
   [--xml file] [--migrate-disks disk-list] [--disks-port port]
   [--compressed] [--comp-methods method-list]
   [--comp-mt-level] [--comp-mt-threads] [--comp-mt-dthreads]
   [--comp-xbzrle-cache] [--comp-zlib-level] [--comp-zstd-level]
   [--auto-converge] [auto-converge-initial]
   [auto-converge-increment] [--persistent-xml file] [--tls]
   [--postcopy-bandwidth bandwidth]
   [--parallel [--parallel-connections connections]]
   [--bandwidth bandwidth] [--tls-destination hostname]
   [--disks-uri URI] [--copy-storage-synchronous-writes]
</pre>
</blockquote>
</blockquote>
<p>
Migrate domain to another host. Add <em>–live</em> for live migration; &lt;–p2p&gt;
for peer-2-peer migration; <em>–direct</em> for direct migration; or
<em>–tunnelled</em> for tunnelled migration. <em>–offline</em> migrates domain
definition without starting the domain on destination and without
stopping it on source host. Offline migration may be used with inactive
domains and it must be used with <em>–persistent</em> option.</p>
<p>
<em>–persistent</em> leaves the domain persistent on destination host,
<em>–undefinesource</em> undefines the domain on the source host, and
<em>–suspend</em> leaves the domain paused on the destination host.</p>
<p>
<em>–copy-storage-all</em> indicates migration with non-shared storage with
full disk copy, <em>–copy-storage-inc</em> indicates migration with non-shared
storage with incremental copy (same base image shared between source and
destination). In both cases the disk images have to exist on destination
host, the <em>–copy-storage-…</em> options only tell libvirt to transfer
data from the images on source host to the images found at the same
place on the destination host. By default only non-shared non-readonly
images are transferred. Use <em>–migrate-disks</em> to explicitly specify a
list of disk targets to transfer via the comma separated <strong>disk-list</strong>
argument. With <em>–copy-storage-synchronous-writes</em> flag used the disk
data migration will synchronously handle guest disk writes to both the
original source and the destination to ensure that the disk migration
converges at the price of possibly decreased burst performance.</p>
<p>
<em>–change-protection</em> enforces that no incompatible configuration
changes will be made to the domain while the migration is underway; this
flag is implicitly enabled when supported by the hypervisor, but can be
explicitly used to reject the migration if the hypervisor lacks change
protection support.</p>
<p>
<em>–verbose</em> displays the progress of migration.</p>
<p>
<em>–abort-on-error</em> cancels the migration if a soft error (for example
I/O error) happens during the migration.</p>
<p>
<em>–postcopy</em> enables post-copy logic in migration, but does not actually
start post-copy, i.e., migration is started in pre-copy mode. Once
migration is running, the user may switch to post-copy using the
<strong>migrate-postcopy</strong> command sent from another virsh instance or use
<em>–postcopy-after-precopy</em> along with <em>–postcopy</em> to let libvirt
automatically switch to post-copy after the first pass of pre-copy is
finished. The maximum bandwidth consumed during the post-copy phase may
be limited using <em>–postcopy-bandwidth</em>. The maximum bandwidth consumed
during the pre-copy phase may be limited using <em>–bandwidth</em>. In case
connection between the hosts breaks while migration is in post-copy
mode, the domain cannot be resumed on either source or destination host
and the <strong>migrate</strong> command will report an error leaving the domain active
on both hosts. To recover from such situation repeat the original
<strong>migrate</strong> command with an additional <em>–postcopy-resume</em> flag.</p>
<p>
<em>–auto-converge</em> forces convergence during live migration. The initial
guest CPU throttling rate can be set with <em>auto-converge-initial</em>. If
the initial throttling rate is not enough to ensure convergence, the
rate is periodically increased by <em>auto-converge-increment</em>.</p>
<p>
<em>–rdma-pin-all</em> can be used with RDMA migration (i.e., when
<em>migrateuri</em> starts with rdma://) to tell the hypervisor to pin all
domain&#39;s memory at once before migration starts rather than letting it
pin memory pages as needed. For QEMU/KVM this requires hard_limit memory
tuning element (in the domain XML) to be used and set to the maximum
memory configured for the domain plus any memory consumed by the QEMU
process itself. Beware of setting the memory limit too high (and thus
allowing the domain to lock most of the host&#39;s memory). Doing so may be
dangerous to both the domain and the host itself since the host&#39;s kernel
may run out of memory.</p>
<p>
<em>–zerocopy</em> requests zero-copy mechanism to be used for migrating
memory pages. For QEMU/KVM this means QEMU will be temporarily allowed
to lock all guest pages in host&#39;s memory, although only those that are
queued for transfer will be locked at the same time.</p>
<p>
<strong>Note</strong>: Individual hypervisors usually do not support all possible types
of migration. For example, QEMU does not support direct migration.</p>
<p>
In some cases libvirt may refuse to migrate the domain because doing so
may lead to potential problems such as data corruption, and thus the
migration is considered unsafe. For QEMU domain, this may happen if the
domain uses disks without explicitly setting cache mode to &#34;none&#34;.
Migrating such domains is unsafe unless the disk images are stored on
coherent clustered filesystem, such as GFS2 or GPFS. If you are sure the
migration is safe or you just do not care, use <em>–unsafe</em> to force the
migration.</p>
<p>
<em>dname</em> is used for renaming the domain to new name during migration,
which also usually can be omitted. Likewise, <em>–xml</em> <strong>file</strong> is usually
omitted, but can be used to supply an alternative XML file for use on
the destination to supply a larger set of changes to any host-specific
portions of the domain XML, such as accounting for naming differences
between source and destination in accessing underlying storage. If
<em>–persistent</em> is enabled, <em>–persistent-xml</em> <strong>file</strong> can be used to
supply an alternative XML file which will be used as the persistent
guest definition on the destination host.</p>
<p>
<em>–timeout</em> <strong>seconds</strong> tells virsh to run a specified action when live
migration exceeds that many seconds. It can only be used with <em>–live</em>.
If <em>–timeout-suspend</em> is specified, the domain will be suspended after
the timeout and the migration will complete offline; this is the default
if no <em>–timeout-\`` option is specified on the command line. When</em>
​*–timeout-postcopy is used, virsh will switch migration from pre-copy
to post-copy upon timeout; migration has to be started with <em>–postcopy</em>
option for this to work.</p>
<p>
<em>–compressed</em> activates compression, the compression method is chosen
with <em>–comp-methods</em>. Supported methods are &#34;mt&#34;, &#34;xbzrle&#34;, &#34;zlib&#34;, and
&#34;zstd&#34;. The supported set of methods and their combinations depend on a
hypervisor and migration options. QEMU only supports &#34;zlib&#34; and &#34;zstd&#34;
methods when <em>–parallel</em> is used and they cannot be used at once. When
no methods are specified, a hypervisor default methods will be used.
QEMU defaults to &#34;xbzrle&#34; as long as <em>–parallel</em> is not used. For
<em>–parallel</em> migrations QEMU does not provide any default compression
method and thus it has to be specified explicitly using <em>–comp-method</em>.
Compression methods can be tuned further. <em>–comp-mt-level</em> sets
compression level for &#34;mt&#34; method. Values are in range from 0 to 9,
where 1 is maximum speed and 9 is maximum compression.
<em>–comp-mt-threads</em> and <em>–comp-mt-dthreads</em> set the number of compress
threads on source and the number of decompress threads on target
respectively. <em>–comp-xbzrle-cache</em> sets size of page cache in bytes.
<em>–comp-zlib-level</em> sets the compression level when using &#34;zlib&#34; method.
Values are in range from 0 to 9 and defaults to 1, where 0 is no
compression, 1 is maximum speed and 9 is maximum compression.
<em>–comp-zstd-level</em> sets the compression level when using &#34;zstd&#34; method.
Values are in range from 0 to 20 and defaults to 1, where 0 is no
compression, 1 is maximum speed and 20 is maximum compression.</p>
<p>
Providing <em>–tls</em> causes the migration to use the host configured TLS
setup (see migrate_tls_x509_cert_dir in /etc/libvirt/qemu.conf) in order
to perform the migration of the domain. Usage requires proper TLS setup
for both source and target. Normally the TLS certificate from the
destination host must match the host&#39;s name for TLS verification to
succeed. When the certificate does not match the destination hostname
and the expected certificate&#39;s hostname is known, <em>–tls-destination</em>
can be used to pass the expected <em>hostname</em> when starting the migration.</p>
<p>
<em>–parallel</em> option will cause migration data to be sent over multiple
parallel connections. The number of such connections can be set using
<em>–parallel-connections</em>. Parallel connections may help with saturating
the network link between the source and the target and thus speeding up
the migration.</p>
<p>
Running migration can be canceled by interrupting virsh (usually using
<strong>Ctrl-C</strong>) or by <strong>domjobabort</strong> command sent from another virsh instance.</p>
<p>
The <em>desturi</em> and <em>migrateuri</em> parameters can be used to control which
destination the migration uses. <em>desturi</em> is important for managed
migration, but unused for direct migration; <em>migrateuri</em> is required for
direct migration, but can usually be automatically determined for
managed migration.</p>
<p>
<strong>Note</strong>: The <em>desturi</em> parameter for normal migration and peer2peer
migration has different semantics:</p>
<blockquote>
<ul>
<li>normal migration: the <em>desturi</em> is an address of the target host as
seen from the client machine.</li>
<li>peer2peer migration: the <em>desturi</em> is an address of the target host as
seen from the source machine.</li>
</ul>
</blockquote>
<p>
In a special circumstance where you require a complete control of the
connection and/or libvirt does not have network access to the remote
side you can use a UNIX transport in the URI and specify a socket path
in the query, for example with the qemu driver you could use this:</p>
<blockquote>
<blockquote>
<pre class="example">
qemu+unix:///system?socket=/path/to/socket
</pre>
</blockquote>
</blockquote>
<p>
When <em>migrateuri</em> is not specified, libvirt will automatically determine
the hypervisor specific URI. Some hypervisors, including QEMU, have an
optional &#34;migration_host&#34; configuration parameter (useful when the host
has multiple network interfaces). If this is unspecified, libvirt
determines a name by looking up the target host&#39;s configured hostname.</p>
<p>
There are a few scenarios where specifying <em>migrateuri</em> may help:</p>
<blockquote>
<ul>
<li>The configured hostname is incorrect, or DNS is broken. If a host has
a hostname which will not resolve to match one of its public IP
addresses, then libvirt will generate an incorrect URI. In this case
<em>migrateuri</em> should be explicitly specified, using an IP address, or a
correct hostname.</li>
<li>The host has multiple network interfaces. If a host has multiple
network interfaces, it might be desirable for the migration data
stream to be sent over a specific interface for either security or
performance reasons. In this case <em>migrateuri</em> should be explicitly
specified, using an IP address associated with the network to be used.</li>
<li>The firewall restricts what ports are available. When libvirt
generates a migration URI, it will pick a port number using hypervisor
specific rules. Some hypervisors only require a single port to be open
in the firewalls, while others require a whole range of port numbers.
In the latter case <em>migrateuri</em> might be specified to choose a
specific port number outside the default range in order to comply with
local firewall policies.</li>
<li>The <em>desturi</em> uses UNIX transport method. In this advanced case
libvirt should not guess a <em>migrateuri</em> and it should be specified
using UNIX socket path URI:</li>
</ul>
</blockquote>
<blockquote>
<blockquote>
<pre class="example">
unix:///path/to/socket
</pre>
</blockquote>
</blockquote>
<p>
See &lt;<a href="https://libvirt.org/migration.html#uris">https://libvirt.org/migration.html#uris</a>&gt; for more details on
migration URIs.</p>
<p>
Optional <em>graphicsuri</em> overrides connection parameters used for
automatically reconnecting a graphical clients at the end of migration.
If omitted, libvirt will compute the parameters based on target host IP
address. In case the client does not have a direct access to the network
virtualization hosts are connected to and needs to connect through a
proxy, <em>graphicsuri</em> may be used to specify the address the client
should connect to. The URI is formed as follows:</p>
<blockquote>
<blockquote>
<pre class="example">
protocol://hostname[:port]/[?parameters]
</pre>
</blockquote>
</blockquote>
<p>
where protocol is either &#34;spice&#34; or &#34;vnc&#34; and parameters is a list of
protocol specific parameters separated by &#39;&amp;&#39;. Currently recognized
parameters are &#34;tlsPort&#34; and &#34;tlsSubject&#34;. For example,</p>
<blockquote>
<blockquote>
<pre class="example">
spice://target.host.com:1234/?tlsPort=4567
</pre>
</blockquote>
</blockquote>
<p>
Optional <em>listen-address</em> sets the listen address that hypervisor on the
destination side should bind to for incoming migration. Both IPv4 and
IPv6 addresses are accepted as well as hostnames (the resolving is done
on destination). Some hypervisors do not support specifying the listen
address and will return an error if this parameter is used. This
parameter cannot be used if <em>desturi</em> uses UNIX transport method.</p>
<p>
Optional <em>disks-port</em> sets the port that hypervisor on destination side
should bind to for incoming disks traffic. Currently it is supported
only by QEMU.</p>
<p>
Optional <em>disks-uri</em> can also be specified (mutually exclusive with
<em>disks-port</em>) to specify what the remote hypervisor should bind/connect
to when migrating disks. This can be <em>tcp://address:port</em> to specify a
listen address (which overrides <em>–migrate-uri</em> and <em>–listen-address</em>
for the disk migration) and a port or <em>unix:///path/to/socket</em> in case
you need the disk migration to happen over a UNIX socket with that
specified path. In this case you need to make sure the same socket path
is accessible to both source and destination hypervisors and connecting
to the socket on the source (after hypervisor creates it on the
destination) will actually connect to the destination. If you are using
SELinux (at least on the source host) you need to make sure the socket
on the source is accessible to libvirtd/QEMU for connection. Libvirt
cannot change the context of the existing socket because it is different
from the file representation of the socket and the context is chosen by
its creator (usually by using <em>setsockcreatecon{,_raw}()</em> functions).</p>
</div>
</div>
<div id="outline-container-headline-118" class="outline-3">
<h3 id="headline-118">
migrate-compcache
</h3>
<div id="outline-text-headline-118" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate-compcache domain [--size bytes]
</pre>
</blockquote>
</blockquote>
<p>
Sets and/or gets size of the cache (in bytes) used for compressing
repeatedly transferred memory pages during live migration. When called
without <em>size</em>, the command just prints current size of the compression
cache. When <em>size</em> is specified, the hypervisor is asked to change
compression cache to <em>size</em> bytes and then the current size is printed
(the result may differ from the requested size due to rounding done by
the hypervisor). The <em>size</em> option is supposed to be used while the
domain is being live-migrated as a reaction to migration progress and
increasing number of compression cache misses obtained from domjobinfo.</p>
</div>
</div>
<div id="outline-container-headline-119" class="outline-3">
<h3 id="headline-119">
migrate-getmaxdowntime
</h3>
<div id="outline-text-headline-119" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate-getmaxdowntime domain
</pre>
</blockquote>
</blockquote>
<p>
Get the maximum tolerable downtime for a domain which is being
live-migrated to another host. This is the number of milliseconds the
guest is allowed to be down at the end of live migration.</p>
</div>
</div>
<div id="outline-container-headline-120" class="outline-3">
<h3 id="headline-120">
migrate-getspeed
</h3>
<div id="outline-text-headline-120" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate-getspeed domain [--postcopy]
</pre>
</blockquote>
</blockquote>
<p>
Get the maximum migration bandwidth (in MiB/s) for a domain. If the
<em>–postcopy</em> option is specified, the command will get the maximum
bandwidth allowed during a post-copy migration phase.</p>
</div>
</div>
<div id="outline-container-headline-121" class="outline-3">
<h3 id="headline-121">
migrate-postcopy
</h3>
<div id="outline-text-headline-121" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate-postcopy domain
</pre>
</blockquote>
</blockquote>
<p>
Switch the current migration from pre-copy to post-copy. This is only
supported for a migration started with <em>–postcopy</em> option.</p>
</div>
</div>
<div id="outline-container-headline-122" class="outline-3">
<h3 id="headline-122">
migrate-setmaxdowntime
</h3>
<div id="outline-text-headline-122" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate-setmaxdowntime domain downtime
</pre>
</blockquote>
</blockquote>
<p>
Set maximum tolerable downtime for a domain which is being live-migrated
to another host. The <em>downtime</em> is a number of milliseconds the guest is
allowed to be down at the end of live migration.</p>
</div>
</div>
<div id="outline-container-headline-123" class="outline-3">
<h3 id="headline-123">
migrate-setspeed
</h3>
<div id="outline-text-headline-123" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
migrate-setspeed domain bandwidth [--postcopy]
</pre>
</blockquote>
</blockquote>
<p>
Set the maximum migration bandwidth (in MiB/s) for a domain which is
being migrated to another host. <em>bandwidth</em> is interpreted as an
unsigned long long value. Specifying a negative value results in an
essentially unlimited value being provided to the hypervisor. The
hypervisor can choose whether to reject the value or convert it to the
maximum value allowed. If the <em>–postcopy</em> option is specified, the
command will set the maximum bandwidth allowed during a post-copy
migration phase.</p>
</div>
</div>
<div id="outline-container-headline-124" class="outline-3">
<h3 id="headline-124">
numatune
</h3>
<div id="outline-text-headline-124" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
numatune domain [--mode mode] [--nodeset nodeset]
   [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Set or get a domain&#39;s numa parameters, corresponding to the &lt;numatune&gt;
element of domain XML. Without flags, the current settings are
displayed.</p>
<p>
<em>mode</em> can be one of `strict&#39;, `interleave&#39;, `preferred&#39; and
&#39;restrictive&#39; or any valid number from the virDomainNumatuneMemMode enum
in case the daemon supports it. For a running domain, the mode can&#39;t be
changed, and the nodeset can be changed only if the domain was started
with `restrictive&#39; mode.</p>
<p>
<em>nodeset</em> is a list of numa nodes used by the host for running the
domain. Its syntax is a comma separated list, with &#39;-&#39; for ranges and
&#39;^&#39; for excluding a node.</p>
<p>
If <em>–live</em> is specified, set scheduler information of a running guest.
If <em>–config</em> is specified, affect the next start of a persistent guest.
If <em>–current</em> is specified, it is equivalent to either <em>–live</em> or
<em>–config</em>, depending on the current state of the guest.</p>
<p>
For running guests in Linux hosts, the changes made in the domain&#39;s numa
parameters does not imply that the guest memory will be moved to a
different nodeset immediately. The memory migration depends on the guest
activity, and the memory of an idle guest will remain in its previous
nodeset for longer. The presence of VFIO devices will also lock parts of
the guest memory in the same nodeset used to start the guest, regardless
of nodeset changes.</p>
</div>
</div>
<div id="outline-container-headline-125" class="outline-3">
<h3 id="headline-125">
perf
</h3>
<div id="outline-text-headline-125" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
perf domain [--enable eventSpec] [--disable eventSpec]
   [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Get the current perf events setting or enable/disable specific perf
events for a guest domain.</p>
<p>
Perf is a performance analyzing tool in Linux, and it can instrument CPU
performance counters, tracepoints, kprobes, and uprobes (dynamic
tracing). Perf supports a list of measurable events, and can measure
events coming from different sources. For instance, some event are pure
kernel counters, in this case they are called software events, including
context-switches, minor-faults, etc.. Now dozens of events from
different sources can be supported by perf.</p>
<p>
Currently only QEMU/KVM supports this command. The <em>–enable</em> and
<em>–disable</em> option combined with <strong>eventSpec</strong> can be used to enable or
disable specific performance event. <strong>eventSpec</strong> is a string list of one
or more events separated by commas. Valid event names are as follows:</p>
<p>
<strong>Valid perf event names</strong></p>
<blockquote>
<ul>
<li><strong>cmt</strong> - A PQos (Platform Qos) feature to monitor the usage of cache by
applications running on the platform.</li>
<li><strong>mbmt</strong> - Provides a way to monitor the total system memory bandwidth
between one level of cache and another.</li>
<li><strong>mbml</strong> - Provides a way to limit the amount of data (bytes/s) send
through the memory controller on the socket.</li>
<li><strong>cache_misses</strong> - Provides the count of cache misses by applications
running on the platform.</li>
<li><strong>cache_references</strong> - Provides the count of cache hits by applications
running on th e platform.</li>
<li><strong>instructions</strong> - Provides the count of instructions executed by
applications running on the platform.</li>
<li><strong>cpu_cycles</strong> - Provides the count of cpu cycles (total/elapsed). May
be used with instructions in order to get a cycles per instruction.</li>
<li><strong>branch_instructions</strong> - Provides the count of branch instructions
executed by applications running on the platform.</li>
<li><strong>branch_misses</strong> - Provides the count of branch misses executed by
applications running on the platform.</li>
<li><strong>bus_cycles</strong> - Provides the count of bus cycles executed by
applications running on the platform.</li>
<li><strong>stalled_cycles_frontend</strong> - Provides the count of stalled cpu cycles
in the frontend of the instruction processor pipeline by applications
running on the platform.</li>
<li><strong>stalled_cycles_backend</strong> - Provides the count of stalled cpu cycles in
the backend of the instruction processor pipeline by applications
running on the platform.</li>
<li><strong>ref_cpu_cycles</strong> - Provides the count of total cpu cycles not affected
by CPU frequency scaling by applications running on the platform.</li>
<li><strong>cpu_clock</strong> - Provides the cpu clock time consumed by applications
running on the platform.</li>
<li><strong>task_clock</strong> - Provides the task clock time consumed by applications
running on the platform.</li>
<li><strong>page_faults</strong> - Provides the count of page faults by applications
running on the platform.</li>
<li><strong>context_switches</strong> - Provides the count of context switches by
applications running on the platform.</li>
<li><strong>cpu_migrations</strong> - Provides the count cpu migrations by applications
running on the platform.</li>
<li><strong>page_faults_min</strong> - Provides the count minor page faults by
applications running on the platform.</li>
<li><strong>page_faults_maj</strong> - Provides the count major page faults by
applications running on the platform.</li>
<li><strong>alignment_faults</strong> - Provides the count alignment faults by
applications running on the platform.</li>
<li><strong>emulation_faults</strong> - Provides the count emulation faults by
applications running on the platform.</li>
</ul>
</blockquote>
<p>
<strong>Note</strong>: The statistics can be retrieved using the <strong>domstats</strong> command
using the <em>–perf</em> flag.</p>
<p>
If <em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-126" class="outline-3">
<h3 id="headline-126">
reboot
</h3>
<div id="outline-text-headline-126" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
reboot domain [--mode MODE-LIST]
</pre>
</blockquote>
</blockquote>
<p>
Reboot a domain. This acts just as if the domain had the <strong>reboot</strong>
command run from the console. The command returns as soon as it has
executed the reboot action, which may be significantly before the domain
actually reboots.</p>
<p>
The exact behavior of a domain when it reboots is set by the <em>on_reboot</em>
parameter in the domain&#39;s XML definition.</p>
<p>
By default the hypervisor will try to pick a suitable shutdown method.
To specify an alternative method, the <em>–mode</em> parameter can specify a
comma separated list which includes <strong>acpi</strong>, <strong>agent</strong>, <strong>initctl</strong>, <strong>signal</strong>
and <strong>paravirt</strong>. The order in which drivers will try each mode is
undefined, and not related to the order specified to virsh. For strict
control over ordering, use a single mode at a time and repeat the
command.</p>
</div>
</div>
<div id="outline-container-headline-127" class="outline-3">
<h3 id="headline-127">
reset
</h3>
<div id="outline-text-headline-127" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
reset domain
</pre>
</blockquote>
</blockquote>
<p>
Reset a domain immediately without any guest shutdown. <strong>reset</strong> emulates
the power reset button on a machine, where all guest hardware sees the
RST line set and reinitializes internal state.</p>
<p>
<strong>Note</strong>: Reset without any guest OS shutdown risks data loss.</p>
</div>
</div>
<div id="outline-container-headline-128" class="outline-3">
<h3 id="headline-128">
restore
</h3>
<div id="outline-text-headline-128" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
restore state-file [--bypass-cache] [--xml file]
   [{--running | --paused}] [--reset-nvram]
</pre>
</blockquote>
</blockquote>
<p>
Restores a domain from a <strong>virsh save</strong> state file. See <em>save</em> for more
info.</p>
<p>
If <em>–bypass-cache</em> is specified, the restore will avoid the file system
cache, although this may slow down the operation.</p>
<p>
<em>–xml</em> <strong>file</strong> is usually omitted, but can be used to supply an
alternative XML file for use on the restored guest with changes only in
the host-specific portions of the domain XML. For example, it can be
used to account for file naming differences in underlying storage due to
disk snapshots taken after the guest was saved.</p>
<p>
Normally, restoring a saved image will use the state recorded in the
save image to decide between running or paused; passing either the
<em>–running</em> or <em>–paused</em> flag will allow overriding which state the
domain should be started in.</p>
<p>
If <em>–reset-nvram</em> is specified, any existing NVRAM file will be deleted
and re-initialized from its pristine template.</p>
<p>
<strong>Note</strong>: To avoid corrupting file system contents within the domain, you
should not reuse the saved state file for a second <strong>restore</strong> unless you
have also reverted all storage volumes back to the same contents as when
the state file was created.</p>
</div>
</div>
<div id="outline-container-headline-129" class="outline-3">
<h3 id="headline-129">
resume
</h3>
<div id="outline-text-headline-129" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
resume domain
</pre>
</blockquote>
</blockquote>
<p>
Moves a domain out of the suspended state. This will allow a previously
suspended domain to now be eligible for scheduling by the underlying
hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-130" class="outline-3">
<h3 id="headline-130">
save
</h3>
<div id="outline-text-headline-130" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
save domain state-file [--bypass-cache] [--xml file]
   [{--running | --paused}] [--verbose]
</pre>
</blockquote>
</blockquote>
<p>
Saves a running domain (RAM, but not disk state) to a state file so that
it can be restored later. Once saved, the domain will no longer be
running on the system, thus the memory allocated for the domain will be
free for other domains to use. <strong>virsh restore</strong> restores from this state
file. If <em>–bypass-cache</em> is specified, the save will avoid the file
system cache, although this may slow down the operation.</p>
<p>
The progress may be monitored using <strong>domjobinfo</strong> virsh command and
canceled with <strong>domjobabort</strong> command (sent by another virsh instance).
Another option is to send SIGINT (usually with <strong>Ctrl-C</strong>) to the virsh
process running <strong>save</strong> command. <em>–verbose</em> displays the progress of
save.</p>
<p>
This is roughly equivalent to doing a hibernate on a running computer,
with all the same limitations. Open network connections may be severed
upon restore, as TCP timeouts may have expired.</p>
<p>
<em>–xml</em> <strong>file</strong> is usually omitted, but can be used to supply an
alternative XML file for use on the restored guest with changes only in
the host-specific portions of the domain XML. For example, it can be
used to account for file naming differences that are planned to be made
via disk snapshots of underlying storage after the guest is saved.</p>
<p>
Normally, restoring a saved image will decide between running or paused
based on the state the domain was in when the save was done; passing
either the <em>–running</em> or <em>–paused</em> flag will allow overriding which
state the <strong>restore</strong> should use.</p>
<p>
Domain saved state files assume that disk images will be unchanged
between the creation and restore point. For a more complete system
restore point, where the disk state is saved alongside the memory state,
see the <strong>snapshot</strong> family of commands.</p>
</div>
</div>
<div id="outline-container-headline-131" class="outline-3">
<h3 id="headline-131">
save-image-define
</h3>
<div id="outline-text-headline-131" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
save-image-define file xml [{--running | --paused}]
</pre>
</blockquote>
</blockquote>
<p>
Update the domain XML that will be used when <em>file</em> is later used in the
<strong>restore</strong> command. The <em>xml</em> argument must be a file name containing the
alternative XML, with changes only in the host-specific portions of the
domain XML. For example, it can be used to account for file naming
differences resulting from creating disk snapshots of underlying storage
after the guest was saved.</p>
<p>
The save image records whether the domain should be restored to a
running or paused state. Normally, this command does not alter the
recorded state; passing either the <em>–running</em> or <em>–paused</em> flag will
allow overriding which state the <strong>restore</strong> should use.</p>
</div>
</div>
<div id="outline-container-headline-132" class="outline-3">
<h3 id="headline-132">
save-image-dumpxml
</h3>
<div id="outline-text-headline-132" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
save-image-dumpxml [--security-info] [--xpath EXPRESSION] [--wrap] file
</pre>
</blockquote>
</blockquote>
<p>
Extract the domain XML that was in effect at the time the saved state
file <em>file</em> was created with the <strong>save</strong> command. Using <em>–security-info</em>
will also include security sensitive information.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-133" class="outline-3">
<h3 id="headline-133">
save-image-edit
</h3>
<div id="outline-text-headline-133" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
save-image-edit file [{--running | --paused}]
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration associated with a saved state file <em>file</em>
created by the <strong>save</strong> command.</p>
<p>
The save image records whether the domain should be restored to a
running or paused state. Normally, this command does not alter the
recorded state; passing either the <em>–running</em> or <em>–paused</em> flag will
allow overriding which state the <strong>restore</strong> should use.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh save-image-dumpxml state-file &gt; state-file.xml
vi state-file.xml (or make changes with your other text editor)
virsh save-image-define state-file state-file-xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-134" class="outline-3">
<h3 id="headline-134">
schedinfo
</h3>
<div id="outline-text-headline-134" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
schedinfo domain [[--config] [--live] | [--current]] [[--set] parameter=value]...
schedinfo [--weight number] [--cap number] domain
</pre>
</blockquote>
</blockquote>
<p>
Allows you to show (and set) the domain scheduler parameters. The
parameters available for each hypervisor are:</p>
<p>
LXC (posix scheduler) : cpu_shares, vcpu_period, vcpu_quota</p>
<p>
QEMU/KVM (posix scheduler): cpu_shares, vcpu_period, vcpu_quota,
emulator_period, emulator_quota, global_period, global_quota,
iothread_period, iothread_quota</p>
<p>
Xen (credit scheduler): weight, cap</p>
<p>
ESX (allocation scheduler): reservation, limit, shares</p>
<p>
If <em>–live</em> is specified, set scheduler information of a running guest.
If <em>–config</em> is specified, affect the next start of a persistent guest.
If <em>–current</em> is specified, it is equivalent to either <em>–live</em> or
<em>–config</em>, depending on the current state of the guest.</p>
<p>
<strong>Note</strong>: The cpu_shares parameter has a valid value range of 2-262144
with cgroups v1, 1-10000 with cgroups v2.</p>
<p>
<strong>Note</strong>: The weight and cap parameters are defined only for the
XEN_CREDIT scheduler.</p>
<p>
<strong>Note</strong>: The vcpu_period, emulator_period, and iothread_period parameters
have a valid value range of 1000-1000000 or 0, and the vcpu_quota,
emulator_quota, and iothread_quota parameters have a valid value range
of 1000-17592186044415 or less than 0. The value 0 for either parameter
is the same as not specifying that parameter.</p>
</div>
</div>
<div id="outline-container-headline-135" class="outline-3">
<h3 id="headline-135">
screenshot
</h3>
<div id="outline-text-headline-135" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
screenshot domain [imagefilepath] [--screen screenID]
</pre>
</blockquote>
</blockquote>
<p>
Takes a screenshot of a current domain console and stores it into a
file. Optionally, if the hypervisor supports more displays for a domain,
<em>screenID</em> allows specifying which screen will be captured. It is the
sequential number of screen. In case of multiple graphics cards, heads
are enumerated before devices, e.g. having two graphics cards, both with
four heads, screen ID 5 addresses the second head on the second card.</p>
</div>
</div>
<div id="outline-container-headline-136" class="outline-3">
<h3 id="headline-136">
send-key
</h3>
<div id="outline-text-headline-136" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
send-key domain [--codeset codeset] [--holdtime holdtime] keycode...
</pre>
</blockquote>
</blockquote>
<p>
Parse the <em>keycode</em> sequence as keystrokes to send to <em>domain</em>. Each
<em>keycode</em> can either be a numeric value or a symbolic name from the
corresponding codeset. If <em>–holdtime</em> is given, each keystroke will be
held for that many milliseconds. The default codeset is <strong>linux</strong>, but use
of the <em>–codeset</em> option allows other codesets to be chosen.</p>
<p>
If multiple keycodes are specified, they are all sent simultaneously to
the guest, and they may be received in random order. If you need
distinct keypresses, you must use multiple send-key invocations.</p>
<blockquote>
<ul>
<li><strong>linux</strong></li>
</ul>
<p>The numeric values are those defined by the Linux generic input event
subsystem. The symbolic names match the corresponding Linux key constant
macro names.</p>
<p>
See virkeycode-linux(7) and virkeyname-linux(7)</p>
<ul>
<li><strong>xt</strong></li>
</ul>
<p>The numeric values are those defined by the original XT keyboard
controller. No symbolic names are provided</p>
<p>
See virkeycode-xt(7)</p>
<ul>
<li><strong>atset1</strong></li>
</ul>
<p>The numeric values are those defined by the AT keyboard controller, set
1 (aka XT compatible set). Extended keycoes from <strong>atset1</strong> may differ
from extended keycodes in the <strong>xt</strong> codeset. No symbolic names are
provided</p>
<p>
See virkeycode-atset1(7)</p>
<ul>
<li><strong>atset2</strong></li>
</ul>
<p>The numeric values are those defined by the AT keyboard controller,
set 2. No symbolic names are provided</p>
<p>
See virkeycode-atset2(7)</p>
<ul>
<li><strong>atset3</strong></li>
</ul>
<p>The numeric values are those defined by the AT keyboard controller, set
3 (aka PS/2 compatible set). No symbolic names are provided</p>
<p>
See virkeycode-atset3(7)</p>
<ul>
<li><strong>os_x</strong></li>
</ul>
<p>The numeric values are those defined by the macOS keyboard input
subsystem. The symbolic names match the corresponding macOS key constant
macro names</p>
<p>
See virkeycode-osx(7) and virkeyname-osx(7)</p>
<ul>
<li><strong>xt_kbd</strong></li>
</ul>
<p>The numeric values are those defined by the Linux KBD device. These are
a variant on the original XT codeset, but often with different encoding
for extended keycodes. No symbolic names are provided.</p>
<p>
See virkeycode-xtkbd(7)</p>
<ul>
<li><strong>win32</strong></li>
</ul>
<p>The numeric values are those defined by the Win32 keyboard input
subsystem. The symbolic names match the corresponding Win32 key constant
macro names</p>
<p>
See virkeycode-win32(7) and virkeyname-win32(7)</p>
<ul>
<li><strong>usb</strong></li>
</ul>
<p>The numeric values are those defined by the USB HID specification for
keyboard input. No symbolic names are provided</p>
<p>
See virkeycode-usb(7)</p>
<ul>
<li><strong>qnum</strong></li>
</ul>
<p>The numeric values are those defined by the QNUM extension for sending
raw keycodes. These are a variant on the XT codeset, but extended
keycodes have the low bit of the second byte set, instead of the high
bit of the first byte. No symbolic names are provided.</p>
<p>
See virkeycode-qnum(7)</p>
</blockquote>
<p>
<strong>Examples:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
# send three strokes &#39;k&#39;, &#39;e&#39;, &#39;y&#39;, using xt codeset. these
# are all pressed simultaneously and may be received by the guest
# in random order
virsh send-key dom --codeset xt 37 18 21

# send one stroke &#39;right-ctrl+C&#39;
virsh send-key dom KEY_RIGHTCTRL KEY_C

# send a tab, held for 1 second
virsh send-key --holdtime 1000 0xf
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-137" class="outline-3">
<h3 id="headline-137">
send-process-signal
</h3>
<div id="outline-text-headline-137" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
send-process-signal domain-id pid signame
</pre>
</blockquote>
</blockquote>
<p>
Send a signal <em>signame</em> to the process identified by <em>pid</em> running in
the virtual domain <em>domain-id</em>. The <em>pid</em> is a process ID in the virtual
domain namespace.</p>
<p>
The <em>signame</em> argument may be either an integer signal constant number,
or one of the symbolic names:</p>
<blockquote>
<blockquote>
<pre class="example">
&#34;nop&#34;, &#34;hup&#34;, &#34;int&#34;, &#34;quit&#34;, &#34;ill&#34;,
&#34;trap&#34;, &#34;abrt&#34;, &#34;bus&#34;, &#34;fpe&#34;, &#34;kill&#34;,
&#34;usr1&#34;, &#34;segv&#34;, &#34;usr2&#34;, &#34;pipe&#34;, &#34;alrm&#34;,
&#34;term&#34;, &#34;stkflt&#34;, &#34;chld&#34;, &#34;cont&#34;, &#34;stop&#34;,
&#34;tstp&#34;, &#34;ttin&#34;, &#34;ttou&#34;, &#34;urg&#34;, &#34;xcpu&#34;,
&#34;xfsz&#34;, &#34;vtalrm&#34;, &#34;prof&#34;, &#34;winch&#34;, &#34;poll&#34;,
&#34;pwr&#34;, &#34;sys&#34;, &#34;rt0&#34;, &#34;rt1&#34;, &#34;rt2&#34;, &#34;rt3&#34;,
&#34;rt4&#34;, &#34;rt5&#34;, &#34;rt6&#34;, &#34;rt7&#34;, &#34;rt8&#34;, &#34;rt9&#34;,
&#34;rt10&#34;, &#34;rt11&#34;, &#34;rt12&#34;, &#34;rt13&#34;, &#34;rt14&#34;, &#34;rt15&#34;,
&#34;rt16&#34;, &#34;rt17&#34;, &#34;rt18&#34;, &#34;rt19&#34;, &#34;rt20&#34;, &#34;rt21&#34;,
&#34;rt22&#34;, &#34;rt23&#34;, &#34;rt24&#34;, &#34;rt25&#34;, &#34;rt26&#34;, &#34;rt27&#34;,
&#34;rt28&#34;, &#34;rt29&#34;, &#34;rt30&#34;, &#34;rt31&#34;, &#34;rt32&#34;
</pre>
</blockquote>
</blockquote>
<p>
The symbol name may optionally be prefixed with <strong>sig</strong> or <strong>sig_</strong> and may
be in uppercase or lowercase.</p>
<p>
<strong>Examples:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
virsh send-process-signal myguest 1 15
virsh send-process-signal myguest 1 term
virsh send-process-signal myguest 1 sigterm
virsh send-process-signal myguest 1 SIG_HUP
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-138" class="outline-3">
<h3 id="headline-138">
set-lifecycle-action
</h3>
<div id="outline-text-headline-138" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
set-lifecycle-action domain type action
   [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Set the lifecycle <em>action</em> for specified lifecycle <em>type</em>. The valid
types are &#34;poweroff&#34;, &#34;reboot&#34; and &#34;crash&#34;, and for each of them valid
<em>action</em> is one of &#34;destroy&#34;, &#34;restart&#34;, &#34;rename-restart&#34;, &#34;preserve&#34;.
For <em>type</em> &#34;crash&#34;, additional actions &#34;coredump-destroy&#34; and
&#34;coredump-restart&#34; are supported.</p>
</div>
</div>
<div id="outline-container-headline-139" class="outline-3">
<h3 id="headline-139">
set-user-password
</h3>
<div id="outline-text-headline-139" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
set-user-password domain user password [--encrypted]
</pre>
</blockquote>
</blockquote>
<p>
Set the password for the <em>user</em> account in the guest domain.</p>
<p>
If <em>–encrypted</em> is specified, the password is assumed to be already
encrypted by the method required by the guest OS.</p>
<p>
For QEMU/KVM, this requires the guest agent to be configured and
running.</p>
</div>
</div>
<div id="outline-container-headline-140" class="outline-3">
<h3 id="headline-140">
set-user-sshkeys
</h3>
<div id="outline-text-headline-140" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
set-user-sshkeys domain user [--file FILE] [{--reset | --remove}]
</pre>
</blockquote>
</blockquote>
<p>
Append keys read from <em>FILE</em> into <em>user</em>&#39;s SSH authorized keys file in
the guest <em>domain</em>. In the <em>FILE</em> keys must be on separate lines and
each line must follow authorized keys format as defined by <em>sshd(8)</em>.</p>
<p>
If <em>–reset</em> is specified, then the guest authorized keys file content
is removed before appending new keys. As a special case, if <em>–reset</em> is
provided and no <em>FILE</em> was provided then no new keys are added and the
authorized keys file is cleared out.</p>
<p>
If <em>–remove</em> is specified, then instead of adding any new keys then
keys read from <em>FILE</em> are removed from the authorized keys file. It is
not considered an error if the key does not exist in the file.</p>
</div>
</div>
<div id="outline-container-headline-141" class="outline-3">
<h3 id="headline-141">
setmaxmem
</h3>
<div id="outline-text-headline-141" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
setmaxmem domain size [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Change the maximum memory allocation limit for a guest domain. If
<em>–live</em> is specified, affect a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor.</p>
<p>
Some hypervisors such as QEMU/KVM don&#39;t support live changes (especially
increasing) of the maximum memory limit. Even persistent configuration
changes might not be performed with some hypervisors/configuration (e.g.
on NUMA enabled domains on QEMU). For complex configuration changes use
command <strong>edit</strong> instead).</p>
<p>
<em>size</em> is a scaled integer (see <strong>NOTES</strong> above); it defaults to kibibytes
(blocks of 1024 bytes) unless you provide a suffix (and the older option
name <em>–kilobytes</em> is available as a deprecated synonym) . Libvirt
rounds up to the nearest kibibyte. Some hypervisors require a larger
granularity than KiB, and requests that are not an even multiple will be
rounded up. For example, vSphere/ESX rounds the parameter up to
mebibytes (1024 kibibytes).</p>
</div>
</div>
<div id="outline-container-headline-142" class="outline-3">
<h3 id="headline-142">
setmem
</h3>
<div id="outline-text-headline-142" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
setmem domain size [[--config] [--live] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Change the memory allocation for a guest domain. If <em>–live</em> is
specified, perform a memory balloon of a running guest. If <em>–config</em> is
specified, affect the next start of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor.</p>
<p>
<em>size</em> is a scaled integer (see <strong>NOTES</strong> above); it defaults to kibibytes
(blocks of 1024 bytes) unless you provide a suffix (and the older option
name <em>–kilobytes</em> is available as a deprecated synonym) . Libvirt
rounds up to the nearest kibibyte. Some hypervisors require a larger
granularity than KiB, and requests that are not an even multiple will be
rounded up. For example, vSphere/ESX rounds the parameter up to
mebibytes (1024 kibibytes).</p>
<p>
For Xen, you can only adjust the memory of a running domain if the
domain is paravirtualized or running the PV balloon driver.</p>
<p>
For LXC, the value being set is the cgroups value for limit_in_bytes or
the maximum amount of user memory (including file cache). When viewing
memory inside the container, this is the /proc/meminfo &#34;MemTotal&#34; value.
When viewing the value from the host, use the <strong>virsh memtune</strong> command.
In order to view the current memory in use and the maximum value allowed
to set memory, use the <strong>virsh dominfo</strong> command.</p>
</div>
</div>
<div id="outline-container-headline-143" class="outline-3">
<h3 id="headline-143">
setvcpus
</h3>
<div id="outline-text-headline-143" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
setvcpus domain count [--maximum] [[--config] [--live] | [--current]] [--guest] [--hotpluggable]
</pre>
</blockquote>
</blockquote>
<p>
Change the number of virtual CPUs active in a guest domain. By default,
this command works on active guest domains. To change the settings for
an inactive guest domain, use the <em>–config</em> flag.</p>
<p>
The <em>count</em> value may be limited by host, hypervisor, or a limit coming
from the original description of the guest domain. For Xen, you can only
adjust the virtual CPUs of a running domain if the domain is
paravirtualized.</p>
<p>
If the <em>–config</em> flag is specified, the change is made to the stored
XML configuration for the guest domain, and will only take effect when
the guest domain is next started.</p>
<p>
If <em>–live</em> is specified, the guest domain must be active, and the
change takes place immediately. Both the <em>–config</em> and <em>–live</em> flags
may be specified together if supported by the hypervisor. If this
command is run before the guest has finished booting, the guest may fail
to process the change.</p>
<p>
If <em>–current</em> is specified, it is equivalent to either <em>–live</em> or
<em>–config</em>, depending on the current state of the guest.</p>
<p>
When no flags are given, the <em>–live</em> flag is assumed and the guest
domain must be active. In this situation it is up to the hypervisor
whether the <em>–config</em> flag is also assumed, and therefore whether the
XML configuration is adjusted to make the change persistent.</p>
<p>
If <em>–guest</em> is specified, then the count of cpus is modified in the
guest instead of the hypervisor. This flag is usable only for live
domains and may require guest agent to be configured in the guest.</p>
<p>
To allow adding vcpus to persistent definitions that can be later
hotunplugged after the domain is booted it is necessary to specify the
<em>–hotpluggable</em> flag. Vcpus added to live domains supporting vcpu
unplug are automatically marked as hotpluggable.</p>
<p>
The <em>–maximum</em> flag controls the maximum number of virtual cpus that
can be hot-plugged the next time the domain is booted. As such, it must
only be used with the <em>–config</em> flag, and not with the <em>–live</em> or the
<em>–current</em> flag. Note that it may not be possible to change the maximum
vcpu count if the processor topology is specified for the guest.</p>
</div>
</div>
<div id="outline-container-headline-144" class="outline-3">
<h3 id="headline-144">
setvcpu
</h3>
<div id="outline-text-headline-144" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
setvcpu domain vcpulist [--enable] | [--disable]
   [[--live] [--config] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Change state of individual vCPUs using hot(un)plug mechanism.</p>
<p>
See <strong>vcpupin</strong> for information on format of <em>vcpulist</em>. Hypervisor
drivers may require that <em>vcpulist</em> contains exactly vCPUs belonging to
one hotpluggable entity. This is usually just a single vCPU but certain
architectures such as ppc64 require a full core to be specified at once.</p>
<p>
Note that hypervisors may refuse to disable certain vcpus such as vcpu 0
or others.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. This is the default. Both
<em>–live</em> and <em>–config</em> flags may be given, but <em>–current</em> is
exclusive.</p>
</div>
</div>
<div id="outline-container-headline-145" class="outline-3">
<h3 id="headline-145">
shutdown
</h3>
<div id="outline-text-headline-145" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
shutdown domain [--mode MODE-LIST]
</pre>
</blockquote>
</blockquote>
<p>
Gracefully shuts down a domain. This coordinates with the domain OS to
perform graceful shutdown, so there is no guarantee that it will
succeed, and may take a variable length of time depending on what
services must be shutdown in the domain.</p>
<p>
The exact behavior of a domain when it shuts down is set by the
<em>on_poweroff</em> parameter in the domain&#39;s XML definition.</p>
<p>
If <em>domain</em> is transient, then the metadata of any snapshots and
checkpoints will be lost once the guest stops running, but the
underlying contents still exist, and a new domain with the same name and
UUID can restore the snapshot metadata with <strong>snapshot-create</strong>, and the
checkpoint metadata with <strong>checkpoint-create</strong>.</p>
<p>
By default the hypervisor will try to pick a suitable shutdown method.
To specify an alternative method, the <em>–mode</em> parameter can specify a
comma separated list which includes <strong>acpi</strong>, <strong>agent</strong>, <strong>initctl</strong>, <strong>signal</strong>
and <strong>paravirt</strong>. The order in which drivers will try each mode is
undefined, and not related to the order specified to virsh. For strict
control over ordering, use a single mode at a time and repeat the
command.</p>
</div>
</div>
<div id="outline-container-headline-146" class="outline-3">
<h3 id="headline-146">
start
</h3>
<div id="outline-text-headline-146" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
start domain-name-or-uuid [--console] [--paused]
   [--autodestroy] [--bypass-cache] [--force-boot]
   [--pass-fds N,M,...] [--reset-nvram]
</pre>
</blockquote>
</blockquote>
<p>
Start a (previously defined) inactive domain, either from the last
<strong>managedsave</strong> state, or via a fresh boot if no managedsave state is
present. The domain will be paused if the <em>–paused</em> option is used and
supported by the driver; otherwise it will be running. If <em>–console</em> is
requested, attach to the console after creation. If <em>–autodestroy</em> is
requested, then the guest will be automatically destroyed when virsh
closes its connection to libvirt, or otherwise exits. If
<em>–bypass-cache</em> is specified, and managedsave state exists, the restore
will avoid the file system cache, although this may slow down the
operation. If <em>–force-boot</em> is specified, then any managedsave state is
discarded and a fresh boot occurs.</p>
<p>
If <em>–pass-fds</em> is specified, the argument is a comma separated list of
open file descriptors which should be pass on into the guest. The file
descriptors will be re-numbered in the guest, starting from 3. This is
only supported with container based virtualization.</p>
<p>
If <em>–reset-nvram</em> is specified, any existing NVRAM file will be deleted
and re-initialized from its pristine template.</p>
</div>
</div>
<div id="outline-container-headline-147" class="outline-3">
<h3 id="headline-147">
suspend
</h3>
<div id="outline-text-headline-147" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
suspend domain
</pre>
</blockquote>
</blockquote>
<p>
Suspend a running domain. It is kept in memory but won&#39;t be scheduled
anymore.</p>
</div>
</div>
<div id="outline-container-headline-148" class="outline-3">
<h3 id="headline-148">
ttyconsole
</h3>
<div id="outline-text-headline-148" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
ttyconsole domain
</pre>
</blockquote>
</blockquote>
<p>
Output the device used for the TTY console of the domain. If the
information is not available the processes will provide an exit code
of 1.</p>
</div>
</div>
<div id="outline-container-headline-149" class="outline-3">
<h3 id="headline-149">
undefine
</h3>
<div id="outline-text-headline-149" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
undefine domain [--managed-save] [--snapshots-metadata]
   [--checkpoints-metadata] [--nvram] [--keep-nvram]
   [ {--storage volumes | --remove-all-storage
      [--delete-storage-volume-snapshots]} --wipe-storage]
   [--tpm] [--keep-tpm]
</pre>
</blockquote>
</blockquote>
<p>
Undefine a domain. If the domain is running, this converts it to a
transient domain, without stopping it. If the domain is inactive, the
domain configuration is removed.</p>
<p>
The <em>–managed-save</em> flag guarantees that any managed save image (see
the <strong>managedsave</strong> command) is also cleaned up. Without the flag,
attempts to undefine a domain with a managed save image will fail.</p>
<p>
The <em>–snapshots-metadata</em> flag guarantees that any snapshots (see the
<strong>snapshot-list</strong> command) are also cleaned up when undefining an inactive
domain. Without the flag, attempts to undefine an inactive domain with
snapshot metadata will fail. If the domain is active, this flag is
ignored.</p>
<p>
The <em>–checkpoints-metadata</em> flag guarantees that any checkpoints (see
the <strong>checkpoint-list</strong> command) are also cleaned up when undefining an
inactive domain. Without the flag, attempts to undefine an inactive
domain with checkpoint metadata will fail. If the domain is active, this
flag is ignored.</p>
<p>
<em>–nvram</em> and <em>–keep-nvram</em> specify accordingly to delete or keep nvram
(<em>domain/os/nvram</em>) file. If the domain has an nvram file and the flags
are omitted, the undefine will fail.</p>
<p>
The <em>–storage</em> flag takes a parameter <strong>volumes</strong>, which is a comma
separated list of volume target names or source paths of storage volumes
to be removed along with the undefined domain. Volumes can be undefined
and thus removed only on inactive domains. Volume deletion is only
attempted after the domain is undefined; if not all of the requested
volumes could be deleted, the error message indicates what still remains
behind. If a volume path is not found in the domain definition, it&#39;s
treated as if the volume was successfully deleted. Only volumes managed
by libvirt in storage pools can be removed this way. Note that this also
removes only the top level image of a backing chain, any backing stores
of the image are kept as they may be shared. (See <strong>domblklist</strong> for list
of target names associated to a domain). Example: –storage
vda,/path/to/storage.img</p>
<p>
The <em>–remove-all-storage</em> flag specifies that all of the domain&#39;s
storage volumes should be deleted as if they were specified via
<em>–storage</em>.</p>
<p>
The <em>–delete-storage-volume-snapshots</em> (previously
<em>–delete-snapshots</em>) flag specifies that any snapshots associated with
the storage volume should be deleted as well. Requires the
<em>–remove-all-storage</em> flag to be provided. Not all storage drivers
support this option, presently only rbd. Using this when also removing
volumes handled by a storage driver which does not support the flag will
result in failure.</p>
<p>
The flag <em>–wipe-storage</em> specifies that the storage volumes should be
wiped before removal.</p>
<p>
<em>–tpm</em> and <em>–keep-tpm</em> specify accordingly to delete or keep a TPM&#39;s
persistent state directory structure and files. If the flags are omitted
then the persistent_state attribute in the TPM emulator definition in
the domain XML determines whether the TPM state is kept.</p>
<p>
NOTE: For an inactive domain, the domain name or UUID must be used as
the <em>domain</em>.</p>
</div>
</div>
<div id="outline-container-headline-150" class="outline-3">
<h3 id="headline-150">
vcpucount
</h3>
<div id="outline-text-headline-150" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vcpucount domain  [{--maximum | --active}
   {--config | --live | --current}] [--guest]
</pre>
</blockquote>
</blockquote>
<p>
Print information about the virtual cpu counts of the given <em>domain</em>. If
no flags are specified, all possible counts are listed in a table;
otherwise, the output is limited to just the numeric value requested.
For historical reasons, the table lists the label &#34;current&#34; on the rows
that can be queried in isolation via the <em>–active</em> flag, rather than
relating to the <em>–current</em> flag.</p>
<p>
<em>–maximum</em> requests information on the maximum cap of vcpus that a
domain can add via <strong>setvcpus</strong>, while <em>–active</em> shows the current usage;
these two flags cannot both be specified. <em>–config</em> requires a
persistent guest and requests information regarding the next time the
domain will be booted, <em>–live</em> requires a running domain and lists
current values, and <em>–current</em> queries according to the current state
of the domain (corresponding to <em>–live</em> if running, or <em>–config</em> if
inactive); these three flags are mutually exclusive.</p>
<p>
If <em>–guest</em> is specified, then the count of cpus is reported from the
perspective of the guest. This flag is usable only for live domains and
may require guest agent to be configured in the guest.</p>
</div>
</div>
<div id="outline-container-headline-151" class="outline-3">
<h3 id="headline-151">
vcpuinfo
</h3>
<div id="outline-text-headline-151" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vcpuinfo domain [--pretty]
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the domain virtual CPUs, like the number
of vCPUs, the running time, the affinity to physical processors.</p>
<p>
With <em>–pretty</em>, cpu affinities are shown as ranges.</p>
<p>
<strong>Example:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
$ virsh vcpuinfo fedora
VCPU:           0
CPU:            0
State:          running
CPU time:       7,0s
CPU Affinity:   yyyy

VCPU:           1
CPU:            1
State:          running
CPU time:       0,7s
CPU Affinity:   yyyy
</pre>
</blockquote>
</blockquote>
<p>
<strong>STATES</strong></p>
<p>
The State field displays the current operating state of a virtual CPU</p>
<blockquote>
<ul>
<li><strong>offline</strong></li>
</ul>
<p>The virtual CPU is offline and not usable by the domain. This state is
not supported by all hypervisors.</p>
<ul>
<li><strong>running</strong></li>
</ul>
<p>The virtual CPU is available to the domain and is operating.</p>
<ul>
<li><strong>blocked</strong></li>
</ul>
<p>The virtual CPU is available to the domain but is waiting for a
resource. This state is not supported by all hypervisors, in which case
<em>running</em> may be reported instead.</p>
<ul>
<li><strong>no state</strong></li>
</ul>
<p>The virtual CPU state could not be determined. This could happen if the
hypervisor is newer than virsh.</p>
<ul>
<li><strong>N/A</strong></li>
</ul>
<p>There&#39;s no information about the virtual CPU state available. This can
be the case if the domain is not running or the hypervisor does not
report the virtual CPU state.</p>
</blockquote>
</div>
</div>
<div id="outline-container-headline-152" class="outline-3">
<h3 id="headline-152">
vcpupin
</h3>
<div id="outline-text-headline-152" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vcpupin domain [vcpu] [cpulist] [[--live] [--config] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Query or change the pinning of domain VCPUs to host physical CPUs. To
pin a single <em>vcpu</em>, specify <em>cpulist</em>; otherwise, you can query one
<em>vcpu</em> or omit <em>vcpu</em> to list all at once.</p>
<p>
<em>cpulist</em> is a list of physical CPU numbers. Its syntax is a comma
separated list and a special markup using &#39;-&#39; and &#39;^&#39; (ex. &#39;0-4&#39;,
&#39;0-3,^2&#39;) can also be allowed. The &#39;-&#39; denotes the range and the &#39;^&#39;
denotes exclusive. For pinning the <em>vcpu</em> to all physical cpus specify
&#39;r&#39; as a <em>cpulist</em>. If <em>–live</em> is specified, affect a running guest. If
<em>–config</em> is specified, affect the next start of a persistent guest. If
<em>–current</em> is specified, it is equivalent to either <em>–live</em> or
<em>–config</em>, depending on the current state of the guest. Both <em>–live</em>
and <em>–config</em> flags may be given if <em>cpulist</em> is present, but
<em>–current</em> is exclusive. If no flag is specified, behavior is different
depending on hypervisor.</p>
<p>
<strong>Note</strong>: The expression is sequentially evaluated, so &#34;0-15,^8&#34; is
identical to &#34;9-14,0-7,15&#34; but not identical to &#34;^8,0-15&#34;.</p>
</div>
</div>
<div id="outline-container-headline-153" class="outline-3">
<h3 id="headline-153">
vncdisplay
</h3>
<div id="outline-text-headline-153" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vncdisplay domain
</pre>
</blockquote>
</blockquote>
<p>
Output the IP address and port number for the VNC display. If the
information is not available the processes will provide an exit code
of 1.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-154" class="outline-2">
<h2 id="headline-154">
DEVICE COMMANDS
</h2>
<div id="outline-text-headline-154" class="outline-text-2">
<p>The following commands manipulate devices associated to domains. The
<em>domain</em> can be specified as a short integer, a name or a full UUID. To
better understand the values allowed as options for the command reading
the documentation at &lt;<a href="https://libvirt.org/formatdomain.html">https://libvirt.org/formatdomain.html</a>&gt; on the
format of the device sections to get the most accurate set of accepted
values.</p>
<div id="outline-container-headline-155" class="outline-3">
<h3 id="headline-155">
attach-device
</h3>
<div id="outline-text-headline-155" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
attach-device domain FILE [[[--live] [--config] | [--current]] | [--persistent]]
</pre>
</blockquote>
</blockquote>
<p>
Attach a device to the domain, using a device definition in an XML file
using a device definition element such as &lt;disk&gt; or &lt;interface&gt; as the
top-level element. See the documentation at
<a href="https://libvirt.org/formatdomain.html#elementsDevices">https://libvirt.org/formatdomain.html#elementsDevices</a>
&lt;<a href="https://libvirt.org/formatdomain.html#devices">https://libvirt.org/formatdomain.html#devices</a>&gt; to learn about libvirt
XML format for a device. If <em>–config</em> is specified the command alters
the persistent guest configuration with the device attach taking effect
the next time libvirt starts the domain. For cdrom and floppy devices,
this command only replaces the media within an existing device; consider
using <strong>update-device</strong> for this usage. For passthrough host devices, see
also <strong>nodedev-detach</strong>, needed if the PCI device does not use managed
mode.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. When no
flag is specified legacy API is used whose behavior depends on the
hypervisor driver.</p>
<p>
For compatibility purposes, <em>–persistent</em> behaves like <em>–config</em> for
an offline domain, and like <em>–live</em> <em>–config</em> for a running domain.</p>
<p>
<strong>Note</strong>: using of partial device definition XML files may lead to
unexpected results as some fields may be autogenerated and thus match
devices other than expected.</p>
</div>
</div>
<div id="outline-container-headline-156" class="outline-3">
<h3 id="headline-156">
attach-disk
</h3>
<div id="outline-text-headline-156" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
attach-disk domain source target [[[--live] [--config] |
   [--current]] | [--persistent]] [--targetbus bus]
   [--driver driver] [--subdriver subdriver] [--iothread iothread]
   [--cache cache] [--io io] [--type type] [--alias alias]
   [--mode mode] [--sourcetype sourcetype]
   [--source-protocol protocol] [--source-host-name hostname:port]
   [--source-host-transport transport] [--source-host-socket socket]
   [--serial serial] [--wwn wwn] [--rawio] [--address address]
   [--multifunction] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Attach a new disk device to the domain. <em>source</em> is path for the files
and devices unless <em>–source-protocol</em> is specified, in which case
<em>source</em> is the name of a network disk. <em>target</em> controls the bus or
device under which the disk is exposed to the guest OS. It indicates the
&#34;logical&#34; device name; the optional <em>targetbus</em> attribute specifies the
type of disk device to emulate; possible values are driver specific,
with typical values being <em>ide</em>, <em>scsi</em>, <em>virtio</em>, <em>xen</em>, <em>usb</em>, <em>sata</em>,
or <em>sd</em>, if omitted, the bus type is inferred from the style of the
device name (e.g. a device named &#39;sda&#39; will typically be exported using
a SCSI bus). <em>driver</em> can be <em>file</em>, <em>tap</em> or <em>phy</em> for the Xen
hypervisor depending on the kind of access; or <em>qemu</em> for the QEMU
emulator. Further details to the driver can be passed using <em>subdriver</em>.
For Xen <em>subdriver</em> can be <em>aio</em>, while for QEMU subdriver should match
the format of the disk source, such as <em>raw</em> or <em>qcow2</em>. Hypervisor
default will be used if <em>subdriver</em> is not specified. However, the
default may not be correct, esp. for QEMU as for security reasons it is
configured not to detect disk formats. <em>type</em> can indicate <em>lun</em>,
<em>cdrom</em> or <em>floppy</em> as alternative to the disk default, although this
use only replaces the media within the existing virtual cdrom or floppy
device; consider using <strong>update-device</strong> for this usage instead. <em>alias</em>
can set user supplied alias. <em>mode</em> can specify the two specific mode
<em>readonly</em> or <em>shareable</em>. <em>sourcetype</em> can indicate the type of source
(block|file|network) <em>cache</em> can be one of &#34;default&#34;, &#34;none&#34;,
&#34;writethrough&#34;, &#34;writeback&#34;, &#34;directsync&#34; or &#34;unsafe&#34;. <em>io</em> controls
specific policies on I/O; QEMU guests support &#34;threads&#34;, &#34;native&#34; and
&#34;io_uring&#34;. <em>iothread</em> is the number within the range of domain
IOThreads to which this disk may be attached (QEMU only). <em>serial</em> is
the serial of disk device. <em>wwn</em> is the wwn of disk device. <em>rawio</em>
indicates the disk needs rawio capability. <em>address</em> is the address of
disk device in the form of pci:domain.bus.slot.function,
scsi:controller.bus.unit, ide:controller.bus.unit, usb:bus.port,
sata:controller.bus.unit or ccw:cssid.ssid.devno. Virtio-ccw devices
must have their cssid set to 0xfe. <em>multifunction</em> indicates specified
pci address is a multifunction pci device address.</p>
<p>
There is also support for using a network disk. As specified, the user
can provide a <em>–source-protocol</em> in which case the <em>source</em> parameter
will be interpreted as the source name. <em>–source-protocol</em> must be
provided if the user intends to provide a network disk or host
information. Host information can be provided using the tags
<em>–source-host-name</em>, <em>–source-host-transport</em>, and
<em>–source-host-socket</em>, which respectively denote the name of the host,
the host&#39;s transport method, and the socket that the host uses.
<em>–source-host-socket</em> and <em>–source-host-name</em> cannot both be provided,
and the user must provide a <em>–source-host-transport</em> if they want to
provide a <em>–source-host-socket</em>. The <em>–source-host-name</em> parameter
supports host:port syntax if the user wants to provide a port as well.</p>
<p>
If <em>–print-xml</em> is specified, then the XML of the disk that would be
attached is printed instead.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. When no
flag is specified legacy API is used whose behavior depends on the
hypervisor driver.</p>
<p>
For compatibility purposes, <em>–persistent</em> behaves like <em>–config</em> for
an offline domain, and like <em>–live</em> <em>–config</em> for a running domain.
Likewise, <em>–shareable</em> is an alias for <em>–mode shareable</em>.</p>
</div>
</div>
<div id="outline-container-headline-157" class="outline-3">
<h3 id="headline-157">
attach-interface
</h3>
<div id="outline-text-headline-157" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
attach-interface domain type source [[[--live]
   [--config] | [--current]] | [--persistent]]
   [--target target] [--mac mac] [--script script] [--model model]
   [--inbound average,peak,burst,floor] [--outbound average,peak,burst]
   [--alias alias] [--managed] [--print-xml]
   [--source-mode mode]
</pre>
</blockquote>
</blockquote>
<p>
Attach a new network interface to the domain.</p>
<p>
<strong>type</strong> can be one of the:</p>
<p>
<em>network</em> to indicate connection via a libvirt virtual network,</p>
<p>
<em>bridge</em> to indicate connection via a bridge device on the host,</p>
<p>
<em>direct</em> to indicate connection directly to one of the host&#39;s network
interfaces or bridges,</p>
<p>
<em>hostdev</em> to indicate connection using a passthrough of PCI device on
the host,</p>
<p>
<em>vhostuser</em> to indicate connection using a virtio transport protocol.</p>
<p>
<strong>source</strong> indicates the source of the connection. The source depends on
the type of the interface:</p>
<p>
<em>network</em> name of the virtual network,</p>
<p>
<em>bridge</em> the name of the bridge device,</p>
<p>
<em>direct</em> the name of the host&#39;s interface or bridge,</p>
<p>
<em>hostdev</em> the PCI address of the host&#39;s interface formatted as
domain:bus:slot.function.</p>
<p>
<em>vhostuser</em> the path to UNIX socket (control plane)</p>
<p>
<strong>–target</strong> is used to specify the tap/macvtap device to be used to
connect the domain to the source. Names starting with &#39;vnet&#39; are
considered as auto-generated and are blanked out/regenerated each time
the interface is attached.</p>
<p>
<strong>–mac</strong> specifies the MAC address of the network interface; if a MAC
address is not given, a new address will be automatically generated (and
stored in the persistent configuration if &#34;–config&#34; is given on the
command line).</p>
<p>
<strong>–script</strong> is used to specify a path to a custom script to be called
while attaching to a bridge - this will be called instead of the default
script not in addition to it. This is valid only for interfaces of
<em>bridge</em> type and only for Xen domains.</p>
<p>
<strong>–model</strong> specifies the network device model to be presented to the
domain.</p>
<p>
<strong>alias</strong> can set user supplied alias.</p>
<p>
<strong>–inbound</strong> and <strong>–outbound</strong> control the bandwidth of the interface. At
least one from the <em>average</em>, <em>floor</em> pair must be specified. The other
two <em>peak</em> and <em>burst</em> are optional, so &#34;average,peak&#34;,
&#34;average,,burst&#34;, &#34;average,,,floor&#34;, &#34;average&#34; and &#34;,,,floor&#34; are also
legal. Values for <em>average</em>, <em>floor</em> and <em>peak</em> are expressed in
kilobytes per second, while <em>burst</em> is expressed in kilobytes in a
single burst at <em>peak</em> speed as described in the Network XML
documentation at
&lt;<a href="https://libvirt.org/formatnetwork.html#quality-of-service">https://libvirt.org/formatnetwork.html#quality-of-service</a>&gt; .</p>
<p>
<strong>–managed</strong> is usable only for <em>hostdev</em> type and tells libvirt that the
interface should be managed, which means detached and reattached from/to
the host by libvirt.</p>
<p>
<strong>–source-mode</strong> is mandatory for <em>vhostuser</em> interface and accepts
values <em>server</em> and <em>client</em> that control whether hypervisor waits for
the other process to connect, or initiates connection, respectively.</p>
<p>
If <strong>–print-xml</strong> is specified, then the XML of the interface that would
be attached is printed instead.</p>
<p>
If <strong>–live</strong> is specified, affect a running domain. If <strong>–config</strong> is
specified, affect the next startup of a persistent guest. If <strong>–current</strong>
is specified, affect the current domain state, which can either be live
or offline. Both <strong>–live</strong> and <strong>–config</strong> flags may be given, but
<strong>–current</strong> is exclusive. When no flag is specified legacy API is used
whose behavior depends on the hypervisor driver.</p>
<p>
For compatibility purposes, <strong>–persistent</strong> behaves like <strong>–config</strong> for
an offline domain, and like <strong>–live</strong> <strong>–config</strong> for a running domain.</p>
<p>
<strong>Note</strong>: the optional target value is the name of a device to be created
as the back-end on the node. If not provided a device named &#34;vnetN&#34; or
&#34;vifN&#34; will be created automatically.</p>
</div>
</div>
<div id="outline-container-headline-158" class="outline-3">
<h3 id="headline-158">
detach-device
</h3>
<div id="outline-text-headline-158" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
detach-device domain FILE [[[--live] [--config] |
   [--current]] | [--persistent]]
</pre>
</blockquote>
</blockquote>
<p>
Detach a device from the domain, takes the same kind of XML descriptions
as command <strong>attach-device</strong>. For passthrough host devices, see also
<strong>nodedev-reattach</strong>, needed if the device does not use managed mode.</p>
<p>
<strong>Note</strong>: The supplied XML description of the device should be as specific
as its definition in the domain XML. The set of attributes used to match
the device are internal to the drivers. Using a partial definition, or
attempting to detach a device that is not present in the domain XML, but
shares some specific attributes with one that is present, may lead to
unexpected results.</p>
<p>
<strong>Quirk</strong>: Device unplug is asynchronous in most cases and requires guest
cooperation. This means that it&#39;s up to the discretion of the guest to
disallow or delay the unplug arbitrarily. As the libvirt API used in
this command was designed as synchronous it returns success after some
timeout even if the device was not unplugged yet to allow further
interactions with the domain e.g. if the guest is unresponsive. Callers
which need to make sure that the device was unplugged can use libvirt
events (see virsh event) to be notified when the device is removed. Note
that the event may arrive before the command returns.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. When no
flag is specified legacy API is used whose behavior depends on the
hypervisor driver.</p>
<p>
For compatibility purposes, <em>–persistent</em> behaves like <em>–config</em> for
an offline domain, and like <em>–live</em> <em>–config</em> for a running domain.</p>
<p>
Note that older versions of virsh used <em>–config</em> as an alias for
<em>–persistent</em>.</p>
</div>
</div>
<div id="outline-container-headline-159" class="outline-3">
<h3 id="headline-159">
detach-device-alias
</h3>
<div id="outline-text-headline-159" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
detach-device-alias domain alias [[[--live] [--config] | [--current]]]]
</pre>
</blockquote>
</blockquote>
<p>
Detach a device with given <em>alias</em> from the <em>domain</em>. This command
returns successfully after the unplug request was sent to the
hypervisor. The actual removal of the device is notified asynchronously
via libvirt events (see virsh event).</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive.</p>
</div>
</div>
<div id="outline-container-headline-160" class="outline-3">
<h3 id="headline-160">
detach-disk
</h3>
<div id="outline-text-headline-160" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
detach-disk domain target [[[--live] [--config] |
   [--current]] | [--persistent]] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Detach a disk device from a domain. The <em>target</em> is the device as seen
from the domain.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. When no
flag is specified legacy API is used whose behavior depends on the
hypervisor driver.</p>
<p>
For compatibility purposes, <em>–persistent</em> behaves like <em>–config</em> for
an offline domain, and like <em>–live</em> <em>–config</em> for a running domain.</p>
<p>
Note that older versions of virsh used <em>–config</em> as an alias for
<em>–persistent</em>.</p>
<p>
If <strong>–print-xml</strong> is specified, then the XML which would be used to
detach the disk is printed instead.</p>
<p>
Please see documentation for <strong>detach-device</strong> for known quirks.</p>
</div>
</div>
<div id="outline-container-headline-161" class="outline-3">
<h3 id="headline-161">
detach-interface
</h3>
<div id="outline-text-headline-161" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
detach-interface domain type [--mac mac]
   [[[--live] [--config] | [--current]] | [--persistent]] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Detach a network interface from a domain. <em>type</em> can be either <em>network</em>
to indicate a physical network device or <em>bridge</em> to indicate a bridge
to a device. It is recommended to use the <em>mac</em> option to distinguish
between the interfaces if more than one are present on the domain.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. When no
flag is specified legacy API is used whose behavior depends on the
hypervisor driver.</p>
<p>
For compatibility purposes, <em>–persistent</em> behaves like <em>–config</em> for
an offline domain, and like <em>–live</em> <em>–config</em> for a running domain.</p>
<p>
Note that older versions of virsh used <em>–config</em> as an alias for
<em>–persistent</em>.</p>
<p>
If <em>–print-xml</em> is specified, then the XML used to detach the interface
is printed instead.</p>
<p>
Please see documentation for <strong>detach-device</strong> for known quirks.</p>
</div>
</div>
<div id="outline-container-headline-162" class="outline-3">
<h3 id="headline-162">
update-device
</h3>
<div id="outline-text-headline-162" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
update-device domain file [--force] [[[--live]
   [--config] | [--current]] | [--persistent]]
</pre>
</blockquote>
</blockquote>
<p>
Update the characteristics of a device associated with <em>domain</em>, based
on the device definition in an XML <em>file</em>. The <em>–force</em> option can be
used to force device update, e.g., to eject a CD-ROM even if it is
locked/mounted in the domain. See the documentation at
<a href="https://libvirt.org/formatdomain.html#elementsDevices">https://libvirt.org/formatdomain.html#elementsDevices</a>
&lt;<a href="https://libvirt.org/formatdomain.html#devices">https://libvirt.org/formatdomain.html#devices</a>&gt; to learn about libvirt
XML format for a device.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. Not
specifying any flag is the same as specifying <em>–current</em>.</p>
<p>
For compatibility purposes, <em>–persistent</em> behaves like <em>–config</em> for
an offline domain, and like <em>–live</em> <em>–config</em> for a running domain.</p>
<p>
Note that older versions of virsh used <em>–config</em> as an alias for
<em>–persistent</em>.</p>
<p>
<strong>Note</strong>: using of partial device definition XML files may lead to
unexpected results as some fields may be autogenerated and thus match
devices other than expected.</p>
</div>
</div>
<div id="outline-container-headline-163" class="outline-3">
<h3 id="headline-163">
update-memory-device
</h3>
<div id="outline-text-headline-163" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
update-memory-device domain [--print-xml] [[--alias alias] | [--node node]]
  [[--live] [--config] | [--current]]
  [--requested-size size]
</pre>
</blockquote>
</blockquote>
<p>
This command finds <strong>&lt;memory/&gt;</strong> device inside given <em>domain</em>, changes
requested values and passes updated device XML to daemon. If
<em>–print-xml</em> is specified then the device is not changed, but the
updated device XML is printed to stdout. If there are more than one
<strong>&lt;memory/&gt;</strong> devices in <em>domain</em> use <em>–alias</em> or <em>–node</em> to select the
desired one.</p>
<p>
If <em>–live</em> is specified, affect a running domain. If <em>–config</em> is
specified, affect the next startup of a persistent guest. If <em>–current</em>
is specified, it is equivalent to either <em>–live</em> or <em>–config</em>,
depending on the current state of the guest. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. Not
specifying any flag is the same as specifying <em>–current</em>.</p>
<p>
If <em>–requested-size</em> is specified then <strong>&lt;requested/&gt;</strong> under memory
target is changed to requested <em>size</em> (as scaled integer, see <strong>NOTES</strong>
above). It defaults to kibibytes if no suffix is provided. The option is
valid only for <strong>virtio-mem</strong> memory device model.</p>
</div>
</div>
<div id="outline-container-headline-164" class="outline-3">
<h3 id="headline-164">
change-media
</h3>
<div id="outline-text-headline-164" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
change-media domain path [--eject] [--insert]
   [--update] [source] [--force] [[--live] [--config] |
   [--current]] [--print-xml] [--block]
</pre>
</blockquote>
</blockquote>
<p>
Change media of CDROM or floppy drive. <em>path</em> can be the fully-qualified
path or the unique target name (&lt;target dev=&#39;hdc&#39;&gt;) of the disk device.
<em>source</em> specifies the path of the media to be inserted or updated. The
<em>–block</em> flag allows setting the backing type in case a block device is
used as media for the CDROM or floppy drive instead of a file.</p>
<p>
<em>–eject</em> indicates the media will be ejected. <em>–insert</em> indicates the
media will be inserted. <em>source</em> must be specified. If the device has
source (e.g. &lt;source file=&#39;media&#39;&gt;), and <em>source</em> is not specified,
<em>–update</em> is equal to <em>–eject</em>. If the device has no source, and
<em>source</em> is specified, <em>–update</em> is equal to <em>–insert</em>. If the device
has source, and <em>source</em> is specified, <em>–update</em> behaves like
combination of <em>–eject</em> and <em>–insert</em>. If none of <em>–eject</em>,
<em>–insert</em>, and <em>–update</em> is specified, <em>–update</em> is used by default.
The <em>–force</em> option can be used to force media changing. If <em>–live</em> is
specified, alter live configuration of running guest. If <em>–config</em> is
specified, alter persistent configuration, effect observed on next
startup of the guest. <em>–current</em> can be either or both of <em>live</em> and
<em>config</em>, depends on the hypervisor&#39;s implementation. Both <em>–live</em> and
<em>–config</em> flags may be given, but <em>–current</em> is exclusive. If no flag
is specified, behavior is different depending on hypervisor. If
<em>–print-xml</em> is specified, the XML that would be used to change media
is printed instead of changing the media.</p>
</div>
</div>
<div id="outline-container-headline-165" class="outline-3">
<h3 id="headline-165">
dom-fd-associate
</h3>
<div id="outline-text-headline-165" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
dom-fd-associate domain --name FDGROUPNAME --pass-fds M,N,....
    [--seclabel-writable] [--seclabel-restore]
</pre>
</blockquote>
</blockquote>
<p>
Associate one or more fds described via <em>–pass-fds</em> argument to
<em>domain</em> as <em>–name</em>. The lifetime of the passed fd group is the same as
the connection, thus exiting virsh un-registers them afterwards.</p>
<p>
By default security labels are applied if needed but they are not
restored after use to avoid keeping them open unnecessarily. Best-effort
security label restore may be requested by using the
<em>–seclabel-restore</em> flag.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-166" class="outline-2">
<h2 id="headline-166">
NODEDEV COMMANDS
</h2>
<div id="outline-text-headline-166" class="outline-text-2">
<p>The following commands manipulate host devices that are intended to be
passed through to guest domains via &lt;hostdev&gt; elements in a domain&#39;s
&lt;devices&gt; section. A node device key is generally specified by the bus
name followed by its address, using underscores between all components,
such as pci_0000_00_02_1, usb_1_5_3, or net_eth1_00_27_13_6a_fe_00. The
<strong>nodedev-list</strong> gives the full list of host devices that are known to
libvirt, although this includes devices that cannot be assigned to a
guest (for example, attempting to detach the PCI device that controls
the host&#39;s hard disk controller where the guest&#39;s disk images live could
cause the host system to lock up or reboot).</p>
<p>
For more information on node device definition see:
&lt;<a href="https://libvirt.org/formatnode.html">https://libvirt.org/formatnode.html</a>&gt; .</p>
<p>
Passthrough devices cannot be simultaneously used by the host and its
guest domains, nor by multiple active guests at once. If the &lt;hostdev&gt;
description of a PCI device includes the attribute <strong>managed=&#39;yes&#39;</strong>, and
the hypervisor driver supports it, then the device is in managed mode,
and attempts to use that passthrough device in an active guest will
automatically behave as if <strong>nodedev-detach</strong> (guest start, device
hot-plug) and <strong>nodedev-reattach</strong> (guest stop, device hot-unplug) were
called at the right points. If a PCI device is not marked as managed,
then it must manually be detached before guests can use it, and manually
reattached to be returned to the host. Also, if a device is manually
detached, then the host does not regain control of the device without a
matching reattach, even if the guests use the device in managed mode.</p>
<div id="outline-container-headline-167" class="outline-3">
<h3 id="headline-167">
nodedev-create
</h3>
<div id="outline-text-headline-167" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-create FILE [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Create a device on the host node that can then be assigned to virtual
machines. Normally, libvirt is able to automatically determine which
host nodes are available for use, but this allows registration of host
hardware that libvirt did not automatically detect. <em>file</em> contains xml
for a top-level &lt;device&gt; description of a node device.</p>
<p>
If <em>–validate</em> is specified, validates the format of the XML document
against an internal RNG schema.</p>
</div>
</div>
<div id="outline-container-headline-168" class="outline-3">
<h3 id="headline-168">
nodedev-update
</h3>
<div id="outline-text-headline-168" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-update device FILE [[--live] [--config] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Update a device on the host. <em>device</em> can be either device name or wwn
pair in &#34;wwnn,wwpn&#34; format (only works for vHBA currently). <em>file</em>
contains xml for a top-level &lt;device&gt; description of the node device.
<em>–current</em> can be either or both of <em>live</em> and <em>config</em>, depends on the
hypervisor&#39;s implementation. Both <em>–live</em> and <em>–config</em> flags may be
given, but <em>–current</em> is exclusive. If no flag is specified, behavior
is different depending on hypervisor.</p>
</div>
</div>
<div id="outline-container-headline-169" class="outline-3">
<h3 id="headline-169">
nodedev-destroy
</h3>
<div id="outline-text-headline-169" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-destroy device
</pre>
</blockquote>
</blockquote>
<p>
Destroy (stop) a device on the host. <em>device</em> can be either device name
or wwn pair in &#34;wwnn,wwpn&#34; format (only works for vHBA currently). Note
that this makes libvirt quit managing a host device, and may even make
that device unusable by the rest of the physical host until a reboot.</p>
</div>
</div>
<div id="outline-container-headline-170" class="outline-3">
<h3 id="headline-170">
nodedev-define
</h3>
<div id="outline-text-headline-170" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-define FILE [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Define an inactive persistent device or modify an existing persistent
one from the XML <em>FILE</em>.</p>
<p>
If <em>–validate</em> is specified, validates the format of the XML document
against an internal RNG schema.</p>
</div>
</div>
<div id="outline-container-headline-171" class="outline-3">
<h3 id="headline-171">
nodedev-undefine
</h3>
<div id="outline-text-headline-171" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-undefine device
</pre>
</blockquote>
</blockquote>
<p>
Undefine the configuration for a persistent device. If the device is
active, make it transient.</p>
</div>
</div>
<div id="outline-container-headline-172" class="outline-3">
<h3 id="headline-172">
nodedev-start
</h3>
<div id="outline-text-headline-172" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-start device
</pre>
</blockquote>
</blockquote>
<p>
Start a (previously defined) inactive device.</p>
</div>
</div>
<div id="outline-container-headline-173" class="outline-3">
<h3 id="headline-173">
nodedev-detach
</h3>
<div id="outline-text-headline-173" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-detach nodedev [--driver backend_driver]
</pre>
</blockquote>
</blockquote>
<p>
Detach <em>nodedev</em> from the host driver and bind it to a special driver
that provides the API needed by the hypervisor for assigning the device
to a virtual machine (using &lt;hostdev&gt; in the domain XML definition).
This is reversed with <strong>nodedev-reattach</strong>, and is done automatically by
the hypervisor driver for managed devices (those devices with
&#34;managed=&#39;yes&#39;&#34; in their XML definition).</p>
<p>
Different hypervisors expect the device being assigned to be bound to
different drivers. For example, QEMU&#39;s &#34;vfio&#34; backend requires the
device to be bound to the driver &#34;vfio-pci&#34; or to a &#34;VFIO variant&#34;
driver (this is a driver that supports the full API provided by
vfio-pci, plus some other APIs to support things like live migration).
The <em>–driver</em> parameter can be used to specify a particular driver
(e.g. a device-specific VFIO variant driver) the device should be bound
to. When <em>–driver</em> is omitted, the default driver for the hypervisor is
used (&#34;vfio-pci&#34; for QEMU, &#34;pciback&#34; for Xen).</p>
</div>
</div>
<div id="outline-container-headline-174" class="outline-3">
<h3 id="headline-174">
nodedev-dumpxml
</h3>
<div id="outline-text-headline-174" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-dumpxml [--inactive] [--xpath EXPRESSION] [--wrap] device
</pre>
</blockquote>
</blockquote>
<p>
Dump a &lt;device&gt; XML representation for the given node device, including
such information as the device name, which bus owns the device, the
vendor and product id, and any capabilities of the device usable by
libvirt (such as whether device reset is supported). <em>device</em> can be
either device name or wwn pair in &#34;wwnn,wwpn&#34; format (only works for
HBA). An additional option affecting the XML dump may be used.
<em>–inactive</em> tells virsh to dump the node device configuration that will
be used on next start of the node device as opposed to the current node
device configuration.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-175" class="outline-3">
<h3 id="headline-175">
nodedev-info
</h3>
<div id="outline-text-headline-175" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-info device
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the <em>device</em> object.</p>
</div>
</div>
<div id="outline-container-headline-176" class="outline-3">
<h3 id="headline-176">
nodedev-list
</h3>
<div id="outline-text-headline-176" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-list [--cap capability] [--tree] [--inactive | --all] [--persistent | --transient]
</pre>
</blockquote>
</blockquote>
<p>
List all of the devices available on the node that are known by libvirt.
<em>cap</em> is used to filter the list by capability types, the types must be
separated by comma, e.g. –cap pci,scsi. Valid capability types include
&#39;system&#39;, &#39;pci&#39;, &#39;usb_device&#39;, &#39;usb&#39;, &#39;net&#39;, &#39;scsi_host&#39;, &#39;scsi_target&#39;,
&#39;scsi&#39;, &#39;storage&#39;, &#39;fc_host&#39;, &#39;vports&#39;, &#39;scsi_generic&#39;, &#39;drm&#39;, &#39;mdev&#39;,
&#39;mdev_types&#39;, &#39;ccw&#39;, &#39;css&#39;, &#39;ap_card&#39;, &#39;ap_queue&#39;, &#39;ap_matrix&#39;. By
default, only active devices are listed. <em>–inactive</em> is used to list
only inactive devices, and <em>–all</em> is used to list both active and
inactive devices. <em>–persistent</em> is used to list only persistent
devices, and <em>–transient</em> is used to list only transient devices. Not
providing <em>–persistent</em> or <em>–transient</em> will list all devices unless
filtered otherwise. <em>–transient</em> is mutually exclusive with
<em>–persistent</em> and <em>–inactive</em>. If <em>–tree</em> is used, the output is
formatted in a tree representing parents of each node. <em>–tree</em> is
mutually exclusive with all other options but <em>–all</em>.</p>
</div>
</div>
<div id="outline-container-headline-177" class="outline-3">
<h3 id="headline-177">
nodedev-reattach
</h3>
<div id="outline-text-headline-177" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-reattach nodedev
</pre>
</blockquote>
</blockquote>
<p>
Declare that <em>nodedev</em> is no longer in use by any guests, and that the
host can resume normal use of the device. This is done automatically for
PCI devices in managed mode and USB devices, but must be done explicitly
to match any explicit <strong>nodedev-detach</strong>.</p>
</div>
</div>
<div id="outline-container-headline-178" class="outline-3">
<h3 id="headline-178">
nodedev-reset
</h3>
<div id="outline-text-headline-178" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-reset nodedev
</pre>
</blockquote>
</blockquote>
<p>
Trigger a device reset for <em>nodedev</em>, useful prior to transferring a
node device between guest passthrough or the host. Libvirt will often do
this action implicitly when required, but this command allows an
explicit reset when needed.</p>
</div>
</div>
<div id="outline-container-headline-179" class="outline-3">
<h3 id="headline-179">
nodedev-event
</h3>
<div id="outline-text-headline-179" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-event {[nodedev] event [--loop] [--timeout seconds] [--timestamp] | --list}
</pre>
</blockquote>
</blockquote>
<p>
Wait for a class of node device events to occur, and print appropriate
details of events as they happen. The events can optionally be filtered
by <em>nodedev</em>. Using <em>–list</em> as the only argument will provide a list of
possible <em>event</em> values known by this client, although the connection
might not allow registering for all these events.</p>
<p>
By default, this command is one-shot, and returns success once an event
occurs; you can send SIGINT (usually via <strong>Ctrl-C</strong>) to quit immediately.
If <em>–timeout</em> is specified, the command gives up waiting for events
after <em>seconds</em> have elapsed. With <em>–loop</em>, the command prints all
events until a timeout or interrupt key.</p>
<p>
When <em>–timestamp</em> is used, a human-readable timestamp will be printed
before the event.</p>
</div>
</div>
<div id="outline-container-headline-180" class="outline-3">
<h3 id="headline-180">
nodedev-autostart
</h3>
<div id="outline-text-headline-180" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nodedev-autostart [--disable] device
</pre>
</blockquote>
</blockquote>
<p>
Configure a device to be automatically started when the host machine
boots or the parent device becomes available. With <em>–disable</em>, the
device will be set to manual mode and will no longer be automatically
started by the host. This command is only supported for
persistently-defined mediated devices.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-181" class="outline-2">
<h2 id="headline-181">
VIRTUAL NETWORK COMMANDS
</h2>
<div id="outline-text-headline-181" class="outline-text-2">
<p>The following commands manipulate networks. Libvirt has the capability
to define virtual networks which can then be used by domains and linked
to actual network devices. For more detailed information about this
feature see the documentation at
&lt;<a href="https://libvirt.org/formatnetwork.html">https://libvirt.org/formatnetwork.html</a>&gt; . Many of the commands for
virtual networks are similar to the ones used for domains, but the way
to name a virtual network is either by its name or UUID.</p>
<div id="outline-container-headline-182" class="outline-3">
<h3 id="headline-182">
net-autostart
</h3>
<div id="outline-text-headline-182" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-autostart network [--disable]
</pre>
</blockquote>
</blockquote>
<p>
Configure a virtual network to be automatically started at boot. The
<em>–disable</em> option disable autostarting.</p>
</div>
</div>
<div id="outline-container-headline-183" class="outline-3">
<h3 id="headline-183">
net-create
</h3>
<div id="outline-text-headline-183" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-create file [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Create a transient (temporary) virtual network from an XML <em>file</em> and
instantiate (start) the network. See the documentation at
&lt;<a href="https://libvirt.org/formatnetwork.html">https://libvirt.org/formatnetwork.html</a>&gt; to get a description of the XML
network format used by libvirt.</p>
<p>
Optionally, the format of the input XML file can be validated against an
internal RNG schema with <em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-184" class="outline-3">
<h3 id="headline-184">
net-define
</h3>
<div id="outline-text-headline-184" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-define file [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Define an inactive persistent virtual network or modify an existing
persistent one from the XML <em>file</em>. Optionally, the format of the input
XML file can be validated against an internal RNG schema with
<em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-185" class="outline-3">
<h3 id="headline-185">
net-desc
</h3>
<div id="outline-text-headline-185" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-desc network [[--live] [--config] |
   [--current]] [--title] [--edit] [--new-desc
   New description or title message]
</pre>
</blockquote>
</blockquote>
<p>
Show or modify description and title of a network. These values are user
fields that allow storing arbitrary textual data to allow easy
identification of networks. Title should be short, although it&#39;s not
enforced. (See also <strong>net-metadata</strong> that works with XML based network
metadata.)</p>
<p>
Flags <em>–live</em> or <em>–config</em> select whether this command works on live
or persistent definitions of the network. If both <em>–live</em> and
<em>–config</em> are specified, the <em>–config</em> option takes precedence on
getting the current description and both live configuration and config
are updated while setting the description. <em>–current</em> is exclusive and
implied if none of these was specified.</p>
<p>
Flag <em>–edit</em> specifies that an editor with the contents of current
description or title should be opened and the contents saved back
afterwards.</p>
<p>
Flag <em>–title</em> selects operation on the title field instead of
description.</p>
<p>
If neither of <em>–edit</em> and <em>–new-desc</em> are specified the note or
description is displayed instead of being modified.</p>
</div>
</div>
<div id="outline-container-headline-186" class="outline-3">
<h3 id="headline-186">
net-destroy
</h3>
<div id="outline-text-headline-186" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-destroy network
</pre>
</blockquote>
</blockquote>
<p>
Destroy (stop) a given transient or persistent virtual network specified
by its name or UUID. This takes effect immediately.</p>
</div>
</div>
<div id="outline-container-headline-187" class="outline-3">
<h3 id="headline-187">
net-dumpxml
</h3>
<div id="outline-text-headline-187" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-dumpxml [--inactive] [--xpath EXPRESSION] [--wrap] network
</pre>
</blockquote>
</blockquote>
<p>
Output the virtual network information as an XML dump to stdout. If
<em>–inactive</em> is specified, then physical functions are not expanded into
their associated virtual functions.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-188" class="outline-3">
<h3 id="headline-188">
net-edit
</h3>
<div id="outline-text-headline-188" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-edit network
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration file for a network.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh net-dumpxml --inactive network &gt; network.xml
vi network.xml (or make changes with your other text editor)
virsh net-define network.xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-189" class="outline-3">
<h3 id="headline-189">
net-event
</h3>
<div id="outline-text-headline-189" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-event {[network] event [--loop] [--timeout seconds] [--timestamp] | --list}
</pre>
</blockquote>
</blockquote>
<p>
Wait for a class of network events to occur, and print appropriate
details of events as they happen. The events can optionally be filtered
by <em>network</em>. Using <em>–list</em> as the only argument will provide a list of
possible <em>event</em> values known by this client, although the connection
might not allow registering for all these events.</p>
<p>
By default, this command is one-shot, and returns success once an event
occurs; you can send SIGINT (usually via <strong>Ctrl-C</strong>) to quit immediately.
If <em>–timeout</em> is specified, the command gives up waiting for events
after <em>seconds</em> have elapsed. With <em>–loop</em>, the command prints all
events until a timeout or interrupt key.</p>
<p>
When <em>–timestamp</em> is used, a human-readable timestamp will be printed
before the event.</p>
</div>
</div>
<div id="outline-container-headline-190" class="outline-3">
<h3 id="headline-190">
net-info
</h3>
<div id="outline-text-headline-190" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-info network
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the <em>network</em> object.</p>
</div>
</div>
<div id="outline-container-headline-191" class="outline-3">
<h3 id="headline-191">
net-list
</h3>
<div id="outline-text-headline-191" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-list [--inactive | --all]
   { [--table] | --name | --uuid }
   [--persistent] [&lt;--transient&gt;]
   [--autostart] [&lt;--no-autostart&gt;]
   [--title]
</pre>
</blockquote>
</blockquote>
<p>
Returns the list of active networks, if <em>–all</em> is specified this will
also include defined but inactive networks, if <em>–inactive</em> is specified
only the inactive ones will be listed. You may also want to filter the
returned networks by <em>–persistent</em> to list the persistent ones,
<em>–transient</em> to list the transient ones, <em>–autostart</em> to list the ones
with autostart enabled, and <em>–no-autostart</em> to list the ones with
autostart disabled.</p>
<p>
If <em>–name</em> is specified, network names are printed instead of the table
formatted one per line. If <em>–uuid</em> is specified network&#39;s UUID&#39;s are
printed instead of names. Flag <em>–table</em> specifies that the legacy
table-formatted output should be used. This is the default. All of these
are mutually exclusive.</p>
<p>
If <em>–title</em> is specified, then the short network description (title) is
printed in an extra column. This flag is usable only with the default
<em>–table</em> output.</p>
<p>
NOTE: When talking to older servers, this command is forced to use a
series of API calls with an inherent race, where a pool might not be
listed or might appear more than once if it changed state between calls
while the list was being collected. Newer servers do not have this
problem.</p>
</div>
</div>
<div id="outline-container-headline-192" class="outline-3">
<h3 id="headline-192">
net-metadata
</h3>
<div id="outline-text-headline-192" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-metadata network [[--live] [--config] | [--current]]
   [--edit] [uri] [key] [set] [--remove]
</pre>
</blockquote>
</blockquote>
<p>
Show or modify custom XML metadata of a network. The metadata is a user
defined XML that allows storing arbitrary XML data in the network
definition. Multiple separate custom metadata pieces can be stored in
the network XML. The pieces are identified by a private XML namespace
provided via the <em>uri</em> argument. (See also <strong>net-desc</strong> that works with
textual metadata of a network, such as title and description.)</p>
<p>
Flags <em>–live</em> or <em>–config</em> select whether this command works on live
or persistent definitions of the network. If both <em>–live</em> and
<em>–config</em> are specified, the <em>–config</em> option takes precedence on
getting the current description and both live configuration and config
are updated while setting the description. <em>–current</em> is exclusive and
implied if none of these was specified.</p>
<p>
Flag <em>–remove</em> specifies that the metadata element specified by the
<em>uri</em> argument should be removed rather than updated.</p>
<p>
Flag <em>–edit</em> specifies that an editor with the metadata identified by
the <em>uri</em> argument should be opened and the contents saved back
afterwards. Otherwise the new contents can be provided via the <em>set</em>
argument.</p>
<p>
When setting metadata via <em>–edit</em> or <em>set</em> the <em>key</em> argument must be
specified and is used to prefix the custom elements to bind them to the
private namespace.</p>
<p>
If neither of <em>–edit</em> and <em>set</em> are specified the XML metadata
corresponding to the <em>uri</em> namespace is displayed instead of being
modified.</p>
</div>
</div>
<div id="outline-container-headline-193" class="outline-3">
<h3 id="headline-193">
net-name
</h3>
<div id="outline-text-headline-193" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-name network-UUID
</pre>
</blockquote>
</blockquote>
<p>
Convert a network UUID to network name.</p>
</div>
</div>
<div id="outline-container-headline-194" class="outline-3">
<h3 id="headline-194">
net-start
</h3>
<div id="outline-text-headline-194" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-start network
</pre>
</blockquote>
</blockquote>
<p>
Start a (previously defined) inactive network.</p>
</div>
</div>
<div id="outline-container-headline-195" class="outline-3">
<h3 id="headline-195">
net-undefine
</h3>
<div id="outline-text-headline-195" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-undefine network
</pre>
</blockquote>
</blockquote>
<p>
Undefine the configuration for a persistent network. If the network is
active, make it transient.</p>
</div>
</div>
<div id="outline-container-headline-196" class="outline-3">
<h3 id="headline-196">
net-uuid
</h3>
<div id="outline-text-headline-196" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-uuid network-name
</pre>
</blockquote>
</blockquote>
<p>
Convert a network name to network UUID.</p>
</div>
</div>
<div id="outline-container-headline-197" class="outline-3">
<h3 id="headline-197">
net-update
</h3>
<div id="outline-text-headline-197" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-update network command section xml
   [--parent-index index] [[--live] [--config] | [--current]]
</pre>
</blockquote>
</blockquote>
<p>
Update the given section of an existing network definition, with the
changes optionally taking effect immediately, without needing to destroy
and re-start the network.</p>
<p>
<em>command</em> is one of &#34;add-first&#34;, &#34;add-last&#34;, &#34;add&#34; (a synonym for
add-last), &#34;delete&#34;, or &#34;modify&#34;.</p>
<p>
<em>section</em> is one of &#34;bridge&#34;, &#34;domain&#34;, &#34;ip&#34;, &#34;ip-dhcp-host&#34;,
&#34;ip-dhcp-range&#34;, &#34;forward&#34;, &#34;forward-interface&#34;, &#34;forward-pf&#34;,
&#34;portgroup&#34;, &#34;dns-host&#34;, &#34;dns-txt&#34;, or &#34;dns-srv&#34;, each section being
named by a concatenation of the xml element hierarchy leading to the
element being changed. For example, &#34;ip-dhcp-host&#34; will change a &lt;host&gt;
element that is contained inside a &lt;dhcp&gt; element inside an &lt;ip&gt; element
of the network.</p>
<p>
<em>xml</em> is either the text of a complete xml element of the type being
changed (e.g. &#34;&lt;host mac=&#34;00:11:22:33:44:55&#39; ip=&#39;1.2.3.4&#39;/&gt;&#34;, or the
name of a file that contains a complete xml element. Disambiguation is
done by looking at the first character of the provided text - if the
first character is &#34;&lt;&#34;, it is xml text, if the first character is not
&#34;&lt;&#34;, it is the name of a file that contains the xml text to be used.</p>
<p>
The <em>–parent-index</em> option is used to specify which of several parent
elements the requested element is in (0-based). For example, a dhcp
&lt;host&gt; element could be in any one of multiple &lt;ip&gt; elements in the
network; if a parent-index isn&#39;t provided, the &#34;most appropriate&#34; &lt;ip&gt;
element will be selected (usually the only one that already has a &lt;dhcp&gt;
element), but if <em>–parent-index</em> is given, that particular instance of
&lt;ip&gt; will get the modification.</p>
<p>
If <em>–live</em> is specified, affect a running network. If <em>–config</em> is
specified, affect the next startup of a persistent network. If
<em>–current</em> is specified, it is equivalent to either <em>–live</em> or
<em>–config</em>, depending on the current state of the guest. Both <em>–live</em>
and <em>–config</em> flags may be given, but <em>–current</em> is exclusive. Not
specifying any flag is the same as specifying <em>–current</em>.</p>
</div>
</div>
<div id="outline-container-headline-198" class="outline-3">
<h3 id="headline-198">
net-dhcp-leases
</h3>
<div id="outline-text-headline-198" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-dhcp-leases network [mac]
</pre>
</blockquote>
</blockquote>
<p>
Get a list of dhcp leases for all network interfaces connected to the
given virtual <em>network</em> or limited output just for one interface if
<em>mac</em> is specified.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-199" class="outline-2">
<h2 id="headline-199">
NETWORK PORT COMMANDS
</h2>
<div id="outline-text-headline-199" class="outline-text-2">
<p>The following commands manipulate network ports. Libvirt virtual
networks have ports created when a virtual machine has a virtual network
interface added. In general there should be no need to use any of the
commands here, since the hypervisor drivers run these commands are the
right point in a virtual machine&#39;s lifecycle. They can be useful for
debugging problems and / or recovering from bugs / stale state.</p>
<div id="outline-container-headline-200" class="outline-3">
<h3 id="headline-200">
net-port-list
</h3>
<div id="outline-text-headline-200" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-port-list { [--table] | --uuid } network
</pre>
</blockquote>
</blockquote>
<p>
List all network ports recorded against the network.</p>
<p>
If <em>–uuid</em> is specified network ports&#39; UUID&#39;s are printed instead of a
table. Flag <em>–table</em> specifies that the legacy table-formatted output
should be used. This is the default. All of these are mutually
exclusive.</p>
</div>
</div>
<div id="outline-container-headline-201" class="outline-3">
<h3 id="headline-201">
net-port-create
</h3>
<div id="outline-text-headline-201" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-port-create network file [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Allocate a new network port reserving resources based on the port
description. Optionally, the format of the input XML file can be
validated against an internal RNG schema with <em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-202" class="outline-3">
<h3 id="headline-202">
net-port-dumpxml
</h3>
<div id="outline-text-headline-202" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-port-dumpxml [--xpath EXPRESSION] [--wrap] network port
</pre>
</blockquote>
</blockquote>
<p>
Output the network port information as an XML dump to stdout.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-203" class="outline-3">
<h3 id="headline-203">
net-port-delete
</h3>
<div id="outline-text-headline-203" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
net-port-delete network port
</pre>
</blockquote>
</blockquote>
<p>
Delete record of the network port and release its resources</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-204" class="outline-2">
<h2 id="headline-204">
INTERFACE COMMANDS
</h2>
<div id="outline-text-headline-204" class="outline-text-2">
<p>The following commands manipulate host interfaces. Often, these host
interfaces can then be used by name within domain &lt;interface&gt; elements
(such as a system-created bridge interface), but there is no requirement
that host interfaces be tied to any particular guest configuration XML
at all.</p>
<p>
Many of the commands for host interfaces are similar to the ones used
for domains, and the way to name an interface is either by its name or
its MAC address. However, using a MAC address for an <em>iface</em> argument
only works when that address is unique (if an interface and a bridge
share the same MAC address, which is often the case, then using that MAC
address results in an error due to ambiguity, and you must resort to a
name instead).</p>
<div id="outline-container-headline-205" class="outline-3">
<h3 id="headline-205">
iface-bridge
</h3>
<div id="outline-text-headline-205" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-bridge interface bridge [--no-stp] [delay] [--no-start]
</pre>
</blockquote>
</blockquote>
<p>
Create a bridge device named <em>bridge</em>, and attach the existing network
device <em>interface</em> to the new bridge. The new bridge defaults to
starting immediately, with STP enabled and a delay of 0; these settings
can be altered with <em>–no-stp</em>, <em>–no-start</em>, and an integer number of
seconds for <em>delay</em>. All IP address configuration of <em>interface</em> will be
moved to the new bridge device.</p>
<p>
See also <strong>iface-unbridge</strong> for undoing this operation.</p>
</div>
</div>
<div id="outline-container-headline-206" class="outline-3">
<h3 id="headline-206">
iface-define
</h3>
<div id="outline-text-headline-206" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-define file [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Define an inactive persistent physical host interface or modify an
existing persistent one from the XML <em>file</em>. Optionally, the format of
the input XML file can be validated against an internal RNG schema with
<em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-207" class="outline-3">
<h3 id="headline-207">
iface-destroy
</h3>
<div id="outline-text-headline-207" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-destroy interface
</pre>
</blockquote>
</blockquote>
<p>
Destroy (stop) a given host interface, such as by running &#34;if-down&#34; to
disable that interface from active use. This takes effect immediately.</p>
</div>
</div>
<div id="outline-container-headline-208" class="outline-3">
<h3 id="headline-208">
iface-dumpxml
</h3>
<div id="outline-text-headline-208" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-dumpxml [--inactive] [--xpath EXPRESSION] [--wrap] interface
</pre>
</blockquote>
</blockquote>
<p>
Output the host interface information as an XML dump to stdout. If
<em>–inactive</em> is specified, then the output reflects the persistent state
of the interface that will be used the next time it is started.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-209" class="outline-3">
<h3 id="headline-209">
iface-edit
</h3>
<div id="outline-text-headline-209" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-edit interface
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration file for a host interface.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh iface-dumpxml iface &gt; iface.xml
vi iface.xml (or make changes with your other text editor)
virsh iface-define iface.xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-210" class="outline-3">
<h3 id="headline-210">
iface-list
</h3>
<div id="outline-text-headline-210" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-list [--inactive | --all]
</pre>
</blockquote>
</blockquote>
<p>
Returns the list of active host interfaces. If <em>–all</em> is specified this
will also include defined but inactive interfaces. If <em>–inactive</em> is
specified only the inactive ones will be listed.</p>
</div>
</div>
<div id="outline-container-headline-211" class="outline-3">
<h3 id="headline-211">
iface-name
</h3>
<div id="outline-text-headline-211" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-name interface
</pre>
</blockquote>
</blockquote>
<p>
Convert a host interface MAC to interface name, if the MAC address is
unique among the host&#39;s interfaces.</p>
<p>
<em>interface</em> specifies the interface MAC address.</p>
</div>
</div>
<div id="outline-container-headline-212" class="outline-3">
<h3 id="headline-212">
iface-mac
</h3>
<div id="outline-text-headline-212" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-mac interface
</pre>
</blockquote>
</blockquote>
<p>
Convert a host interface name to MAC address.</p>
<p>
<em>interface</em> specifies the interface name.</p>
</div>
</div>
<div id="outline-container-headline-213" class="outline-3">
<h3 id="headline-213">
iface-start
</h3>
<div id="outline-text-headline-213" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-start interface
</pre>
</blockquote>
</blockquote>
<p>
Start a (previously defined) host interface, such as by running &#34;if-up&#34;.</p>
</div>
</div>
<div id="outline-container-headline-214" class="outline-3">
<h3 id="headline-214">
iface-unbridge
</h3>
<div id="outline-text-headline-214" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-unbridge bridge [--no-start]
</pre>
</blockquote>
</blockquote>
<p>
Tear down a bridge device named <em>bridge</em>, releasing its underlying
interface back to normal usage, and moving all IP address configuration
from the bridge device to the underlying device. The underlying
interface is restarted unless <em>–no-start</em> is present; this flag is
present for symmetry, but generally not recommended.</p>
<p>
See also <strong>iface-bridge</strong> for creating a bridge.</p>
</div>
</div>
<div id="outline-container-headline-215" class="outline-3">
<h3 id="headline-215">
iface-undefine
</h3>
<div id="outline-text-headline-215" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-undefine interface
</pre>
</blockquote>
</blockquote>
<p>
Undefine the configuration for an inactive host interface.</p>
</div>
</div>
<div id="outline-container-headline-216" class="outline-3">
<h3 id="headline-216">
iface-begin
</h3>
<div id="outline-text-headline-216" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-begin
</pre>
</blockquote>
</blockquote>
<p>
Create a snapshot of current host interface settings, which can later be
committed (<em>iface-commit</em>) or restored (<em>iface-rollback</em>). If a snapshot
already exists, then this command will fail until the previous snapshot
has been committed or restored. Undefined behavior results if any
external changes are made to host interfaces outside of the libvirt API
between the beginning of a snapshot and its eventual commit or rollback.</p>
</div>
</div>
<div id="outline-container-headline-217" class="outline-3">
<h3 id="headline-217">
iface-commit
</h3>
<div id="outline-text-headline-217" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-commit
</pre>
</blockquote>
</blockquote>
<p>
Declare all changes since the last <em>iface-begin</em> as working, and delete
the rollback point. If no interface snapshot has already been started,
then this command will fail.</p>
</div>
</div>
<div id="outline-container-headline-218" class="outline-3">
<h3 id="headline-218">
iface-rollback
</h3>
<div id="outline-text-headline-218" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
iface-rollback
</pre>
</blockquote>
</blockquote>
<p>
Revert all host interface settings back to the state recorded in the
last <em>iface-begin</em>. If no interface snapshot has already been started,
then this command will fail. Rebooting the host also serves as an
implicit rollback point.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-219" class="outline-2">
<h2 id="headline-219">
STORAGE POOL COMMANDS
</h2>
<div id="outline-text-headline-219" class="outline-text-2">
<p>The following commands manipulate storage pools. Libvirt has the
capability to manage various storage solutions, including files, raw
partitions, and domain-specific formats, used to provide the storage
volumes visible as devices within virtual machines. For more detailed
information about this feature, see the documentation at
&lt;<a href="https://libvirt.org/formatstorage.html">https://libvirt.org/formatstorage.html</a>&gt; . Many of the commands for
pools are similar to the ones used for domains.</p>
<div id="outline-container-headline-220" class="outline-3">
<h3 id="headline-220">
find-storage-pool-sources
</h3>
<div id="outline-text-headline-220" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
find-storage-pool-sources type [srcSpec]
</pre>
</blockquote>
</blockquote>
<p>
Returns XML describing all possible available storage pool sources that
could be used to create or define a storage pool of a given <em>type</em>. If
<em>srcSpec</em> is provided, it is a file that contains XML to further
restrict the query for pools.</p>
<p>
Not all storage pools support discovery in this manner. Furthermore, for
those that do support discovery, only specific XML elements are required
in order to return valid data, while other elements and even attributes
of some elements are ignored since they are not necessary to find the
pool based on the search criteria. The following lists the supported
<em>type</em> options and the expected minimal XML elements used to perform the
search.</p>
<p>
For a &#34;netfs&#34; or &#34;gluster&#34; pool, the minimal expected XML required is
the &lt;host&gt; element with a &#34;name&#34; attribute describing the IP address or
hostname to be used to find the pool. The &#34;port&#34; attribute will be
ignored as will any other provided XML elements in <em>srcSpec</em>.</p>
<p>
For a &#34;logical&#34; pool, the contents of the <em>srcSpec</em> file are ignored,
although if provided the file must at least exist.</p>
<p>
For an &#34;iscsi&#34; or &#34;iscsi-direct&#34; pool, the minimal expect XML required
is the &lt;host&gt; element with a &#34;name&#34; attribute describing the IP address
or hostname to be used to find the pool (the iSCSI server address).
Optionally, the &#34;port&#34; attribute may be provided, although it will
default to 3260. Optionally, an &lt;initiator&gt; XML element with a &#34;name&#34;
attribute may be provided to further restrict the iSCSI target search to
a specific initiator for multi-iqn iSCSI storage pools.</p>
</div>
</div>
<div id="outline-container-headline-221" class="outline-3">
<h3 id="headline-221">
find-pool-sources-as
</h3>
<div id="outline-text-headline-221" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
find-storage-pool-sources-as type [host] [port] [initiator]
</pre>
</blockquote>
</blockquote>
<p>
Rather than providing <em>srcSpec</em> XML file for <strong>find-storage-pool-sources</strong>
use this command option in order to have virsh generate the query XML
file using the optional arguments. The command will return the same
output XML as <strong>find-storage-pool-sources</strong>.</p>
<p>
Use <em>host</em> to describe a specific host to use for networked storage,
such as netfs, gluster, and iscsi <em>type</em> pools.</p>
<p>
Use <em>port</em> to further restrict which networked port to utilize for the
connection if required by the specific storage backend, such as iscsi.</p>
<p>
Use <em>initiator</em> to further restrict the iscsi <em>type</em> pool searches to
specific target initiators.</p>
</div>
</div>
<div id="outline-container-headline-222" class="outline-3">
<h3 id="headline-222">
pool-autostart
</h3>
<div id="outline-text-headline-222" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-autostart pool-or-uuid [--disable]
</pre>
</blockquote>
</blockquote>
<p>
Configure whether <em>pool</em> should automatically start at boot.</p>
</div>
</div>
<div id="outline-container-headline-223" class="outline-3">
<h3 id="headline-223">
pool-build
</h3>
<div id="outline-text-headline-223" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-build pool-or-uuid [--overwrite] [--no-overwrite]
</pre>
</blockquote>
</blockquote>
<p>
Build a given pool.</p>
<p>
Options <em>–overwrite</em> and <em>–no-overwrite</em> can only be used for
<strong>pool-build</strong> a filesystem, disk, or logical pool.</p>
<p>
For a file system pool if neither flag is specified, then <strong>pool-build</strong>
just makes the target path directory and no attempt to run mkfs on the
target volume device. If <em>–no-overwrite</em> is specified, it probes to
determine if a filesystem already exists on the target device, returning
an error if one exists or using mkfs to format the target device if not.
If <em>–overwrite</em> is specified, mkfs is always executed and any existing
data on the target device is overwritten unconditionally.</p>
<p>
For a disk pool, if neither of them is specified or <em>–no-overwrite</em> is
specified, <strong>pool-build</strong> will check the target volume device for existing
filesystems or partitions before attempting to write a new label on the
target volume device. If the target volume device already has a label,
the command will fail. If <em>–overwrite</em> is specified, then no check will
be made on the target volume device prior to writing a new label.
Writing of the label uses the pool source format type or &#34;dos&#34; if not
specified.</p>
<p>
For a logical pool, if neither of them is specified or <em>–no-overwrite</em>
is specified, <strong>pool-build</strong> will check the target volume devices for
existing filesystems or partitions before attempting to initialize and
format each device for usage by the logical pool. If any target volume
device already has a label, the command will fail. If <em>–overwrite</em> is
specified, then no check will be made on the target volume devices prior
to initializing and formatting each device. Once all the target volume
devices are properly formatted via pvcreate, the volume group will be
created using all the devices.</p>
</div>
</div>
<div id="outline-container-headline-224" class="outline-3">
<h3 id="headline-224">
pool-create
</h3>
<div id="outline-text-headline-224" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-create file [--build] [[--overwrite] | [--no-overwrite]]
</pre>
</blockquote>
</blockquote>
<p>
Create and start a pool object from the XML <em>file</em>.</p>
<p>
[/–build/] <a href="/--overwrite/] | [/--no-overwrite/">/--overwrite/] | [/--no-overwrite/</a> perform a
<strong>pool-build</strong> after creation in order to remove the need for a follow-up
command to build the pool. The <em>–overwrite</em> and <em>–no-overwrite</em> flags
follow the same rules as <strong>pool-build</strong>. If just <em>–build</em> is provided,
then <strong>pool-build</strong> is called with no flags.</p>
</div>
</div>
<div id="outline-container-headline-225" class="outline-3">
<h3 id="headline-225">
pool-create-as
</h3>
<div id="outline-text-headline-225" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-create-as name type
   [--source-host hostname] [--source-path path] [--source-dev path]
   [--source-name name] [--target path] [--source-format format]
   [--source-initiator initiator-iqn]
   [--auth-type authtype --auth-username username
   [--secret-usage usage | --secret-uuid uuid]]
   [--source-protocol-ver ver]
   [[--adapter-name name] | [--adapter-wwnn wwnn --adapter-wwpn wwpn]
   [--adapter-parent parent |
   --adapter-parent-wwnn parent_wwnn adapter-parent-wwpn parent_wwpn |
   --adapter-parent-fabric-wwn parent_fabric_wwn]]
   [--build] [[--overwrite] | [--no-overwrite]] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Create and start a pool object <em>name</em> from the raw parameters. If
<em>–print-xml</em> is specified, then print the XML of the pool object
without creating the pool. Otherwise, the pool has the specified <em>type</em>.
When using <strong>pool-create-as</strong> for a pool of <em>type</em> &#34;disk&#34;, the existing
partitions found on the <em>–source-dev path</em> will be used to populate the
disk pool. Therefore, it is suggested to use <strong>pool-define-as</strong> and
<strong>pool-build</strong> with the <em>–overwrite</em> in order to properly initialize the
disk pool.</p>
<p>
[/–source-host hostname/] provides the source hostname for pools backed
by storage from a remote server (pool types netfs, iscsi, rbd, sheepdog,
gluster).</p>
<p>
[/–source-path path/] provides the source directory path for pools
backed by directories (pool type dir).</p>
<p>
[/–source-dev path/] provides the source path for pools backed by
physical devices (pool types fs, logical, disk, iscsi, zfs).</p>
<p>
[/–source-name name/] provides the source name for pools backed by
storage from a named element (pool types logical, rbd, sheepdog,
gluster).</p>
<p>
[/–target path/] is the path for the mapping of the storage pool into
the host file system.</p>
<p>
[/–source-format format/] provides information about the format of the
pool (pool types fs, netfs, disk, logical).</p>
<p>
[/–source-initiator initiator-iqn/] provides the initiator iqn for
iscsi connection of the pool (pool type iscsi-direct).</p>
<p>
[/–auth-type authtype/ <em>–auth-username username</em> [/–secret-usage
usage/ | <em>–secret-uuid uuid/]] provides the elements required to
generate authentication credentials for the storage pool. The /authtype</em>
is either chap for iscsi <em>type</em> pools or ceph for rbd <em>type</em> pools.
Either the secret <em>usage</em> or <em>uuid</em> value may be provided, but not both.</p>
<p>
[/–source-protocol-ver ver/] provides the NFS protocol version number
used to contact the server&#39;s NFS service via nfs mount option
&#39;nfsvers=n&#39;. It is expect the <em>ver</em> value is an unsigned integer.</p>
<p>
[/–adapter-name name/] defines the scsi_hostN adapter name to be used
for the scsi_host adapter type pool.</p>
<p>
[/–adapter-wwnn wwnn/ <em>–adapter-wwpn wwpn</em> [/–adapter-parent parent/
​| <em>–adapter-parent-wwnn parent_wwnn</em> <em>adapter-parent-wwpn parent_wwpn</em>
​| /–adapter-parent-fabric-wwn parent_fabric_wwn/]] defines the wwnn and
wwpn to be used for the fc_host adapter type pool. Optionally provide
the parent scsi_hostN node device to be used for the vHBA either by
parent name, parent_wwnn and parent_wwpn, or parent_fabric_wwn. The
parent name could change between reboots if the hardware environment
changes, so providing the parent_wwnn and parent_wwpn ensure usage of
the same physical HBA even if the scsi_hostN node device changes. Usage
of the parent_fabric_wwn allows a bit more flexibility to choose an HBA
on the same storage fabric in order to define the pool.</p>
<p>
[/–build/] <a href="/--overwrite/] | [/--no-overwrite/">/--overwrite/] | [/--no-overwrite/</a> perform a
<strong>pool-build</strong> after creation in order to remove the need for a follow-up
command to build the pool. The <em>–overwrite</em> and <em>–no-overwrite</em> flags
follow the same rules as <strong>pool-build</strong>. If just <em>–build</em> is provided,
then <strong>pool-build</strong> is called with no flags.</p>
<p>
For a &#34;logical&#34; pool only [/–name/] needs to be provided. The
[/–source-name/] if provided must match the Volume Group name. If not
provided, one will be generated using the [/–name/]. If provided the
[/–target/] is ignored and a target source is generated using the
[/–source-name/] (or as generated from the [/–name/]).</p>
</div>
</div>
<div id="outline-container-headline-226" class="outline-3">
<h3 id="headline-226">
pool-define
</h3>
<div id="outline-text-headline-226" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-define file [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Define an inactive persistent storage pool or modify an existing
persistent one from the XML <em>file</em>. Optionally, the format of the input
XML file can be validated against an internal RNG schema with
<em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-227" class="outline-3">
<h3 id="headline-227">
pool-define-as
</h3>
<div id="outline-text-headline-227" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-define-as name type
   [--source-host hostname] [--source-path path] [--source-dev path]
   [*--source-name name*] [*--target path*] [*--source-format format*]
   [--source-initiator initiator-iqn]
   [*--auth-type authtype* *--auth-username username*
   [*--secret-usage usage* | *--secret-uuid uuid*]]
   [*--source-protocol-ver ver*]
   [[*--adapter-name name*] | [*--adapter-wwnn* *--adapter-wwpn*]
   [*--adapter-parent parent*]] [*--print-xml*]
</pre>
</blockquote>
</blockquote>
<p>
Create, but do not start, a pool object <em>name</em> from the raw parameters.
If <em>–print-xml</em> is specified, then print the XML of the pool object
without defining the pool. Otherwise, the pool has the specified <em>type</em>.</p>
<p>
Use the same arguments as <strong>pool-create-as</strong>, except for the <em>–build</em>,
<em>–overwrite</em>, and <em>–no-overwrite</em> options.</p>
</div>
</div>
<div id="outline-container-headline-228" class="outline-3">
<h3 id="headline-228">
pool-destroy
</h3>
<div id="outline-text-headline-228" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-destroy pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Destroy (stop) a given <em>pool</em> object. Libvirt will no longer manage the
storage described by the pool object, but the raw data contained in the
pool is not changed, and can be later recovered with <strong>pool-create</strong>.</p>
</div>
</div>
<div id="outline-container-headline-229" class="outline-3">
<h3 id="headline-229">
pool-delete
</h3>
<div id="outline-text-headline-229" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-delete pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Destroy the resources used by a given <em>pool</em> object. This operation is
non-recoverable. The <em>pool</em> object will still exist after this command,
ready for the creation of new storage volumes.</p>
</div>
</div>
<div id="outline-container-headline-230" class="outline-3">
<h3 id="headline-230">
pool-dumpxml
</h3>
<div id="outline-text-headline-230" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-dumpxml [--inactive] [--xpath EXPRESSION] [--wrap] pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Returns the XML information about the <em>pool</em> object. <em>–inactive</em> tells
virsh to dump pool configuration that will be used on next start of the
pool as opposed to the current pool configuration.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-231" class="outline-3">
<h3 id="headline-231">
pool-edit
</h3>
<div id="outline-text-headline-231" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-edit pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration file for a storage pool.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh pool-dumpxml pool &gt; pool.xml
vi pool.xml (or make changes with your other text editor)
virsh pool-define pool.xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-232" class="outline-3">
<h3 id="headline-232">
pool-info
</h3>
<div id="outline-text-headline-232" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-info [--bytes] pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the <em>pool</em> object. If <em>–bytes</em> is
specified the sizes of basic info are not converted to human friendly
units.</p>
</div>
</div>
<div id="outline-container-headline-233" class="outline-3">
<h3 id="headline-233">
pool-list
</h3>
<div id="outline-text-headline-233" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-list [--inactive] [--all]
   [--persistent] [--transient]
   [--autostart] [--no-autostart]
   [[--details] [--uuid]
   [--name] [&lt;type&gt;]
</pre>
</blockquote>
</blockquote>
<p>
List pool objects known to libvirt. By default, only active pools are
listed; <em>–inactive</em> lists just the inactive pools, and <em>–all</em> lists
all pools.</p>
<p>
In addition, there are several sets of filtering flags. <em>–persistent</em>
is to list the persistent pools, <em>–transient</em> is to list the transient
pools. <em>–autostart</em> lists the autostarting pools, <em>–no-autostart</em>
lists the pools with autostarting disabled. If <em>–uuid</em> is specified
only pool&#39;s UUIDs are printed. If <em>–name</em> is specified only pool&#39;s
names are printed. If both <em>–name</em> and <em>–uuid</em> are specified, pool&#39;s
UUID and names are printed side by side without any header. Option
<em>–details</em> is mutually exclusive with options <em>–uuid</em> and <em>–name</em>.</p>
<p>
You may also want to list pools with specified types using <em>type</em>, the
pool types must be separated by comma, e.g. –type dir,disk. The valid
pool types include &#39;dir&#39;, &#39;fs&#39;, &#39;netfs&#39;, &#39;logical&#39;, &#39;disk&#39;, &#39;iscsi&#39;,
&#39;scsi&#39;, &#39;mpath&#39;, &#39;rbd&#39;, &#39;sheepdog&#39;, &#39;gluster&#39;, &#39;zfs&#39;, &#39;vstorage&#39; and
&#39;iscsi-direct&#39;.</p>
<p>
The <em>–details</em> option instructs virsh to additionally display pool
persistence and capacity related information where available.</p>
<p>
NOTE: When talking to older servers, this command is forced to use a
series of API calls with an inherent race, where a pool might not be
listed or might appear more than once if it changed state between calls
while the list was being collected. Newer servers do not have this
problem.</p>
</div>
</div>
<div id="outline-container-headline-234" class="outline-3">
<h3 id="headline-234">
pool-name
</h3>
<div id="outline-text-headline-234" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-name uuid
</pre>
</blockquote>
</blockquote>
<p>
Convert the <em>uuid</em> to a pool name.</p>
</div>
</div>
<div id="outline-container-headline-235" class="outline-3">
<h3 id="headline-235">
pool-refresh
</h3>
<div id="outline-text-headline-235" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-refresh pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Refresh the list of volumes contained in <em>pool</em>.</p>
</div>
</div>
<div id="outline-container-headline-236" class="outline-3">
<h3 id="headline-236">
pool-start
</h3>
<div id="outline-text-headline-236" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-start pool-or-uuid [--build] [[--overwrite] | [--no-overwrite]]
</pre>
</blockquote>
</blockquote>
<p>
Start the storage <em>pool</em>, which is previously defined but inactive.</p>
<p>
[/–build/] <a href="/--overwrite/] | [/--no-overwrite/">/--overwrite/] | [/--no-overwrite/</a> perform a
<strong>pool-build</strong> prior to <strong>pool-start</strong> to ensure the pool environment is in
an expected state rather than needing to run the build command prior to
startup. The <em>–overwrite</em> and <em>–no-overwrite</em> flags follow the same
rules as <strong>pool-build</strong>. If just <em>–build</em> is provided, then <strong>pool-build</strong>
is called with no flags.</p>
<p>
<strong>Note</strong>: A storage pool that relies on remote resources such as an
&#34;iscsi&#34; or a (v)HBA backed &#34;scsi&#34; pool may need to be refreshed multiple
times in order to have all the volumes detected (see <strong>pool-refresh</strong>).
This is because the corresponding volume devices may not be present in
the host&#39;s filesystem during the initial pool startup or the current
refresh attempt. The number of refresh retries is dependent upon the
network connection and the time the host takes to export the
corresponding devices.</p>
</div>
</div>
<div id="outline-container-headline-237" class="outline-3">
<h3 id="headline-237">
pool-undefine
</h3>
<div id="outline-text-headline-237" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-undefine pool-or-uuid
</pre>
</blockquote>
</blockquote>
<p>
Undefine the configuration for an inactive <em>pool</em>.</p>
</div>
</div>
<div id="outline-container-headline-238" class="outline-3">
<h3 id="headline-238">
pool-uuid
</h3>
<div id="outline-text-headline-238" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-uuid pool
</pre>
</blockquote>
</blockquote>
<p>
Returns the UUID of the named <em>pool</em>.</p>
</div>
</div>
<div id="outline-container-headline-239" class="outline-3">
<h3 id="headline-239">
pool-event
</h3>
<div id="outline-text-headline-239" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
pool-event {[pool] event [--loop] [--timeout seconds] [--timestamp] | --list}
</pre>
</blockquote>
</blockquote>
<p>
Wait for a class of storage pool events to occur, and print appropriate
details of events as they happen. The events can optionally be filtered
by <em>pool</em>. Using <em>–list</em> as the only argument will provide a list of
possible <em>event</em> values known by this client, although the connection
might not allow registering for all these events.</p>
<p>
By default, this command is one-shot, and returns success once an event
occurs; you can send SIGINT (usually via <strong>Ctrl-C</strong>) to quit immediately.
If <em>–timeout</em> is specified, the command gives up waiting for events
after <em>seconds</em> have elapsed. With <em>–loop</em>, the command prints all
events until a timeout or interrupt key.</p>
<p>
When <em>–timestamp</em> is used, a human-readable timestamp will be printed
before the event.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-240" class="outline-2">
<h2 id="headline-240">
VOLUME COMMANDS
</h2>
<div id="outline-text-headline-240" class="outline-text-2">
<div id="outline-container-headline-241" class="outline-3">
<h3 id="headline-241">
vol-create
</h3>
<div id="outline-text-headline-241" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-create pool-or-uuid FILE [--prealloc-metadata] [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Create a volume from an XML &lt;file&gt;.</p>
<p>
<em>pool-or-uuid</em> is the name or UUID of the storage pool to create the
volume in.</p>
<p>
<em>FILE</em> is the XML &lt;file&gt; with the volume definition. An easy way to
create the XML &lt;file&gt; is to use the <strong>vol-dumpxml</strong> command to obtain the
definition of a pre-existing volume.</p>
<p>
[/–prealloc-metadata/] preallocate metadata (for qcow2 images which
don&#39;t support full allocation). This option creates a sparse image file
with metadata, resulting in higher performance compared to images with
no preallocation and only slightly higher initial disk space usage.</p>
<p>
If <em>–validate</em> is specified, validates the format of the XML document
against an internal RNG schema.</p>
<p>
<strong>Example:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
virsh vol-dumpxml --pool storagepool1 appvolume1 &gt; newvolume.xml
vi newvolume.xml (or make changes with your other text editor)
virsh vol-create differentstoragepool newvolume.xml
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-242" class="outline-3">
<h3 id="headline-242">
vol-create-from
</h3>
<div id="outline-text-headline-242" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-create-from pool-or-uuid FILE vol-name-or-key-or-path
   [--inputpool pool-or-uuid]  [--prealloc-metadata] [--reflink] [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Create a volume, using another volume as input.</p>
<p>
<em>pool-or-uuid</em> is the name or UUID of the storage pool to create the
volume in.</p>
<p>
<em>FILE</em> is the XML &lt;file&gt; with the volume definition.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the source
volume.</p>
<p>
<em>–inputpool</em> <em>pool-or-uuid</em> is the name or uuid of the storage pool the
source volume is in.</p>
<p>
[/–prealloc-metadata/] preallocate metadata (for qcow2 images which
don&#39;t support full allocation). This option creates a sparse image file
with metadata, resulting in higher performance compared to images with
no preallocation and only slightly higher initial disk space usage.</p>
<p>
When <em>–reflink</em> is specified, perform a COW lightweight copy, where the
data blocks are copied only when modified. If this is not possible, the
copy fails.</p>
<p>
If <em>–validate</em> is specified, validates the format of the XML document
against an internal RNG schema.</p>
</div>
</div>
<div id="outline-container-headline-243" class="outline-3">
<h3 id="headline-243">
vol-create-as
</h3>
<div id="outline-text-headline-243" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-create-as pool-or-uuid name capacity [--allocation size] [--format string]
   [--backing-vol vol-name-or-key-or-path]
   [--backing-vol-format string] [--prealloc-metadata] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Create a volume from a set of arguments unless <em>–print-xml</em> is
specified, in which case just the XML of the volume object is printed
out without any actual object creation.</p>
<p>
<em>pool-or-uuid</em> is the name or UUID of the storage pool to create the
volume in.</p>
<p>
<em>name</em> is the name of the new volume. For a disk pool, this must match
the partition name as determined from the pool&#39;s source device path and
the next available partition. For example, a source device path of
/dev/sdb and there are no partitions on the disk, then the name must be
sdb1 with the next name being sdb2 and so on.</p>
<p>
<em>capacity</em> is the size of the volume to be created, as a scaled integer
(see <strong>NOTES</strong> above), defaulting to bytes if there is no suffix.</p>
<p>
<em>–allocation</em> <em>size</em> is the initial size to be allocated in the volume,
also as a scaled integer defaulting to bytes.</p>
<p>
<em>–format</em> <em>string</em> is used in file based storage pools to specify the
volume file format to use; raw, bochs, qcow, qcow2, vmdk, qed. Use
extended for disk storage pools in order to create an extended partition
(other values are validity checked but not preserved when libvirtd is
restarted or the pool is refreshed).</p>
<p>
<em>–backing-vol</em> <em>vol-name-or-key-or-path</em> is the source backing volume
to be used if taking a snapshot of an existing volume.</p>
<p>
<em>–backing-vol-format</em> <em>string</em> is the format of the snapshot backing
volume; raw, bochs, qcow, qcow2, qed, vmdk, host_device. These are,
however, meant for file based storage pools.</p>
<p>
[/–prealloc-metadata/] preallocate metadata (for qcow2 images which
don&#39;t support full allocation). This option creates a sparse image file
with metadata, resulting in higher performance compared to images with
no preallocation and only slightly higher initial disk space usage.</p>
</div>
</div>
<div id="outline-container-headline-244" class="outline-3">
<h3 id="headline-244">
vol-clone
</h3>
<div id="outline-text-headline-244" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-clone vol-name-or-key-or-path name
   [--pool pool-or-uuid] [--prealloc-metadata] [--reflink] [--print-xml]
</pre>
</blockquote>
</blockquote>
<p>
Clone an existing volume within the parent pool. Less powerful, but
easier to type, version of <strong>vol-create-from</strong>.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the source
volume.</p>
<p>
<em>name</em> is the name of the new volume.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool that
contains the source volume and will contain the new volume. If the
source volume name is provided instead of the key or path, then
providing the pool is necessary to find the volume to be cloned;
otherwise, the first volume found by the key or path will be used.</p>
<p>
[/–prealloc-metadata/] preallocate metadata (for qcow2 images which
don&#39;t support full allocation). This option creates a sparse image file
with metadata, resulting in higher performance compared to images with
no preallocation and only slightly higher initial disk space usage.</p>
<p>
When <em>–reflink</em> is specified, perform a COW lightweight copy, where the
data blocks are copied only when modified. If this is not possible, the
copy fails.</p>
<p>
If <em>–print-xml</em> is specified, then the XML used to clone the volume is
printed instead.</p>
</div>
</div>
<div id="outline-container-headline-245" class="outline-3">
<h3 id="headline-245">
vol-delete
</h3>
<div id="outline-text-headline-245" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-delete vol-name-or-key-or-path [--pool pool-or-uuid] [--delete-snapshots]
</pre>
</blockquote>
</blockquote>
<p>
Delete a given volume.</p>
<p>
<em>vol-name-or-key-or-path</em> is the volume name or key or path of the
volume to delete.</p>
<p>
[/–pool/ /pool-or-uuid/] is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be deleted;
otherwise, the first volume found by the key or path will be used.</p>
<p>
The <em>–delete-snapshots</em> flag specifies that any snapshots associated
with the storage volume should be deleted as well. Not all storage
drivers support this option, presently only rbd.</p>
</div>
</div>
<div id="outline-container-headline-246" class="outline-3">
<h3 id="headline-246">
vol-upload
</h3>
<div id="outline-text-headline-246" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-upload vol-name-or-key-or-path local-file
   [--pool pool-or-uuid] [--offset bytes]
   [--length bytes] [--sparse]
</pre>
</blockquote>
</blockquote>
<p>
Upload the contents of <em>local-file</em> to a storage volume.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the volume where
the <em>local-file</em> will be uploaded.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be uploaded
into; otherwise, the first volume found by the key or path will be used.</p>
<p>
<em>–offset</em> is the position in the storage volume at which to start
writing the data. The value must be 0 or larger.</p>
<p>
<em>–length</em> is an upper bound of the amount of data to be uploaded. A
negative value is interpreted as an unsigned long long value to
essentially include everything from the offset to the end of the volume.</p>
<p>
If <em>–sparse</em> is specified, this command will preserve volume
sparseness.</p>
<p>
An error will occur if the <em>local-file</em> is greater than the specified
<em>length</em>.</p>
<p>
See the description for the libvirt virStorageVolUpload API for details
regarding possible target volume and pool changes as a result of the
pool refresh when the upload is attempted.</p>
</div>
</div>
<div id="outline-container-headline-247" class="outline-3">
<h3 id="headline-247">
vol-download
</h3>
<div id="outline-text-headline-247" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-download vol-name-or-key-or-path local-file
   [--pool pool-or-uuid] [--offset bytes] [--length bytes]
   [--sparse]
</pre>
</blockquote>
</blockquote>
<p>
Download the contents of a storage volume to <em>local-file</em>.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the volume to
download into <em>local-file</em>.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be uploaded
into; otherwise, the first volume found by the key or path will be used.</p>
<p>
<em>–offset</em> is the position in the storage volume at which to start
reading the data. The value must be 0 or larger.</p>
<p>
<em>–length</em> is an upper bound of the amount of data to be downloaded. A
negative value is interpreted as an unsigned long long value to
essentially include everything from the offset to the end of the volume.</p>
<p>
If <em>–sparse</em> is specified, this command will preserve volume
sparseness.</p>
</div>
</div>
<div id="outline-container-headline-248" class="outline-3">
<h3 id="headline-248">
vol-wipe
</h3>
<div id="outline-text-headline-248" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-wipe vol-name-or-key-or-path [--pool pool-or-uuid] [--algorithm algorithm]
</pre>
</blockquote>
</blockquote>
<p>
Wipe a volume, ensure data previously on the volume is not accessible to
future reads.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the volume to
wipe. It is possible to choose different wiping algorithms instead of
re-writing volume with zeroes.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be wiped;
otherwise, the first volume found by the key or path will be used.</p>
<p>
Use the <em>–algorithm</em> switch choosing from the list of the following
algorithms in order to define which algorithm to use for the wipe.</p>
<p>
<strong>Supported algorithms</strong></p>
<blockquote>
<ul>
<li>zero - 1-pass all zeroes</li>
<li>nnsa - 4-pass NNSA Policy Letter NAP-14.1-C (XVI-8) for sanitizing
removable and non-removable hard disks: random x2, 0x00, verify.</li>
<li>dod - 4-pass DoD 5220.22-M section 8-306 procedure for sanitizing
removable and non-removable rigid disks: random, 0x00, 0xff, verify.</li>
<li>bsi - 9-pass method recommended by the German Center of Security in
Information Technologies ( &lt;<a href="https://www.bsi.bund.de">https://www.bsi.bund.de</a>&gt; ): 0xff, 0xfe,
0xfd, 0xfb, 0xf7, 0xef, 0xdf, 0xbf, 0x7f.</li>
<li>gutmann - The canonical 35-pass sequence described in Gutmann&#39;s paper.</li>
<li>schneier - 7-pass method described by Bruce Schneier in &#34;Applied
Cryptography&#34; (1996): 0x00, 0xff, random x5.</li>
<li>pfitzner7 - Roy Pfitzner&#39;s 7-random-pass method: random x7.</li>
<li>pfitzner33 - Roy Pfitzner&#39;s 33-random-pass method: random x33.</li>
<li>random - 1-pass pattern: random.</li>
<li>trim - 1-pass trimming the volume using TRIM or DISCARD</li>
</ul>
</blockquote>
<p>
<strong>Note</strong>: The <strong>scrub</strong> binary will be used to handle the &#39;nnsa&#39;, &#39;dod&#39;,
&#39;bsi&#39;, &#39;gutmann&#39;, &#39;schneier&#39;, &#39;pfitzner7&#39; and &#39;pfitzner33&#39; algorithms.
The availability of the algorithms may be limited by the version of the
<strong>scrub</strong> binary installed on the host. The &#39;zero&#39; algorithm will write
zeroes to the entire volume. For some volumes, such as sparse or rbd
volumes, this may result in completely filling the volume with zeroes
making it appear to be completely full. As an alternative, the &#39;trim&#39;
algorithm does not overwrite all the data in a volume, rather it expects
the storage driver to be able to discard all bytes in a volume. It is up
to the storage driver to handle how the discarding occurs. Not all
storage drivers or volume types can support &#39;trim&#39;.</p>
</div>
</div>
<div id="outline-container-headline-249" class="outline-3">
<h3 id="headline-249">
vol-dumpxml
</h3>
<div id="outline-text-headline-249" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-dumpxml [--pool pool-or-uuid] [--xpath EXPRESSION] [--wrap]
            vol-name-or-key-or-path
</pre>
</blockquote>
</blockquote>
<p>
Output the volume information as an XML dump to stdout.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the volume to
output the XML.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be uploaded
into; otherwise, the first volume found by the key or path will be used.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-250" class="outline-3">
<h3 id="headline-250">
vol-info
</h3>
<div id="outline-text-headline-250" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-info vol-name-or-key-or-path [--pool pool-or-uuid] [--bytes] [--physical]
</pre>
</blockquote>
</blockquote>
<p>
Returns basic information about the given storage volume.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the volume to
return information for.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be uploaded
into; otherwise, the first volume found by the key or path will be used.</p>
<p>
If <em>–bytes</em> is specified the sizes are not converted to human friendly
units.</p>
<p>
If <em>–physical</em> is specified, then the host physical size is returned
and displayed instead of the allocation value. The physical value for
some file types, such as qcow2 may have a different (larger) physical
value than is shown for allocation. Additionally sparse files will have
different physical and allocation values.</p>
</div>
</div>
<div id="outline-container-headline-251" class="outline-3">
<h3 id="headline-251">
vol-list
</h3>
<div id="outline-text-headline-251" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-list [--pool pool-or-uuid] [--details]
</pre>
</blockquote>
</blockquote>
<p>
Return the list of volumes in the given storage pool.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool.</p>
<p>
The <em>–details</em> option instructs virsh to additionally display volume
type and capacity related information where available.</p>
</div>
</div>
<div id="outline-container-headline-252" class="outline-3">
<h3 id="headline-252">
vol-pool
</h3>
<div id="outline-text-headline-252" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-pool vol-key-or-path [--uuid]
</pre>
</blockquote>
</blockquote>
<p>
Return the pool name or UUID for a given volume. By default, the pool
name is returned.</p>
<p>
<em>vol-key-or-path</em> is the key or path of the volume to return the pool
information.</p>
<p>
If the <em>–uuid</em> option is given, the pool UUID is returned instead.</p>
</div>
</div>
<div id="outline-container-headline-253" class="outline-3">
<h3 id="headline-253">
vol-path
</h3>
<div id="outline-text-headline-253" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-path vol-name-or-key [--pool pool-or-uuid]
</pre>
</blockquote>
</blockquote>
<p>
Return the path for a given volume.</p>
<p>
<em>vol-name-or-key</em> is the name or key of the volume to return the path.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key, then
providing the pool is necessary to find the volume to be uploaded into;
otherwise, the first volume found by the key will be used.</p>
</div>
</div>
<div id="outline-container-headline-254" class="outline-3">
<h3 id="headline-254">
vol-name
</h3>
<div id="outline-text-headline-254" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-name vol-key-or-path
</pre>
</blockquote>
</blockquote>
<p>
Return the name for a given volume.</p>
<p>
<em>vol-key-or-path</em> is the key or path of the volume to return the name.</p>
</div>
</div>
<div id="outline-container-headline-255" class="outline-3">
<h3 id="headline-255">
vol-key
</h3>
<div id="outline-text-headline-255" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-key vol-name-or-path [--pool pool-or-uuid]
</pre>
</blockquote>
</blockquote>
<p>
Return the volume key for a given volume.</p>
<p>
<em>vol-name-or-path</em> is the name or path of the volume to return the
volume key.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the path, then
providing the pool is necessary to find the volume to be uploaded into;
otherwise, the first volume found by the path will be used.</p>
</div>
</div>
<div id="outline-container-headline-256" class="outline-3">
<h3 id="headline-256">
vol-resize
</h3>
<div id="outline-text-headline-256" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
vol-resize vol-name-or-path capacity [--pool pool-or-uuid] [--allocate] [--delta] [--shrink]
</pre>
</blockquote>
</blockquote>
<p>
Resize the capacity of the given volume, in bytes.</p>
<p>
<em>vol-name-or-key-or-path</em> is the name or key or path of the volume to
resize.</p>
<p>
<em>capacity</em> is a scaled integer (see <strong>NOTES</strong> above) for the volume, which
defaults to bytes if there is no suffix.</p>
<p>
<em>–pool</em> <em>pool-or-uuid</em> is the name or UUID of the storage pool the
volume is in. If the volume name is provided instead of the key or path,
then providing the pool is necessary to find the volume to be uploaded
into; otherwise, the first volume found by the key or path will be used.</p>
<p>
The new <em>capacity</em> might be sparse unless <em>–allocate</em> is specified.</p>
<p>
Normally, <em>capacity</em> is the new size, but if <em>–delta</em> is present, then
it is added to the existing size.</p>
<p>
Attempts to shrink the volume will fail unless <em>–shrink</em> is present.
The <em>capacity</em> cannot be negative unless <em>–shrink</em> is provided, but a
negative sign is not necessary.</p>
<p>
This command is only safe for storage volumes not in use by an active
guest; see also <strong>blockresize</strong> for live resizing.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-257" class="outline-2">
<h2 id="headline-257">
SECRET COMMANDS
</h2>
<div id="outline-text-headline-257" class="outline-text-2">
<p>The following commands manipulate &#34;secrets&#34; (e.g. passwords, passphrases
and encryption keys). Libvirt can store secrets independently from their
use, and other objects (e.g. volumes or domains) can refer to the
secrets for encryption or possibly other uses. Secrets are identified
using a UUID. See &lt;<a href="https://libvirt.org/formatsecret.html">https://libvirt.org/formatsecret.html</a>&gt; for
documentation of the XML format used to represent properties of secrets.</p>
<div id="outline-container-headline-258" class="outline-3">
<h3 id="headline-258">
secret-define
</h3>
<div id="outline-text-headline-258" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-define file [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Create a secret with the properties specified in <em>file</em>, with no
associated secret value. If <em>file</em> does not specify a UUID, choose one
automatically. If <em>file</em> specifies a UUID of an existing secret, replace
its properties by properties defined in <em>file</em>, without affecting the
secret value.</p>
<p>
Optionally, the format of the input XML file can be validated against an
internal RNG schema with <em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-259" class="outline-3">
<h3 id="headline-259">
secret-dumpxml
</h3>
<div id="outline-text-headline-259" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-dumpxml [--xpath EXPRESSION] [--wrap] secret
</pre>
</blockquote>
</blockquote>
<p>
Output properties of <em>secret</em> (specified by its UUID) as an XML dump to
stdout.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-260" class="outline-3">
<h3 id="headline-260">
secret-event
</h3>
<div id="outline-text-headline-260" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-event {[secret] event [--loop] [--timeout seconds] [--timestamp] | --list}
</pre>
</blockquote>
</blockquote>
<p>
Wait for a class of secret events to occur, and print appropriate
details of events as they happen. The events can optionally be filtered
by <em>secret</em>. Using <em>–list</em> as the only argument will provide a list of
possible <em>event</em> values known by this client, although the connection
might not allow registering for all these events.</p>
<p>
By default, this command is one-shot, and returns success once an event
occurs; you can send SIGINT (usually via <strong>Ctrl-C</strong>) to quit immediately.
If <em>–timeout</em> is specified, the command gives up waiting for events
after <em>seconds</em> have elapsed. With <em>–loop</em>, the command prints all
events until a timeout or interrupt key.</p>
<p>
When <em>–timestamp</em> is used, a human-readable timestamp will be printed
before the event.</p>
</div>
</div>
<div id="outline-container-headline-261" class="outline-3">
<h3 id="headline-261">
secret-set-value
</h3>
<div id="outline-text-headline-261" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-set-value secret (--file filename [--plain] | --interactive | base64)
</pre>
</blockquote>
</blockquote>
<p>
Set the value associated with <em>secret</em> (specified by its UUID) to the
value Base64-encoded value <em>base64</em> or Base-64-encoded contents of file
named <em>filename</em>. Using the <em>–plain</em> flag is together with <em>–file</em>
allows one to use the file contents directly as the secret value.</p>
<p>
If <em>–interactive</em> flag is used the secret value is read as a password
from the terminal.</p>
<p>
Note that <em>–file</em>, <em>–interactive</em> and <em>base64</em> options are mutually
exclusive.</p>
<p>
Passing secrets via the <em>base64</em> option on command line is INSECURE and
deprecated. Use the <em>–file</em> option instead.</p>
</div>
</div>
<div id="outline-container-headline-262" class="outline-3">
<h3 id="headline-262">
secret-get-value
</h3>
<div id="outline-text-headline-262" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-get-value [--plain] secret
</pre>
</blockquote>
</blockquote>
<p>
Output the value associated with <em>secret</em> (specified by its UUID) to
stdout, encoded using Base64.</p>
<p>
If the <em>–plain</em> flag is used the value is not base64 encoded, but
rather printed raw. Note that unless virsh is started in quiet mode
(<em>virsh -q</em>) it prints a newline at the end of the command. This newline
is not part of the secret.</p>
</div>
</div>
<div id="outline-container-headline-263" class="outline-3">
<h3 id="headline-263">
secret-undefine
</h3>
<div id="outline-text-headline-263" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-undefine secret
</pre>
</blockquote>
</blockquote>
<p>
Delete a <em>secret</em> (specified by its UUID), including the associated
value, if any.</p>
</div>
</div>
<div id="outline-container-headline-264" class="outline-3">
<h3 id="headline-264">
secret-list
</h3>
<div id="outline-text-headline-264" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
secret-list [--ephemeral] [--no-ephemeral]
   [--private] [--no-private]
</pre>
</blockquote>
</blockquote>
<p>
Returns the list of secrets. You may also want to filter the returned
secrets by <em>–ephemeral</em> to list the ephemeral ones, <em>–no-ephemeral</em> to
list the non-ephemeral ones, <em>–private</em> to list the private ones, and
<em>–no-private</em> to list the non-private ones.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-265" class="outline-2">
<h2 id="headline-265">
SNAPSHOT COMMANDS
</h2>
<div id="outline-text-headline-265" class="outline-text-2">
<p>The following commands manipulate domain snapshots. Snapshots take the
disk, memory, and device state of a domain at a point-of-time, and save
it for future use. They have many uses, from saving a &#34;clean&#34; copy of an
OS image to saving a domain&#39;s state before a potentially destructive
operation. Snapshots are identified with a unique name. See
&lt;<a href="https://libvirt.org/formatsnapshot.html">https://libvirt.org/formatsnapshot.html</a>&gt; for documentation of the XML
format used to represent properties of snapshots.</p>
<div id="outline-container-headline-266" class="outline-3">
<h3 id="headline-266">
snapshot-create
</h3>
<div id="outline-text-headline-266" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-create domain [xmlfile] {[--redefine [--current]] |
   [--no-metadata] [--halt] [--disk-only] [--reuse-external]
   [--quiesce] [--atomic] [--live]} [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Create a snapshot for domain <em>domain</em> with the properties specified in
<em>xmlfile</em>. Optionally, the <em>–validate</em> option can be passed to validate
the format of the input XML file against an internal RNG schema
(identical to using the virt-xml-validate(1) tool). Normally, the only
properties settable for a domain snapshot are the &lt;name&gt; and
&lt;description&gt; elements, as well as &lt;disks&gt; if <em>–disk-only</em> is given;
the rest of the fields are ignored, and automatically filled in by
libvirt. If <em>xmlfile</em> is completely omitted, then libvirt will choose a
value for all fields. The new snapshot will become current, as listed by
<strong>snapshot-current</strong>.</p>
<p>
If <em>–halt</em> is specified, the domain will be left in an inactive state
after the snapshot is created.</p>
<p>
If <em>–disk-only</em> is specified, the snapshot will only include disk
content rather than the usual full system snapshot with vm state. Disk
snapshots are captured faster than full system snapshots, but reverting
to a disk snapshot may require fsck or journal replays, since it is like
the disk state at the point when the power cord is abruptly pulled; and
mixing <em>–halt</em> and <em>–disk-only</em> loses any data that was not flushed to
disk at the time.</p>
<p>
If <em>–redefine</em> is specified, then all XML elements produced by
<strong>snapshot-dumpxml</strong> are valid; this can be used to migrate snapshot
hierarchy from one machine to another, to recreate hierarchy for the
case of a transient domain that goes away and is later recreated with
the same name and UUID, or to make slight alterations in the snapshot
metadata (such as host-specific aspects of the domain XML embedded in
the snapshot). When this flag is supplied, the <em>xmlfile</em> argument is
mandatory, and the domain&#39;s current snapshot will not be altered unless
the <em>–current</em> flag is also given.</p>
<p>
If <em>–no-metadata</em> is specified, then the snapshot data is created, but
any metadata is immediately discarded (that is, libvirt does not treat
the snapshot as current, and cannot revert to the snapshot unless
<em>–redefine</em> is later used to teach libvirt about the metadata again).</p>
<p>
If <em>–reuse-external</em> is specified, and the snapshot XML requests an
external snapshot with a destination of an existing file, then the
destination must exist and be pre-created with correct format and
metadata. The file is then reused; otherwise, a snapshot is refused to
avoid losing contents of the existing files.</p>
<p>
If <em>–quiesce</em> is specified, libvirt will try to use guest agent to
freeze and unfreeze domain&#39;s mounted file systems. However, if domain
has no guest agent, snapshot creation will fail. Currently, this
requires <em>–disk-only</em> to be passed as well.</p>
<p>
If <em>–atomic</em> is specified, libvirt will guarantee that the snapshot
either succeeds, or fails with no changes; not all hypervisors support
this. If this flag is not specified, then some hypervisors may fail
after partially performing the action, and <strong>dumpxml</strong> must be used to see
whether any partial changes occurred.</p>
<p>
If <em>–live</em> is specified, libvirt takes the snapshot while the guest is
running. Both disk snapshot and domain memory snapshot are taken. This
increases the size of the memory image of the external snapshot. This is
currently supported only for full system external snapshots.</p>
<p>
Existence of snapshot metadata will prevent attempts to <strong>undefine</strong> a
persistent guest. However, for transient domains, snapshot metadata is
silently lost when the domain quits running (whether by command such as
<strong>destroy</strong> or by internal guest action).</p>
<p>
For now, it is not possible to create snapshots in a domain that has
checkpoints, although this restriction will be lifted in a future
release.</p>
</div>
</div>
<div id="outline-container-headline-267" class="outline-3">
<h3 id="headline-267">
snapshot-create-as
</h3>
<div id="outline-text-headline-267" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-create-as domain {[--print-xml] [--no-metadata]
   [--halt] [--reuse-external]} [name]
   [description] [--disk-only [--quiesce]] [--atomic] [--validate]
   [[--live] [--memspec memspec]] [--diskspec] diskspec]...
</pre>
</blockquote>
</blockquote>
<p>
Create a snapshot for domain <em>domain</em> with the given &lt;name&gt; and
&lt;description&gt;; if either value is omitted, libvirt will choose a value.
If <em>–print-xml</em> is specified, then XML appropriate for
<em>snapshot-create</em> is output, rather than actually creating a snapshot.
Otherwise, if <em>–halt</em> is specified, the domain will be left in an
inactive state after the snapshot is created, and if <em>–disk-only</em> is
specified, the snapshot will not include vm state.</p>
<p>
The <em>–memspec</em> option can be used to control whether a full system
snapshot is internal or external. The <em>–memspec</em> flag is mandatory,
followed by a <strong>memspec</strong> of the form <strong>[file=]name[,snapshot=type]</strong>, where
type can be <strong>no</strong>, <strong>internal</strong>, or <strong>external</strong>. To include a literal comma
in <strong>file=name</strong>, escape it with a second comma. <em>–memspec</em> cannot be
used together with <em>–disk-only</em>.</p>
<p>
The <em>–diskspec</em> option can be used to control how <em>–disk-only</em> and
external full system snapshots create external files. This option can
occur multiple times, according to the number of &lt;disk&gt; elements in the
domain xml. Each &lt;diskspec&gt; is in the form
<strong>disk[,snapshot=type][,driver=type][,stype=type][,file=name]</strong>. A
<em>diskspec</em> must be provided for disks backed by block devices as libvirt
doesn&#39;t auto-generate file names for those. The optional <strong>stype</strong>
parameter allows one to control the type of the source file. Supported
values are &#39;file&#39; (default) and &#39;block&#39;. To exclude a disk from an
external snapshot use <strong>–diskspec disk,snapshot=no</strong>.</p>
<p>
To include a literal comma in <strong>disk</strong> or in <strong>file=name</strong>, escape it with a
second comma. A literal <em>–diskspec</em> must precede each <strong>diskspec</strong> unless
all three of <em>domain</em>, <em>name</em>, and <em>description</em> are also present. For
example, a diskspec of &#34;vda,snapshot=external,file=/path/to,,new&#34;
results in the following XML:</p>
<blockquote>
<blockquote>
<pre class="example">
&lt;disk name=&#39;vda&#39; snapshot=&#39;external&#39;&gt;
  &lt;source file=&#39;/path/to,new&#39;/&gt;
&lt;/disk&gt;
</pre>
</blockquote>
</blockquote>
<p>
If <em>–reuse-external</em> is specified, and the domain XML or <em>diskspec</em>
option requests an external snapshot with a destination of an existing
file, then the destination must exist and be pre-created with correct
format and metadata. The file is then reused; otherwise, a snapshot is
refused to avoid losing contents of the existing files.</p>
<p>
If <em>–quiesce</em> is specified, libvirt will try to use guest agent to
freeze and unfreeze domain&#39;s mounted file systems. However, if domain
has no guest agent, snapshot creation will fail. Currently, this
requires <em>–disk-only</em> to be passed as well.</p>
<p>
If <em>–no-metadata</em> is specified, then the snapshot data is created, but
any metadata is immediately discarded (that is, libvirt does not treat
the snapshot as current, and cannot revert to the snapshot unless
<strong>snapshot-create</strong> is later used to teach libvirt about the metadata
again).</p>
<p>
If <em>–atomic</em> is specified, libvirt will guarantee that the snapshot
either succeeds, or fails with no changes; not all hypervisors support
this. If this flag is not specified, then some hypervisors may fail
after partially performing the action, and <strong>dumpxml</strong> must be used to see
whether any partial changes occurred.</p>
<p>
If <em>–live</em> is specified, libvirt takes the snapshot while the guest is
running. This increases the size of the memory image of the external
snapshot. This is currently supported only for external full system
snapshots.</p>
<p>
For now, it is not possible to create snapshots in a domain that has
checkpoints, although this restriction will be lifted in a future
release.</p>
<p>
Optionally, the <em>–validate</em> option can be passed to validate XML
document which is internally generated by this command against the
internal RNG schema.</p>
</div>
</div>
<div id="outline-container-headline-268" class="outline-3">
<h3 id="headline-268">
snapshot-current
</h3>
<div id="outline-text-headline-268" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-current domain {[--name] | [--security-info] | [snapshotname]}
</pre>
</blockquote>
</blockquote>
<p>
Without <em>snapshotname</em>, this will output the snapshot XML for the
domain&#39;s current snapshot (if any). If <em>–name</em> is specified, just the
current snapshot name instead of the full xml. Otherwise, using
<em>–security-info</em> will also include security sensitive information in
the XML.</p>
<p>
With <em>snapshotname</em>, this is a request to make the existing named
snapshot become the current snapshot, without reverting the domain.</p>
</div>
</div>
<div id="outline-container-headline-269" class="outline-3">
<h3 id="headline-269">
snapshot-edit
</h3>
<div id="outline-text-headline-269" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-edit domain [snapshotname] [--current] {[--rename] | [--clone]}
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration file for <em>snapshotname</em> of a domain. If both
<em>snapshotname</em> and <em>–current</em> are specified, also force the edited
snapshot to become the current snapshot. If <em>snapshotname</em> is omitted,
then <em>–current</em> must be supplied, to edit the current snapshot.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh snapshot-dumpxml dom name &gt; snapshot.xml
vi snapshot.xml (or make changes with your other text editor)
virsh snapshot-create dom snapshot.xml --redefine [--current]
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
<p>
If <em>–rename</em> is specified, then the edits can change the snapshot name.
If <em>–clone</em> is specified, then changing the snapshot name will create a
clone of the snapshot metadata. If neither is specified, then the edits
must not change the snapshot name. Note that changing a snapshot name
must be done with care, since the contents of some snapshots, such as
internal snapshots within a single qcow2 file, are accessible only from
the original name.</p>
</div>
</div>
<div id="outline-container-headline-270" class="outline-3">
<h3 id="headline-270">
snapshot-info
</h3>
<div id="outline-text-headline-270" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-info domain {snapshot | --current}
</pre>
</blockquote>
</blockquote>
<p>
Output basic information about a named &lt;snapshot&gt;, or the current
snapshot with <em>–current</em>.</p>
</div>
</div>
<div id="outline-container-headline-271" class="outline-3">
<h3 id="headline-271">
snapshot-list
</h3>
<div id="outline-text-headline-271" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-list domain [--metadata] [--no-metadata]
   [{--parent | --roots | [{--tree | --name}]}] [--topological]
   [{[--from] snapshot | --current} [--descendants]]
   [--leaves] [--no-leaves] [--inactive] [--active]
   [--disk-only] [--internal] [--external]
</pre>
</blockquote>
</blockquote>
<p>
List all of the available snapshots for the given domain, defaulting to
show columns for the snapshot name, creation time, and domain state.</p>
<p>
Normally, table form output is sorted by snapshot name; using
<em>–topological</em> instead sorts so that no child is listed before its
ancestors (although there may be more than one possible ordering with
this property).</p>
<p>
If <em>–parent</em> is specified, add a column to the output table giving the
name of the parent of each snapshot. If <em>–roots</em> is specified, the list
will be filtered to just snapshots that have no parents. If <em>–tree</em> is
specified, the output will be in a tree format, listing just snapshot
names. These three options are mutually exclusive.</p>
<p>
If <em>–name</em> is specified only the snapshot name is printed optionally
followed by a tab-separated name of the parent snapshot if <em>–parent</em> is
used as well. This option is mutually exclusive with <em>–tree</em>.</p>
<p>
If <em>–from</em> is provided, filter the list to snapshots which are children
of the given <strong>snapshot</strong>; or if <em>–current</em> is provided, start at the
current snapshot. When used in isolation or with <em>–parent</em>, the list is
limited to direct children unless <em>–descendants</em> is also present. When
used with <em>–tree</em>, the use of <em>–descendants</em> is implied. This option
is not compatible with <em>–roots</em>. Note that the starting point of
<em>–from</em> or <em>–current</em> is not included in the list unless the <em>–tree</em>
option is also present.</p>
<p>
If <em>–leaves</em> is specified, the list will be filtered to just snapshots
that have no children. Likewise, if <em>–no-leaves</em> is specified, the list
will be filtered to just snapshots with children. (Note that omitting
both options does no filtering, while providing both options will either
produce the same list or error out depending on whether the server
recognizes the flags). Filtering options are not compatible with
<em>–tree</em>.</p>
<p>
If <em>–metadata</em> is specified, the list will be filtered to just
snapshots that involve libvirt metadata, and thus would prevent
<strong>undefine</strong> of a persistent guest, or be lost on <strong>destroy</strong> of a transient
domain. Likewise, if <em>–no-metadata</em> is specified, the list will be
filtered to just snapshots that exist without the need for libvirt
metadata.</p>
<p>
If <em>–inactive</em> is specified, the list will be filtered to snapshots
that were taken when the domain was shut off. If <em>–active</em> is
specified, the list will be filtered to snapshots that were taken when
the domain was running, and where the snapshot includes the memory state
to revert to that running state. If <em>–disk-only</em> is specified, the list
will be filtered to snapshots that were taken when the domain was
running, but where the snapshot includes only disk state.</p>
<p>
If <em>–internal</em> is specified, the list will be filtered to snapshots
that use internal storage of existing disk images. If <em>–external</em> is
specified, the list will be filtered to snapshots that use external
files for disk images or memory state.</p>
</div>
</div>
<div id="outline-container-headline-272" class="outline-3">
<h3 id="headline-272">
snapshot-dumpxml
</h3>
<div id="outline-text-headline-272" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-dumpxml [--security-info] [--xpath EXPRESSION] [--wrap]
                 domain snapshot
</pre>
</blockquote>
</blockquote>
<p>
Output the snapshot XML for the domain&#39;s snapshot named <em>snapshot</em>.
Using <em>–security-info</em> will also include security sensitive
information. Use <strong>snapshot-current</strong> to easily access the XML of the
current snapshot.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-273" class="outline-3">
<h3 id="headline-273">
snapshot-parent
</h3>
<div id="outline-text-headline-273" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-parent domain {snapshot | --current}
</pre>
</blockquote>
</blockquote>
<p>
Output the name of the parent snapshot, if any, for the given
<em>snapshot</em>, or for the current snapshot with <em>–current</em>.</p>
</div>
</div>
<div id="outline-container-headline-274" class="outline-3">
<h3 id="headline-274">
snapshot-revert
</h3>
<div id="outline-text-headline-274" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-revert domain {snapshot | --current} [{--running | --paused}]
   [--force] [--reset-nvram]
</pre>
</blockquote>
</blockquote>
<p>
Revert the given domain to the snapshot specified by <em>snapshot</em>, or to
the current snapshot with <em>–current</em>. Be aware that this is a
destructive action; any changes in the domain since the last snapshot
was taken will be lost. Also note that the state of the domain after
snapshot-revert is complete will be the state of the domain at the time
the original snapshot was taken.</p>
<p>
Normally, reverting to a snapshot leaves the domain in the state it was
at the time the snapshot was created, except that a disk snapshot with
no vm state leaves the domain in an inactive state. Passing either the
<em>–running</em> or <em>–paused</em> flag will perform additional state changes
(such as booting an inactive domain, or pausing a running domain). Since
transient domains cannot be inactive, it is required to use one of these
flags when reverting to a disk snapshot of a transient domain.</p>
<p>
Since libvirt 7.10.0 the VM process is always restarted so the following
paragraph is no longer valid. If the snapshot metadata lacks the full VM
XML it&#39;s no longer possible to revert to such snapshot.</p>
<p>
There are a number of cases where a snapshot revert involves extra risk,
which requires the use of <em>–force</em> to proceed:</p>
<blockquote>
<blockquote>
<blockquote>
<ul>
<li>One is the case of a snapshot that lacks full domain information for
reverting configuration (such as snapshots created prior to libvirt
0.9.5); since libvirt cannot prove that the current configuration
matches what was in use at the time of the snapshot, supplying
<em>–force</em> assures libvirt that the snapshot is compatible with the
current configuration (and if it is not, the domain will likely fail
to run).</li>
<li>Another is the case of reverting from a running domain to an active
state where a new hypervisor has to be created rather than reusing the
existing hypervisor, because it implies drawbacks such as breaking any
existing VNC or Spice connections; this condition happens with an
active snapshot that uses a provably incompatible configuration, as
well as with an inactive snapshot that is combined with the <em>–start</em>
or <em>–pause</em> flag.</li>
<li>Also, libvirt will refuse to restore snapshots of inactive QEMU
domains while there is managed saved state. This is because those
snapshots do not contain memory state and will therefore not replace
the existing memory state. This ends up switching a disk underneath a
running system and will likely cause extensive filesystem corruption
or crashes due to swap content mismatches when run.</li>
</ul>
</blockquote>
</blockquote>
</blockquote>
<p>
If <em>–reset-nvram</em> is specified, any existing NVRAM file will be deleted
and re-initialized from its pristine template.</p>
</div>
</div>
<div id="outline-container-headline-275" class="outline-3">
<h3 id="headline-275">
snapshot-delete
</h3>
<div id="outline-text-headline-275" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
snapshot-delete domain {snapshot | --current}
   [--metadata] [{--children | --children-only}]
</pre>
</blockquote>
</blockquote>
<p>
Delete the snapshot for the domain named <em>snapshot</em>, or the current
snapshot with <em>–current</em>. If this snapshot has child snapshots, changes
from this snapshot will be merged into the children. If <em>–children</em> is
passed, then delete this snapshot and any children of this snapshot. If
<em>–children-only</em> is passed, then delete any children of this snapshot,
but leave this snapshot intact. These two flags are mutually exclusive.</p>
<p>
If <em>–metadata</em> is specified, then only delete the snapshot metadata
maintained by libvirt, while leaving the snapshot contents intact for
access by external tools; otherwise deleting a snapshot also removes the
data contents from that point in time.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-276" class="outline-2">
<h2 id="headline-276">
CHECKPOINT COMMANDS
</h2>
<div id="outline-text-headline-276" class="outline-text-2">
<p>The following commands manipulate domain checkpoints. Checkpoints serve
as a point in time to identify which portions of a guest&#39;s disks have
changed after that time, making it possible to perform incremental and
differential backups. Checkpoints are identified with a unique name. See
&lt;<a href="https://libvirt.org/formatcheckpoint.html">https://libvirt.org/formatcheckpoint.html</a>&gt; for documentation of the XML
format used to represent properties of checkpoints.</p>
<div id="outline-container-headline-277" class="outline-3">
<h3 id="headline-277">
checkpoint-create
</h3>
<div id="outline-text-headline-277" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-create domain [xmlfile] { --redefine [--redefine-validate] | [--quiesce]}
</pre>
</blockquote>
</blockquote>
<p>
Create a checkpoint for domain <em>domain</em> with the properties specified in
<em>xmlfile</em> describing a &lt;domaincheckpoint&gt; top-level element. The format
of the input XML file will be validated against an internal RNG schema
(identical to using the virt-xml-validate(1) tool). If <em>xmlfile</em> is
completely omitted, then libvirt will create a checkpoint with a name
based on the current time.</p>
<p>
If <em>–redefine</em> is specified, then all XML elements produced by
<strong>checkpoint-dumpxml</strong> are valid; this can be used to migrate checkpoint
hierarchy from one machine to another, to recreate hierarchy for the
case of a transient domain that goes away and is later recreated with
the same name and UUID, or to make slight alterations in the checkpoint
metadata (such as host-specific aspects of the domain XML embedded in
the checkpoint). When this flag is supplied, the <em>xmlfile</em> argument is
mandatory.</p>
<p>
If <em>–redefine-validate</em> is specified along with <em>–redefine</em> the
hypervisor performs validation of metadata associated with the
checkpoint stored in places besides the checkpoint XML. Note that some
hypervisors may require that the domain is running to perform
validation.</p>
<p>
If <em>–quiesce</em> is specified, libvirt will try to use guest agent to
freeze and unfreeze domain&#39;s mounted file systems. However, if domain
has no guest agent, checkpoint creation will fail.</p>
<p>
Existence of checkpoint metadata will prevent attempts to <strong>undefine</strong> a
persistent guest. However, for transient domains, checkpoint metadata is
silently lost when the domain quits running (whether by command such as
<strong>destroy</strong> or by internal guest action).</p>
<p>
For now, it is not possible to create checkpoints in a domain that has
snapshots, although this restriction will be lifted in a future release.</p>
</div>
</div>
<div id="outline-container-headline-278" class="outline-3">
<h3 id="headline-278">
checkpoint-create-as
</h3>
<div id="outline-text-headline-278" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-create-as domain [--print-xml] [name]
   [description] [--quiesce] [--diskspec] diskspec]...
</pre>
</blockquote>
</blockquote>
<p>
Create a checkpoint for domain <em>domain</em> with the given &lt;name&gt; and
&lt;description&gt;; if either value is omitted, libvirt will choose a value.
If <em>–print-xml</em> is specified, then XML appropriate for
<em>checkpoint-create</em> is output, rather than actually creating a
checkpoint.</p>
<p>
The <em>–diskspec</em> option can be used to control which guest disks
participate in the checkpoint. This option can occur multiple times,
according to the number of &lt;disk&gt; elements in the domain xml. Each
&lt;diskspec&gt; is in the form <strong>disk[,checkpoint=type][,bitmap=name]</strong>. A
literal <em>–diskspec</em> must precede each <strong>diskspec</strong> unless all three of
<em>domain</em>, <em>name</em>, and <em>description</em> are also present. For example, a
diskspec of &#34;vda,checkpoint=bitmap,bitmap=map1&#34; results in the following
XML:</p>
<blockquote>
<blockquote>
<pre class="example">
&lt;disk name=&#39;vda&#39; checkpoint=&#39;bitmap&#39; bitmap=&#39;map1&#39;/&gt;
</pre>
</blockquote>
</blockquote>
<p>
If <em>–quiesce</em> is specified, libvirt will try to use guest agent to
freeze and unfreeze domain&#39;s mounted file systems. However, if domain
has no guest agent, checkpoint creation will fail.</p>
<p>
For now, it is not possible to create checkpoints in a domain that has
snapshots, although this restriction will be lifted in a future release.</p>
</div>
</div>
<div id="outline-container-headline-279" class="outline-3">
<h3 id="headline-279">
checkpoint-edit
</h3>
<div id="outline-text-headline-279" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-edit domain checkpointname
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML configuration file for <em>checkpointname</em> of a domain.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh checkpoint-dumpxml dom name &gt; checkpoint.xml
vi checkpoint.xml (or make changes with your other text editor)
virsh checkpoint-create dom checkpoint.xml --redefine
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking, including that the edits should
not attempt to change the checkpoint name.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
<div id="outline-container-headline-280" class="outline-3">
<h3 id="headline-280">
checkpoint-info
</h3>
<div id="outline-text-headline-280" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-info domain checkpoint
</pre>
</blockquote>
</blockquote>
<p>
Output basic information about a named &lt;checkpoint&gt;.</p>
</div>
</div>
<div id="outline-container-headline-281" class="outline-3">
<h3 id="headline-281">
checkpoint-list
</h3>
<div id="outline-text-headline-281" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-list domain [{--parent | --roots |
   [{--tree | --name}]}] [--topological]
   [[--from] checkpoint | [--descendants]]
   [--leaves] [--no-leaves]
</pre>
</blockquote>
</blockquote>
<p>
List all of the available checkpoints for the given domain, defaulting
to show columns for the checkpoint name and creation time.</p>
<p>
Normally, table form output is sorted by checkpoint name; using
<em>–topological</em> instead sorts so that no child is listed before its
ancestors (although there may be more than one possible ordering with
this property).</p>
<p>
If <em>–parent</em> is specified, add a column to the output table giving the
name of the parent of each checkpoint. If <em>–roots</em> is specified, the
list will be filtered to just checkpoints that have no parents. If
<em>–tree</em> is specified, the output will be in a tree format, listing just
checkpoint names. These three options are mutually exclusive.</p>
<p>
If <em>–name</em> is specified only the checkpoint name is printed optionally
followed by a tab-separated name of the parent checkpoint if <em>–parent</em>
is used as well. This option is mutually exclusive with <em>–tree</em>.</p>
<p>
If <em>–from</em> is provided, filter the list to checkpoints which are
children of the given <strong>checkpoint</strong>. When used in isolation or with
<em>–parent</em>, the list is limited to direct children unless
<em>–descendants</em> is also present. When used with <em>–tree</em>, the use of
<em>–descendants</em> is implied. This option is not compatible with
<em>–roots</em>. Note that the starting point of <em>–from</em> is not included in
the list unless the <em>–tree</em> option is also present.</p>
<p>
If <em>–leaves</em> is specified, the list will be filtered to just
checkpoints that have no children. Likewise, if <em>–no-leaves</em> is
specified, the list will be filtered to just checkpoints with children.
(Note that omitting both options does no filtering, while providing both
options will either produce the same list or error out depending on
whether the server recognizes the flags). Filtering options are not
compatible with <em>–tree</em>.</p>
</div>
</div>
<div id="outline-container-headline-282" class="outline-3">
<h3 id="headline-282">
checkpoint-dumpxml
</h3>
<div id="outline-text-headline-282" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-dumpxml [--security-info] [--no-domain] [--size]
                   [--xpath EXPRESSION] [--wrap] domain checkpoint
</pre>
</blockquote>
</blockquote>
<p>
Output the checkpoint XML for the domain&#39;s checkpoint named
<em>checkpoint</em>. Using <em>–security-info</em> will also include security
sensitive information.</p>
<p>
Using <em>–size</em> will add XML indicating the current size in bytes of
guest data that has changed since the checkpoint was created (although
remember that guest activity between a size check and actually creating
a backup can result in the backup needing slightly more space). Note
that some hypervisors may require that <em>domain</em> is running when <em>–size</em>
is used.</p>
<p>
Using <em>–no-domain</em> will omit the &lt;domain&gt; element from the output for a
more compact view.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-283" class="outline-3">
<h3 id="headline-283">
checkpoint-parent
</h3>
<div id="outline-text-headline-283" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-parent domain checkpoint
</pre>
</blockquote>
</blockquote>
<p>
Output the name of the parent checkpoint, if any, for the given
<em>checkpoint</em>.</p>
</div>
</div>
<div id="outline-container-headline-284" class="outline-3">
<h3 id="headline-284">
checkpoint-delete
</h3>
<div id="outline-text-headline-284" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
checkpoint-delete domain checkpoint
   [--metadata] [{--children | --children-only}]
</pre>
</blockquote>
</blockquote>
<p>
Delete the checkpoint for the domain named <em>checkpoint</em>. The record of
which portions of the disk changed since the checkpoint are merged into
the parent checkpoint (if any). If <em>–children</em> is passed, then delete
this checkpoint and any children of this checkpoint. If
<em>–children-only</em> is passed, then delete any children of this
checkpoint, but leave this checkpoint intact. These two flags are
mutually exclusive.</p>
<p>
If <em>–metadata</em> is specified, then only delete the checkpoint metadata
maintained by libvirt, while leaving the checkpoint contents intact for
access by external tools; otherwise deleting a checkpoint also removes
the ability to perform an incremental backup from that point in time.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-285" class="outline-2">
<h2 id="headline-285">
NWFILTER COMMANDS
</h2>
<div id="outline-text-headline-285" class="outline-text-2">
<p>The following commands manipulate network filters. Network filters allow
filtering of the network traffic coming from and going to virtual
machines. Individual network traffic filters are written in XML and may
contain references to other network filters, describe traffic filtering
rules, or contain both. Network filters are referenced by virtual
machines from within their interface description. A network filter may
be referenced by multiple virtual machines&#39; interfaces.</p>
<div id="outline-container-headline-286" class="outline-3">
<h3 id="headline-286">
nwfilter-define
</h3>
<div id="outline-text-headline-286" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-define xmlfile [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Make a new network filter known to libvirt. If a network filter with the
same name already exists, it will be replaced with the new XML. Any
running virtual machine referencing this network filter will have its
network traffic rules adapted. If for any reason the network traffic
filtering rules cannot be instantiated by any of the running virtual
machines, then the new XML will be rejected.</p>
<p>
Optionally, the format of the input XML file can be validated against an
internal RNG schema with <em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-287" class="outline-3">
<h3 id="headline-287">
nwfilter-undefine
</h3>
<div id="outline-text-headline-287" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-undefine nwfilter-name
</pre>
</blockquote>
</blockquote>
<p>
Delete a network filter. The deletion will fail if any running virtual
machine is currently using this network filter.</p>
</div>
</div>
<div id="outline-container-headline-288" class="outline-3">
<h3 id="headline-288">
nwfilter-list
</h3>
<div id="outline-text-headline-288" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-list
</pre>
</blockquote>
</blockquote>
<p>
List all of the available network filters.</p>
</div>
</div>
<div id="outline-container-headline-289" class="outline-3">
<h3 id="headline-289">
nwfilter-dumpxml
</h3>
<div id="outline-text-headline-289" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-dumpxml [--xpath EXPRESSION] [--wrap] nwfilter-name
</pre>
</blockquote>
</blockquote>
<p>
Output the network filter XML.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
<div id="outline-container-headline-290" class="outline-3">
<h3 id="headline-290">
nwfilter-edit
</h3>
<div id="outline-text-headline-290" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-edit nwfilter-name
</pre>
</blockquote>
</blockquote>
<p>
Edit the XML of a network filter.</p>
<p>
This is equivalent to:</p>
<blockquote>
<blockquote>
<pre class="example">
virsh nwfilter-dumpxml myfilter &gt; myfilter.xml
vi myfilter.xml (or make changes with your other text editor)
virsh nwfilter-define myfilter.xml
</pre>
</blockquote>
</blockquote>
<p>
except that it does some error checking. The new network filter may be
rejected due to the same reason as mentioned in <em>nwfilter-define</em>.</p>
<p>
The editor used can be supplied by the <strong>$VISUAL</strong> or <strong>$EDITOR</strong>
environment variables, and defaults to <strong>vi</strong>.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-291" class="outline-2">
<h2 id="headline-291">
NWFILTER BINDING COMMANDS
</h2>
<div id="outline-text-headline-291" class="outline-text-2">
<p>The following commands manipulate network filter bindings. Network
filter bindings track the association between a network port and a
network filter. Generally the bindings are managed automatically by the
hypervisor drivers when adding/removing NICs on a guest.</p>
<p>
If an admin is creating/deleting TAP devices for non-guest usage,
however, the network filter binding commands provide a way to make use
of the network filters directly.</p>
<div id="outline-container-headline-292" class="outline-3">
<h3 id="headline-292">
nwfilter-binding-create
</h3>
<div id="outline-text-headline-292" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-binding-create xmlfile [--validate]
</pre>
</blockquote>
</blockquote>
<p>
Associate a network port with a network filter. The network filter
backend will immediately attempt to instantiate the filter rules on the
port. This command may be used to associate a filter with a currently
running guest that does not have a filter defined for a specific network
port. Since the bindings are generally automatically managed by the
hypervisor, using this command to define a filter for a network port and
then starting the guest afterwards may prevent the guest from starting
if it attempts to use the network port and finds a filter already
defined.</p>
<p>
Optionally, the format of the input XML file can be validated against an
internal RNG schema with <em>–validate</em>.</p>
</div>
</div>
<div id="outline-container-headline-293" class="outline-3">
<h3 id="headline-293">
nwfilter-binding-delete
</h3>
<div id="outline-text-headline-293" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-binding-delete port-name
</pre>
</blockquote>
</blockquote>
<p>
Disassociate a network port from a network filter. The network filter
backend will immediately tear down the filter rules that exist on the
port. This command may be used to remove the network port binding for a
filter currently in use for the guest while the guest is running without
needing to restart the guest. Restoring the network port binding filter
for the running guest would be accomplished by using
<em>nwfilter-binding-create</em>.</p>
</div>
</div>
<div id="outline-container-headline-294" class="outline-3">
<h3 id="headline-294">
nwfilter-binding-list
</h3>
<div id="outline-text-headline-294" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-binding-list
</pre>
</blockquote>
</blockquote>
<p>
List all of the network ports which have filters associated with them.</p>
</div>
</div>
<div id="outline-container-headline-295" class="outline-3">
<h3 id="headline-295">
nwfilter-binding-dumpxml
</h3>
<div id="outline-text-headline-295" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
nwfilter-binding-dumpxml [--xpath EXPRESSION] [--wrap] port-name
</pre>
</blockquote>
</blockquote>
<p>
Output the network filter binding XML for the network device called
<strong>port-name</strong>.</p>
<p>
If the <strong>–xpath</strong> argument provides an XPath expression, it will be
evaluated against the output XML and only those matching nodes will be
printed. The default behaviour is to print each matching node as a
standalone document, however, for ease of additional processing, the
<strong>–wrap</strong> argument will cause the matching node to be wrapped in a common
root node.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-296" class="outline-2">
<h2 id="headline-296">
HYPERVISOR-SPECIFIC COMMANDS
</h2>
<div id="outline-text-headline-296" class="outline-text-2">
<p>NOTE: Use of the following commands is <strong>strongly</strong> discouraged. They can
cause libvirt to become confused and do the wrong thing on subsequent
operations. Once you have used these commands, please do not report
problems to the libvirt developers; the reports will be ignored. If you
find that these commands are the only way to accomplish something, then
it is better to request that the feature be added as a first-class
citizen in the regular libvirt library.</p>
<div id="outline-container-headline-297" class="outline-3">
<h3 id="headline-297">
qemu-attach
</h3>
<div id="outline-text-headline-297" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
qemu-attach pid
</pre>
</blockquote>
</blockquote>
<p>
Attach an externally launched QEMU process to the libvirt QEMU driver.
The QEMU process must have been created with a monitor connection using
the UNIX driver. Ideally the process will also have had the &#39;-name&#39;
argument specified.</p>
<blockquote>
<blockquote>
<pre class="example">
$ qemu-kvm -cdrom ~/demo.iso \
    -monitor unix:/tmp/demo,server,nowait \
    -name foo \
    -uuid cece4f9f-dff0-575d-0e8e-01fe380f12ea  &amp;
$ QEMUPID=$!
$ virsh qemu-attach $QEMUPID
</pre>
</blockquote>
</blockquote>
<p>
Not all functions of libvirt are expected to work reliably after
attaching to an externally launched QEMU process. There may be issues
with the guest ABI changing upon migration and device hotplug or
hotunplug may not work. The attached environment should be considered
primarily read-only.</p>
</div>
</div>
<div id="outline-container-headline-298" class="outline-3">
<h3 id="headline-298">
qemu-monitor-command
</h3>
<div id="outline-text-headline-298" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
qemu-monitor-command domain { [--hmp] | [--pretty] [--return-value] }
    [--pass-fds N,M,...] command...
</pre>
</blockquote>
</blockquote>
<p>
Send an arbitrary monitor command <em>command</em> to domain <em>domain</em> through
the QEMU monitor. The results of the command will be printed on stdout.</p>
<p>
If more than one argument is provided for <em>command</em>, they are
concatenated with a space in between before passing the single command
to the monitor.</p>
<p>
Note that libvirt uses the QMP to talk to qemu so <em>command</em> must be
valid JSON in QMP format to work properly. If <em>command</em> is not a JSON
object libvirt tries to wrap it as a JSON object to provide convenient
interface such as the groups of commands with identical handling:</p>
<blockquote>
<blockquote>
<pre class="example">
# simple command
$ virsh qemu-monitor-command VM commandname
$ virsh qemu-monitor-command VM &#39;{&#34;execute&#34;:&#34;commandname&#34;}&#39;

# with arguments
$ virsh qemu-monitor-command VM commandname &#39;&#34;arg1&#34;:123&#39; &#39;&#34;arg2&#34;:&#34;test&#34;&#39;
$ virsh qemu-monitor-command VM commandname &#39;{&#34;arg1&#34;:123,&#34;arg2&#34;:&#34;test&#34;}&#39;
$ virsh qemu-monitor-command VM &#39;{&#34;execute&#34;:&#34;commandname&#34;, &#34;arguments&#34;:{&#34;arg1&#34;:123,&#34;arg2&#34;:&#34;test&#34;}}&#39;
</pre>
</blockquote>
</blockquote>
<p>
If <em>–pretty</em> is given the QMP reply is pretty-printed.</p>
<p>
If <em>–return-value</em> is given the &#39;return&#39; key of the QMP response object
is extracted rather than passing through the full reply from QEMU.</p>
<p>
If <em>–hmp</em> is passed, the command is considered to be a human monitor
command and libvirt will automatically convert it into QMP and convert
the result back.</p>
<p>
If <em>–pass-fds</em> is specified, the argument is a comma separated list of
open file descriptors which should be passed on to qemu along with the
command.</p>
</div>
</div>
<div id="outline-container-headline-299" class="outline-3">
<h3 id="headline-299">
qemu-agent-command
</h3>
<div id="outline-text-headline-299" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
qemu-agent-command domain [--timeout seconds | --async | --block] command...
</pre>
</blockquote>
</blockquote>
<p>
Send an arbitrary guest agent command <em>command</em> to domain <em>domain</em>
through QEMU agent. <em>–timeout</em>, <em>–async</em> and <em>–block</em> options are
exclusive. <em>–timeout</em> requires timeout seconds <em>seconds</em> and it must be
positive. When <em>–aysnc</em> is given, the command waits for timeout whether
success or failed. And when <em>–block</em> is given, the command waits
forever with blocking timeout.</p>
</div>
</div>
<div id="outline-container-headline-300" class="outline-3">
<h3 id="headline-300">
qemu-monitor-event
</h3>
<div id="outline-text-headline-300" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
qemu-monitor-event [domain] [--event event-name]
  [--loop] [--timeout seconds] [--pretty] [--regex] [--no-case]
  [--timestamp]
</pre>
</blockquote>
</blockquote>
<p>
Wait for arbitrary QEMU monitor events to occur, and print out the
details of events as they happen. The events can optionally be filtered
by <em>domain</em> or <em>event-name</em>. The &#39;query-events&#39; QMP command can be used
via <em>qemu-monitor-command</em> to learn what events are supported. If
<em>–regex</em> is used, <em>event-name</em> is a basic regular expression instead of
a literal string. If <em>–no-case</em> is used, <em>event-name</em> will match
case-insensitively.</p>
<p>
By default, this command is one-shot, and returns success once an event
occurs; you can send SIGINT (usually via <strong>Ctrl-C</strong>) to quit immediately.
If <em>–timeout</em> is specified, the command gives up waiting for events
after <em>seconds</em> have elapsed. With <em>–loop</em>, the command prints all
events until a timeout or interrupt key. If <em>–pretty</em> is specified, any
JSON event details are pretty-printed for better legibility.</p>
<p>
When <em>–timestamp</em> is used, a human-readable timestamp will be printed
before the event, and the timing information provided by QEMU will be
omitted.</p>
</div>
</div>
<div id="outline-container-headline-301" class="outline-3">
<h3 id="headline-301">
lxc-enter-namespace
</h3>
<div id="outline-text-headline-301" class="outline-text-3">
<p><strong>Syntax:</strong></p>
<blockquote>
<blockquote>
<pre class="example">
lxc-enter-namespace domain [--noseclabel] --
   /path/to/binary [arg1, [arg2, ...]]
</pre>
</blockquote>
</blockquote>
<p>
Enter the namespace of <em>domain</em> and execute the command
<strong>/path/to/binary</strong> passing the requested args. The binary path is
relative to the container root filesystem, not the host root filesystem.
The binary will inherit the environment variables / console visible to
virsh. The command will be run with the same sVirt context and cgroups
placement as processes within the container. This command only works
when connected to the LXC hypervisor driver. This command succeeds only
if <strong>/path/to/binary</strong> has 0 exit status.</p>
<p>
By default the new process will run with the security label of the new
parent container. Use the <em>–noseclabel</em> option to instead have the
process keep the same security label as <strong>virsh</strong>.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-302" class="outline-2">
<h2 id="headline-302">
ENVIRONMENT
</h2>
<div id="outline-text-headline-302" class="outline-text-2">
<p>The following environment variables can be set to alter the behaviour of
<strong>virsh</strong></p>
<blockquote>
<ul>
<li>VIRSH_DEBUG=&lt;0 to 4&gt;</li>
</ul>
<p>Turn on verbose debugging of virsh commands. Valid levels are</p>
<blockquote>
<ul>
<li>VIRSH_DEBUG=0</li>
</ul>
<p>DEBUG - Messages at ALL levels get logged</p>
<ul>
<li>VIRSH_DEBUG=1</li>
</ul>
<p>INFO - Logs messages at levels INFO, NOTICE, WARNING and ERROR</p>
<ul>
<li>VIRSH_DEBUG=2</li>
</ul>
<p>NOTICE - Logs messages at levels NOTICE, WARNING and ERROR</p>
<ul>
<li>VIRSH_DEBUG=3</li>
</ul>
<p>WARNING - Logs messages at levels WARNING and ERROR</p>
<ul>
<li>VIRSH_DEBUG=4</li>
</ul>
<p>ERROR - Messages at only ERROR level gets logged.</p>
</blockquote>
<ul>
<li>VIRSH_LOG_FILE=``LOGFILE``</li>
</ul>
<p>The file to log virsh debug messages.</p>
<ul>
<li>VIRSH_DEFAULT_CONNECT_URI</li>
</ul>
<p>The hypervisor to connect to by default. Set this to a URI, in the same
format as accepted by the <strong>connect</strong> option. This environment variable is
deprecated in favour of the global <strong>LIBVIRT_DEFAULT_URI</strong> variable which
serves the same purpose.</p>
<ul>
<li>LIBVIRT_DEFAULT_URI</li>
</ul>
<p>The hypervisor to connect to by default. Set this to a URI, in the same
format as accepted by the <strong>connect</strong> option. This overrides the default
URI set in any client config file and prevents libvirt from probing for
drivers.</p>
<ul>
<li>VISUAL</li>
</ul>
<p>The editor to use by the <strong>edit</strong> and related options.</p>
<ul>
<li>EDITOR</li>
</ul>
<p>The editor to use by the <strong>edit</strong> and related options, if <strong>VISUAL</strong> is not
set.</p>
<ul>
<li>VIRSH_HISTSIZE</li>
</ul>
<p>The number of commands to remember in the command history. The default
value is 500.</p>
<ul>
<li>LIBVIRT_DEBUG=LEVEL</li>
</ul>
<p>Turn on verbose debugging of all libvirt API calls. Valid levels are</p>
<blockquote>
<ul>
<li>LIBVIRT_DEBUG=1</li>
</ul>
<p>Messages at level DEBUG or above</p>
<ul>
<li>LIBVIRT_DEBUG=2</li>
</ul>
<p>Messages at level INFO or above</p>
<ul>
<li>LIBVIRT_DEBUG=3</li>
</ul>
<p>Messages at level WARNING or above</p>
<ul>
<li>LIBVIRT_DEBUG=4</li>
</ul>
<p>Messages at level ERROR</p>
</blockquote>
</blockquote>
<p>
For further information about debugging options consult
&lt;<a href="https://libvirt.org/logging.html">https://libvirt.org/logging.html</a>&gt;</p>
</div>
</div>
<div id="outline-container-headline-303" class="outline-2">
<h2 id="headline-303">
BUGS
</h2>
<div id="outline-text-headline-303" class="outline-text-2">
<p>Please report all bugs you discover. This should be done via either:</p>
<blockquote>
<ol>
<li>the mailing list</li>
</ol>
<p>&lt;https://libvirt.org/contact.html&gt;</p>
<ol>
<li value="2">the bug tracker</li>
</ol>
<p>&lt;https://libvirt.org/bugs.html&gt;</p>
</blockquote>
<p>
Alternatively, you may report bugs to your software distributor /
vendor.</p>
</div>
</div>
<div id="outline-container-headline-304" class="outline-2">
<h2 id="headline-304">
AUTHORS
</h2>
<div id="outline-text-headline-304" class="outline-text-2">
<p>Please refer to the AUTHORS file distributed with libvirt.</p>
</div>
</div>
<div id="outline-container-headline-305" class="outline-2">
<h2 id="headline-305">
COPYRIGHT
</h2>
<div id="outline-text-headline-305" class="outline-text-2">
<p>Copyright (C) 2005, 2007-2015 Red Hat, Inc., and the authors listed in
the libvirt AUTHORS file.</p>
</div>
</div>
<div id="outline-container-headline-306" class="outline-2">
<h2 id="headline-306">
LICENSE
</h2>
<div id="outline-text-headline-306" class="outline-text-2">
<p><strong>virsh</strong> is distributed under the terms of the GNU LGPL v2+. This is free
software; see the source for copying conditions. There is NO warranty;
not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE</p>
</div>
</div>
<div id="outline-container-headline-307" class="outline-2">
<h2 id="headline-307">
SEE ALSO
</h2>
<div id="outline-text-headline-307" class="outline-text-2">
<p>virt-install(1), virt-xml-validate(1), virt-top(1), virt-df(1),
&lt;<a href="https://libvirt.org/">https://libvirt.org/</a>&gt;</p>
</div>
</div>


        </main>
        <footer class="container footer">
            <p>Copyright 2024. All rights reserved.</p>

        </footer>

        
        

        
            <script src="/js/main.95916b5b8c09add4922ea47e674b5da7fc4b6347a3e8c4e25e98b4b7d236080b.js" integrity="sha256-lZFrW4wJrdSSLqR&#43;Z0tdp/xLY0ej6MTiXpi0t9I2CAs=" crossorigin="anonymous"></script>
    </body>
</html>
