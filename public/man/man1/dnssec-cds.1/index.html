<!DOCTYPE html>
<html
    lang="en-us"
    dir="ltr"
>
    <head>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Manpages - dnssec-cds.1 | Technical Notes</title>

      <link rel="stylesheet" href="/css/main.min.a9ecaac9d4f7845fc2de4738f7709cab0bd1c3d19c3466fadd637a6987603257.css" integrity="sha256-qeyqydT3hF/C3kc493CcqwvRw9GcNGb63WN6aYdgMlc=" crossorigin="anonymous">


<link rel="stylesheet" href="/css/syntax.css">
        
        
    </head>
    <body>
        <header class="container header">
            <span class="header__title">Technical Notes</span>
<button id="menuOpenBtn" class="header__menu-open-btn"><i data-lucide="menu"></i></button>

  <nav id="siteNav">
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a href="/notes/">Notes</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/man/">Manpages</a>
    </li>
    <li>
      <a href="/search/">Search</a>
    </li>
    </ul>
    <button id="menuCloseBtn" class="header__menu-close-btn"><i data-lucide="x"></i></button>
  </nav>


        </header>
        <main class="container">
            
    <h1>Manpages - dnssec-cds.1</h1>
    
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
NAME
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>dnssec-cds - change DS records for a child zone based on CDS/CDNSKEY</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
SYNOPSIS
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p><strong>dnssec-cds</strong> [*-a* algâ€¦] [*-c* class] [*-D*] {<strong>-d</strong> dsset-file} {<strong>-f</strong>
child-file} [*-i**[extension]] [*-s** start-time] [*-T* ttl] [*-u*]
[*-v* level] [*-V*] {domain}</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
DESCRIPTION
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>The <strong>dnssec-cds</strong> command changes DS records at a delegation point based
on CDS or CDNSKEY records published in the child zone. If both CDS and
CDNSKEY records are present in the child zone, the CDS is preferred.
This enables a child zone to inform its parent of upcoming changes to
its key-signing keys (KSKs); by polling periodically with <strong>dnssec-cds</strong>,
the parent can keep the DS records up-to-date and enable automatic
rolling of KSKs.</p>
<p>
Two input files are required. The <em>-f child-file</em> option specifies a
file containing the child&#39;s CDS and/or CDNSKEY records, plus RRSIG and
DNSKEY records so that they can be authenticated. The <em>-d path</em> option
specifies the location of a file containing the current DS records. For
example, this could be a <strong>dsset-</strong> file generated by <em>dnssec-signzone</em>,
or the output of <em>dnssec-dsfromkey</em>, or the output of a previous run of
<strong>dnssec-cds</strong>.</p>
<p>
The <strong>dnssec-cds</strong> command uses special DNSSEC validation logic specified
by <em>RFC 7344</em>. It requires that the CDS and/or CDNSKEY records be
validly signed by a key represented in the existing DS records. This is
typically the pre-existing KSK.</p>
<p>
For protection against replay attacks, the signatures on the child
records must not be older than they were on a previous run of
<strong>dnssec-cds</strong>. Their age is obtained from the modification time of the
<strong>dsset-</strong> file, or from the <em>-s</em> option.</p>
<p>
To protect against breaking the delegation, <strong>dnssec-cds</strong> ensures that
the DNSKEY RRset can be verified by every key algorithm in the new DS
RRset, and that the same set of keys are covered by every DS digest
type.</p>
<p>
By default, replacement DS records are written to the standard output;
with the <em>-i</em> option the input file is overwritten in place. The
replacement DS records are the same as the existing records, when no
change is required. The output can be empty if the CDS/CDNSKEY records
specify that the child zone wants to be insecure.</p>
<p>
<strong>WARNING:</strong></p>
<blockquote>
<blockquote>
<p>Be careful not to delete the DS records when <strong>dnssec-cds</strong> fails!</p>
</blockquote>
</blockquote>
<p>
Alternatively, :option`dnssec-cds -u` writes an <em>nsupdate</em> script to the
standard output. The <em>-u</em> and <em>-i</em> options can be used together to
maintain a <strong>dsset-</strong> file as well as emit an <em>nsupdate</em> script.</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
OPTIONS
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<blockquote>
<dl>
<dt>
<strong>-a algorithm</strong>
</dt>
<dd>When converting CDS records to DS records, this
option specifies the acceptable digest algorithms. This option can be
repeated, so that multiple digest types are allowed. If none of the
CDS records use an acceptable digest type, <strong>dnssec-cds</strong> will try to
use CDNSKEY records instead; if there are no CDNSKEY records, it
reports an error.

When converting CDNSKEY records to DS records, this option specifies
the digest algorithm to use. It can be repeated, so that multiple DS
records are created for each CDNSKEY records.

The algorithm must be one of SHA-1, SHA-256, or SHA-384. These values
are case-insensitive, and the hyphen may be omitted. If no algorithm
is specified, the default is SHA-256 only.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-c class</strong>
</dt>
<dd>This option specifies the DNS class of the zones.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-D</strong>
</dt>
<dd>This option generates DS records from CDNSKEY records if both
CDS and CDNSKEY records are present in the child zone. By default CDS
records are preferred.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-d path</strong>
</dt>
<dd>This specifies the location of the parent DS records. The
path can be the name of a file containing the DS records; if it is a
directory, <strong>dnssec-cds</strong> looks for a <strong>dsset-</strong> file for the domain
inside the directory.

To protect against replay attacks, child records are rejected if they
were signed earlier than the modification time of the <strong>dsset-</strong> file.
This can be adjusted with the <em>-s</em> option.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-f child-file</strong>
</dt>
<dd>This option specifies the file containing the
child&#39;s CDS and/or CDNSKEY records, plus its DNSKEY records and the
covering RRSIG records, so that they can be authenticated.

The examples below describe how to generate this file.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-i extension</strong>
</dt>
<dd>This option updates the <strong>dsset-</strong> file in place,
instead of writing DS records to the standard output.

There must be no space between the <em>-i</em> and the extension. If no
extension is provided, the old <strong>dsset-</strong> is discarded. If an extension
is present, a backup of the old <strong>dsset-</strong> file is kept with the
extension appended to its filename.

To protect against replay attacks, the modification time of the
<strong>dsset-</strong> file is set to match the signature inception time of the
child records, provided that it is later than the file&#39;s current
modification time.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-s start-time</strong>
</dt>
<dd>This option specifies the date and time after which
RRSIG records become acceptable. This can be either an absolute or a
relative time. An absolute start time is indicated by a number in
YYYYMMDDHHMMSS notation; 20170827133700 denotes 13:37:00 UTC on August
27th, 2017. A time relative to the <strong>dsset-</strong> file is indicated with
<strong>-N</strong>, which is N seconds before the file modification time. A time
relative to the current time is indicated with <strong>now+N</strong>.

If no start-time is specified, the modification time of the <strong>dsset-</strong>
file is used.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-T ttl</strong>
</dt>
<dd>This option specifies a TTL to be used for new DS records.
If not specified, the default is the TTL of the old DS records. If
they had no explicit TTL, the new DS records also have no explicit
TTL.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-u</strong>
</dt>
<dd>This option writes an <em>nsupdate</em> script to the standard
output, instead of printing the new DS reords. The output is empty if
no change is needed.

Note: The TTL of new records needs to be specified: it can be done in
the original <strong>dsset-</strong> file, with the <em>-T</em> option, or using the
<em>nsupdate</em> <strong>ttl</strong> command.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-V</strong>
</dt>
<dd>This option prints version information.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong>-v level</strong>
</dt>
<dd>This option sets the debugging level. Level 1 is
intended to be usefully verbose for general users; higher levels are
intended for developers.</dd>
</dl>
</blockquote>
<blockquote>
<dl>
<dt>
<strong><strong>domain</strong></strong>
</dt>
<dd>This indicates the name of the delegation point/child
zone apex.</dd>
</dl>
</blockquote>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
EXIT STATUS
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>The <strong>dnssec-cds</strong> command exits 0 on success, or non-zero if an error
occurred.</p>
<p>
If successful, the DS records may or may not need to be changed.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-2">
<h2 id="headline-6">
EXAMPLES
</h2>
<div id="outline-text-headline-6" class="outline-text-2">
<p>Before running <em>dnssec-signzone</em>, ensure that the delegations are
up-to-date by running <strong>dnssec-cds</strong> on every <strong>dsset-</strong> file.</p>
<p>
To fetch the child records required by <strong>dnssec-cds</strong>, invoke <em>dig</em> as in
the script below. It is acceptable if the <em>dig</em> fails, since
<strong>dnssec-cds</strong> performs all the necessary checking.</p>
<blockquote>
<blockquote>
<pre class="example">
for f in dsset-*
do
    d=${f#dsset-}
    dig +dnssec +noall +answer $d DNSKEY $d CDNSKEY $d CDS |
    dnssec-cds -i -f /dev/stdin -d $f $d
done
</pre>
</blockquote>
</blockquote>
<p>
When the parent zone is automatically signed by <em>named</em>, <strong>dnssec-cds</strong>
can be used with <em>nsupdate</em> to maintain a delegation as follows. The
<strong>dsset-</strong> file allows the script to avoid having to fetch and validate
the parent DS records, and it maintains the replay attack protection
time.</p>
<blockquote>
<blockquote>
<pre class="example">
dig +dnssec +noall +answer $d DNSKEY $d CDNSKEY $d CDS |
dnssec-cds -u -i -f /dev/stdin -d $f $d |
nsupdate -l
</pre>
</blockquote>
</blockquote>
</div>
</div>
<div id="outline-container-headline-7" class="outline-2">
<h2 id="headline-7">
SEE ALSO
</h2>
<div id="outline-text-headline-7" class="outline-text-2">
<p><em>dig(1)</em>, <em>dnssec-settime(8)</em>, <em>dnssec-signzone(8)</em>, <em>nsupdate(1)</em>, BIND
9 Administrator Reference Manual, <em>RFC 7344</em>.</p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-2">
<h2 id="headline-8">
AUTHOR
</h2>
<div id="outline-text-headline-8" class="outline-text-2">
<p>Internet Systems Consortium</p>
</div>
</div>
<div id="outline-container-headline-9" class="outline-2">
<h2 id="headline-9">
COPYRIGHT
</h2>
<div id="outline-text-headline-9" class="outline-text-2">
<p>2024, Internet Systems Consortium</p>
</div>
</div>


        </main>
        <footer class="container footer">
            <p>Copyright 2024. All rights reserved.</p>

        </footer>

        
        

        
            <script src="/js/main.95916b5b8c09add4922ea47e674b5da7fc4b6347a3e8c4e25e98b4b7d236080b.js" integrity="sha256-lZFrW4wJrdSSLqR&#43;Z0tdp/xLY0ej6MTiXpi0t9I2CAs=" crossorigin="anonymous"></script>
    </body>
</html>
